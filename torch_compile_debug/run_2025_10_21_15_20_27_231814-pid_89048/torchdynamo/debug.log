Step 1: torchdynamo start tracing RunLLM /home/client/Projects/RWKV-Infer/rwkvengine/rwkvinfer_fla.py:473
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/rwkvinfer_fla.py:473 in RunLLM (LLMWorker)
        @torch.compile()
TRACE RETURN_GENERATOR None [BuiltinVariable(None)]
TRACE POP_TOP None [BuiltinVariable(None)]
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/rwkvinfer_fla.py:475 in RunLLM (LLMWorker.RunLLM)
            print('Start LLM Engine')
TRACE LOAD_GLOBAL print []
TRACE LOAD_CONST Start LLM Engine [NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), ConstantVariable(str: 'Start LLM Engine')]
empty checkpoint
Step 1: torchdynamo start tracing GQA_Attention_Flash_ /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:875
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:875 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7)
        @torch.compile(mode="max-autotune-no-cudagraphs")
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:904 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            B, T, C = x_in.shape
TRACE LOAD_FAST x_in []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
wrap_to_fake L['x_in'] (1, 512, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='x_in', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_x_in_ L['x_in'] FakeTensor(..., device='cuda:0', size=(1, 512, 5120), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE UNPACK_SEQUENCE 3 [SizeVariable(length=3)]
TRACE STORE_FAST B [ConstantVariable(int: 5120), ConstantVariable(int: 512), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 5120), ConstantVariable(int: 512)]
TRACE STORE_FAST C [ConstantVariable(int: 5120)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:905 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            device = x_in.device
TRACE LOAD_FAST x_in []
TRACE LOAD_ATTR device [TensorVariable()]
TRACE STORE_FAST device [ConstantVariable(device: device(type='cuda', index=0))]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:906 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            Lmax = past_key_value.shape[3]
TRACE LOAD_FAST past_key_value []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
wrap_to_fake L['past_key_value'] (8, 1, 2, 8192, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='past_key_value', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}), tensor_source=LocalSource(local_name='past_key_value', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_past_key_value_ L['past_key_value'] FakeTensor(..., device='cuda:0', size=(8, 1, 2, 8192, 1024),
           dtype=torch.bfloat16) at debug_level 0 before=False
wrap_to_fake L['past_key_value']._base (8, 1, 2, 8192, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='past_key_value', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
TRACE LOAD_CONST 3 [SizeVariable(length=5)]
TRACE BINARY_SUBSCR None [SizeVariable(length=5), ConstantVariable(int: 3)]
TRACE STORE_FAST Lmax [ConstantVariable(int: 8192)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            starts = cache_position[:, 0].clone()
TRACE LOAD_FAST cache_position []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE LOAD_CONST None [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [LazyVariableTracker(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST 0 [LazyVariableTracker(), SliceVariable()]
TRACE BUILD_TUPLE 2 [LazyVariableTracker(), SliceVariable(), ConstantVariable(int: 0)]
TRACE BINARY_SUBSCR None [LazyVariableTracker(), TupleVariable(length=2)]
wrap_to_fake L['cache_position'] (1, 1) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='cache_position', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_cache_position_ L['cache_position'] FakeTensor(..., device='cuda:0', size=(1, 1), dtype=torch.int64) at debug_level 0 before=False
TRACE FX call getitem from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        starts = cache_position[:, 0].clone()
                 ~~~~~~~~~~~~~~^^^^^^
TRACE LOAD_ATTR clone [TensorVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), clone)]
TRACE FX call clone from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        starts = cache_position[:, 0].clone()
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST starts [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:910 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            starts.clamp_(min=0, max=Lmax)
TRACE LOAD_FAST starts []
TRACE LOAD_ATTR clamp_ [TensorVariable()]
TRACE LOAD_CONST 0 [NullVariable, GetAttrVariable(TensorVariable(), clamp_)]
TRACE LOAD_FAST Lmax [NullVariable, GetAttrVariable(TensorVariable(), clamp_), ConstantVariable(int: 0)]
TRACE KW_NAMES ('min', 'max') [NullVariable, GetAttrVariable(TensorVariable(), clamp_), ConstantVariable(int: 0), ConstantVariable(int: 8192)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), clamp_), ConstantVariable(int: 0), ConstantVariable(int: 8192)]
TRACE FX call clamp_ from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:910 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        starts.clamp_(min=0, max=Lmax)
        ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:913 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            x = T5RMSNorm(x_in, ln1, rmsnorm_epsilon)  # 実装は外部
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST x_in [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:913 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        x = T5RMSNorm(x_in, ln1, rmsnorm_epsilon)  # 実装は外部
            ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x7f7c1d008ab0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE FX call add from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln1'] (5120,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln1', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln1_ L['ln1'] FakeTensor(..., device='cuda:0', size=(5120,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x7f7c1d008ab0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:915 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            HN = H * N
TRACE LOAD_FAST H []
TRACE LOAD_FAST N [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), LazyVariableTracker()]
TRACE STORE_FAST HN [ConstantVariable(int: 8192)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:918 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            qkv = fpx_matmul(x, QKV_, QKV_state, ebits, mbits)  # [B,T, QHN + KVd + KVd]
TRACE LOAD_GLOBAL fpx_matmul []
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST QKV_ [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST QKV_state [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_FAST ebits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST mbits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call fpx_matmul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:918 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        qkv = fpx_matmul(x, QKV_, QKV_state, ebits, mbits)  # [B,T, QHN + KVd + KVd]
              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object fpx_matmul at 0x3c1ee490, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:420 in fpx_matmul (fpx_matmul) (inline depth: 1)
    def fpx_matmul(x,weight,weight_state,ebits:int=3,mbits:int=2):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:421 in fpx_matmul (fpx_matmul) (inline depth: 1)
        if ebits == -44: #hqq
TRACE LOAD_FAST ebits []
TRACE LOAD_CONST -44 [LazyVariableTracker()]
TRACE COMPARE_OP == [LazyVariableTracker(), ConstantVariable(int: -44)]
TRACE POP_JUMP_IF_FALSE 322 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S0=x.shape[0]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 0 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 0)]
TRACE STORE_FAST S0 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S1=x.shape[1]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 1)]
TRACE STORE_FAST S1 [ConstantVariable(int: 512)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:424 in fpx_matmul (fpx_matmul) (inline depth: 1)
            dtype = x.dtype
TRACE LOAD_FAST x []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
            x = x.to(dtype=torch.float16).view(-1,x.shape[2])
TRACE LOAD_FAST x []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float16 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_2 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST x [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1)]
TRACE LOAD_ATTR shape [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3), ConstantVariable(int: 2)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), ConstantVariable(int: 5120)]
TRACE FX call view from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
            out = weight.forward_manual(x).to(dtype=dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_ATTR forward_manual [LazyVariableTracker()]
TRACE LOAD_FAST x [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x7f7c1f9a11c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE CALL 1 [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x7f7c1f9a11c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton)), TensorVariable()]
TRACE inlined call forward_manual from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object forward_manual at 0x7f7c1fbe0cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:543 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        def forward_manual(self, x: Tensor, matmul_type: str="GEMM") -> Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE LOAD_GLOBAL forward_functional []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:545 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                x,
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:546 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.bias,
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR bias [NullVariable, LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_tensor_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_ATTR get_tensor_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_tensor_args at 0x7f7c1f9a1080>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_tensor_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_tensor_args(),
            ~~~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_tensor_args at 0x7f7c1fbc6560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:524 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
        def get_tensor_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:525 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
            return [self.W_q, self.scales, self.zeros]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR W_q [UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_FAST self [LazyVariableTracker()]
TRACE LOAD_ATTR scales [LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['QKV_']._parameters['scales'] (80, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='QKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='scales'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_QKV_parameters_scales_ L['QKV_']._parameters['scales'] Parameter(FakeTensor(..., device='cuda:0', size=(80, 10240), dtype=torch.float16)) at debug_level 0 before=False
TRACE LOAD_FAST self [LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR zeros [LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['QKV_']._parameters['zeros'] (80, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='QKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='zeros'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_QKV_parameters_zeros_ L['QKV_']._parameters['zeros'] Parameter(FakeTensor(..., device='cuda:0', size=(80, 10240), dtype=torch.float16)) at debug_level 0 before=False
TRACE BUILD_LIST 3 [LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [ListVariable(length=3)]
DONE INLINING <code object get_tensor_args at 0x7f7c1fbc6560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_meta_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3)]
TRACE LOAD_ATTR get_meta_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_meta_args at 0x7f7c1f9a1120>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_meta_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_meta_args(),
            ~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_meta_args at 0x3c1c0c40, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:527 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
        def get_meta_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE LOAD_GLOBAL int []
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR scaled_activations [NullVariable, LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:529 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_nbits,
TRACE LOAD_FAST self [ConstantVariable(int: 0)]
TRACE LOAD_ATTR W_nbits [ConstantVariable(int: 0), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:530 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.group_size,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker()]
TRACE LOAD_ATTR group_size [ConstantVariable(int: 0), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:531 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.unpack_mask,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR unpack_mask [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:532 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.elements_per_sample,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR elements_per_sample [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:533 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.input_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR input_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:534 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.output_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR output_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:535 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.acc_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR acc_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:536 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.meta_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR meta_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:537 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.channel_scale_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR channel_scale_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:538 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_group_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR W_group_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:539 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    int(self.data_contiguous),
TRACE LOAD_GLOBAL int [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int)]
TRACE LOAD_ATTR data_contiguous [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE BUILD_LIST 12 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [ListVariable(length=12)]
DONE INLINING <code object get_meta_args at 0x3c1c0c40, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:549 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
TRACE LOAD_GLOBAL GEMLITE_MATMUL_TYPES_MAPPING [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12)]
TRACE LOAD_FAST matmul_type [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker(), ConstantVariable(str: 'GEMM')]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        return forward_functional(
               ~~~~~~~~~~~~~~~~~~^
            x,
            ^^
            self.bias,
            ^^^^^^^^^^
            self.get_tensor_args(),
            ^^^^^^^^^^^^^^^^^^^^^^^
            self.get_meta_args(),
            ^^^^^^^^^^^^^^^^^^^^^
            GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object __call__ at 0x7f7c609ab960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:675 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        def __call__(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
            return self._opoverload(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR _opoverload [NullVariable, UserDefinedObjectVariable(CustomOpDef)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=5)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
wrap_to_fake L['QKV_'].W_q (640, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=AttrSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='QKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='W_q'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_QKV_W_q L['QKV_'].W_q FakeTensor(..., device='cuda:0', size=(640, 10240), dtype=torch.int32) at debug_level 0 before=False
TRACE FX call forward_functional_default from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        return self._opoverload(*args, **kwargs)
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object __call__ at 0x7f7c609ab960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object forward_manual at 0x7f7c1fbe0cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_3 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE STORE_FAST out [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
            return out.view(S0,S1,-1)
TRACE LOAD_FAST out []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST S0 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST S1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: -1)]
TRACE FX call view_1 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
        return out.view(S0,S1,-1)
               ~~~~~~~~^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object fpx_matmul at 0x3c1ee490, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>
TRACE STORE_FAST qkv [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:919 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q, k, v = qkv.split(qkv_split_list, dim=-1)
TRACE LOAD_FAST qkv []
TRACE LOAD_ATTR split [TensorVariable()]
TRACE LOAD_FAST qkv_split_list [NullVariable, GetAttrVariable(TensorVariable(), split)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker()]
TRACE KW_NAMES ('dim',) [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE FX call split from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:919 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        q, k, v = qkv.split(qkv_split_list, dim=-1)
                  ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
TRACE UNPACK_SEQUENCE 3 [TupleVariable(length=3)]
TRACE STORE_FAST q [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST k [TensorVariable(), TensorVariable()]
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:922 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q.add_(Q_bias)
TRACE LOAD_FAST q []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST Q_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
wrap_to_fake L['Q_bias'] () StatefulSymbolicContext(dynamic_sizes=[], dynamic_strides=[], constraint_sizes=[], constraint_strides=[], specialize_on=[], view_base_context=None, tensor_source=LocalSource(local_name='Q_bias', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_Q_bias_ L['Q_bias'] FakeTensor(..., device='cuda:0', size=(), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call add_ from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:922 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        q.add_(Q_bias)
        ~~~~~~^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:923 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k.add_(K_bias)
TRACE LOAD_FAST k []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST K_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
TRACE FX call add__1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:923 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        k.add_(K_bias)
        ~~~~~~^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:924 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            v.add_(V_bias)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST V_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
TRACE FX call add__2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:924 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        v.add_(V_bias)
        ~~~~~~^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:927 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q = q.view(B, T, H, N)  # [B,T,H,N]
TRACE LOAD_FAST q []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:927 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        q = q.view(B, T, H, N)  # [B,T,H,N]
            ~~~~~~^^^^^^^^^^^^
TRACE STORE_FAST q [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:928 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            kv_dim_flat = k.shape[-1]     # kv_heads * N
TRACE LOAD_FAST k []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST -1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: -1)]
TRACE STORE_FAST kv_dim_flat [ConstantVariable(int: 1024)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:929 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            kv_heads = kv_dim_flat // N
TRACE LOAD_FAST kv_dim_flat []
TRACE LOAD_FAST N [ConstantVariable(int: 1024)]
TRACE BINARY_OP 2 [ConstantVariable(int: 1024), ConstantVariable(int: 128)]
TRACE STORE_FAST kv_heads [ConstantVariable(int: 8)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:930 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k = k.view(B, T, kv_heads, N) # [B,T,kv_h,N]
TRACE LOAD_FAST k []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_heads [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:930 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        k = k.view(B, T, kv_heads, N) # [B,T,kv_h,N]
            ~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:931 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            v = v.view(B, T, kv_heads, N)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_heads [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:931 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        v = v.view(B, T, kv_heads, N)
            ~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:934 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            if ln_r is not None:
TRACE LOAD_FAST ln_r []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 0 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
wrap_to_fake L['ln_r'] (128,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln_r', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln_r_ L['ln_r'] FakeTensor(..., device='cuda:0', size=(128,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE POP_JUMP_IF_TRUE 606 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:935 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
                q = T5RMSNorm(q, ln_r, rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln_r [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:935 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q = T5RMSNorm(q, ln_r, rmsnorm_epsilon)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x7f7c1d008ab0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x7f7c1d008ab0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST q [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:936 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
                k = T5RMSNorm(k, ln_k, rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln_k [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:936 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k = T5RMSNorm(k, ln_k, rmsnorm_epsilon)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x7f7c1d008ab0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln_k'] (128,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln_k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln_k_ L['ln_k'] FakeTensor(..., device='cuda:0', size=(128,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x7f7c1d008ab0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:940 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k_write = k.view(B, T, -1)
TRACE LOAD_FAST k []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: -1)]
TRACE FX call view_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:940 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        k_write = k.view(B, T, -1)
                  ~~~~~~^^^^^^^^^^
TRACE STORE_FAST k_write [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:941 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            v_write = v.view(B, T, -1)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: -1)]
TRACE FX call view_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:941 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        v_write = v.view(B, T, -1)
                  ~~~~~~^^^^^^^^^^
TRACE STORE_FAST v_write [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:944 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            new_lengths = starts + T
TRACE LOAD_FAST starts []
TRACE LOAD_FAST T [TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), ConstantVariable(int: 512)]
TRACE FX call add_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:944 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        new_lengths = starts + T
                      ~~~~~~~^~~
TRACE STORE_FAST new_lengths [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            excess_tokens = torch.clamp(new_lengths - Lmax, min=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR clamp [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST new_lengths [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST Lmax [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 10 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 8192)]
TRACE FX call sub from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        excess_tokens = torch.clamp(new_lengths - Lmax, min=0)
                                    ~~~~~~~~~~~~^~~~~~
TRACE LOAD_CONST 0 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE KW_NAMES ('min',) [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 0)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 0)]
TRACE FX call clamp from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        excess_tokens = torch.clamp(new_lengths - Lmax, min=0)
                        ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST excess_tokens [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:946 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            batches_to_evict = excess_tokens > 0
TRACE LOAD_FAST excess_tokens []
TRACE LOAD_CONST 0 [TensorVariable()]
TRACE COMPARE_OP > [TensorVariable(), ConstantVariable(int: 0)]
TRACE FX call gt from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:946 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        batches_to_evict = excess_tokens > 0
                           ^^^^^^^^^^^^^^^^^
TRACE STORE_FAST batches_to_evict [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            if bool(batches_to_evict.any()):
TRACE LOAD_GLOBAL bool []
TRACE LOAD_FAST batches_to_evict [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR any [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), any)]
TRACE FX call any_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        if bool(batches_to_evict.any()):
                ~~~~~~~~~~~~~~~~~~~~^^
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
Graph break in user code at /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949
Graph Break Reason: Failed to trace builtin operator
  Explanation: Dynamo does not know how to trace builtin operator `bool` with argument types ['Tensor'] (has_kwargs False)
  Hint: Avoid calling builtin `bool` with argument types ['Tensor']. Consider using an equivalent alternative function/method to `bool`.
  Hint: If you are attempting to call a logging function (e.g. `print`), you can try adding it to `torch._dynamo.config.reorderable_logging_functions`.
  Hint: Please report an issue to PyTorch.

  Developer debug context: builtin bool [<class 'torch._dynamo.variables.tensor.TensorVariable'>] False

 For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0059.html
User code traceback:
  File "/home/client/Projects/RWKV-Infer/rwkv_server_fla_fastapi.py", line 1182, in <module>
    asyncio.run(main())
  File "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
  File "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/asyncio/base_events.py", line 678, in run_until_complete
    self.run_forever()
  File "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/asyncio/base_events.py", line 645, in run_forever
    self._run_once()
  File "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/asyncio/base_events.py", line 1999, in _run_once
    handle._run()
  File "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/home/client/Projects/RWKV-Infer/rwkvengine/rwkvinfer_fla.py", line 703, in RunLLM
    x, _, wkv_states, kv_caches,pos_caches = self.model.forward(idx, shift_states, wkv_states,kv_caches,pos_caches)
  File "/home/client/Projects/RWKV-Infer/rwkvengine/rwkvcore.py", line 1009, in forward
    return HRWKV_7.hxa079r_forward_offload(self,idx,last_wkv_states,kv_cache,pos_cache,full_output)
  File "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 1690, in hxa079r_forward_offload
    xx, x, kv_cache = HRWKV_7.GQA_Attention_Flash_(
  File "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 949, in GQA_Attention_Flash_
    if bool(batches_to_evict.any()):

Step 1: torchdynamo start tracing GQA_Attention_Flash_ /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:875
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:875 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7)
        @torch.compile(mode="max-autotune-no-cudagraphs")
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:904 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            B, T, C = x_in.shape
TRACE LOAD_FAST x_in []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
wrap_to_fake L['x_in'] (1, 512, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='x_in', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_x_in_ L['x_in'] FakeTensor(..., device='cuda:0', size=(1, 512, 5120), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE UNPACK_SEQUENCE 3 [SizeVariable(length=3)]
TRACE STORE_FAST B [ConstantVariable(int: 5120), ConstantVariable(int: 512), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 5120), ConstantVariable(int: 512)]
TRACE STORE_FAST C [ConstantVariable(int: 5120)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:905 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            device = x_in.device
TRACE LOAD_FAST x_in []
TRACE LOAD_ATTR device [TensorVariable()]
TRACE STORE_FAST device [ConstantVariable(device: device(type='cuda', index=0))]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:906 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            Lmax = past_key_value.shape[3]
TRACE LOAD_FAST past_key_value []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
wrap_to_fake L['past_key_value'] (8, 1, 2, 8192, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='past_key_value', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}), tensor_source=LocalSource(local_name='past_key_value', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_past_key_value_ L['past_key_value'] FakeTensor(..., device='cuda:0', size=(8, 1, 2, 8192, 1024),
           dtype=torch.bfloat16) at debug_level 0 before=False
wrap_to_fake L['past_key_value']._base (8, 1, 2, 8192, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='past_key_value', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
TRACE LOAD_CONST 3 [SizeVariable(length=5)]
TRACE BINARY_SUBSCR None [SizeVariable(length=5), ConstantVariable(int: 3)]
TRACE STORE_FAST Lmax [ConstantVariable(int: 8192)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            starts = cache_position[:, 0].clone()
TRACE LOAD_FAST cache_position []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE LOAD_CONST None [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [LazyVariableTracker(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST 0 [LazyVariableTracker(), SliceVariable()]
TRACE BUILD_TUPLE 2 [LazyVariableTracker(), SliceVariable(), ConstantVariable(int: 0)]
TRACE BINARY_SUBSCR None [LazyVariableTracker(), TupleVariable(length=2)]
wrap_to_fake L['cache_position'] (1, 1) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='cache_position', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_cache_position_ L['cache_position'] FakeTensor(..., device='cuda:0', size=(1, 1), dtype=torch.int64) at debug_level 0 before=False
TRACE FX call getitem from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        starts = cache_position[:, 0].clone()
                 ~~~~~~~~~~~~~~^^^^^^
TRACE LOAD_ATTR clone [TensorVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), clone)]
TRACE FX call clone from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        starts = cache_position[:, 0].clone()
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST starts [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:910 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            starts.clamp_(min=0, max=Lmax)
TRACE LOAD_FAST starts []
TRACE LOAD_ATTR clamp_ [TensorVariable()]
TRACE LOAD_CONST 0 [NullVariable, GetAttrVariable(TensorVariable(), clamp_)]
TRACE LOAD_FAST Lmax [NullVariable, GetAttrVariable(TensorVariable(), clamp_), ConstantVariable(int: 0)]
TRACE KW_NAMES ('min', 'max') [NullVariable, GetAttrVariable(TensorVariable(), clamp_), ConstantVariable(int: 0), ConstantVariable(int: 8192)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), clamp_), ConstantVariable(int: 0), ConstantVariable(int: 8192)]
TRACE FX call clamp_ from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:910 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        starts.clamp_(min=0, max=Lmax)
        ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:913 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            x = T5RMSNorm(x_in, ln1, rmsnorm_epsilon)  # 実装は外部
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST x_in [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:913 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        x = T5RMSNorm(x_in, ln1, rmsnorm_epsilon)  # 実装は外部
            ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x7f7c1d008ab0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE FX call add from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln1'] (5120,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln1', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln1_ L['ln1'] FakeTensor(..., device='cuda:0', size=(5120,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x7f7c1d008ab0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:915 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            HN = H * N
TRACE LOAD_FAST H []
TRACE LOAD_FAST N [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), LazyVariableTracker()]
TRACE STORE_FAST HN [ConstantVariable(int: 8192)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:918 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            qkv = fpx_matmul(x, QKV_, QKV_state, ebits, mbits)  # [B,T, QHN + KVd + KVd]
TRACE LOAD_GLOBAL fpx_matmul []
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST QKV_ [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST QKV_state [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_FAST ebits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST mbits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call fpx_matmul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:918 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        qkv = fpx_matmul(x, QKV_, QKV_state, ebits, mbits)  # [B,T, QHN + KVd + KVd]
              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object fpx_matmul at 0x3c1ee490, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:420 in fpx_matmul (fpx_matmul) (inline depth: 1)
    def fpx_matmul(x,weight,weight_state,ebits:int=3,mbits:int=2):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:421 in fpx_matmul (fpx_matmul) (inline depth: 1)
        if ebits == -44: #hqq
TRACE LOAD_FAST ebits []
TRACE LOAD_CONST -44 [LazyVariableTracker()]
TRACE COMPARE_OP == [LazyVariableTracker(), ConstantVariable(int: -44)]
TRACE POP_JUMP_IF_FALSE 322 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S0=x.shape[0]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 0 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 0)]
TRACE STORE_FAST S0 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S1=x.shape[1]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 1)]
TRACE STORE_FAST S1 [ConstantVariable(int: 512)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:424 in fpx_matmul (fpx_matmul) (inline depth: 1)
            dtype = x.dtype
TRACE LOAD_FAST x []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
            x = x.to(dtype=torch.float16).view(-1,x.shape[2])
TRACE LOAD_FAST x []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float16 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_2 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST x [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1)]
TRACE LOAD_ATTR shape [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3), ConstantVariable(int: 2)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), ConstantVariable(int: 5120)]
TRACE FX call view from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
            out = weight.forward_manual(x).to(dtype=dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_ATTR forward_manual [LazyVariableTracker()]
TRACE LOAD_FAST x [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x7f7c1f9a11c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE CALL 1 [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x7f7c1f9a11c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton)), TensorVariable()]
TRACE inlined call forward_manual from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object forward_manual at 0x7f7c1fbe0cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:543 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        def forward_manual(self, x: Tensor, matmul_type: str="GEMM") -> Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE LOAD_GLOBAL forward_functional []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:545 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                x,
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:546 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.bias,
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR bias [NullVariable, LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_tensor_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_ATTR get_tensor_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_tensor_args at 0x7f7c1f9a1080>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_tensor_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_tensor_args(),
            ~~~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_tensor_args at 0x7f7c1fbc6560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:524 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
        def get_tensor_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:525 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
            return [self.W_q, self.scales, self.zeros]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR W_q [UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_FAST self [LazyVariableTracker()]
TRACE LOAD_ATTR scales [LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['QKV_']._parameters['scales'] (80, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='QKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='scales'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_QKV_parameters_scales_ L['QKV_']._parameters['scales'] Parameter(FakeTensor(..., device='cuda:0', size=(80, 10240), dtype=torch.float16)) at debug_level 0 before=False
TRACE LOAD_FAST self [LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR zeros [LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['QKV_']._parameters['zeros'] (80, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='QKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='zeros'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_QKV_parameters_zeros_ L['QKV_']._parameters['zeros'] Parameter(FakeTensor(..., device='cuda:0', size=(80, 10240), dtype=torch.float16)) at debug_level 0 before=False
TRACE BUILD_LIST 3 [LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [ListVariable(length=3)]
DONE INLINING <code object get_tensor_args at 0x7f7c1fbc6560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_meta_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3)]
TRACE LOAD_ATTR get_meta_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_meta_args at 0x7f7c1f9a1120>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_meta_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_meta_args(),
            ~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_meta_args at 0x3c1c0c40, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:527 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
        def get_meta_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE LOAD_GLOBAL int []
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR scaled_activations [NullVariable, LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:529 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_nbits,
TRACE LOAD_FAST self [ConstantVariable(int: 0)]
TRACE LOAD_ATTR W_nbits [ConstantVariable(int: 0), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:530 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.group_size,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker()]
TRACE LOAD_ATTR group_size [ConstantVariable(int: 0), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:531 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.unpack_mask,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR unpack_mask [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:532 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.elements_per_sample,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR elements_per_sample [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:533 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.input_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR input_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:534 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.output_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR output_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:535 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.acc_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR acc_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:536 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.meta_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR meta_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:537 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.channel_scale_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR channel_scale_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:538 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_group_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR W_group_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:539 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    int(self.data_contiguous),
TRACE LOAD_GLOBAL int [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int)]
TRACE LOAD_ATTR data_contiguous [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE BUILD_LIST 12 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [ListVariable(length=12)]
DONE INLINING <code object get_meta_args at 0x3c1c0c40, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:549 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
TRACE LOAD_GLOBAL GEMLITE_MATMUL_TYPES_MAPPING [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12)]
TRACE LOAD_FAST matmul_type [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker(), ConstantVariable(str: 'GEMM')]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        return forward_functional(
               ~~~~~~~~~~~~~~~~~~^
            x,
            ^^
            self.bias,
            ^^^^^^^^^^
            self.get_tensor_args(),
            ^^^^^^^^^^^^^^^^^^^^^^^
            self.get_meta_args(),
            ^^^^^^^^^^^^^^^^^^^^^
            GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object __call__ at 0x7f7c609ab960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:675 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        def __call__(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
            return self._opoverload(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR _opoverload [NullVariable, UserDefinedObjectVariable(CustomOpDef)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=5)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
wrap_to_fake L['QKV_'].W_q (640, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=AttrSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='QKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='W_q'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_QKV_W_q L['QKV_'].W_q FakeTensor(..., device='cuda:0', size=(640, 10240), dtype=torch.int32) at debug_level 0 before=False
TRACE FX call forward_functional_default from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        return self._opoverload(*args, **kwargs)
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object __call__ at 0x7f7c609ab960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object forward_manual at 0x7f7c1fbe0cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_3 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE STORE_FAST out [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
            return out.view(S0,S1,-1)
TRACE LOAD_FAST out []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST S0 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST S1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: -1)]
TRACE FX call view_1 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
        return out.view(S0,S1,-1)
               ~~~~~~~~^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object fpx_matmul at 0x3c1ee490, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>
TRACE STORE_FAST qkv [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:919 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q, k, v = qkv.split(qkv_split_list, dim=-1)
TRACE LOAD_FAST qkv []
TRACE LOAD_ATTR split [TensorVariable()]
TRACE LOAD_FAST qkv_split_list [NullVariable, GetAttrVariable(TensorVariable(), split)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker()]
TRACE KW_NAMES ('dim',) [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE FX call split from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:919 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        q, k, v = qkv.split(qkv_split_list, dim=-1)
                  ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
TRACE UNPACK_SEQUENCE 3 [TupleVariable(length=3)]
TRACE STORE_FAST q [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST k [TensorVariable(), TensorVariable()]
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:922 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q.add_(Q_bias)
TRACE LOAD_FAST q []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST Q_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
wrap_to_fake L['Q_bias'] () StatefulSymbolicContext(dynamic_sizes=[], dynamic_strides=[], constraint_sizes=[], constraint_strides=[], specialize_on=[], view_base_context=None, tensor_source=LocalSource(local_name='Q_bias', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_Q_bias_ L['Q_bias'] FakeTensor(..., device='cuda:0', size=(), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call add_ from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:922 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        q.add_(Q_bias)
        ~~~~~~^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:923 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k.add_(K_bias)
TRACE LOAD_FAST k []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST K_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
TRACE FX call add__1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:923 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        k.add_(K_bias)
        ~~~~~~^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:924 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            v.add_(V_bias)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST V_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
TRACE FX call add__2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:924 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        v.add_(V_bias)
        ~~~~~~^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:927 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q = q.view(B, T, H, N)  # [B,T,H,N]
TRACE LOAD_FAST q []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:927 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        q = q.view(B, T, H, N)  # [B,T,H,N]
            ~~~~~~^^^^^^^^^^^^
TRACE STORE_FAST q [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:928 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            kv_dim_flat = k.shape[-1]     # kv_heads * N
TRACE LOAD_FAST k []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST -1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: -1)]
TRACE STORE_FAST kv_dim_flat [ConstantVariable(int: 1024)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:929 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            kv_heads = kv_dim_flat // N
TRACE LOAD_FAST kv_dim_flat []
TRACE LOAD_FAST N [ConstantVariable(int: 1024)]
TRACE BINARY_OP 2 [ConstantVariable(int: 1024), ConstantVariable(int: 128)]
TRACE STORE_FAST kv_heads [ConstantVariable(int: 8)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:930 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k = k.view(B, T, kv_heads, N) # [B,T,kv_h,N]
TRACE LOAD_FAST k []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_heads [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:930 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        k = k.view(B, T, kv_heads, N) # [B,T,kv_h,N]
            ~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:931 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            v = v.view(B, T, kv_heads, N)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_heads [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:931 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        v = v.view(B, T, kv_heads, N)
            ~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:934 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            if ln_r is not None:
TRACE LOAD_FAST ln_r []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 0 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
wrap_to_fake L['ln_r'] (128,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln_r', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln_r_ L['ln_r'] FakeTensor(..., device='cuda:0', size=(128,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE POP_JUMP_IF_TRUE 606 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:935 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
                q = T5RMSNorm(q, ln_r, rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln_r [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:935 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q = T5RMSNorm(q, ln_r, rmsnorm_epsilon)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x7f7c1d008ab0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x7f7c1d008ab0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST q [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:936 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
                k = T5RMSNorm(k, ln_k, rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln_k [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:936 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k = T5RMSNorm(k, ln_k, rmsnorm_epsilon)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x7f7c1d008ab0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln_k'] (128,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln_k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln_k_ L['ln_k'] FakeTensor(..., device='cuda:0', size=(128,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x7f7c1d008ab0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:940 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k_write = k.view(B, T, -1)
TRACE LOAD_FAST k []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: -1)]
TRACE FX call view_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:940 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        k_write = k.view(B, T, -1)
                  ~~~~~~^^^^^^^^^^
TRACE STORE_FAST k_write [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:941 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            v_write = v.view(B, T, -1)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: -1)]
TRACE FX call view_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:941 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        v_write = v.view(B, T, -1)
                  ~~~~~~^^^^^^^^^^
TRACE STORE_FAST v_write [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:944 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            new_lengths = starts + T
TRACE LOAD_FAST starts []
TRACE LOAD_FAST T [TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), ConstantVariable(int: 512)]
TRACE FX call add_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:944 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        new_lengths = starts + T
                      ~~~~~~~^~~
TRACE STORE_FAST new_lengths [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            excess_tokens = torch.clamp(new_lengths - Lmax, min=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR clamp [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST new_lengths [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST Lmax [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 10 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 8192)]
TRACE FX call sub from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        excess_tokens = torch.clamp(new_lengths - Lmax, min=0)
                                    ~~~~~~~~~~~~^~~~~~
TRACE LOAD_CONST 0 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE KW_NAMES ('min',) [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 0)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 0)]
TRACE FX call clamp from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        excess_tokens = torch.clamp(new_lengths - Lmax, min=0)
                        ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST excess_tokens [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:946 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            batches_to_evict = excess_tokens > 0
TRACE LOAD_FAST excess_tokens []
TRACE LOAD_CONST 0 [TensorVariable()]
TRACE COMPARE_OP > [TensorVariable(), ConstantVariable(int: 0)]
TRACE FX call gt from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:946 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        batches_to_evict = excess_tokens > 0
                           ^^^^^^^^^^^^^^^^^
TRACE STORE_FAST batches_to_evict [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            if bool(batches_to_evict.any()):
TRACE LOAD_GLOBAL bool []
TRACE LOAD_FAST batches_to_evict [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR any [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), any)]
TRACE FX call any_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        if bool(batches_to_evict.any()):
                ~~~~~~~~~~~~~~~~~~~~^^
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
COMPILING GRAPH due to GraphCompileReason(reason="Failed to trace builtin operator\n  Explanation: Dynamo does not know how to trace builtin operator `bool` with argument types ['Tensor'] (has_kwargs False)\n  Hint: Avoid calling builtin `bool` with argument types ['Tensor']. Consider using an equivalent alternative function/method to `bool`.\n  Hint: If you are attempting to call a logging function (e.g. `print`), you can try adding it to `torch._dynamo.config.reorderable_logging_functions`.\n  Hint: Please report an issue to PyTorch.\n\n  Developer debug context: builtin bool [<class 'torch._dynamo.variables.tensor.TensorVariable'>] False\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0059.html", user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py, line 949 in GQA_Attention_Flash_>], graph_break=True)
REMOVE UNUSED GRAPHARG L['past_key_value']
TRACED GRAPH
 ===== __compiled_fn_3_4a92453f_b94f_4b7b_9afc_f216e6953089 =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, L_x_in_: "[31mbf16[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m", L_cache_position_: "[31mi64[0m[34m[1, 1][0m[2m[34m[1, 1][0m[2m[32mcuda:0[0m", L_ln1_: "[31mbf16[0m[34m[5120][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_QKV_parameters_scales_: "[31mf16[0m[34m[80, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m", L_QKV_parameters_zeros_: "[31mf16[0m[34m[80, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m", L_QKV_W_q: "[31mi32[0m[34m[640, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m", L_Q_bias_: "[31mbf16[0m[34m[][0m[2m[34m[][0m[2m[32mcuda:0[0m", L_ln_r_: "[31mbf16[0m[34m[128][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_ln_k_: "[31mbf16[0m[34m[128][0m[2m[34m[1][0m[2m[32mcuda:0[0m"):
        l_x_in_ = L_x_in_
        l_cache_position_ = L_cache_position_
        l_ln1_ = L_ln1_
        l_qkv_parameters_scales_ = L_QKV_parameters_scales_
        l_qkv_parameters_zeros_ = L_QKV_parameters_zeros_
        l_qkv_w_q = L_QKV_W_q
        l_q_bias_ = L_Q_bias_
        l_ln_r_ = L_ln_r_
        l_ln_k_ = L_ln_k_
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_, code: starts = cache_position[:, 0].clone()[0m
        getitem: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = l_cache_position_[(slice([34mNone[0m, [34mNone[0m, [34mNone[0m), [34m0[0m)];  [2ml_cache_position_ = None[0m
        starts: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = getitem.clone();  [2mgetitem = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:910 in GQA_Attention_Flash_, code: starts.clamp_(min=0, max=Lmax)[0m
        clamp_: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = starts.clamp_(min = [34m0[0m, max = [34m8192[0m);  [2mclamp_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states: "[31mf32[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = l_x_in_.to([34mtorch.float32[0m);  [2ml_x_in_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_1: "[31mf32[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states.pow([34m2[0m)
        variance: "[31mf32[0m[34m[1, 512, 1][0m[2m[34m[512, 1, 1][0m[2m[32mcuda:0[0m" = pow_1.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add: "[31mf32[0m[34m[1, 512, 1][0m[2m[34m[512, 1, 1][0m[2m[32mcuda:0[0m" = variance + [34m1e-06[0m;  [2mvariance = None[0m
        rsqrt: "[31mf32[0m[34m[1, 512, 1][0m[2m[34m[512, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add);  [2madd = None[0m
        hidden_states_1: "[31mf32[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states * rsqrt;  [2mhidden_states = rsqrt = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_1: "[31mf32[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = l_ln1_ * hidden_states_1;  [2ml_ln1_ = hidden_states_1 = None[0m
        x: "[31mbf16[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = mul_1.to([34mtorch.bfloat16[0m);  [2mmul_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul, code: x = x.to(dtype=torch.float16).view(-1,x.shape[2])[0m
        to_2: "[31mf16[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = x.to(dtype = [34mtorch.float16[0m);  [2mx = None[0m
        x_1: "[31mf16[0m[34m[512, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m" = to_2.view([34m-1[0m, [34m5120[0m);  [2mto_2 = None[0m
        
         [2m# File: /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__, code: return self._opoverload(*args, **kwargs)[0m
        forward_functional_default: "[31mf16[0m[34m[512, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m" = torch.ops.gemlite.forward_functional.default(x_1, [34mNone[0m, [l_qkv_w_q, l_qkv_parameters_scales_, l_qkv_parameters_zeros_], [[34m0[0m, [34m4[0m, [34m64[0m, [34m15[0m, [34m8[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m0[0m, [34m4[0m, [34m1[0m], [34m4[0m);  [2mx_1 = l_qkv_w_q = l_qkv_parameters_scales_ = l_qkv_parameters_zeros_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul, code: out = weight.forward_manual(x).to(dtype=dtype)[0m
        out: "[31mbf16[0m[34m[512, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m" = forward_functional_default.to(dtype = [34mtorch.bfloat16[0m);  [2mforward_functional_default = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul, code: return out.view(S0,S1,-1)[0m
        qkv: "[31mbf16[0m[34m[1, 512, 10240][0m[2m[34m[5242880, 10240, 1][0m[2m[32mcuda:0[0m" = out.view([34m1[0m, [34m512[0m, [34m-1[0m);  [2mout = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:919 in GQA_Attention_Flash_, code: q, k, v = qkv.split(qkv_split_list, dim=-1)[0m
        split = qkv.split([[34m8192[0m, [34m1024[0m, [34m1024[0m], dim = [34m-1[0m);  [2mqkv = None[0m
        q: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[5242880, 10240, 1][0m[2m[32mcuda:0[0m" = split[[34m0[0m]
        k: "[31mbf16[0m[34m[1, 512, 1024][0m[2m[34m[5242880, 10240, 1][0m[2m[32mcuda:0[0m" = split[[34m1[0m]
        v: "[31mbf16[0m[34m[1, 512, 1024][0m[2m[34m[5242880, 10240, 1][0m[2m[32mcuda:0[0m" = split[[34m2[0m];  [2msplit = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:922 in GQA_Attention_Flash_, code: q.add_(Q_bias)[0m
        add_: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[5242880, 10240, 1][0m[2m[32mcuda:0[0m" = q.add_(l_q_bias_);  [2madd_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:923 in GQA_Attention_Flash_, code: k.add_(K_bias)[0m
        add__1: "[31mbf16[0m[34m[1, 512, 1024][0m[2m[34m[5242880, 10240, 1][0m[2m[32mcuda:0[0m" = k.add_(l_q_bias_);  [2madd__1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:924 in GQA_Attention_Flash_, code: v.add_(V_bias)[0m
        add__2: "[31mbf16[0m[34m[1, 512, 1024][0m[2m[34m[5242880, 10240, 1][0m[2m[32mcuda:0[0m" = v.add_(l_q_bias_);  [2ml_q_bias_ = add__2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:927 in GQA_Attention_Flash_, code: q = q.view(B, T, H, N)  # [B,T,H,N][0m
        q_1: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[5242880, 10240, 128, 1][0m[2m[32mcuda:0[0m" = q.view([34m1[0m, [34m512[0m, [34m64[0m, [34m128[0m);  [2mq = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:930 in GQA_Attention_Flash_, code: k = k.view(B, T, kv_heads, N) # [B,T,kv_h,N][0m
        k_1: "[31mbf16[0m[34m[1, 512, 8, 128][0m[2m[34m[5242880, 10240, 128, 1][0m[2m[32mcuda:0[0m" = k.view([34m1[0m, [34m512[0m, [34m8[0m, [34m128[0m);  [2mk = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:931 in GQA_Attention_Flash_, code: v = v.view(B, T, kv_heads, N)[0m
        v_1: "[31mbf16[0m[34m[1, 512, 8, 128][0m[2m[34m[5242880, 10240, 128, 1][0m[2m[32mcuda:0[0m" = v.view([34m1[0m, [34m512[0m, [34m8[0m, [34m128[0m);  [2mv = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states_2: "[31mf32[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = q_1.to([34mtorch.float32[0m);  [2mq_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_2: "[31mf32[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_2.pow([34m2[0m)
        variance_1: "[31mf32[0m[34m[1, 512, 64, 1][0m[2m[34m[32768, 64, 1, 1][0m[2m[32mcuda:0[0m" = pow_2.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add_1: "[31mf32[0m[34m[1, 512, 64, 1][0m[2m[34m[32768, 64, 1, 1][0m[2m[32mcuda:0[0m" = variance_1 + [34m1e-06[0m;  [2mvariance_1 = None[0m
        rsqrt_1: "[31mf32[0m[34m[1, 512, 64, 1][0m[2m[34m[32768, 64, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add_1);  [2madd_1 = None[0m
        hidden_states_3: "[31mf32[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_2 * rsqrt_1;  [2mhidden_states_2 = rsqrt_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_3: "[31mf32[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = l_ln_r_ * hidden_states_3;  [2ml_ln_r_ = hidden_states_3 = None[0m
        q_2: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = mul_3.to([34mtorch.bfloat16[0m);  [2mmul_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states_4: "[31mf32[0m[34m[1, 512, 8, 128][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = k_1.to([34mtorch.float32[0m);  [2mk_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_3: "[31mf32[0m[34m[1, 512, 8, 128][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_4.pow([34m2[0m)
        variance_2: "[31mf32[0m[34m[1, 512, 8, 1][0m[2m[34m[4096, 8, 1, 1][0m[2m[32mcuda:0[0m" = pow_3.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add_2: "[31mf32[0m[34m[1, 512, 8, 1][0m[2m[34m[4096, 8, 1, 1][0m[2m[32mcuda:0[0m" = variance_2 + [34m1e-06[0m;  [2mvariance_2 = None[0m
        rsqrt_2: "[31mf32[0m[34m[1, 512, 8, 1][0m[2m[34m[4096, 8, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add_2);  [2madd_2 = None[0m
        hidden_states_5: "[31mf32[0m[34m[1, 512, 8, 128][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_4 * rsqrt_2;  [2mhidden_states_4 = rsqrt_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_5: "[31mf32[0m[34m[1, 512, 8, 128][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = l_ln_k_ * hidden_states_5;  [2ml_ln_k_ = hidden_states_5 = None[0m
        k_2: "[31mbf16[0m[34m[1, 512, 8, 128][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = mul_5.to([34mtorch.bfloat16[0m);  [2mmul_5 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:940 in GQA_Attention_Flash_, code: k_write = k.view(B, T, -1)[0m
        k_write: "[31mbf16[0m[34m[1, 512, 1024][0m[2m[34m[524288, 1024, 1][0m[2m[32mcuda:0[0m" = k_2.view([34m1[0m, [34m512[0m, [34m-1[0m)
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:941 in GQA_Attention_Flash_, code: v_write = v.view(B, T, -1)[0m
        v_write: "[31mbf16[0m[34m[1, 512, 1024][0m[2m[34m[5242880, 10240, 1][0m[2m[32mcuda:0[0m" = v_1.view([34m1[0m, [34m512[0m, [34m-1[0m)
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:944 in GQA_Attention_Flash_, code: new_lengths = starts + T[0m
        new_lengths: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = starts + [34m512[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_, code: excess_tokens = torch.clamp(new_lengths - Lmax, min=0)[0m
        sub: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = new_lengths - [34m8192[0m;  [2mnew_lengths = None[0m
        excess_tokens: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = torch.clamp(sub, min = [34m0[0m);  [2msub = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:946 in GQA_Attention_Flash_, code: batches_to_evict = excess_tokens > 0[0m
        batches_to_evict: "[31mb8[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = excess_tokens > [34m0[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949 in GQA_Attention_Flash_, code: if bool(batches_to_evict.any()):[0m
        any_1: "[31mb8[0m[34m[][0m[2m[34m[][0m[2m[32mcuda:0[0m" = batches_to_evict.any()
        return (any_1, starts, q_2, k_2, v_1, k_write, v_write, excess_tokens, batches_to_evict)
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing torch_dynamo_resume_in_GQA_Attention_Flash__at_949 /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949 in torch_dynamo_resume_in_GQA_Attention_Flash__at_949 (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            if bool(batches_to_evict.any()):
TRACE RESUME 0 []
TRACE LOAD_CONST True []
TRACE STORE_FAST __is_tracing_resume_prologue [ConstantVariable(bool: True)]
TRACE LOAD_FAST ___stack0 []
TRACE LOAD_CONST False [LazyVariableTracker()]
TRACE STORE_FAST __is_tracing_resume_prologue [LazyVariableTracker(), ConstantVariable(bool: False)]
TRACE JUMP_FORWARD 816 [LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 876 [LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:955 in torch_dynamo_resume_in_GQA_Attention_Flash__at_949 (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            for b in range(B):
TRACE LOAD_GLOBAL range []
TRACE LOAD_FAST B [NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 1192 [RangeIteratorVariable()]
TRACE STORE_FAST b [RangeIteratorVariable(), ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:956 in torch_dynamo_resume_in_GQA_Attention_Flash__at_949 (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
                s = int(starts[b].item())
TRACE LOAD_GLOBAL int [RangeIteratorVariable()]
TRACE LOAD_FAST starts [RangeIteratorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST b [RangeIteratorVariable(), NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [RangeIteratorVariable(), NullVariable, LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: 0)]
wrap_to_fake L['starts'] (1,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='starts', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_starts_ L['starts'] FakeTensor(..., device='cuda:0', size=(1,), dtype=torch.int64) at debug_level 0 before=False
TRACE FX call getitem from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:956 in torch_dynamo_resume_in_GQA_Attention_Flash__at_949 (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            s = int(starts[b].item())
                    ~~~~~~^^^
TRACE LOAD_ATTR item [RangeIteratorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE CALL 0 [RangeIteratorVariable(), NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), item)]
TRACE FX call item from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:956 in torch_dynamo_resume_in_GQA_Attention_Flash__at_949 (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            s = int(starts[b].item())
                    ~~~~~~~~~~~~~~^^
TRACE CALL 1 [RangeIteratorVariable(), NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE FX call sym_int from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:956 in torch_dynamo_resume_in_GQA_Attention_Flash__at_949 (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            s = int(starts[b].item())
                ~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST s [RangeIteratorVariable(), SymNodeVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:957 in torch_dynamo_resume_in_GQA_Attention_Flash__at_949 (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
                write_T = min(T, Lmax - s)
TRACE LOAD_GLOBAL min [RangeIteratorVariable()]
TRACE LOAD_FAST T [RangeIteratorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST Lmax [RangeIteratorVariable(), NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST s [RangeIteratorVariable(), NullVariable, LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE BINARY_OP 10 [RangeIteratorVariable(), NullVariable, LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), SymNodeVariable()]
TRACE FX call sub from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:957 in torch_dynamo_resume_in_GQA_Attention_Flash__at_949 (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            write_T = min(T, Lmax - s)
                             ~~~~~^~~
TRACE CALL 2 [RangeIteratorVariable(), NullVariable, LazyVariableTracker(), LazyVariableTracker(), SymNodeVariable()]
TRACE FX call sym_min from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:957 in torch_dynamo_resume_in_GQA_Attention_Flash__at_949 (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            write_T = min(T, Lmax - s)
                      ~~~^^^^^^^^^^^^^
TRACE STORE_FAST write_T [RangeIteratorVariable(), SymNodeVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:958 in torch_dynamo_resume_in_GQA_Attention_Flash__at_949 (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
                if write_T > 0:
TRACE LOAD_FAST write_T [RangeIteratorVariable()]
TRACE LOAD_CONST 0 [RangeIteratorVariable(), SymNodeVariable()]
TRACE COMPARE_OP > [RangeIteratorVariable(), SymNodeVariable(), ConstantVariable(int: 0)]
TRACE FX call gt from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:958 in torch_dynamo_resume_in_GQA_Attention_Flash__at_949 (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            if write_T > 0:
               ^^^^^^^^^^^
TRACE POP_JUMP_IF_TRUE 1002 [RangeIteratorVariable(), SymNodeVariable()]
Graph break in user code at /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:958
Graph Break Reason: Data-dependent branching
  Explanation: Detected data-dependent branching (e.g. `if my_tensor.sum() > 0:`). Dynamo does not support tracing dynamic control flow.
  Hint: This graph break is fundamental - it is unlikely that Dynamo will ever be able to trace through your code. Consider finding a workaround.
  Hint: Use `torch.cond` to express dynamic control flow.

  Developer debug context: attempted to jump with SymNodeVariable()

User code traceback:
  File "/home/client/Projects/RWKV-Infer/rwkv_server_fla_fastapi.py", line 1182, in <module>
    asyncio.run(main())
  File "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
  File "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/asyncio/base_events.py", line 678, in run_until_complete
    self.run_forever()
  File "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/asyncio/base_events.py", line 645, in run_forever
    self._run_once()
  File "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/asyncio/base_events.py", line 1999, in _run_once
    handle._run()
  File "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/home/client/Projects/RWKV-Infer/rwkvengine/rwkvinfer_fla.py", line 703, in RunLLM
    x, _, wkv_states, kv_caches,pos_caches = self.model.forward(idx, shift_states, wkv_states,kv_caches,pos_caches)
  File "/home/client/Projects/RWKV-Infer/rwkvengine/rwkvcore.py", line 1009, in forward
    return HRWKV_7.hxa079r_forward_offload(self,idx,last_wkv_states,kv_cache,pos_cache,full_output)
  File "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 1690, in hxa079r_forward_offload
    xx, x, kv_cache = HRWKV_7.GQA_Attention_Flash_(
  File "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 958, in GQA_Attention_Flash_
    if write_T > 0:

Skipping frame because there is a graph break in a for/while loop
<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py, line 958 in torch_dynamo_resume_in_GQA_Attention_Flash__at_949>
Step 1: torchdynamo start tracing forward /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:831
TRACE MAKE_CELL max_seqlens_q []
TRACE MAKE_CELL batch []
TRACE MAKE_CELL nheads_q []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:831 in forward (_attention)
        @staticmethod
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:848 in forward (_attention.forward)
            use_fp8 = False
TRACE LOAD_CONST False []
TRACE STORE_FAST use_fp8 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:849 in forward (_attention.forward)
            fp8_out_scale=None
TRACE LOAD_CONST None []
TRACE STORE_FAST fp8_out_scale [ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:850 in forward (_attention.forward)
            fp8_scales=None
TRACE LOAD_CONST None []
TRACE STORE_FAST fp8_scales [ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:851 in forward (_attention.forward)
            q_scale = k_scale = v_scale = p_scale = 1.0
TRACE LOAD_CONST 1.0 []
TRACE COPY 1 [ConstantVariable(float: 1.0)]
TRACE STORE_FAST q_scale [ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE COPY 1 [ConstantVariable(float: 1.0)]
TRACE STORE_FAST k_scale [ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE COPY 1 [ConstantVariable(float: 1.0)]
TRACE STORE_FAST v_scale [ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE STORE_FAST p_scale [ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:853 in forward (_attention.forward)
            if o is None:
TRACE LOAD_FAST o []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
wrap_to_fake L['o'] (512, 64, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='o', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_o_ L['o'] FakeTensor(..., device='cuda:0', size=(512, 64, 128), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE POP_JUMP_IF_TRUE 110 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:865 in forward (_attention.forward)
            if True:  # varlen
TRACE NOP None []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:866 in forward (_attention.forward)
                total_q, nheads_q, head_size = q.shape
TRACE LOAD_FAST q []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
wrap_to_fake L['q'] (512, 64, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None], constraint_strides=[None, None, None, None], specialize_on=[[], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='q', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}), tensor_source=LocalSource(local_name='q', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_q_ L['q'] FakeTensor(..., device='cuda:0', size=(512, 64, 128), dtype=torch.bfloat16) at debug_level 0 before=False
wrap_to_fake L['q']._base (1, 512, 64, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None], constraint_strides=[None, None, None, None], specialize_on=[[], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='q', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
TRACE UNPACK_SEQUENCE 3 [SizeVariable(length=3)]
TRACE STORE_FAST total_q [ConstantVariable(int: 128), ConstantVariable(int: 64), ConstantVariable(int: 512)]
TRACE STORE_DEREF nheads_q [ConstantVariable(int: 128), ConstantVariable(int: 64)]
TRACE STORE_FAST head_size [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:867 in forward (_attention.forward)
                total_k, nheads_k, _ = k.shape
TRACE LOAD_FAST k []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
wrap_to_fake L['k'] (512, 8, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_k_ L['k'] FakeTensor(..., device='cuda:0', size=(512, 8, 128), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE UNPACK_SEQUENCE 3 [SizeVariable(length=3)]
TRACE STORE_FAST total_k [ConstantVariable(int: 128), ConstantVariable(int: 8), ConstantVariable(int: 512)]
TRACE STORE_FAST nheads_k [ConstantVariable(int: 128), ConstantVariable(int: 8)]
TRACE STORE_FAST _ [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:868 in forward (_attention.forward)
                batch = len(cu_seqlens_q) - 1
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST cu_seqlens_q [NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
wrap_to_fake L['cu_seqlens_q'] (2,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='cu_seqlens_q', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_cu_seqlens_q_ L['cu_seqlens_q'] FakeTensor(..., device='cuda:0', size=(2,), dtype=torch.int32) at debug_level 0 before=False
TRACE LOAD_CONST 1 [ConstantVariable(int: 2)]
TRACE BINARY_OP 10 [ConstantVariable(int: 2), ConstantVariable(int: 1)]
TRACE STORE_DEREF batch [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:869 in forward (_attention.forward)
                q_strides = (0, q.stride(1), q.stride(0), q.stride(2))
TRACE LOAD_CONST 0 []
TRACE LOAD_FAST q [ConstantVariable(int: 0)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), TensorVariable()]
TRACE LOAD_CONST 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 1)]
TRACE LOAD_FAST q [ConstantVariable(int: 0), ConstantVariable(int: 128)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 0)]
TRACE LOAD_FAST q [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), TensorVariable()]
TRACE LOAD_CONST 2 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 2)]
TRACE BUILD_TUPLE 4 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), ConstantVariable(int: 1)]
TRACE STORE_FAST q_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:870 in forward (_attention.forward)
                k_strides = (0, k.stride(1), k.stride(0), k.stride(2))
TRACE LOAD_CONST 0 []
TRACE LOAD_FAST k [ConstantVariable(int: 0)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), TensorVariable()]
TRACE LOAD_CONST 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 1)]
TRACE LOAD_FAST k [ConstantVariable(int: 0), ConstantVariable(int: 128)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 0)]
TRACE LOAD_FAST k [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), TensorVariable()]
TRACE LOAD_CONST 2 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 2)]
TRACE BUILD_TUPLE 4 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), ConstantVariable(int: 1)]
TRACE STORE_FAST k_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:871 in forward (_attention.forward)
                v_strides = (0, v.stride(1), v.stride(0), v.stride(2))
TRACE LOAD_CONST 0 []
TRACE LOAD_FAST v [ConstantVariable(int: 0)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), LazyVariableTracker()]
wrap_to_fake L['v'] (512, 8, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='v', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_v_ L['v'] FakeTensor(..., device='cuda:0', size=(512, 8, 128), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE LOAD_CONST 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 1)]
TRACE LOAD_FAST v [ConstantVariable(int: 0), ConstantVariable(int: 128)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 0)]
TRACE LOAD_FAST v [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), TensorVariable()]
TRACE LOAD_CONST 2 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 2)]
TRACE BUILD_TUPLE 4 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), ConstantVariable(int: 1)]
TRACE STORE_FAST v_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:872 in forward (_attention.forward)
                o_strides = (0, o.stride(1), o.stride(0), o.stride(2))
TRACE LOAD_CONST 0 []
TRACE LOAD_FAST o [ConstantVariable(int: 0)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), TensorVariable()]
TRACE LOAD_CONST 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 1)]
TRACE LOAD_FAST o [ConstantVariable(int: 0), ConstantVariable(int: 128)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 0)]
TRACE LOAD_FAST o [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), TensorVariable()]
TRACE LOAD_CONST 2 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 2)]
TRACE BUILD_TUPLE 4 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), ConstantVariable(int: 1)]
TRACE STORE_FAST o_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:882 in forward (_attention.forward)
            unpadded_head_dims = {32, 64, 128, 256}
TRACE BUILD_SET 0 []
TRACE LOAD_CONST frozenset({256, 32, 64, 128}) [SetVariable()]
TRACE SET_UPDATE 1 [SetVariable(), FrozensetVariable()]
TRACE inlined call set_update from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:882 in forward (_attention.forward)
        unpadded_head_dims = {32, 64, 128, 256}
                             ^^^^^^^^^^^^^^^^^^
INLINING <code object set_update at 0x7f7c332be630, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 210>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:210 in set_update (set_update) (inline depth: 1)
    def set_update(set1, *others):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:211 in set_update (set_update) (inline depth: 1)
        if len(others) == 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST others [NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=1)]
TRACE LOAD_CONST 0 [ConstantVariable(int: 1)]
TRACE COMPARE_OP == [ConstantVariable(int: 1), ConstantVariable(int: 0)]
TRACE POP_JUMP_IF_FALSE 34 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:214 in set_update (set_update) (inline depth: 1)
        for set2 in others:
TRACE LOAD_FAST others []
TRACE GET_ITER None [TupleVariable(length=1)]
TRACE FOR_ITER 104 [ListIteratorVariable(length=1, index=0)]
TRACE STORE_FAST set2 [ListIteratorVariable(length=1, index=1), FrozensetVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE LOAD_FAST set2 [ListIteratorVariable(length=1, index=1)]
TRACE GET_ITER None [ListIteratorVariable(length=1, index=1), FrozensetVariable()]
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=0)]
TRACE STORE_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(int: 256)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:216 in set_update (set_update) (inline depth: 1)
                if x not in set1:
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1)]
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(int: 256)]
TRACE CONTAINS_OP 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(int: 256), SetVariable()]
TRACE POP_JUMP_IF_TRUE 64 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:217 in set_update (set_update) (inline depth: 1)
                    set1.add(x)
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1)]
TRACE LOAD_ATTR add [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), SetVariable()]
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), NullVariable, GetAttrVariable(SetVariable(), add)]
TRACE CALL 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), NullVariable, GetAttrVariable(SetVariable(), add), ConstantVariable(int: 256)]
TRACE POP_TOP None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 48 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1)]
TRACE STORE_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(int: 32)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:216 in set_update (set_update) (inline depth: 1)
                if x not in set1:
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2)]
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(int: 32)]
TRACE CONTAINS_OP 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(int: 32), SetVariable()]
TRACE POP_JUMP_IF_TRUE 64 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:217 in set_update (set_update) (inline depth: 1)
                    set1.add(x)
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2)]
TRACE LOAD_ATTR add [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), SetVariable()]
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), NullVariable, GetAttrVariable(SetVariable(), add)]
TRACE CALL 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), NullVariable, GetAttrVariable(SetVariable(), add), ConstantVariable(int: 32)]
TRACE POP_TOP None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 48 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2)]
TRACE STORE_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(int: 64)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:216 in set_update (set_update) (inline depth: 1)
                if x not in set1:
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3)]
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(int: 64)]
TRACE CONTAINS_OP 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(int: 64), SetVariable()]
TRACE POP_JUMP_IF_TRUE 64 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:217 in set_update (set_update) (inline depth: 1)
                    set1.add(x)
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3)]
TRACE LOAD_ATTR add [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), SetVariable()]
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), NullVariable, GetAttrVariable(SetVariable(), add)]
TRACE CALL 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), NullVariable, GetAttrVariable(SetVariable(), add), ConstantVariable(int: 64)]
TRACE POP_TOP None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 48 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3)]
TRACE STORE_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(int: 128)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:216 in set_update (set_update) (inline depth: 1)
                if x not in set1:
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4)]
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(int: 128)]
TRACE CONTAINS_OP 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(int: 128), SetVariable()]
TRACE POP_JUMP_IF_TRUE 64 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:217 in set_update (set_update) (inline depth: 1)
                    set1.add(x)
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4)]
TRACE LOAD_ATTR add [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), SetVariable()]
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), NullVariable, GetAttrVariable(SetVariable(), add)]
TRACE CALL 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), NullVariable, GetAttrVariable(SetVariable(), add), ConstantVariable(int: 128)]
TRACE POP_TOP None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 48 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4)]
TRACE END_FOR None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 38 [ListIteratorVariable(length=1, index=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:214 in set_update (set_update) (inline depth: 1)
        for set2 in others:
TRACE FOR_ITER 104 [ListIteratorVariable(length=1, index=1)]
TRACE END_FOR None [ListIteratorVariable(length=1, index=1), ConstantVariable(NoneType: None)]
TRACE RETURN_CONST None []
DONE INLINING <code object set_update at 0x7f7c332be630, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 210>
TRACE STORE_FAST unpadded_head_dims [SetVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:883 in forward (_attention.forward)
            if head_size not in unpadded_head_dims:
TRACE LOAD_FAST head_size []
TRACE LOAD_FAST unpadded_head_dims [ConstantVariable(int: 128)]
TRACE CONTAINS_OP 1 [ConstantVariable(int: 128), SetVariable()]
TRACE POP_JUMP_IF_FALSE 676 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:891 in forward (_attention.forward)
                padded_d_model = head_size
TRACE LOAD_FAST head_size []
TRACE STORE_FAST padded_d_model [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in forward (_attention.forward)
            grid = lambda META: (
TRACE LOAD_CLOSURE batch []
TRACE LOAD_CLOSURE max_seqlens_q [CellVariable()]
TRACE LOAD_CLOSURE nheads_q [CellVariable(), CellVariable()]
TRACE BUILD_TUPLE 3 [CellVariable(), CellVariable(), CellVariable()]
TRACE LOAD_CONST <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893> [TupleVariable(length=3)]
TRACE MAKE_FUNCTION 8 [TupleVariable(length=3), ConstantVariable(code: <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>)]
TRACE STORE_FAST grid [NestedUserFunctionVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:899 in forward (_attention.forward)
            encoded_softmax = None
TRACE LOAD_CONST None []
TRACE STORE_FAST encoded_softmax [ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:902 in forward (_attention.forward)
            philox_seed = 0x1BF52
TRACE LOAD_CONST 114514 []
TRACE STORE_FAST philox_seed [ConstantVariable(int: 114514)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:903 in forward (_attention.forward)
            philox_offset = 0x1D4B42
TRACE LOAD_CONST 1919810 []
TRACE STORE_FAST philox_offset [ConstantVariable(int: 1919810)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:905 in forward (_attention.forward)
            if bias is not None:
TRACE LOAD_FAST bias []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 0 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 848 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:913 in forward (_attention.forward)
                bias_strides = (0, 0, 0, 0)
TRACE LOAD_CONST (0, 0, 0, 0) []
TRACE STORE_FAST bias_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:915 in forward (_attention.forward)
            p_descale = 1.0 / p_scale
TRACE LOAD_CONST 1.0 []
TRACE LOAD_FAST p_scale [ConstantVariable(float: 1.0)]
TRACE BINARY_OP 11 [ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE STORE_FAST p_descale [ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:917 in forward (_attention.forward)
            ) if fp8_out_scale is not None else 1.0
TRACE LOAD_FAST fp8_out_scale []
TRACE LOAD_CONST None [ConstantVariable(NoneType: None)]
TRACE IS_OP 0 [ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 908 [ConstantVariable(bool: True)]
TRACE LOAD_CONST 1.0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:916 in forward (_attention.forward)
            o_descale = 1.0 / fp8_out_scale.item(
TRACE STORE_FAST o_descale [ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:919 in forward (_attention.forward)
            arg_max_seqlens_q = 0 if on_gfx1x() else max_seqlens_q
TRACE LOAD_GLOBAL on_gfx1x []
TRACE CALL 0 [NullVariable, LazyVariableTracker()]
TRACE inlined call on_gfx1x from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:919 in forward (_attention.forward)
        arg_max_seqlens_q = 0 if on_gfx1x() else max_seqlens_q
                                 ~~~~~~~~^^
INLINING <code object on_gfx1x at 0x7f7c1d0ccd30, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 35>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:35 in on_gfx1x (on_gfx1x) (inline depth: 1)
    def on_gfx1x():
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:36 in on_gfx1x (on_gfx1x) (inline depth: 1)
        return True
TRACE RETURN_CONST True []
DONE INLINING <code object on_gfx1x at 0x7f7c1d0ccd30, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 35>
TRACE POP_JUMP_IF_FALSE 936 [ConstantVariable(bool: True)]
TRACE LOAD_CONST 0 []
TRACE JUMP_FORWARD 938 [ConstantVariable(int: 0)]
TRACE STORE_FAST arg_max_seqlens_q [ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:920 in forward (_attention.forward)
            arg_max_seqlens_k = 0 if on_gfx1x() else max_seqlens_k
TRACE LOAD_GLOBAL on_gfx1x []
TRACE CALL 0 [NullVariable, LazyVariableTracker()]
TRACE inlined call on_gfx1x from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:920 in forward (_attention.forward)
        arg_max_seqlens_k = 0 if on_gfx1x() else max_seqlens_k
                                 ~~~~~~~~^^
INLINING <code object on_gfx1x at 0x7f7c1d0ccd30, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 35>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:35 in on_gfx1x (on_gfx1x) (inline depth: 1)
    def on_gfx1x():
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:36 in on_gfx1x (on_gfx1x) (inline depth: 1)
        return True
TRACE RETURN_CONST True []
DONE INLINING <code object on_gfx1x at 0x7f7c1d0ccd30, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 35>
TRACE POP_JUMP_IF_FALSE 964 [ConstantVariable(bool: True)]
TRACE LOAD_CONST 0 []
TRACE JUMP_FORWARD 966 [ConstantVariable(int: 0)]
TRACE STORE_FAST arg_max_seqlens_k [ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_GLOBAL attn_fwd []
TRACE LOAD_FAST grid [NullVariable, LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), NestedUserFunctionVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:923 in forward (_attention.forward)
                q,
TRACE LOAD_FAST q [NullVariable, TritonKernelVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:924 in forward (_attention.forward)
                k,
TRACE LOAD_FAST k [NullVariable, TritonKernelVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:925 in forward (_attention.forward)
                v,
TRACE LOAD_FAST v [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:926 in forward (_attention.forward)
                bias,
TRACE LOAD_FAST bias [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:927 in forward (_attention.forward)
                sm_scale,
TRACE LOAD_FAST sm_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:928 in forward (_attention.forward)
                q_scale,
TRACE LOAD_FAST q_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:929 in forward (_attention.forward)
                k_scale,
TRACE LOAD_FAST k_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:930 in forward (_attention.forward)
                v_scale,
TRACE LOAD_FAST v_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:931 in forward (_attention.forward)
                p_scale,
TRACE LOAD_FAST p_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:932 in forward (_attention.forward)
                p_descale,
TRACE LOAD_FAST p_descale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:933 in forward (_attention.forward)
                o_descale,
TRACE LOAD_FAST o_descale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:934 in forward (_attention.forward)
                None,
TRACE LOAD_CONST None [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:935 in forward (_attention.forward)
                o,
TRACE LOAD_FAST o [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE BUILD_LIST 13 [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(NoneType: None), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:936 in forward (_attention.forward)
                *q_strides,
TRACE LOAD_FAST q_strides [NullVariable, TritonKernelVariable(), ListVariable(length=13)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=13), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:937 in forward (_attention.forward)
                *k_strides,
TRACE LOAD_FAST k_strides [NullVariable, TritonKernelVariable(), ListVariable(length=17)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=17), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:938 in forward (_attention.forward)
                *v_strides,
TRACE LOAD_FAST v_strides [NullVariable, TritonKernelVariable(), ListVariable(length=21)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=21), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:939 in forward (_attention.forward)
                *o_strides,
TRACE LOAD_FAST o_strides [NullVariable, TritonKernelVariable(), ListVariable(length=25)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=25), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:940 in forward (_attention.forward)
                *bias_strides,
TRACE LOAD_FAST bias_strides [NullVariable, TritonKernelVariable(), ListVariable(length=29)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=29), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:941 in forward (_attention.forward)
                cu_seqlens_q,
TRACE LOAD_FAST cu_seqlens_q [NullVariable, TritonKernelVariable(), ListVariable(length=33)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_APPEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=33), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:942 in forward (_attention.forward)
                cu_seqlens_k,
TRACE LOAD_FAST cu_seqlens_k [NullVariable, TritonKernelVariable(), ListVariable(length=34)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_APPEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=34), LazyVariableTracker()]
TRACE CALL_INTRINSIC_1 6 [NullVariable, TritonKernelVariable(), ListVariable(length=35)]
TRACE BUILD_MAP 0 [NullVariable, TritonKernelVariable(), TupleVariable(length=35)]
TRACE LOAD_CONST dropout_p [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:943 in forward (_attention.forward)
                dropout_p=0.0,
TRACE LOAD_CONST 0.0 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'dropout_p')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'dropout_p'), ConstantVariable(float: 0.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST philox_seed [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:944 in forward (_attention.forward)
                philox_seed=philox_seed,
TRACE LOAD_FAST philox_seed [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'philox_seed')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'philox_seed'), ConstantVariable(int: 114514)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST philox_offset_base [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:945 in forward (_attention.forward)
                philox_offset_base=philox_offset,
TRACE LOAD_FAST philox_offset [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'philox_offset_base')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'philox_offset_base'), ConstantVariable(int: 1919810)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST encoded_softmax [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:946 in forward (_attention.forward)
                encoded_softmax=encoded_softmax,
TRACE LOAD_FAST encoded_softmax [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'encoded_softmax')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'encoded_softmax'), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST HQ [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:947 in forward (_attention.forward)
                HQ=nheads_q,
TRACE LOAD_DEREF nheads_q [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'HQ')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'HQ'), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST HK [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:948 in forward (_attention.forward)
                HK=nheads_k,
TRACE LOAD_FAST nheads_k [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'HK')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'HK'), ConstantVariable(int: 8)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST ACTUAL_BLOCK_DMODEL [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:949 in forward (_attention.forward)
                ACTUAL_BLOCK_DMODEL=head_size,
TRACE LOAD_FAST head_size [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'ACTUAL_BLOCK_DMODEL')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'ACTUAL_BLOCK_DMODEL'), ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST MAX_SEQLENS_Q [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:950 in forward (_attention.forward)
                MAX_SEQLENS_Q=arg_max_seqlens_q,
TRACE LOAD_FAST arg_max_seqlens_q [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'MAX_SEQLENS_Q')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'MAX_SEQLENS_Q'), ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST MAX_SEQLENS_K [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:951 in forward (_attention.forward)
                MAX_SEQLENS_K=arg_max_seqlens_k,
TRACE LOAD_FAST arg_max_seqlens_k [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'MAX_SEQLENS_K')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'MAX_SEQLENS_K'), ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST IS_CAUSAL [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:952 in forward (_attention.forward)
                IS_CAUSAL=causal,
TRACE LOAD_FAST causal [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'IS_CAUSAL')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'IS_CAUSAL'), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST VARLEN [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:953 in forward (_attention.forward)
                VARLEN=True,
TRACE LOAD_CONST True [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'VARLEN')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'VARLEN'), ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST BLOCK_DMODEL [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:954 in forward (_attention.forward)
                BLOCK_DMODEL=padded_d_model,
TRACE LOAD_FAST padded_d_model [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BLOCK_DMODEL')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BLOCK_DMODEL'), ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST BIAS_TYPE [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:955 in forward (_attention.forward)
                BIAS_TYPE=0 if bias is None else 1,
TRACE LOAD_FAST bias [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE')]
TRACE LOAD_CONST None [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(NoneType: None)]
TRACE IS_OP 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 1130 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(bool: False)]
TRACE LOAD_CONST 0 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE')]
TRACE JUMP_FORWARD 1132 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(int: 0)]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST ENABLE_DROPOUT [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:956 in forward (_attention.forward)
                ENABLE_DROPOUT=False,
TRACE LOAD_CONST False [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'ENABLE_DROPOUT')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'ENABLE_DROPOUT'), ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST RETURN_ENCODED_SOFTMAX [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:957 in forward (_attention.forward)
                RETURN_ENCODED_SOFTMAX=False,
TRACE LOAD_CONST False [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'RETURN_ENCODED_SOFTMAX')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'RETURN_ENCODED_SOFTMAX'), ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST USE_FP8 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:958 in forward (_attention.forward)
                USE_FP8=use_fp8,
TRACE LOAD_FAST use_fp8 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8'), ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST USE_FP8_OUT [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:959 in forward (_attention.forward)
                USE_FP8_OUT=fp8_out_scale is not None,
TRACE LOAD_FAST fp8_out_scale [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8_OUT')]
TRACE LOAD_CONST None [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8_OUT'), ConstantVariable(NoneType: None)]
TRACE IS_OP 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8_OUT'), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8_OUT'), ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE CALL_FUNCTION_EX 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE inlined call <lambda> from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
                triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF max_seqlens_q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST META [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE LOAD_CONST BLOCK_M [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstDictVariable(), ConstantVariable(str: 'BLOCK_M')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
            triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
            ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x7f7c3c064990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 512)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 512)]
DONE INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 512)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x7f7c3c0d01f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 3)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [ConstantVariable(int: 512)]
TRACE BINARY_OP 0 [ConstantVariable(int: 512), ConstantVariable(int: 32)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 544)]
TRACE BINARY_OP 10 [ConstantVariable(int: 544), ConstantVariable(int: 1)]
TRACE LOAD_FAST y [ConstantVariable(int: 543)]
TRACE BINARY_OP 2 [ConstantVariable(int: 543), ConstantVariable(int: 32)]
TRACE RETURN_VALUE None [ConstantVariable(int: 16)]
DONE INLINING <code object cdiv at 0x7f7c3c0d01f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [ConstantVariable(int: 16)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 16)]
DONE INLINING <code object __call__ at 0x7f7c3c064990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:895 in <lambda> (_attention.forward) (inline depth: 1)
                nheads_q,
TRACE LOAD_DEREF nheads_q [ConstantVariable(int: 16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:896 in <lambda> (_attention.forward) (inline depth: 1)
                batch,
TRACE LOAD_DEREF batch [ConstantVariable(int: 16), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE BUILD_TUPLE 3 [ConstantVariable(int: 16), ConstantVariable(int: 64), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [TupleVariable(length=3)]
DONE INLINING <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>
TRACE inlined call <lambda> from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
                triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF max_seqlens_q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST META [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE LOAD_CONST BLOCK_M [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstDictVariable(), ConstantVariable(str: 'BLOCK_M')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
            triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
            ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x7f7c3c064990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 512)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 512)]
DONE INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 512)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x7f7c3c0d01f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 3)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [ConstantVariable(int: 512)]
TRACE BINARY_OP 0 [ConstantVariable(int: 512), ConstantVariable(int: 32)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 544)]
TRACE BINARY_OP 10 [ConstantVariable(int: 544), ConstantVariable(int: 1)]
TRACE LOAD_FAST y [ConstantVariable(int: 543)]
TRACE BINARY_OP 2 [ConstantVariable(int: 543), ConstantVariable(int: 32)]
TRACE RETURN_VALUE None [ConstantVariable(int: 16)]
DONE INLINING <code object cdiv at 0x7f7c3c0d01f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [ConstantVariable(int: 16)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 16)]
DONE INLINING <code object __call__ at 0x7f7c3c064990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:895 in <lambda> (_attention.forward) (inline depth: 1)
                nheads_q,
TRACE LOAD_DEREF nheads_q [ConstantVariable(int: 16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:896 in <lambda> (_attention.forward) (inline depth: 1)
                batch,
TRACE LOAD_DEREF batch [ConstantVariable(int: 16), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE BUILD_TUPLE 3 [ConstantVariable(int: 16), ConstantVariable(int: 64), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [TupleVariable(length=3)]
DONE INLINING <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>
TRACE inlined call <lambda> from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
                triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF max_seqlens_q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST META [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE LOAD_CONST BLOCK_M [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstDictVariable(), ConstantVariable(str: 'BLOCK_M')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
            triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
            ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x7f7c3c064990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 512)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 512)]
DONE INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 512)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x7f7c3c0d01f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 3)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [ConstantVariable(int: 512)]
TRACE BINARY_OP 0 [ConstantVariable(int: 512), ConstantVariable(int: 32)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 544)]
TRACE BINARY_OP 10 [ConstantVariable(int: 544), ConstantVariable(int: 1)]
TRACE LOAD_FAST y [ConstantVariable(int: 543)]
TRACE BINARY_OP 2 [ConstantVariable(int: 543), ConstantVariable(int: 32)]
TRACE RETURN_VALUE None [ConstantVariable(int: 16)]
DONE INLINING <code object cdiv at 0x7f7c3c0d01f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [ConstantVariable(int: 16)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 16)]
DONE INLINING <code object __call__ at 0x7f7c3c064990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:895 in <lambda> (_attention.forward) (inline depth: 1)
                nheads_q,
TRACE LOAD_DEREF nheads_q [ConstantVariable(int: 16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:896 in <lambda> (_attention.forward) (inline depth: 1)
                batch,
TRACE LOAD_DEREF batch [ConstantVariable(int: 16), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE BUILD_TUPLE 3 [ConstantVariable(int: 16), ConstantVariable(int: 64), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [TupleVariable(length=3)]
DONE INLINING <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>
TRACE inlined call <lambda> from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
                triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF max_seqlens_q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST META [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE LOAD_CONST BLOCK_M [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstDictVariable(), ConstantVariable(str: 'BLOCK_M')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
            triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
            ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x7f7c3c064990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 512)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 512)]
DONE INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 512)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x7f7c3c0d01f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 3)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [ConstantVariable(int: 512)]
TRACE BINARY_OP 0 [ConstantVariable(int: 512), ConstantVariable(int: 32)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 544)]
TRACE BINARY_OP 10 [ConstantVariable(int: 544), ConstantVariable(int: 1)]
TRACE LOAD_FAST y [ConstantVariable(int: 543)]
TRACE BINARY_OP 2 [ConstantVariable(int: 543), ConstantVariable(int: 32)]
TRACE RETURN_VALUE None [ConstantVariable(int: 16)]
DONE INLINING <code object cdiv at 0x7f7c3c0d01f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [ConstantVariable(int: 16)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 16)]
DONE INLINING <code object __call__ at 0x7f7c3c064990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:895 in <lambda> (_attention.forward) (inline depth: 1)
                nheads_q,
TRACE LOAD_DEREF nheads_q [ConstantVariable(int: 16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:896 in <lambda> (_attention.forward) (inline depth: 1)
                batch,
TRACE LOAD_DEREF batch [ConstantVariable(int: 16), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE BUILD_TUPLE 3 [ConstantVariable(int: 16), ConstantVariable(int: 64), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [TupleVariable(length=3)]
DONE INLINING <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>
wrap_to_fake L['cu_seqlens_k'] (2,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='cu_seqlens_k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_cu_seqlens_k_ L['cu_seqlens_k'] FakeTensor(..., device='cuda:0', size=(2,), dtype=torch.int32) at debug_level 0 before=False
TRACE FX call triton_kernel_wrapper_mutation from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
TRACE POP_TOP None [ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:962 in forward (_attention.forward)
            return o, encoded_softmax
TRACE LOAD_FAST o []
TRACE LOAD_FAST encoded_softmax [TensorVariable()]
TRACE BUILD_TUPLE 2 [TensorVariable(), ConstantVariable(NoneType: None)]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
Step 1: torchdynamo done tracing forward (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py, line 962 in forward>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_7_3a6cbba8_3067_4d6b_bcb0_e95f93c8bfe6 =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, L_o_: "[31mbf16[0m[34m[512, 64, 128][0m[2m[34m[8192, 128, 1][0m[2m[32mcuda:0[0m", L_q_: "[31mbf16[0m[34m[512, 64, 128][0m[2m[34m[8192, 128, 1][0m[2m[32mcuda:0[0m", L_k_: "[31mbf16[0m[34m[512, 8, 128][0m[2m[34m[1024, 128, 1][0m[2m[32mcuda:0[0m", L_cu_seqlens_q_: "[31mi32[0m[34m[2][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_v_: "[31mbf16[0m[34m[512, 8, 128][0m[2m[34m[1024, 128, 1][0m[2m[32mcuda:0[0m", L_cu_seqlens_k_: "[31mi32[0m[34m[2][0m[2m[34m[1][0m[2m[32mcuda:0[0m"):
        l_o_ = L_o_
        l_q_ = L_q_
        l_k_ = L_k_
        l_cu_seqlens_q_ = L_cu_seqlens_q_
        l_v_ = L_v_
        l_cu_seqlens_k_ = L_cu_seqlens_k_
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward, code: attn_fwd[grid]([0m
        triton_kernel_wrapper_mutation = torch.ops.higher_order.triton_kernel_wrapper_mutation(kernel_idx = [34m0[0m, constant_args_idx = [34m0[0m, grid = [([34m16[0m, [34m64[0m, [34m1[0m), ([34m16[0m, [34m64[0m, [34m1[0m), ([34m16[0m, [34m64[0m, [34m1[0m), ([34m16[0m, [34m64[0m, [34m1[0m)], tma_descriptor_metadata = [34m{}[0m, kwargs = [34m{'Q': l_q_, 'K': l_k_, 'V': l_v_, 'Out': l_o_, 'cu_seqlens_q': l_cu_seqlens_q_, 'cu_seqlens_k': l_cu_seqlens_k_}[0m);  [2ml_q_ = l_k_ = l_v_ = l_o_ = l_cu_seqlens_q_ = l_cu_seqlens_k_ = triton_kernel_wrapper_mutation = None[0m
        return ()
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing fpx_matmul /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:420
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:420 in fpx_matmul (fpx_matmul)
    def fpx_matmul(x,weight,weight_state,ebits:int=3,mbits:int=2):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:421 in fpx_matmul (fpx_matmul)
        if ebits == -44: #hqq
TRACE LOAD_FAST ebits []
TRACE LOAD_CONST -44 [LazyVariableTracker()]
TRACE COMPARE_OP == [LazyVariableTracker(), ConstantVariable(int: -44)]
TRACE POP_JUMP_IF_FALSE 322 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul)
            S0=x.shape[0]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
wrap_to_fake L['x'] (1, 512, 8192) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='x', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}), tensor_source=LocalSource(local_name='x', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_x_ L['x'] FakeTensor(..., device='cuda:0', size=(1, 512, 8192), dtype=torch.bfloat16) at debug_level 0 before=False
wrap_to_fake L['x']._base (512, 64, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='x', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
TRACE LOAD_CONST 0 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 0)]
TRACE STORE_FAST S0 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul)
            S1=x.shape[1]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 1)]
TRACE STORE_FAST S1 [ConstantVariable(int: 512)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:424 in fpx_matmul (fpx_matmul)
            dtype = x.dtype
TRACE LOAD_FAST x []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul)
            x = x.to(dtype=torch.float16).view(-1,x.shape[2])
TRACE LOAD_FAST x []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float16 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST x [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1)]
TRACE LOAD_ATTR shape [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3), ConstantVariable(int: 2)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), ConstantVariable(int: 8192)]
TRACE FX call view from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul)
            out = weight.forward_manual(x).to(dtype=dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_ATTR forward_manual [LazyVariableTracker()]
TRACE LOAD_FAST x [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x7f7c1f9a11c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE CALL 1 [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x7f7c1f9a11c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton)), TensorVariable()]
TRACE inlined call forward_manual from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object forward_manual at 0x7f7c1fbe0cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:543 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
        def forward_manual(self, x: Tensor, matmul_type: str="GEMM") -> Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
            return forward_functional(
TRACE LOAD_GLOBAL forward_functional []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:545 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
                x,
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:546 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
                self.bias,
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR bias [NullVariable, LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
                self.get_tensor_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_ATTR get_tensor_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_tensor_args at 0x7f7c1f9a1080>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_tensor_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
            self.get_tensor_args(),
            ~~~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_tensor_args at 0x7f7c1fbc6560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:524 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 2)
        def get_tensor_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:525 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 2)
            return [self.W_q, self.scales, self.zeros]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR W_q [UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_FAST self [LazyVariableTracker()]
TRACE LOAD_ATTR scales [LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['weight']._parameters['scales'] (128, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='weight', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='scales'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_weight_parameters_scales_ L['weight']._parameters['scales'] Parameter(FakeTensor(..., device='cuda:0', size=(128, 5120), dtype=torch.float16)) at debug_level 0 before=False
TRACE LOAD_FAST self [LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR zeros [LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['weight']._parameters['zeros'] (128, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='weight', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='zeros'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_weight_parameters_zeros_ L['weight']._parameters['zeros'] Parameter(FakeTensor(..., device='cuda:0', size=(128, 5120), dtype=torch.float16)) at debug_level 0 before=False
TRACE BUILD_LIST 3 [LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [ListVariable(length=3)]
DONE INLINING <code object get_tensor_args at 0x7f7c1fbc6560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
                self.get_meta_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3)]
TRACE LOAD_ATTR get_meta_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_meta_args at 0x7f7c1f9a1120>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_meta_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
            self.get_meta_args(),
            ~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_meta_args at 0x3c1c0c40, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:527 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
        def get_meta_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
            return [int(self.scaled_activations),
TRACE LOAD_GLOBAL int []
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR scaled_activations [NullVariable, LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:529 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.W_nbits,
TRACE LOAD_FAST self [ConstantVariable(int: 0)]
TRACE LOAD_ATTR W_nbits [ConstantVariable(int: 0), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:530 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.group_size,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker()]
TRACE LOAD_ATTR group_size [ConstantVariable(int: 0), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:531 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.unpack_mask,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR unpack_mask [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:532 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.elements_per_sample,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR elements_per_sample [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:533 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.input_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR input_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:534 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.output_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR output_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:535 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.acc_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR acc_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:536 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.meta_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR meta_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:537 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.channel_scale_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR channel_scale_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:538 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.W_group_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR W_group_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:539 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    int(self.data_contiguous),
TRACE LOAD_GLOBAL int [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int)]
TRACE LOAD_ATTR data_contiguous [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
            return [int(self.scaled_activations),
TRACE BUILD_LIST 12 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [ListVariable(length=12)]
DONE INLINING <code object get_meta_args at 0x3c1c0c40, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:549 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
                GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
TRACE LOAD_GLOBAL GEMLITE_MATMUL_TYPES_MAPPING [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12)]
TRACE LOAD_FAST matmul_type [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker(), ConstantVariable(str: 'GEMM')]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
            return forward_functional(
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
        return forward_functional(
               ~~~~~~~~~~~~~~~~~~^
            x,
            ^^
            self.bias,
            ^^^^^^^^^^
            self.get_tensor_args(),
            ^^^^^^^^^^^^^^^^^^^^^^^
            self.get_meta_args(),
            ^^^^^^^^^^^^^^^^^^^^^
            GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object __call__ at 0x7f7c609ab960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:675 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 2)
        def __call__(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 2)
            return self._opoverload(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR _opoverload [NullVariable, UserDefinedObjectVariable(CustomOpDef)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=5)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
wrap_to_fake L['weight'].W_q (1024, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=AttrSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='weight', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='W_q'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_weight_W_q L['weight'].W_q FakeTensor(..., device='cuda:0', size=(1024, 5120), dtype=torch.int32) at debug_level 0 before=False
TRACE FX call forward_functional_default from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 2)
        return self._opoverload(*args, **kwargs)
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object __call__ at 0x7f7c609ab960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object forward_manual at 0x7f7c1fbe0cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_1 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE STORE_FAST out [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul)
            return out.view(S0,S1,-1)
TRACE LOAD_FAST out []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST S0 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST S1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: -1)]
TRACE FX call view_1 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul)
        return out.view(S0,S1,-1)
               ~~~~~~~~^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
Step 1: torchdynamo done tracing fpx_matmul (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py, line 440 in fpx_matmul>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_9_ec9fc3a4_6e08_480d_8af6_a1c0e79b01ca =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, L_x_: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m", L_weight_parameters_scales_: "[31mf16[0m[34m[128, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m", L_weight_parameters_zeros_: "[31mf16[0m[34m[128, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m", L_weight_W_q: "[31mi32[0m[34m[1024, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m"):
        l_x_ = L_x_
        l_weight_parameters_scales_ = L_weight_parameters_scales_
        l_weight_parameters_zeros_ = L_weight_parameters_zeros_
        l_weight_w_q = L_weight_W_q
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul, code: x = x.to(dtype=torch.float16).view(-1,x.shape[2])[0m
        to: "[31mf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = l_x_.to(dtype = [34mtorch.float16[0m);  [2ml_x_ = None[0m
        x: "[31mf16[0m[34m[512, 8192][0m[2m[34m[8192, 1][0m[2m[32mcuda:0[0m" = to.view([34m-1[0m, [34m8192[0m);  [2mto = None[0m
        
         [2m# File: /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__, code: return self._opoverload(*args, **kwargs)[0m
        forward_functional_default: "[31mf16[0m[34m[512, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m" = torch.ops.gemlite.forward_functional.default(x, [34mNone[0m, [l_weight_w_q, l_weight_parameters_scales_, l_weight_parameters_zeros_], [[34m0[0m, [34m4[0m, [34m64[0m, [34m15[0m, [34m8[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m0[0m, [34m4[0m, [34m1[0m], [34m4[0m);  [2mx = l_weight_w_q = l_weight_parameters_scales_ = l_weight_parameters_zeros_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul, code: out = weight.forward_manual(x).to(dtype=dtype)[0m
        out: "[31mbf16[0m[34m[512, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m" = forward_functional_default.to(dtype = [34mtorch.bfloat16[0m);  [2mforward_functional_default = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul, code: return out.view(S0,S1,-1)[0m
        view_1: "[31mbf16[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = out.view([34m1[0m, [34m512[0m, [34m-1[0m);  [2mout = None[0m
        return (view_1,)
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing T5RMSNorm /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [LazyVariableTracker()]
wrap_to_fake L['hidden_states'] (1, 512, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='hidden_states', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_hidden_states_ L['hidden_states'] FakeTensor(..., device='cuda:0', size=(1, 512, 5120), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE FX call add from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['weight'] (5120,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='weight', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_weight_ L['weight'] FakeTensor(..., device='cuda:0', size=(5120,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
Step 1: torchdynamo done tracing T5RMSNorm (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py, line 378 in T5RMSNorm>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_11_98b4930d_7d37_43fb_b701_f9ca5287c890 =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, L_hidden_states_: "[31mbf16[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m", L_weight_: "[31mbf16[0m[34m[5120][0m[2m[34m[1][0m[2m[32mcuda:0[0m"):
        l_hidden_states_ = L_hidden_states_
        l_weight_ = L_weight_
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states: "[31mf32[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = l_hidden_states_.to([34mtorch.float32[0m);  [2ml_hidden_states_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_1: "[31mf32[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states.pow([34m2[0m)
        variance: "[31mf32[0m[34m[1, 512, 1][0m[2m[34m[512, 1, 1][0m[2m[32mcuda:0[0m" = pow_1.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add: "[31mf32[0m[34m[1, 512, 1][0m[2m[34m[512, 1, 1][0m[2m[32mcuda:0[0m" = variance + [34m1e-06[0m;  [2mvariance = None[0m
        rsqrt: "[31mf32[0m[34m[1, 512, 1][0m[2m[34m[512, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add);  [2madd = None[0m
        hidden_states_1: "[31mf32[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states * rsqrt;  [2mhidden_states = rsqrt = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_1: "[31mf32[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = l_weight_ * hidden_states_1;  [2ml_weight_ = hidden_states_1 = None[0m
        to_1: "[31mbf16[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = mul_1.to([34mtorch.bfloat16[0m);  [2mmul_1 = None[0m
        return (to_1,)
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing reference_dequant_gemm /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:213
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:213 in reference_dequant_gemm ()
    @torch.compile
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:219 in reference_dequant_gemm (reference_dequant_gemm)
        W_fp16 = W_int8.to(torch.float16) * scale.view(-1, 1)
TRACE LOAD_FAST W_int8 []
TRACE LOAD_ATTR to [LazyVariableTracker()]
wrap_to_fake L['W_int8'] (5120, 151936) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='W_int8', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_W_int8_ L['W_int8'] FakeTensor(..., device='cuda:0', size=(5120, 151936), dtype=torch.int8) at debug_level 0 before=False
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float16 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to from /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:219 in reference_dequant_gemm (reference_dequant_gemm)
    W_fp16 = W_int8.to(torch.float16) * scale.view(-1, 1)
             ~~~~~~~~~^^^^^^^^^^^^^^^
TRACE LOAD_FAST scale [TensorVariable()]
TRACE LOAD_ATTR view [TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['scale'] (5120,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='scale', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_scale_ L['scale'] FakeTensor(..., device='cuda:0', size=(5120,), dtype=torch.float16) at debug_level 0 before=False
TRACE LOAD_CONST -1 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_CONST 1 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1)]
TRACE CALL 2 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), ConstantVariable(int: 1)]
TRACE FX call view from /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:219 in reference_dequant_gemm (reference_dequant_gemm)
    W_fp16 = W_int8.to(torch.float16) * scale.view(-1, 1)
                                        ~~~~~~~~~~^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul from /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:219 in reference_dequant_gemm (reference_dequant_gemm)
    W_fp16 = W_int8.to(torch.float16) * scale.view(-1, 1)
             ~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST W_fp16 [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:220 in reference_dequant_gemm (reference_dequant_gemm)
        return torch.matmul(A, W_fp16)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR matmul [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST A [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST W_fp16 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['A'] (1, 512, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='A', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_A_ L['A'] FakeTensor(..., device='cuda:0', size=(1, 512, 5120), dtype=torch.float16) at debug_level 0 before=False
TRACE FX call matmul from /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:220 in reference_dequant_gemm (reference_dequant_gemm)
    return torch.matmul(A, W_fp16)
           ~~~~~~~~~~~~^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
Step 1: torchdynamo done tracing reference_dequant_gemm (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py, line 220 in reference_dequant_gemm>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_13_a7bf524a_67fe_4a1c_8b97_ee13fe44158f =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, L_W_int8_: "[31mi8[0m[34m[5120, 151936][0m[2m[34m[1, 5120][0m[2m[32mcuda:0[0m", L_scale_: "[31mf16[0m[34m[5120][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_A_: "[31mf16[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m"):
        l_w_int8_ = L_W_int8_
        l_scale_ = L_scale_
        l_a_ = L_A_
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:219 in reference_dequant_gemm, code: W_fp16 = W_int8.to(torch.float16) * scale.view(-1, 1)[0m
        to: "[31mf16[0m[34m[5120, 151936][0m[2m[34m[1, 5120][0m[2m[32mcuda:0[0m" = l_w_int8_.to([34mtorch.float16[0m);  [2ml_w_int8_ = None[0m
        view: "[31mf16[0m[34m[5120, 1][0m[2m[34m[1, 1][0m[2m[32mcuda:0[0m" = l_scale_.view([34m-1[0m, [34m1[0m);  [2ml_scale_ = None[0m
        W_fp16: "[31mf16[0m[34m[5120, 151936][0m[2m[34m[1, 5120][0m[2m[32mcuda:0[0m" = to * view;  [2mto = view = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:220 in reference_dequant_gemm, code: return torch.matmul(A, W_fp16)[0m
        matmul: "[31mf16[0m[34m[1, 512, 151936][0m[2m[34m[77791232, 151936, 1][0m[2m[32mcuda:0[0m" = torch.matmul(l_a_, W_fp16);  [2ml_a_ = W_fp16 = None[0m
        return (matmul,)
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing forward /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:831
TRACE MAKE_CELL max_seqlens_q []
TRACE MAKE_CELL batch []
TRACE MAKE_CELL nheads_q []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:831 in forward (_attention)
        @staticmethod
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:848 in forward (_attention.forward)
            use_fp8 = False
TRACE LOAD_CONST False []
TRACE STORE_FAST use_fp8 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:849 in forward (_attention.forward)
            fp8_out_scale=None
TRACE LOAD_CONST None []
TRACE STORE_FAST fp8_out_scale [ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:850 in forward (_attention.forward)
            fp8_scales=None
TRACE LOAD_CONST None []
TRACE STORE_FAST fp8_scales [ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:851 in forward (_attention.forward)
            q_scale = k_scale = v_scale = p_scale = 1.0
TRACE LOAD_CONST 1.0 []
TRACE COPY 1 [ConstantVariable(float: 1.0)]
TRACE STORE_FAST q_scale [ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE COPY 1 [ConstantVariable(float: 1.0)]
TRACE STORE_FAST k_scale [ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE COPY 1 [ConstantVariable(float: 1.0)]
TRACE STORE_FAST v_scale [ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE STORE_FAST p_scale [ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:853 in forward (_attention.forward)
            if o is None:
TRACE LOAD_FAST o []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
wrap_to_fake L['o'] (512, 64, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='o', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_o_ L['o'] FakeTensor(..., device='cuda:0', size=(512, 64, 128), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE POP_JUMP_IF_TRUE 110 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:865 in forward (_attention.forward)
            if True:  # varlen
TRACE NOP None []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:866 in forward (_attention.forward)
                total_q, nheads_q, head_size = q.shape
TRACE LOAD_FAST q []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
wrap_to_fake L['q'] (512, 64, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None], constraint_strides=[None, None, None, None], specialize_on=[[], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='q', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}), tensor_source=LocalSource(local_name='q', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_q_ L['q'] FakeTensor(..., device='cuda:0', size=(512, 64, 128), dtype=torch.bfloat16) at debug_level 0 before=False
wrap_to_fake L['q']._base (1, 512, 64, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None], constraint_strides=[None, None, None, None], specialize_on=[[], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='q', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
TRACE UNPACK_SEQUENCE 3 [SizeVariable(length=3)]
TRACE STORE_FAST total_q [ConstantVariable(int: 128), ConstantVariable(int: 64), ConstantVariable(int: 512)]
TRACE STORE_DEREF nheads_q [ConstantVariable(int: 128), ConstantVariable(int: 64)]
TRACE STORE_FAST head_size [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:867 in forward (_attention.forward)
                total_k, nheads_k, _ = k.shape
TRACE LOAD_FAST k []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
automatic dynamic size L['k'] size(0) 1024 != 512
wrap_to_fake L['k'] (1024, 8, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_k_ L['k'] FakeTensor(..., device='cuda:0', size=(s37, 8, 128), dtype=torch.bfloat16) at debug_level 0 before=False
create_graph_input s37 L['k'].size()[0] s37 at debug_level 0 before=True
_lift_symbols_in_symint s37 from L['k'].size()[0] at debug_level 0
TRACE FX call size from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:867 in forward (_attention.forward)
            total_k, nheads_k, _ = k.shape
                                   ^^^^^^^
TRACE UNPACK_SEQUENCE 3 [SizeVariable(length=3)]
TRACE STORE_FAST total_k [ConstantVariable(int: 128), ConstantVariable(int: 8), SymNodeVariable()]
TRACE STORE_FAST nheads_k [ConstantVariable(int: 128), ConstantVariable(int: 8)]
TRACE STORE_FAST _ [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:868 in forward (_attention.forward)
                batch = len(cu_seqlens_q) - 1
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST cu_seqlens_q [NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
wrap_to_fake L['cu_seqlens_q'] (2,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='cu_seqlens_q', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_cu_seqlens_q_ L['cu_seqlens_q'] FakeTensor(..., device='cuda:0', size=(2,), dtype=torch.int32) at debug_level 0 before=False
TRACE LOAD_CONST 1 [ConstantVariable(int: 2)]
TRACE BINARY_OP 10 [ConstantVariable(int: 2), ConstantVariable(int: 1)]
TRACE STORE_DEREF batch [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:869 in forward (_attention.forward)
                q_strides = (0, q.stride(1), q.stride(0), q.stride(2))
TRACE LOAD_CONST 0 []
TRACE LOAD_FAST q [ConstantVariable(int: 0)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), TensorVariable()]
TRACE LOAD_CONST 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 1)]
TRACE LOAD_FAST q [ConstantVariable(int: 0), ConstantVariable(int: 128)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 0)]
TRACE LOAD_FAST q [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), TensorVariable()]
TRACE LOAD_CONST 2 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 2)]
TRACE BUILD_TUPLE 4 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), ConstantVariable(int: 1)]
TRACE STORE_FAST q_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:870 in forward (_attention.forward)
                k_strides = (0, k.stride(1), k.stride(0), k.stride(2))
TRACE LOAD_CONST 0 []
TRACE LOAD_FAST k [ConstantVariable(int: 0)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), TensorVariable()]
TRACE LOAD_CONST 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 1)]
TRACE LOAD_FAST k [ConstantVariable(int: 0), ConstantVariable(int: 128)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 0)]
TRACE LOAD_FAST k [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), TensorVariable()]
TRACE LOAD_CONST 2 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 2)]
TRACE BUILD_TUPLE 4 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), ConstantVariable(int: 1)]
TRACE STORE_FAST k_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:871 in forward (_attention.forward)
                v_strides = (0, v.stride(1), v.stride(0), v.stride(2))
TRACE LOAD_CONST 0 []
TRACE LOAD_FAST v [ConstantVariable(int: 0)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), LazyVariableTracker()]
automatic dynamic size L['v'] size(0) 1024 != 512
wrap_to_fake L['v'] (1024, 8, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='v', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_v_ L['v'] FakeTensor(..., device='cuda:0', size=(s33, 8, 128), dtype=torch.bfloat16) at debug_level 0 before=False
create_graph_input s33 L['v'].size()[0] s33 at debug_level 0 before=True
_lift_symbols_in_symint s33 from L['v'].size()[0] at debug_level 0
TRACE LOAD_CONST 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 1)]
TRACE LOAD_FAST v [ConstantVariable(int: 0), ConstantVariable(int: 128)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 0)]
TRACE LOAD_FAST v [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), TensorVariable()]
TRACE LOAD_CONST 2 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 2)]
TRACE BUILD_TUPLE 4 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), ConstantVariable(int: 1)]
TRACE STORE_FAST v_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:872 in forward (_attention.forward)
                o_strides = (0, o.stride(1), o.stride(0), o.stride(2))
TRACE LOAD_CONST 0 []
TRACE LOAD_FAST o [ConstantVariable(int: 0)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), TensorVariable()]
TRACE LOAD_CONST 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 1)]
TRACE LOAD_FAST o [ConstantVariable(int: 0), ConstantVariable(int: 128)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 0)]
TRACE LOAD_FAST o [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), TensorVariable()]
TRACE LOAD_CONST 2 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 2)]
TRACE BUILD_TUPLE 4 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), ConstantVariable(int: 1)]
TRACE STORE_FAST o_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:882 in forward (_attention.forward)
            unpadded_head_dims = {32, 64, 128, 256}
TRACE BUILD_SET 0 []
TRACE LOAD_CONST frozenset({256, 32, 64, 128}) [SetVariable()]
TRACE SET_UPDATE 1 [SetVariable(), FrozensetVariable()]
TRACE inlined call set_update from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:882 in forward (_attention.forward)
        unpadded_head_dims = {32, 64, 128, 256}
                             ^^^^^^^^^^^^^^^^^^
INLINING <code object set_update at 0x7f7c332be630, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 210>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:210 in set_update (set_update) (inline depth: 1)
    def set_update(set1, *others):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:211 in set_update (set_update) (inline depth: 1)
        if len(others) == 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST others [NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=1)]
TRACE LOAD_CONST 0 [ConstantVariable(int: 1)]
TRACE COMPARE_OP == [ConstantVariable(int: 1), ConstantVariable(int: 0)]
TRACE POP_JUMP_IF_FALSE 34 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:214 in set_update (set_update) (inline depth: 1)
        for set2 in others:
TRACE LOAD_FAST others []
TRACE GET_ITER None [TupleVariable(length=1)]
TRACE FOR_ITER 104 [ListIteratorVariable(length=1, index=0)]
TRACE STORE_FAST set2 [ListIteratorVariable(length=1, index=1), FrozensetVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE LOAD_FAST set2 [ListIteratorVariable(length=1, index=1)]
TRACE GET_ITER None [ListIteratorVariable(length=1, index=1), FrozensetVariable()]
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=0)]
TRACE STORE_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(int: 256)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:216 in set_update (set_update) (inline depth: 1)
                if x not in set1:
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1)]
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(int: 256)]
TRACE CONTAINS_OP 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(int: 256), SetVariable()]
TRACE POP_JUMP_IF_TRUE 64 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:217 in set_update (set_update) (inline depth: 1)
                    set1.add(x)
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1)]
TRACE LOAD_ATTR add [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), SetVariable()]
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), NullVariable, GetAttrVariable(SetVariable(), add)]
TRACE CALL 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), NullVariable, GetAttrVariable(SetVariable(), add), ConstantVariable(int: 256)]
TRACE POP_TOP None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 48 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1)]
TRACE STORE_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(int: 32)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:216 in set_update (set_update) (inline depth: 1)
                if x not in set1:
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2)]
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(int: 32)]
TRACE CONTAINS_OP 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(int: 32), SetVariable()]
TRACE POP_JUMP_IF_TRUE 64 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:217 in set_update (set_update) (inline depth: 1)
                    set1.add(x)
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2)]
TRACE LOAD_ATTR add [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), SetVariable()]
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), NullVariable, GetAttrVariable(SetVariable(), add)]
TRACE CALL 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), NullVariable, GetAttrVariable(SetVariable(), add), ConstantVariable(int: 32)]
TRACE POP_TOP None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 48 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2)]
TRACE STORE_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(int: 64)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:216 in set_update (set_update) (inline depth: 1)
                if x not in set1:
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3)]
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(int: 64)]
TRACE CONTAINS_OP 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(int: 64), SetVariable()]
TRACE POP_JUMP_IF_TRUE 64 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:217 in set_update (set_update) (inline depth: 1)
                    set1.add(x)
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3)]
TRACE LOAD_ATTR add [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), SetVariable()]
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), NullVariable, GetAttrVariable(SetVariable(), add)]
TRACE CALL 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), NullVariable, GetAttrVariable(SetVariable(), add), ConstantVariable(int: 64)]
TRACE POP_TOP None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 48 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3)]
TRACE STORE_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(int: 128)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:216 in set_update (set_update) (inline depth: 1)
                if x not in set1:
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4)]
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(int: 128)]
TRACE CONTAINS_OP 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(int: 128), SetVariable()]
TRACE POP_JUMP_IF_TRUE 64 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:217 in set_update (set_update) (inline depth: 1)
                    set1.add(x)
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4)]
TRACE LOAD_ATTR add [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), SetVariable()]
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), NullVariable, GetAttrVariable(SetVariable(), add)]
TRACE CALL 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), NullVariable, GetAttrVariable(SetVariable(), add), ConstantVariable(int: 128)]
TRACE POP_TOP None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 48 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4)]
TRACE END_FOR None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 38 [ListIteratorVariable(length=1, index=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:214 in set_update (set_update) (inline depth: 1)
        for set2 in others:
TRACE FOR_ITER 104 [ListIteratorVariable(length=1, index=1)]
TRACE END_FOR None [ListIteratorVariable(length=1, index=1), ConstantVariable(NoneType: None)]
TRACE RETURN_CONST None []
DONE INLINING <code object set_update at 0x7f7c332be630, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 210>
TRACE STORE_FAST unpadded_head_dims [SetVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:883 in forward (_attention.forward)
            if head_size not in unpadded_head_dims:
TRACE LOAD_FAST head_size []
TRACE LOAD_FAST unpadded_head_dims [ConstantVariable(int: 128)]
TRACE CONTAINS_OP 1 [ConstantVariable(int: 128), SetVariable()]
TRACE POP_JUMP_IF_FALSE 676 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:891 in forward (_attention.forward)
                padded_d_model = head_size
TRACE LOAD_FAST head_size []
TRACE STORE_FAST padded_d_model [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in forward (_attention.forward)
            grid = lambda META: (
TRACE LOAD_CLOSURE batch []
TRACE LOAD_CLOSURE max_seqlens_q [CellVariable()]
TRACE LOAD_CLOSURE nheads_q [CellVariable(), CellVariable()]
TRACE BUILD_TUPLE 3 [CellVariable(), CellVariable(), CellVariable()]
TRACE LOAD_CONST <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893> [TupleVariable(length=3)]
TRACE MAKE_FUNCTION 8 [TupleVariable(length=3), ConstantVariable(code: <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>)]
TRACE STORE_FAST grid [NestedUserFunctionVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:899 in forward (_attention.forward)
            encoded_softmax = None
TRACE LOAD_CONST None []
TRACE STORE_FAST encoded_softmax [ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:902 in forward (_attention.forward)
            philox_seed = 0x1BF52
TRACE LOAD_CONST 114514 []
TRACE STORE_FAST philox_seed [ConstantVariable(int: 114514)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:903 in forward (_attention.forward)
            philox_offset = 0x1D4B42
TRACE LOAD_CONST 1919810 []
TRACE STORE_FAST philox_offset [ConstantVariable(int: 1919810)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:905 in forward (_attention.forward)
            if bias is not None:
TRACE LOAD_FAST bias []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 0 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 848 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:913 in forward (_attention.forward)
                bias_strides = (0, 0, 0, 0)
TRACE LOAD_CONST (0, 0, 0, 0) []
TRACE STORE_FAST bias_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:915 in forward (_attention.forward)
            p_descale = 1.0 / p_scale
TRACE LOAD_CONST 1.0 []
TRACE LOAD_FAST p_scale [ConstantVariable(float: 1.0)]
TRACE BINARY_OP 11 [ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE STORE_FAST p_descale [ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:917 in forward (_attention.forward)
            ) if fp8_out_scale is not None else 1.0
TRACE LOAD_FAST fp8_out_scale []
TRACE LOAD_CONST None [ConstantVariable(NoneType: None)]
TRACE IS_OP 0 [ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 908 [ConstantVariable(bool: True)]
TRACE LOAD_CONST 1.0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:916 in forward (_attention.forward)
            o_descale = 1.0 / fp8_out_scale.item(
TRACE STORE_FAST o_descale [ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:919 in forward (_attention.forward)
            arg_max_seqlens_q = 0 if on_gfx1x() else max_seqlens_q
TRACE LOAD_GLOBAL on_gfx1x []
TRACE CALL 0 [NullVariable, LazyVariableTracker()]
TRACE inlined call on_gfx1x from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:919 in forward (_attention.forward)
        arg_max_seqlens_q = 0 if on_gfx1x() else max_seqlens_q
                                 ~~~~~~~~^^
INLINING <code object on_gfx1x at 0x7f7c1d0ccd30, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 35>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:35 in on_gfx1x (on_gfx1x) (inline depth: 1)
    def on_gfx1x():
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:36 in on_gfx1x (on_gfx1x) (inline depth: 1)
        return True
TRACE RETURN_CONST True []
DONE INLINING <code object on_gfx1x at 0x7f7c1d0ccd30, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 35>
TRACE POP_JUMP_IF_FALSE 936 [ConstantVariable(bool: True)]
TRACE LOAD_CONST 0 []
TRACE JUMP_FORWARD 938 [ConstantVariable(int: 0)]
TRACE STORE_FAST arg_max_seqlens_q [ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:920 in forward (_attention.forward)
            arg_max_seqlens_k = 0 if on_gfx1x() else max_seqlens_k
TRACE LOAD_GLOBAL on_gfx1x []
TRACE CALL 0 [NullVariable, LazyVariableTracker()]
TRACE inlined call on_gfx1x from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:920 in forward (_attention.forward)
        arg_max_seqlens_k = 0 if on_gfx1x() else max_seqlens_k
                                 ~~~~~~~~^^
INLINING <code object on_gfx1x at 0x7f7c1d0ccd30, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 35>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:35 in on_gfx1x (on_gfx1x) (inline depth: 1)
    def on_gfx1x():
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:36 in on_gfx1x (on_gfx1x) (inline depth: 1)
        return True
TRACE RETURN_CONST True []
DONE INLINING <code object on_gfx1x at 0x7f7c1d0ccd30, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 35>
TRACE POP_JUMP_IF_FALSE 964 [ConstantVariable(bool: True)]
TRACE LOAD_CONST 0 []
TRACE JUMP_FORWARD 966 [ConstantVariable(int: 0)]
TRACE STORE_FAST arg_max_seqlens_k [ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_GLOBAL attn_fwd []
TRACE LOAD_FAST grid [NullVariable, LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), NestedUserFunctionVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:923 in forward (_attention.forward)
                q,
TRACE LOAD_FAST q [NullVariable, TritonKernelVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:924 in forward (_attention.forward)
                k,
TRACE LOAD_FAST k [NullVariable, TritonKernelVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:925 in forward (_attention.forward)
                v,
TRACE LOAD_FAST v [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:926 in forward (_attention.forward)
                bias,
TRACE LOAD_FAST bias [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:927 in forward (_attention.forward)
                sm_scale,
TRACE LOAD_FAST sm_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:928 in forward (_attention.forward)
                q_scale,
TRACE LOAD_FAST q_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:929 in forward (_attention.forward)
                k_scale,
TRACE LOAD_FAST k_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:930 in forward (_attention.forward)
                v_scale,
TRACE LOAD_FAST v_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:931 in forward (_attention.forward)
                p_scale,
TRACE LOAD_FAST p_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:932 in forward (_attention.forward)
                p_descale,
TRACE LOAD_FAST p_descale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:933 in forward (_attention.forward)
                o_descale,
TRACE LOAD_FAST o_descale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:934 in forward (_attention.forward)
                None,
TRACE LOAD_CONST None [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:935 in forward (_attention.forward)
                o,
TRACE LOAD_FAST o [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE BUILD_LIST 13 [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(NoneType: None), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:936 in forward (_attention.forward)
                *q_strides,
TRACE LOAD_FAST q_strides [NullVariable, TritonKernelVariable(), ListVariable(length=13)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=13), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:937 in forward (_attention.forward)
                *k_strides,
TRACE LOAD_FAST k_strides [NullVariable, TritonKernelVariable(), ListVariable(length=17)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=17), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:938 in forward (_attention.forward)
                *v_strides,
TRACE LOAD_FAST v_strides [NullVariable, TritonKernelVariable(), ListVariable(length=21)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=21), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:939 in forward (_attention.forward)
                *o_strides,
TRACE LOAD_FAST o_strides [NullVariable, TritonKernelVariable(), ListVariable(length=25)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=25), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:940 in forward (_attention.forward)
                *bias_strides,
TRACE LOAD_FAST bias_strides [NullVariable, TritonKernelVariable(), ListVariable(length=29)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=29), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:941 in forward (_attention.forward)
                cu_seqlens_q,
TRACE LOAD_FAST cu_seqlens_q [NullVariable, TritonKernelVariable(), ListVariable(length=33)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_APPEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=33), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:942 in forward (_attention.forward)
                cu_seqlens_k,
TRACE LOAD_FAST cu_seqlens_k [NullVariable, TritonKernelVariable(), ListVariable(length=34)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_APPEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=34), LazyVariableTracker()]
TRACE CALL_INTRINSIC_1 6 [NullVariable, TritonKernelVariable(), ListVariable(length=35)]
TRACE BUILD_MAP 0 [NullVariable, TritonKernelVariable(), TupleVariable(length=35)]
TRACE LOAD_CONST dropout_p [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:943 in forward (_attention.forward)
                dropout_p=0.0,
TRACE LOAD_CONST 0.0 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'dropout_p')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'dropout_p'), ConstantVariable(float: 0.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST philox_seed [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:944 in forward (_attention.forward)
                philox_seed=philox_seed,
TRACE LOAD_FAST philox_seed [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'philox_seed')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'philox_seed'), ConstantVariable(int: 114514)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST philox_offset_base [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:945 in forward (_attention.forward)
                philox_offset_base=philox_offset,
TRACE LOAD_FAST philox_offset [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'philox_offset_base')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'philox_offset_base'), ConstantVariable(int: 1919810)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST encoded_softmax [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:946 in forward (_attention.forward)
                encoded_softmax=encoded_softmax,
TRACE LOAD_FAST encoded_softmax [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'encoded_softmax')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'encoded_softmax'), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST HQ [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:947 in forward (_attention.forward)
                HQ=nheads_q,
TRACE LOAD_DEREF nheads_q [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'HQ')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'HQ'), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST HK [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:948 in forward (_attention.forward)
                HK=nheads_k,
TRACE LOAD_FAST nheads_k [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'HK')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'HK'), ConstantVariable(int: 8)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST ACTUAL_BLOCK_DMODEL [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:949 in forward (_attention.forward)
                ACTUAL_BLOCK_DMODEL=head_size,
TRACE LOAD_FAST head_size [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'ACTUAL_BLOCK_DMODEL')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'ACTUAL_BLOCK_DMODEL'), ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST MAX_SEQLENS_Q [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:950 in forward (_attention.forward)
                MAX_SEQLENS_Q=arg_max_seqlens_q,
TRACE LOAD_FAST arg_max_seqlens_q [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'MAX_SEQLENS_Q')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'MAX_SEQLENS_Q'), ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST MAX_SEQLENS_K [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:951 in forward (_attention.forward)
                MAX_SEQLENS_K=arg_max_seqlens_k,
TRACE LOAD_FAST arg_max_seqlens_k [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'MAX_SEQLENS_K')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'MAX_SEQLENS_K'), ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST IS_CAUSAL [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:952 in forward (_attention.forward)
                IS_CAUSAL=causal,
TRACE LOAD_FAST causal [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'IS_CAUSAL')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'IS_CAUSAL'), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST VARLEN [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:953 in forward (_attention.forward)
                VARLEN=True,
TRACE LOAD_CONST True [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'VARLEN')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'VARLEN'), ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST BLOCK_DMODEL [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:954 in forward (_attention.forward)
                BLOCK_DMODEL=padded_d_model,
TRACE LOAD_FAST padded_d_model [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BLOCK_DMODEL')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BLOCK_DMODEL'), ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST BIAS_TYPE [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:955 in forward (_attention.forward)
                BIAS_TYPE=0 if bias is None else 1,
TRACE LOAD_FAST bias [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE')]
TRACE LOAD_CONST None [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(NoneType: None)]
TRACE IS_OP 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 1130 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(bool: False)]
TRACE LOAD_CONST 0 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE')]
TRACE JUMP_FORWARD 1132 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(int: 0)]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST ENABLE_DROPOUT [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:956 in forward (_attention.forward)
                ENABLE_DROPOUT=False,
TRACE LOAD_CONST False [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'ENABLE_DROPOUT')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'ENABLE_DROPOUT'), ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST RETURN_ENCODED_SOFTMAX [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:957 in forward (_attention.forward)
                RETURN_ENCODED_SOFTMAX=False,
TRACE LOAD_CONST False [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'RETURN_ENCODED_SOFTMAX')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'RETURN_ENCODED_SOFTMAX'), ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST USE_FP8 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:958 in forward (_attention.forward)
                USE_FP8=use_fp8,
TRACE LOAD_FAST use_fp8 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8'), ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST USE_FP8_OUT [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:959 in forward (_attention.forward)
                USE_FP8_OUT=fp8_out_scale is not None,
TRACE LOAD_FAST fp8_out_scale [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8_OUT')]
TRACE LOAD_CONST None [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8_OUT'), ConstantVariable(NoneType: None)]
TRACE IS_OP 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8_OUT'), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8_OUT'), ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE CALL_FUNCTION_EX 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE inlined call <lambda> from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
                triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF max_seqlens_q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST META [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE LOAD_CONST BLOCK_M [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstDictVariable(), ConstantVariable(str: 'BLOCK_M')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
            triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
            ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x7f7c3c064990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 512)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 512)]
DONE INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 512)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x7f7c3c0d01f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 3)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [ConstantVariable(int: 512)]
TRACE BINARY_OP 0 [ConstantVariable(int: 512), ConstantVariable(int: 32)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 544)]
TRACE BINARY_OP 10 [ConstantVariable(int: 544), ConstantVariable(int: 1)]
TRACE LOAD_FAST y [ConstantVariable(int: 543)]
TRACE BINARY_OP 2 [ConstantVariable(int: 543), ConstantVariable(int: 32)]
TRACE RETURN_VALUE None [ConstantVariable(int: 16)]
DONE INLINING <code object cdiv at 0x7f7c3c0d01f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [ConstantVariable(int: 16)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 16)]
DONE INLINING <code object __call__ at 0x7f7c3c064990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:895 in <lambda> (_attention.forward) (inline depth: 1)
                nheads_q,
TRACE LOAD_DEREF nheads_q [ConstantVariable(int: 16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:896 in <lambda> (_attention.forward) (inline depth: 1)
                batch,
TRACE LOAD_DEREF batch [ConstantVariable(int: 16), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE BUILD_TUPLE 3 [ConstantVariable(int: 16), ConstantVariable(int: 64), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [TupleVariable(length=3)]
DONE INLINING <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>
TRACE inlined call <lambda> from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
                triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF max_seqlens_q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST META [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE LOAD_CONST BLOCK_M [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstDictVariable(), ConstantVariable(str: 'BLOCK_M')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
            triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
            ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x7f7c3c064990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 512)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 512)]
DONE INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 512)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x7f7c3c0d01f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 3)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [ConstantVariable(int: 512)]
TRACE BINARY_OP 0 [ConstantVariable(int: 512), ConstantVariable(int: 32)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 544)]
TRACE BINARY_OP 10 [ConstantVariable(int: 544), ConstantVariable(int: 1)]
TRACE LOAD_FAST y [ConstantVariable(int: 543)]
TRACE BINARY_OP 2 [ConstantVariable(int: 543), ConstantVariable(int: 32)]
TRACE RETURN_VALUE None [ConstantVariable(int: 16)]
DONE INLINING <code object cdiv at 0x7f7c3c0d01f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [ConstantVariable(int: 16)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 16)]
DONE INLINING <code object __call__ at 0x7f7c3c064990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:895 in <lambda> (_attention.forward) (inline depth: 1)
                nheads_q,
TRACE LOAD_DEREF nheads_q [ConstantVariable(int: 16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:896 in <lambda> (_attention.forward) (inline depth: 1)
                batch,
TRACE LOAD_DEREF batch [ConstantVariable(int: 16), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE BUILD_TUPLE 3 [ConstantVariable(int: 16), ConstantVariable(int: 64), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [TupleVariable(length=3)]
DONE INLINING <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>
TRACE inlined call <lambda> from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
                triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF max_seqlens_q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST META [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE LOAD_CONST BLOCK_M [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstDictVariable(), ConstantVariable(str: 'BLOCK_M')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
            triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
            ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x7f7c3c064990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 512)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 512)]
DONE INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 512)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x7f7c3c0d01f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 3)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [ConstantVariable(int: 512)]
TRACE BINARY_OP 0 [ConstantVariable(int: 512), ConstantVariable(int: 32)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 544)]
TRACE BINARY_OP 10 [ConstantVariable(int: 544), ConstantVariable(int: 1)]
TRACE LOAD_FAST y [ConstantVariable(int: 543)]
TRACE BINARY_OP 2 [ConstantVariable(int: 543), ConstantVariable(int: 32)]
TRACE RETURN_VALUE None [ConstantVariable(int: 16)]
DONE INLINING <code object cdiv at 0x7f7c3c0d01f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [ConstantVariable(int: 16)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 16)]
DONE INLINING <code object __call__ at 0x7f7c3c064990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:895 in <lambda> (_attention.forward) (inline depth: 1)
                nheads_q,
TRACE LOAD_DEREF nheads_q [ConstantVariable(int: 16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:896 in <lambda> (_attention.forward) (inline depth: 1)
                batch,
TRACE LOAD_DEREF batch [ConstantVariable(int: 16), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE BUILD_TUPLE 3 [ConstantVariable(int: 16), ConstantVariable(int: 64), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [TupleVariable(length=3)]
DONE INLINING <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>
TRACE inlined call <lambda> from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
                triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF max_seqlens_q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST META [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE LOAD_CONST BLOCK_M [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstDictVariable(), ConstantVariable(str: 'BLOCK_M')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
            triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
            ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x7f7c3c064990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 512)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 512)]
DONE INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 512)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x7f7c3c0d01f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 3)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [ConstantVariable(int: 512)]
TRACE BINARY_OP 0 [ConstantVariable(int: 512), ConstantVariable(int: 32)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 544)]
TRACE BINARY_OP 10 [ConstantVariable(int: 544), ConstantVariable(int: 1)]
TRACE LOAD_FAST y [ConstantVariable(int: 543)]
TRACE BINARY_OP 2 [ConstantVariable(int: 543), ConstantVariable(int: 32)]
TRACE RETURN_VALUE None [ConstantVariable(int: 16)]
DONE INLINING <code object cdiv at 0x7f7c3c0d01f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [ConstantVariable(int: 16)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 16)]
DONE INLINING <code object __call__ at 0x7f7c3c064990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:895 in <lambda> (_attention.forward) (inline depth: 1)
                nheads_q,
TRACE LOAD_DEREF nheads_q [ConstantVariable(int: 16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:896 in <lambda> (_attention.forward) (inline depth: 1)
                batch,
TRACE LOAD_DEREF batch [ConstantVariable(int: 16), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE BUILD_TUPLE 3 [ConstantVariable(int: 16), ConstantVariable(int: 64), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [TupleVariable(length=3)]
DONE INLINING <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>
wrap_to_fake L['cu_seqlens_k'] (2,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='cu_seqlens_k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_cu_seqlens_k_ L['cu_seqlens_k'] FakeTensor(..., device='cuda:0', size=(2,), dtype=torch.int32) at debug_level 0 before=False
TRACE FX call triton_kernel_wrapper_mutation from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
TRACE POP_TOP None [ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:962 in forward (_attention.forward)
            return o, encoded_softmax
TRACE LOAD_FAST o []
TRACE LOAD_FAST encoded_softmax [TensorVariable()]
TRACE BUILD_TUPLE 2 [TensorVariable(), ConstantVariable(NoneType: None)]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
Step 1: torchdynamo done tracing forward (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py, line 962 in forward>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_15_56d9b49b_43fd_407f_8b51_04923b0ca224 =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, L_o_: "[31mbf16[0m[34m[512, 64, 128][0m[2m[34m[8192, 128, 1][0m[2m[32mcuda:0[0m", L_q_: "[31mbf16[0m[34m[512, 64, 128][0m[2m[34m[8192, 128, 1][0m[2m[32mcuda:0[0m", s37: "Sym(s37)", L_k_: "[31mbf16[0m[34m[s37, 8, 128][0m[2m[34m[1024, 128, 1][0m[2m[32mcuda:0[0m", L_cu_seqlens_q_: "[31mi32[0m[34m[2][0m[2m[34m[1][0m[2m[32mcuda:0[0m", s33: "Sym(s33)", L_v_: "[31mbf16[0m[34m[s33, 8, 128][0m[2m[34m[1024, 128, 1][0m[2m[32mcuda:0[0m", L_cu_seqlens_k_: "[31mi32[0m[34m[2][0m[2m[34m[1][0m[2m[32mcuda:0[0m"):
        l_o_ = L_o_
        l_q_ = L_q_
        l_k_ = L_k_
        l_cu_seqlens_q_ = L_cu_seqlens_q_
        l_v_ = L_v_
        l_cu_seqlens_k_ = L_cu_seqlens_k_
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward, code: attn_fwd[grid]([0m
        triton_kernel_wrapper_mutation = torch.ops.higher_order.triton_kernel_wrapper_mutation(kernel_idx = [34m0[0m, constant_args_idx = [34m1[0m, grid = [([34m16[0m, [34m64[0m, [34m1[0m), ([34m16[0m, [34m64[0m, [34m1[0m), ([34m16[0m, [34m64[0m, [34m1[0m), ([34m16[0m, [34m64[0m, [34m1[0m)], tma_descriptor_metadata = [34m{}[0m, kwargs = [34m{'Q': l_q_, 'K': l_k_, 'V': l_v_, 'Out': l_o_, 'cu_seqlens_q': l_cu_seqlens_q_, 'cu_seqlens_k': l_cu_seqlens_k_}[0m);  [2ml_q_ = l_k_ = l_v_ = l_o_ = l_cu_seqlens_q_ = l_cu_seqlens_k_ = triton_kernel_wrapper_mutation = None[0m
        return ()
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing GQA_Attention_Flash_ /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:875
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:875 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7)
        @torch.compile(mode="max-autotune-no-cudagraphs")
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:904 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            B, T, C = x_in.shape
TRACE LOAD_FAST x_in []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
automatic dynamic size L['x_in'] size(1) 128 != 512
wrap_to_fake L['x_in'] (1, 128, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='x_in', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_x_in_ L['x_in'] FakeTensor(..., device='cuda:0', size=(1, s52, 5120), dtype=torch.bfloat16) at debug_level 0 before=False
create_graph_input s52 L['x_in'].size()[1] s52 at debug_level 0 before=True
_lift_symbols_in_symint s52 from L['x_in'].size()[1] at debug_level 0
TRACE FX call size from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:904 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        B, T, C = x_in.shape
                  ^^^^^^^^^^
TRACE UNPACK_SEQUENCE 3 [SizeVariable(length=3)]
TRACE STORE_FAST B [ConstantVariable(int: 5120), SymNodeVariable(), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 5120), SymNodeVariable()]
TRACE STORE_FAST C [ConstantVariable(int: 5120)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:905 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            device = x_in.device
TRACE LOAD_FAST x_in []
TRACE LOAD_ATTR device [TensorVariable()]
TRACE STORE_FAST device [ConstantVariable(device: device(type='cuda', index=0))]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:906 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            Lmax = past_key_value.shape[3]
TRACE LOAD_FAST past_key_value []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
wrap_to_fake L['past_key_value'] (8, 1, 2, 8192, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='past_key_value', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}), tensor_source=LocalSource(local_name='past_key_value', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_past_key_value_ L['past_key_value'] FakeTensor(..., device='cuda:0', size=(8, 1, 2, 8192, 1024),
           dtype=torch.bfloat16) at debug_level 0 before=False
wrap_to_fake L['past_key_value']._base (8, 1, 2, 8192, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='past_key_value', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
TRACE LOAD_CONST 3 [SizeVariable(length=5)]
TRACE BINARY_SUBSCR None [SizeVariable(length=5), ConstantVariable(int: 3)]
TRACE STORE_FAST Lmax [ConstantVariable(int: 8192)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            starts = cache_position[:, 0].clone()
TRACE LOAD_FAST cache_position []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE LOAD_CONST None [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [LazyVariableTracker(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST 0 [LazyVariableTracker(), SliceVariable()]
TRACE BUILD_TUPLE 2 [LazyVariableTracker(), SliceVariable(), ConstantVariable(int: 0)]
TRACE BINARY_SUBSCR None [LazyVariableTracker(), TupleVariable(length=2)]
wrap_to_fake L['cache_position'] (1, 1) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='cache_position', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_cache_position_ L['cache_position'] FakeTensor(..., device='cuda:0', size=(1, 1), dtype=torch.int64) at debug_level 0 before=False
TRACE FX call getitem_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        starts = cache_position[:, 0].clone()
                 ~~~~~~~~~~~~~~^^^^^^
TRACE LOAD_ATTR clone [TensorVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), clone)]
TRACE FX call clone from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        starts = cache_position[:, 0].clone()
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST starts [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:910 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            starts.clamp_(min=0, max=Lmax)
TRACE LOAD_FAST starts []
TRACE LOAD_ATTR clamp_ [TensorVariable()]
TRACE LOAD_CONST 0 [NullVariable, GetAttrVariable(TensorVariable(), clamp_)]
TRACE LOAD_FAST Lmax [NullVariable, GetAttrVariable(TensorVariable(), clamp_), ConstantVariable(int: 0)]
TRACE KW_NAMES ('min', 'max') [NullVariable, GetAttrVariable(TensorVariable(), clamp_), ConstantVariable(int: 0), ConstantVariable(int: 8192)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), clamp_), ConstantVariable(int: 0), ConstantVariable(int: 8192)]
TRACE FX call clamp_ from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:910 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        starts.clamp_(min=0, max=Lmax)
        ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:913 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            x = T5RMSNorm(x_in, ln1, rmsnorm_epsilon)  # 実装は外部
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST x_in [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:913 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        x = T5RMSNorm(x_in, ln1, rmsnorm_epsilon)  # 実装は外部
            ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x7f7c1d008ab0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE FX call add from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln1'] (5120,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln1', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln1_ L['ln1'] FakeTensor(..., device='cuda:0', size=(5120,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x7f7c1d008ab0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:915 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            HN = H * N
TRACE LOAD_FAST H []
TRACE LOAD_FAST N [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), LazyVariableTracker()]
TRACE STORE_FAST HN [ConstantVariable(int: 8192)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:918 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            qkv = fpx_matmul(x, QKV_, QKV_state, ebits, mbits)  # [B,T, QHN + KVd + KVd]
TRACE LOAD_GLOBAL fpx_matmul []
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST QKV_ [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST QKV_state [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_FAST ebits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST mbits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call fpx_matmul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:918 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        qkv = fpx_matmul(x, QKV_, QKV_state, ebits, mbits)  # [B,T, QHN + KVd + KVd]
              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object fpx_matmul at 0x3c1ee490, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:420 in fpx_matmul (fpx_matmul) (inline depth: 1)
    def fpx_matmul(x,weight,weight_state,ebits:int=3,mbits:int=2):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:421 in fpx_matmul (fpx_matmul) (inline depth: 1)
        if ebits == -44: #hqq
TRACE LOAD_FAST ebits []
TRACE LOAD_CONST -44 [LazyVariableTracker()]
TRACE COMPARE_OP == [LazyVariableTracker(), ConstantVariable(int: -44)]
TRACE POP_JUMP_IF_FALSE 322 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S0=x.shape[0]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE FX call size_1 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul) (inline depth: 1)
        S0=x.shape[0]
           ^^^^^^^
TRACE LOAD_CONST 0 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 0)]
TRACE STORE_FAST S0 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S1=x.shape[1]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE FX call size_2 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul) (inline depth: 1)
        S1=x.shape[1]
           ^^^^^^^
TRACE LOAD_CONST 1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 1)]
TRACE STORE_FAST S1 [SymNodeVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:424 in fpx_matmul (fpx_matmul) (inline depth: 1)
            dtype = x.dtype
TRACE LOAD_FAST x []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
            x = x.to(dtype=torch.float16).view(-1,x.shape[2])
TRACE LOAD_FAST x []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float16 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_2 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST x [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1)]
TRACE LOAD_ATTR shape [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), TensorVariable()]
TRACE FX call size_3 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
                                              ^^^^^^^
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3), ConstantVariable(int: 2)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), ConstantVariable(int: 5120)]
TRACE FX call view from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
            out = weight.forward_manual(x).to(dtype=dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_ATTR forward_manual [LazyVariableTracker()]
TRACE LOAD_FAST x [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x7f7c1f9a11c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE CALL 1 [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x7f7c1f9a11c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton)), TensorVariable()]
TRACE inlined call forward_manual from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object forward_manual at 0x7f7c1fbe0cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:543 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        def forward_manual(self, x: Tensor, matmul_type: str="GEMM") -> Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE LOAD_GLOBAL forward_functional []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:545 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                x,
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:546 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.bias,
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR bias [NullVariable, LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_tensor_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_ATTR get_tensor_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_tensor_args at 0x7f7c1f9a1080>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_tensor_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_tensor_args(),
            ~~~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_tensor_args at 0x7f7c1fbc6560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:524 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
        def get_tensor_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:525 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
            return [self.W_q, self.scales, self.zeros]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR W_q [UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_FAST self [LazyVariableTracker()]
TRACE LOAD_ATTR scales [LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['QKV_']._parameters['scales'] (80, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='QKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='scales'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_QKV_parameters_scales_ L['QKV_']._parameters['scales'] Parameter(FakeTensor(..., device='cuda:0', size=(80, 10240), dtype=torch.float16)) at debug_level 0 before=False
TRACE LOAD_FAST self [LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR zeros [LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['QKV_']._parameters['zeros'] (80, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='QKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='zeros'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_QKV_parameters_zeros_ L['QKV_']._parameters['zeros'] Parameter(FakeTensor(..., device='cuda:0', size=(80, 10240), dtype=torch.float16)) at debug_level 0 before=False
TRACE BUILD_LIST 3 [LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [ListVariable(length=3)]
DONE INLINING <code object get_tensor_args at 0x7f7c1fbc6560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_meta_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3)]
TRACE LOAD_ATTR get_meta_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_meta_args at 0x7f7c1f9a1120>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_meta_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_meta_args(),
            ~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_meta_args at 0x3c1c0c40, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:527 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
        def get_meta_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE LOAD_GLOBAL int []
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR scaled_activations [NullVariable, LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:529 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_nbits,
TRACE LOAD_FAST self [ConstantVariable(int: 0)]
TRACE LOAD_ATTR W_nbits [ConstantVariable(int: 0), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:530 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.group_size,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker()]
TRACE LOAD_ATTR group_size [ConstantVariable(int: 0), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:531 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.unpack_mask,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR unpack_mask [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:532 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.elements_per_sample,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR elements_per_sample [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:533 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.input_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR input_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:534 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.output_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR output_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:535 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.acc_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR acc_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:536 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.meta_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR meta_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:537 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.channel_scale_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR channel_scale_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:538 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_group_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR W_group_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:539 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    int(self.data_contiguous),
TRACE LOAD_GLOBAL int [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int)]
TRACE LOAD_ATTR data_contiguous [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE BUILD_LIST 12 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [ListVariable(length=12)]
DONE INLINING <code object get_meta_args at 0x3c1c0c40, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:549 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
TRACE LOAD_GLOBAL GEMLITE_MATMUL_TYPES_MAPPING [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12)]
TRACE LOAD_FAST matmul_type [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker(), ConstantVariable(str: 'GEMM')]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        return forward_functional(
               ~~~~~~~~~~~~~~~~~~^
            x,
            ^^
            self.bias,
            ^^^^^^^^^^
            self.get_tensor_args(),
            ^^^^^^^^^^^^^^^^^^^^^^^
            self.get_meta_args(),
            ^^^^^^^^^^^^^^^^^^^^^
            GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object __call__ at 0x7f7c609ab960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:675 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        def __call__(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
            return self._opoverload(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR _opoverload [NullVariable, UserDefinedObjectVariable(CustomOpDef)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=5)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
wrap_to_fake L['QKV_'].W_q (640, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=AttrSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='QKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='W_q'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_QKV_W_q L['QKV_'].W_q FakeTensor(..., device='cuda:0', size=(640, 10240), dtype=torch.int32) at debug_level 0 before=False
TRACE FX call forward_functional_default from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        return self._opoverload(*args, **kwargs)
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object __call__ at 0x7f7c609ab960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object forward_manual at 0x7f7c1fbe0cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_3 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE STORE_FAST out [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
            return out.view(S0,S1,-1)
TRACE LOAD_FAST out []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST S0 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST S1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: -1)]
TRACE FX call view_1 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
        return out.view(S0,S1,-1)
               ~~~~~~~~^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object fpx_matmul at 0x3c1ee490, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>
TRACE STORE_FAST qkv [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:919 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q, k, v = qkv.split(qkv_split_list, dim=-1)
TRACE LOAD_FAST qkv []
TRACE LOAD_ATTR split [TensorVariable()]
TRACE LOAD_FAST qkv_split_list [NullVariable, GetAttrVariable(TensorVariable(), split)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker()]
TRACE KW_NAMES ('dim',) [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE FX call split from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:919 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        q, k, v = qkv.split(qkv_split_list, dim=-1)
                  ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
TRACE UNPACK_SEQUENCE 3 [TupleVariable(length=3)]
TRACE STORE_FAST q [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST k [TensorVariable(), TensorVariable()]
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:922 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q.add_(Q_bias)
TRACE LOAD_FAST q []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST Q_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
wrap_to_fake L['Q_bias'] () StatefulSymbolicContext(dynamic_sizes=[], dynamic_strides=[], constraint_sizes=[], constraint_strides=[], specialize_on=[], view_base_context=None, tensor_source=LocalSource(local_name='Q_bias', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_Q_bias_ L['Q_bias'] FakeTensor(..., device='cuda:0', size=(), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call add_ from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:922 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        q.add_(Q_bias)
        ~~~~~~^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:923 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k.add_(K_bias)
TRACE LOAD_FAST k []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST K_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
TRACE FX call add__1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:923 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        k.add_(K_bias)
        ~~~~~~^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:924 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            v.add_(V_bias)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST V_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
TRACE FX call add__2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:924 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        v.add_(V_bias)
        ~~~~~~^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:927 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q = q.view(B, T, H, N)  # [B,T,H,N]
TRACE LOAD_FAST q []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:927 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        q = q.view(B, T, H, N)  # [B,T,H,N]
            ~~~~~~^^^^^^^^^^^^
TRACE STORE_FAST q [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:928 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            kv_dim_flat = k.shape[-1]     # kv_heads * N
TRACE LOAD_FAST k []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE FX call size_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:928 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        kv_dim_flat = k.shape[-1]     # kv_heads * N
                      ^^^^^^^
TRACE LOAD_CONST -1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: -1)]
TRACE STORE_FAST kv_dim_flat [ConstantVariable(int: 1024)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:929 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            kv_heads = kv_dim_flat // N
TRACE LOAD_FAST kv_dim_flat []
TRACE LOAD_FAST N [ConstantVariable(int: 1024)]
TRACE BINARY_OP 2 [ConstantVariable(int: 1024), ConstantVariable(int: 128)]
TRACE STORE_FAST kv_heads [ConstantVariable(int: 8)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:930 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k = k.view(B, T, kv_heads, N) # [B,T,kv_h,N]
TRACE LOAD_FAST k []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_heads [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:930 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        k = k.view(B, T, kv_heads, N) # [B,T,kv_h,N]
            ~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:931 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            v = v.view(B, T, kv_heads, N)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_heads [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:931 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        v = v.view(B, T, kv_heads, N)
            ~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:934 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            if ln_r is not None:
TRACE LOAD_FAST ln_r []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 0 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
wrap_to_fake L['ln_r'] (128,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln_r', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln_r_ L['ln_r'] FakeTensor(..., device='cuda:0', size=(128,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE POP_JUMP_IF_TRUE 606 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:935 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
                q = T5RMSNorm(q, ln_r, rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln_r [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:935 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q = T5RMSNorm(q, ln_r, rmsnorm_epsilon)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x7f7c1d008ab0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x7f7c1d008ab0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST q [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:936 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
                k = T5RMSNorm(k, ln_k, rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln_k [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:936 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k = T5RMSNorm(k, ln_k, rmsnorm_epsilon)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x7f7c1d008ab0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln_k'] (128,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln_k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln_k_ L['ln_k'] FakeTensor(..., device='cuda:0', size=(128,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x7f7c1d008ab0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:940 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k_write = k.view(B, T, -1)
TRACE LOAD_FAST k []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: -1)]
TRACE FX call view_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:940 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        k_write = k.view(B, T, -1)
                  ~~~~~~^^^^^^^^^^
TRACE STORE_FAST k_write [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:941 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            v_write = v.view(B, T, -1)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: -1)]
TRACE FX call view_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:941 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        v_write = v.view(B, T, -1)
                  ~~~~~~^^^^^^^^^^
TRACE STORE_FAST v_write [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:944 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            new_lengths = starts + T
TRACE LOAD_FAST starts []
TRACE LOAD_FAST T [TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), SymNodeVariable()]
TRACE FX call add_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:944 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        new_lengths = starts + T
                      ~~~~~~~^~~
TRACE STORE_FAST new_lengths [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            excess_tokens = torch.clamp(new_lengths - Lmax, min=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR clamp [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST new_lengths [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST Lmax [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 10 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 8192)]
TRACE FX call sub from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        excess_tokens = torch.clamp(new_lengths - Lmax, min=0)
                                    ~~~~~~~~~~~~^~~~~~
TRACE LOAD_CONST 0 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE KW_NAMES ('min',) [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 0)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 0)]
TRACE FX call clamp from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        excess_tokens = torch.clamp(new_lengths - Lmax, min=0)
                        ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST excess_tokens [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:946 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            batches_to_evict = excess_tokens > 0
TRACE LOAD_FAST excess_tokens []
TRACE LOAD_CONST 0 [TensorVariable()]
TRACE COMPARE_OP > [TensorVariable(), ConstantVariable(int: 0)]
TRACE FX call gt from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:946 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        batches_to_evict = excess_tokens > 0
                           ^^^^^^^^^^^^^^^^^
TRACE STORE_FAST batches_to_evict [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            if bool(batches_to_evict.any()):
TRACE LOAD_GLOBAL bool []
TRACE LOAD_FAST batches_to_evict [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR any [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), any)]
TRACE FX call any_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        if bool(batches_to_evict.any()):
                ~~~~~~~~~~~~~~~~~~~~^^
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
Graph break (user stack suppressed due to duplicate graph break) in user code at /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949
Graph Break Reason: Failed to trace builtin operator
  Explanation: Dynamo does not know how to trace builtin operator `bool` with argument types ['Tensor'] (has_kwargs False)
  Hint: Avoid calling builtin `bool` with argument types ['Tensor']. Consider using an equivalent alternative function/method to `bool`.
  Hint: If you are attempting to call a logging function (e.g. `print`), you can try adding it to `torch._dynamo.config.reorderable_logging_functions`.
  Hint: Please report an issue to PyTorch.

  Developer debug context: builtin bool [<class 'torch._dynamo.variables.tensor.TensorVariable'>] False

 For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0059.html
Step 1: torchdynamo start tracing GQA_Attention_Flash_ /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:875
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:875 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7)
        @torch.compile(mode="max-autotune-no-cudagraphs")
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:904 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            B, T, C = x_in.shape
TRACE LOAD_FAST x_in []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
wrap_to_fake L['x_in'] (1, 128, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='x_in', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_x_in_ L['x_in'] FakeTensor(..., device='cuda:0', size=(1, s52, 5120), dtype=torch.bfloat16) at debug_level 0 before=False
create_graph_input s52 L['x_in'].size()[1] s52 at debug_level 0 before=True
_lift_symbols_in_symint s52 from L['x_in'].size()[1] at debug_level 0
TRACE FX call size from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:904 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        B, T, C = x_in.shape
                  ^^^^^^^^^^
TRACE UNPACK_SEQUENCE 3 [SizeVariable(length=3)]
TRACE STORE_FAST B [ConstantVariable(int: 5120), SymNodeVariable(), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 5120), SymNodeVariable()]
TRACE STORE_FAST C [ConstantVariable(int: 5120)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:905 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            device = x_in.device
TRACE LOAD_FAST x_in []
TRACE LOAD_ATTR device [TensorVariable()]
TRACE STORE_FAST device [ConstantVariable(device: device(type='cuda', index=0))]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:906 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            Lmax = past_key_value.shape[3]
TRACE LOAD_FAST past_key_value []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
wrap_to_fake L['past_key_value'] (8, 1, 2, 8192, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='past_key_value', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}), tensor_source=LocalSource(local_name='past_key_value', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_past_key_value_ L['past_key_value'] FakeTensor(..., device='cuda:0', size=(8, 1, 2, 8192, 1024),
           dtype=torch.bfloat16) at debug_level 0 before=False
wrap_to_fake L['past_key_value']._base (8, 1, 2, 8192, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='past_key_value', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
TRACE LOAD_CONST 3 [SizeVariable(length=5)]
TRACE BINARY_SUBSCR None [SizeVariable(length=5), ConstantVariable(int: 3)]
TRACE STORE_FAST Lmax [ConstantVariable(int: 8192)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            starts = cache_position[:, 0].clone()
TRACE LOAD_FAST cache_position []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE LOAD_CONST None [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [LazyVariableTracker(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST 0 [LazyVariableTracker(), SliceVariable()]
TRACE BUILD_TUPLE 2 [LazyVariableTracker(), SliceVariable(), ConstantVariable(int: 0)]
TRACE BINARY_SUBSCR None [LazyVariableTracker(), TupleVariable(length=2)]
wrap_to_fake L['cache_position'] (1, 1) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='cache_position', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_cache_position_ L['cache_position'] FakeTensor(..., device='cuda:0', size=(1, 1), dtype=torch.int64) at debug_level 0 before=False
TRACE FX call getitem_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        starts = cache_position[:, 0].clone()
                 ~~~~~~~~~~~~~~^^^^^^
TRACE LOAD_ATTR clone [TensorVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), clone)]
TRACE FX call clone from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        starts = cache_position[:, 0].clone()
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST starts [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:910 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            starts.clamp_(min=0, max=Lmax)
TRACE LOAD_FAST starts []
TRACE LOAD_ATTR clamp_ [TensorVariable()]
TRACE LOAD_CONST 0 [NullVariable, GetAttrVariable(TensorVariable(), clamp_)]
TRACE LOAD_FAST Lmax [NullVariable, GetAttrVariable(TensorVariable(), clamp_), ConstantVariable(int: 0)]
TRACE KW_NAMES ('min', 'max') [NullVariable, GetAttrVariable(TensorVariable(), clamp_), ConstantVariable(int: 0), ConstantVariable(int: 8192)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), clamp_), ConstantVariable(int: 0), ConstantVariable(int: 8192)]
TRACE FX call clamp_ from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:910 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        starts.clamp_(min=0, max=Lmax)
        ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:913 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            x = T5RMSNorm(x_in, ln1, rmsnorm_epsilon)  # 実装は外部
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST x_in [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:913 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        x = T5RMSNorm(x_in, ln1, rmsnorm_epsilon)  # 実装は外部
            ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x7f7c1d008ab0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE FX call add from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln1'] (5120,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln1', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln1_ L['ln1'] FakeTensor(..., device='cuda:0', size=(5120,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x7f7c1d008ab0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:915 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            HN = H * N
TRACE LOAD_FAST H []
TRACE LOAD_FAST N [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), LazyVariableTracker()]
TRACE STORE_FAST HN [ConstantVariable(int: 8192)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:918 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            qkv = fpx_matmul(x, QKV_, QKV_state, ebits, mbits)  # [B,T, QHN + KVd + KVd]
TRACE LOAD_GLOBAL fpx_matmul []
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST QKV_ [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST QKV_state [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_FAST ebits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST mbits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call fpx_matmul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:918 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        qkv = fpx_matmul(x, QKV_, QKV_state, ebits, mbits)  # [B,T, QHN + KVd + KVd]
              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object fpx_matmul at 0x3c1ee490, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:420 in fpx_matmul (fpx_matmul) (inline depth: 1)
    def fpx_matmul(x,weight,weight_state,ebits:int=3,mbits:int=2):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:421 in fpx_matmul (fpx_matmul) (inline depth: 1)
        if ebits == -44: #hqq
TRACE LOAD_FAST ebits []
TRACE LOAD_CONST -44 [LazyVariableTracker()]
TRACE COMPARE_OP == [LazyVariableTracker(), ConstantVariable(int: -44)]
TRACE POP_JUMP_IF_FALSE 322 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S0=x.shape[0]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE FX call size_1 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul) (inline depth: 1)
        S0=x.shape[0]
           ^^^^^^^
TRACE LOAD_CONST 0 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 0)]
TRACE STORE_FAST S0 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S1=x.shape[1]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE FX call size_2 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul) (inline depth: 1)
        S1=x.shape[1]
           ^^^^^^^
TRACE LOAD_CONST 1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 1)]
TRACE STORE_FAST S1 [SymNodeVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:424 in fpx_matmul (fpx_matmul) (inline depth: 1)
            dtype = x.dtype
TRACE LOAD_FAST x []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
            x = x.to(dtype=torch.float16).view(-1,x.shape[2])
TRACE LOAD_FAST x []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float16 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_2 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST x [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1)]
TRACE LOAD_ATTR shape [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), TensorVariable()]
TRACE FX call size_3 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
                                              ^^^^^^^
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3), ConstantVariable(int: 2)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), ConstantVariable(int: 5120)]
TRACE FX call view from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
            out = weight.forward_manual(x).to(dtype=dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_ATTR forward_manual [LazyVariableTracker()]
TRACE LOAD_FAST x [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x7f7c1f9a11c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE CALL 1 [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x7f7c1f9a11c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton)), TensorVariable()]
TRACE inlined call forward_manual from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object forward_manual at 0x7f7c1fbe0cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:543 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        def forward_manual(self, x: Tensor, matmul_type: str="GEMM") -> Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE LOAD_GLOBAL forward_functional []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:545 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                x,
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:546 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.bias,
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR bias [NullVariable, LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_tensor_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_ATTR get_tensor_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_tensor_args at 0x7f7c1f9a1080>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_tensor_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_tensor_args(),
            ~~~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_tensor_args at 0x7f7c1fbc6560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:524 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
        def get_tensor_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:525 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
            return [self.W_q, self.scales, self.zeros]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR W_q [UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_FAST self [LazyVariableTracker()]
TRACE LOAD_ATTR scales [LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['QKV_']._parameters['scales'] (80, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='QKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='scales'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_QKV_parameters_scales_ L['QKV_']._parameters['scales'] Parameter(FakeTensor(..., device='cuda:0', size=(80, 10240), dtype=torch.float16)) at debug_level 0 before=False
TRACE LOAD_FAST self [LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR zeros [LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['QKV_']._parameters['zeros'] (80, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='QKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='zeros'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_QKV_parameters_zeros_ L['QKV_']._parameters['zeros'] Parameter(FakeTensor(..., device='cuda:0', size=(80, 10240), dtype=torch.float16)) at debug_level 0 before=False
TRACE BUILD_LIST 3 [LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [ListVariable(length=3)]
DONE INLINING <code object get_tensor_args at 0x7f7c1fbc6560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_meta_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3)]
TRACE LOAD_ATTR get_meta_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_meta_args at 0x7f7c1f9a1120>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_meta_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_meta_args(),
            ~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_meta_args at 0x3c1c0c40, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:527 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
        def get_meta_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE LOAD_GLOBAL int []
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR scaled_activations [NullVariable, LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:529 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_nbits,
TRACE LOAD_FAST self [ConstantVariable(int: 0)]
TRACE LOAD_ATTR W_nbits [ConstantVariable(int: 0), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:530 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.group_size,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker()]
TRACE LOAD_ATTR group_size [ConstantVariable(int: 0), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:531 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.unpack_mask,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR unpack_mask [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:532 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.elements_per_sample,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR elements_per_sample [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:533 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.input_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR input_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:534 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.output_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR output_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:535 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.acc_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR acc_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:536 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.meta_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR meta_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:537 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.channel_scale_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR channel_scale_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:538 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_group_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR W_group_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:539 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    int(self.data_contiguous),
TRACE LOAD_GLOBAL int [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int)]
TRACE LOAD_ATTR data_contiguous [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE BUILD_LIST 12 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [ListVariable(length=12)]
DONE INLINING <code object get_meta_args at 0x3c1c0c40, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:549 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
TRACE LOAD_GLOBAL GEMLITE_MATMUL_TYPES_MAPPING [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12)]
TRACE LOAD_FAST matmul_type [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker(), ConstantVariable(str: 'GEMM')]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        return forward_functional(
               ~~~~~~~~~~~~~~~~~~^
            x,
            ^^
            self.bias,
            ^^^^^^^^^^
            self.get_tensor_args(),
            ^^^^^^^^^^^^^^^^^^^^^^^
            self.get_meta_args(),
            ^^^^^^^^^^^^^^^^^^^^^
            GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object __call__ at 0x7f7c609ab960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:675 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        def __call__(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
            return self._opoverload(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR _opoverload [NullVariable, UserDefinedObjectVariable(CustomOpDef)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=5)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
wrap_to_fake L['QKV_'].W_q (640, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=AttrSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='QKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='W_q'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_QKV_W_q L['QKV_'].W_q FakeTensor(..., device='cuda:0', size=(640, 10240), dtype=torch.int32) at debug_level 0 before=False
TRACE FX call forward_functional_default from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        return self._opoverload(*args, **kwargs)
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object __call__ at 0x7f7c609ab960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object forward_manual at 0x7f7c1fbe0cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_3 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE STORE_FAST out [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
            return out.view(S0,S1,-1)
TRACE LOAD_FAST out []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST S0 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST S1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: -1)]
TRACE FX call view_1 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
        return out.view(S0,S1,-1)
               ~~~~~~~~^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object fpx_matmul at 0x3c1ee490, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>
TRACE STORE_FAST qkv [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:919 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q, k, v = qkv.split(qkv_split_list, dim=-1)
TRACE LOAD_FAST qkv []
TRACE LOAD_ATTR split [TensorVariable()]
TRACE LOAD_FAST qkv_split_list [NullVariable, GetAttrVariable(TensorVariable(), split)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker()]
TRACE KW_NAMES ('dim',) [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE FX call split from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:919 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        q, k, v = qkv.split(qkv_split_list, dim=-1)
                  ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
TRACE UNPACK_SEQUENCE 3 [TupleVariable(length=3)]
TRACE STORE_FAST q [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST k [TensorVariable(), TensorVariable()]
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:922 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q.add_(Q_bias)
TRACE LOAD_FAST q []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST Q_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
wrap_to_fake L['Q_bias'] () StatefulSymbolicContext(dynamic_sizes=[], dynamic_strides=[], constraint_sizes=[], constraint_strides=[], specialize_on=[], view_base_context=None, tensor_source=LocalSource(local_name='Q_bias', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_Q_bias_ L['Q_bias'] FakeTensor(..., device='cuda:0', size=(), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call add_ from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:922 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        q.add_(Q_bias)
        ~~~~~~^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:923 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k.add_(K_bias)
TRACE LOAD_FAST k []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST K_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
TRACE FX call add__1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:923 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        k.add_(K_bias)
        ~~~~~~^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:924 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            v.add_(V_bias)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST V_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
TRACE FX call add__2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:924 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        v.add_(V_bias)
        ~~~~~~^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:927 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q = q.view(B, T, H, N)  # [B,T,H,N]
TRACE LOAD_FAST q []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:927 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        q = q.view(B, T, H, N)  # [B,T,H,N]
            ~~~~~~^^^^^^^^^^^^
TRACE STORE_FAST q [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:928 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            kv_dim_flat = k.shape[-1]     # kv_heads * N
TRACE LOAD_FAST k []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE FX call size_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:928 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        kv_dim_flat = k.shape[-1]     # kv_heads * N
                      ^^^^^^^
TRACE LOAD_CONST -1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: -1)]
TRACE STORE_FAST kv_dim_flat [ConstantVariable(int: 1024)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:929 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            kv_heads = kv_dim_flat // N
TRACE LOAD_FAST kv_dim_flat []
TRACE LOAD_FAST N [ConstantVariable(int: 1024)]
TRACE BINARY_OP 2 [ConstantVariable(int: 1024), ConstantVariable(int: 128)]
TRACE STORE_FAST kv_heads [ConstantVariable(int: 8)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:930 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k = k.view(B, T, kv_heads, N) # [B,T,kv_h,N]
TRACE LOAD_FAST k []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_heads [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:930 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        k = k.view(B, T, kv_heads, N) # [B,T,kv_h,N]
            ~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:931 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            v = v.view(B, T, kv_heads, N)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_heads [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:931 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        v = v.view(B, T, kv_heads, N)
            ~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:934 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            if ln_r is not None:
TRACE LOAD_FAST ln_r []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 0 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
wrap_to_fake L['ln_r'] (128,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln_r', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln_r_ L['ln_r'] FakeTensor(..., device='cuda:0', size=(128,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE POP_JUMP_IF_TRUE 606 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:935 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
                q = T5RMSNorm(q, ln_r, rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln_r [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:935 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q = T5RMSNorm(q, ln_r, rmsnorm_epsilon)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x7f7c1d008ab0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x7f7c1d008ab0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST q [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:936 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
                k = T5RMSNorm(k, ln_k, rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln_k [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:936 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k = T5RMSNorm(k, ln_k, rmsnorm_epsilon)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x7f7c1d008ab0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln_k'] (128,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln_k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln_k_ L['ln_k'] FakeTensor(..., device='cuda:0', size=(128,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x7f7c1d008ab0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:940 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k_write = k.view(B, T, -1)
TRACE LOAD_FAST k []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: -1)]
TRACE FX call view_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:940 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        k_write = k.view(B, T, -1)
                  ~~~~~~^^^^^^^^^^
TRACE STORE_FAST k_write [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:941 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            v_write = v.view(B, T, -1)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: -1)]
TRACE FX call view_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:941 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        v_write = v.view(B, T, -1)
                  ~~~~~~^^^^^^^^^^
TRACE STORE_FAST v_write [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:944 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            new_lengths = starts + T
TRACE LOAD_FAST starts []
TRACE LOAD_FAST T [TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), SymNodeVariable()]
TRACE FX call add_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:944 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        new_lengths = starts + T
                      ~~~~~~~^~~
TRACE STORE_FAST new_lengths [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            excess_tokens = torch.clamp(new_lengths - Lmax, min=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR clamp [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST new_lengths [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST Lmax [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 10 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 8192)]
TRACE FX call sub from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        excess_tokens = torch.clamp(new_lengths - Lmax, min=0)
                                    ~~~~~~~~~~~~^~~~~~
TRACE LOAD_CONST 0 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE KW_NAMES ('min',) [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 0)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 0)]
TRACE FX call clamp from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        excess_tokens = torch.clamp(new_lengths - Lmax, min=0)
                        ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST excess_tokens [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:946 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            batches_to_evict = excess_tokens > 0
TRACE LOAD_FAST excess_tokens []
TRACE LOAD_CONST 0 [TensorVariable()]
TRACE COMPARE_OP > [TensorVariable(), ConstantVariable(int: 0)]
TRACE FX call gt from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:946 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        batches_to_evict = excess_tokens > 0
                           ^^^^^^^^^^^^^^^^^
TRACE STORE_FAST batches_to_evict [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            if bool(batches_to_evict.any()):
TRACE LOAD_GLOBAL bool []
TRACE LOAD_FAST batches_to_evict [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR any [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), any)]
TRACE FX call any_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        if bool(batches_to_evict.any()):
                ~~~~~~~~~~~~~~~~~~~~^^
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
COMPILING GRAPH due to GraphCompileReason(reason="Failed to trace builtin operator\n  Explanation: Dynamo does not know how to trace builtin operator `bool` with argument types ['Tensor'] (has_kwargs False)\n  Hint: Avoid calling builtin `bool` with argument types ['Tensor']. Consider using an equivalent alternative function/method to `bool`.\n  Hint: If you are attempting to call a logging function (e.g. `print`), you can try adding it to `torch._dynamo.config.reorderable_logging_functions`.\n  Hint: Please report an issue to PyTorch.\n\n  Developer debug context: builtin bool [<class 'torch._dynamo.variables.tensor.TensorVariable'>] False\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0059.html", user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py, line 949 in GQA_Attention_Flash_>], graph_break=True)
REMOVE UNUSED GRAPHARG L['past_key_value']
TRACED GRAPH
 ===== __compiled_fn_18_e9519f26_ce07_426c_b076_b2ae802b436d =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, s52: "Sym(s52)", L_x_in_: "[31mbf16[0m[34m[1, s52, 5120][0m[2m[34m[5120*s52, 5120, 1][0m[2m[32mcuda:0[0m", L_cache_position_: "[31mi64[0m[34m[1, 1][0m[2m[34m[1, 1][0m[2m[32mcuda:0[0m", L_ln1_: "[31mbf16[0m[34m[5120][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_QKV_parameters_scales_: "[31mf16[0m[34m[80, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m", L_QKV_parameters_zeros_: "[31mf16[0m[34m[80, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m", L_QKV_W_q: "[31mi32[0m[34m[640, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m", L_Q_bias_: "[31mbf16[0m[34m[][0m[2m[34m[][0m[2m[32mcuda:0[0m", L_ln_r_: "[31mbf16[0m[34m[128][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_ln_k_: "[31mbf16[0m[34m[128][0m[2m[34m[1][0m[2m[32mcuda:0[0m"):
        l_x_in_ = L_x_in_
        l_cache_position_ = L_cache_position_
        l_ln1_ = L_ln1_
        l_qkv_parameters_scales_ = L_QKV_parameters_scales_
        l_qkv_parameters_zeros_ = L_QKV_parameters_zeros_
        l_qkv_w_q = L_QKV_W_q
        l_q_bias_ = L_Q_bias_
        l_ln_r_ = L_ln_r_
        l_ln_k_ = L_ln_k_
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_, code: starts = cache_position[:, 0].clone()[0m
        getitem_3: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = l_cache_position_[(slice([34mNone[0m, [34mNone[0m, [34mNone[0m), [34m0[0m)];  [2ml_cache_position_ = None[0m
        starts: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = getitem_3.clone();  [2mgetitem_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:910 in GQA_Attention_Flash_, code: starts.clamp_(min=0, max=Lmax)[0m
        clamp_: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = starts.clamp_(min = [34m0[0m, max = [34m8192[0m);  [2mclamp_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states: "[31mf32[0m[34m[1, s52, 5120][0m[2m[34m[5120*s52, 5120, 1][0m[2m[32mcuda:0[0m" = l_x_in_.to([34mtorch.float32[0m);  [2ml_x_in_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_1: "[31mf32[0m[34m[1, s52, 5120][0m[2m[34m[5120*s52, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states.pow([34m2[0m)
        variance: "[31mf32[0m[34m[1, s52, 1][0m[2m[34m[s52, 1, 1][0m[2m[32mcuda:0[0m" = pow_1.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add: "[31mf32[0m[34m[1, s52, 1][0m[2m[34m[s52, 1, 1][0m[2m[32mcuda:0[0m" = variance + [34m1e-06[0m;  [2mvariance = None[0m
        rsqrt: "[31mf32[0m[34m[1, s52, 1][0m[2m[34m[s52, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add);  [2madd = None[0m
        hidden_states_1: "[31mf32[0m[34m[1, s52, 5120][0m[2m[34m[5120*s52, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states * rsqrt;  [2mhidden_states = rsqrt = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_1: "[31mf32[0m[34m[1, s52, 5120][0m[2m[34m[5120*s52, 5120, 1][0m[2m[32mcuda:0[0m" = l_ln1_ * hidden_states_1;  [2ml_ln1_ = hidden_states_1 = None[0m
        x: "[31mbf16[0m[34m[1, s52, 5120][0m[2m[34m[5120*s52, 5120, 1][0m[2m[32mcuda:0[0m" = mul_1.to([34mtorch.bfloat16[0m);  [2mmul_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul, code: x = x.to(dtype=torch.float16).view(-1,x.shape[2])[0m
        to_2: "[31mf16[0m[34m[1, s52, 5120][0m[2m[34m[5120*s52, 5120, 1][0m[2m[32mcuda:0[0m" = x.to(dtype = [34mtorch.float16[0m);  [2mx = None[0m
        x_1: "[31mf16[0m[34m[s52, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m" = to_2.view([34m-1[0m, [34m5120[0m);  [2mto_2 = None[0m
        
         [2m# File: /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__, code: return self._opoverload(*args, **kwargs)[0m
        forward_functional_default: "[31mf16[0m[34m[s52, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m" = torch.ops.gemlite.forward_functional.default(x_1, [34mNone[0m, [l_qkv_w_q, l_qkv_parameters_scales_, l_qkv_parameters_zeros_], [[34m0[0m, [34m4[0m, [34m64[0m, [34m15[0m, [34m8[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m0[0m, [34m4[0m, [34m1[0m], [34m4[0m);  [2mx_1 = l_qkv_w_q = l_qkv_parameters_scales_ = l_qkv_parameters_zeros_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul, code: out = weight.forward_manual(x).to(dtype=dtype)[0m
        out: "[31mbf16[0m[34m[s52, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m" = forward_functional_default.to(dtype = [34mtorch.bfloat16[0m);  [2mforward_functional_default = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul, code: return out.view(S0,S1,-1)[0m
        qkv: "[31mbf16[0m[34m[1, s52, 10240][0m[2m[34m[10240*s52, 10240, 1][0m[2m[32mcuda:0[0m" = out.view([34m1[0m, s52, [34m-1[0m);  [2mout = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:919 in GQA_Attention_Flash_, code: q, k, v = qkv.split(qkv_split_list, dim=-1)[0m
        split = qkv.split([[34m8192[0m, [34m1024[0m, [34m1024[0m], dim = [34m-1[0m);  [2mqkv = None[0m
        q: "[31mbf16[0m[34m[1, s52, 8192][0m[2m[34m[10240*s52, 10240, 1][0m[2m[32mcuda:0[0m" = split[[34m0[0m]
        k: "[31mbf16[0m[34m[1, s52, 1024][0m[2m[34m[10240*s52, 10240, 1][0m[2m[32mcuda:0[0m" = split[[34m1[0m]
        v: "[31mbf16[0m[34m[1, s52, 1024][0m[2m[34m[10240*s52, 10240, 1][0m[2m[32mcuda:0[0m" = split[[34m2[0m];  [2msplit = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:922 in GQA_Attention_Flash_, code: q.add_(Q_bias)[0m
        add_: "[31mbf16[0m[34m[1, s52, 8192][0m[2m[34m[10240*s52, 10240, 1][0m[2m[32mcuda:0[0m" = q.add_(l_q_bias_);  [2madd_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:923 in GQA_Attention_Flash_, code: k.add_(K_bias)[0m
        add__1: "[31mbf16[0m[34m[1, s52, 1024][0m[2m[34m[10240*s52, 10240, 1][0m[2m[32mcuda:0[0m" = k.add_(l_q_bias_);  [2madd__1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:924 in GQA_Attention_Flash_, code: v.add_(V_bias)[0m
        add__2: "[31mbf16[0m[34m[1, s52, 1024][0m[2m[34m[10240*s52, 10240, 1][0m[2m[32mcuda:0[0m" = v.add_(l_q_bias_);  [2ml_q_bias_ = add__2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:927 in GQA_Attention_Flash_, code: q = q.view(B, T, H, N)  # [B,T,H,N][0m
        q_1: "[31mbf16[0m[34m[1, s52, 64, 128][0m[2m[34m[10240*s52, 10240, 128, 1][0m[2m[32mcuda:0[0m" = q.view([34m1[0m, s52, [34m64[0m, [34m128[0m);  [2mq = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:930 in GQA_Attention_Flash_, code: k = k.view(B, T, kv_heads, N) # [B,T,kv_h,N][0m
        k_1: "[31mbf16[0m[34m[1, s52, 8, 128][0m[2m[34m[10240*s52, 10240, 128, 1][0m[2m[32mcuda:0[0m" = k.view([34m1[0m, s52, [34m8[0m, [34m128[0m);  [2mk = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:931 in GQA_Attention_Flash_, code: v = v.view(B, T, kv_heads, N)[0m
        v_1: "[31mbf16[0m[34m[1, s52, 8, 128][0m[2m[34m[10240*s52, 10240, 128, 1][0m[2m[32mcuda:0[0m" = v.view([34m1[0m, s52, [34m8[0m, [34m128[0m);  [2mv = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states_2: "[31mf32[0m[34m[1, s52, 64, 128][0m[2m[34m[8192*s52, 8192, 128, 1][0m[2m[32mcuda:0[0m" = q_1.to([34mtorch.float32[0m);  [2mq_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_2: "[31mf32[0m[34m[1, s52, 64, 128][0m[2m[34m[8192*s52, 8192, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_2.pow([34m2[0m)
        variance_1: "[31mf32[0m[34m[1, s52, 64, 1][0m[2m[34m[64*s52, 64, 1, 1][0m[2m[32mcuda:0[0m" = pow_2.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add_1: "[31mf32[0m[34m[1, s52, 64, 1][0m[2m[34m[64*s52, 64, 1, 1][0m[2m[32mcuda:0[0m" = variance_1 + [34m1e-06[0m;  [2mvariance_1 = None[0m
        rsqrt_1: "[31mf32[0m[34m[1, s52, 64, 1][0m[2m[34m[64*s52, 64, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add_1);  [2madd_1 = None[0m
        hidden_states_3: "[31mf32[0m[34m[1, s52, 64, 128][0m[2m[34m[8192*s52, 8192, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_2 * rsqrt_1;  [2mhidden_states_2 = rsqrt_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_3: "[31mf32[0m[34m[1, s52, 64, 128][0m[2m[34m[8192*s52, 8192, 128, 1][0m[2m[32mcuda:0[0m" = l_ln_r_ * hidden_states_3;  [2ml_ln_r_ = hidden_states_3 = None[0m
        q_2: "[31mbf16[0m[34m[1, s52, 64, 128][0m[2m[34m[8192*s52, 8192, 128, 1][0m[2m[32mcuda:0[0m" = mul_3.to([34mtorch.bfloat16[0m);  [2mmul_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states_4: "[31mf32[0m[34m[1, s52, 8, 128][0m[2m[34m[1024*s52, 1024, 128, 1][0m[2m[32mcuda:0[0m" = k_1.to([34mtorch.float32[0m);  [2mk_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_3: "[31mf32[0m[34m[1, s52, 8, 128][0m[2m[34m[1024*s52, 1024, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_4.pow([34m2[0m)
        variance_2: "[31mf32[0m[34m[1, s52, 8, 1][0m[2m[34m[8*s52, 8, 1, 1][0m[2m[32mcuda:0[0m" = pow_3.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add_2: "[31mf32[0m[34m[1, s52, 8, 1][0m[2m[34m[8*s52, 8, 1, 1][0m[2m[32mcuda:0[0m" = variance_2 + [34m1e-06[0m;  [2mvariance_2 = None[0m
        rsqrt_2: "[31mf32[0m[34m[1, s52, 8, 1][0m[2m[34m[8*s52, 8, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add_2);  [2madd_2 = None[0m
        hidden_states_5: "[31mf32[0m[34m[1, s52, 8, 128][0m[2m[34m[1024*s52, 1024, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_4 * rsqrt_2;  [2mhidden_states_4 = rsqrt_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_5: "[31mf32[0m[34m[1, s52, 8, 128][0m[2m[34m[1024*s52, 1024, 128, 1][0m[2m[32mcuda:0[0m" = l_ln_k_ * hidden_states_5;  [2ml_ln_k_ = hidden_states_5 = None[0m
        k_2: "[31mbf16[0m[34m[1, s52, 8, 128][0m[2m[34m[1024*s52, 1024, 128, 1][0m[2m[32mcuda:0[0m" = mul_5.to([34mtorch.bfloat16[0m);  [2mmul_5 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:940 in GQA_Attention_Flash_, code: k_write = k.view(B, T, -1)[0m
        k_write: "[31mbf16[0m[34m[1, s52, 1024][0m[2m[34m[1024*s52, 1024, 1][0m[2m[32mcuda:0[0m" = k_2.view([34m1[0m, s52, [34m-1[0m)
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:941 in GQA_Attention_Flash_, code: v_write = v.view(B, T, -1)[0m
        v_write: "[31mbf16[0m[34m[1, s52, 1024][0m[2m[34m[10240*s52, 10240, 1][0m[2m[32mcuda:0[0m" = v_1.view([34m1[0m, s52, [34m-1[0m)
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:944 in GQA_Attention_Flash_, code: new_lengths = starts + T[0m
        new_lengths: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = starts + s52
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_, code: excess_tokens = torch.clamp(new_lengths - Lmax, min=0)[0m
        sub: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = new_lengths - [34m8192[0m;  [2mnew_lengths = None[0m
        excess_tokens: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = torch.clamp(sub, min = [34m0[0m);  [2msub = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:946 in GQA_Attention_Flash_, code: batches_to_evict = excess_tokens > 0[0m
        batches_to_evict: "[31mb8[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = excess_tokens > [34m0[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949 in GQA_Attention_Flash_, code: if bool(batches_to_evict.any()):[0m
        any_1: "[31mb8[0m[34m[][0m[2m[34m[][0m[2m[32mcuda:0[0m" = batches_to_evict.any()
        return (any_1, s52, starts, q_2, k_2, v_1, k_write, v_write, excess_tokens, batches_to_evict)
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing forward /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:831
TRACE MAKE_CELL max_seqlens_q []
TRACE MAKE_CELL batch []
TRACE MAKE_CELL nheads_q []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:831 in forward (_attention)
        @staticmethod
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:848 in forward (_attention.forward)
            use_fp8 = False
TRACE LOAD_CONST False []
TRACE STORE_FAST use_fp8 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:849 in forward (_attention.forward)
            fp8_out_scale=None
TRACE LOAD_CONST None []
TRACE STORE_FAST fp8_out_scale [ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:850 in forward (_attention.forward)
            fp8_scales=None
TRACE LOAD_CONST None []
TRACE STORE_FAST fp8_scales [ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:851 in forward (_attention.forward)
            q_scale = k_scale = v_scale = p_scale = 1.0
TRACE LOAD_CONST 1.0 []
TRACE COPY 1 [ConstantVariable(float: 1.0)]
TRACE STORE_FAST q_scale [ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE COPY 1 [ConstantVariable(float: 1.0)]
TRACE STORE_FAST k_scale [ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE COPY 1 [ConstantVariable(float: 1.0)]
TRACE STORE_FAST v_scale [ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE STORE_FAST p_scale [ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:853 in forward (_attention.forward)
            if o is None:
TRACE LOAD_FAST o []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
automatic dynamic size L['o'] size(0) 128 != 512
wrap_to_fake L['o'] (128, 64, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='o', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_o_ L['o'] FakeTensor(..., device='cuda:0', size=(s45, 64, 128), dtype=torch.bfloat16) at debug_level 0 before=False
create_graph_input s45 L['o'].size()[0] s45 at debug_level 0 before=True
_lift_symbols_in_symint s45 from L['o'].size()[0] at debug_level 0
TRACE POP_JUMP_IF_TRUE 110 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:865 in forward (_attention.forward)
            if True:  # varlen
TRACE NOP None []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:866 in forward (_attention.forward)
                total_q, nheads_q, head_size = q.shape
TRACE LOAD_FAST q []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
automatic dynamic size L['q']._base size(1) 128 != 512
automatic dynamic size L['q'] size(0) 128 != 512
wrap_to_fake L['q'] (128, 64, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None, None], specialize_on=[[], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='q', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}), tensor_source=LocalSource(local_name='q', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_q_ L['q'] FakeTensor(..., device='cuda:0', size=(s85, 64, 128), dtype=torch.bfloat16) at debug_level 0 before=False
create_graph_input s85 L['q'].size()[0] s85 at debug_level 0 before=True
_lift_symbols_in_symint s85 from L['q'].size()[0] at debug_level 0
wrap_to_fake L['q']._base (1, 128, 64, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None, None], specialize_on=[[], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='q', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
TRACE FX call size from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:866 in forward (_attention.forward)
            total_q, nheads_q, head_size = q.shape
                                           ^^^^^^^
TRACE UNPACK_SEQUENCE 3 [SizeVariable(length=3)]
TRACE STORE_FAST total_q [ConstantVariable(int: 128), ConstantVariable(int: 64), SymNodeVariable()]
TRACE STORE_DEREF nheads_q [ConstantVariable(int: 128), ConstantVariable(int: 64)]
TRACE STORE_FAST head_size [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:867 in forward (_attention.forward)
                total_k, nheads_k, _ = k.shape
TRACE LOAD_FAST k []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
wrap_to_fake L['k'] (1152, 8, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_k_ L['k'] FakeTensor(..., device='cuda:0', size=(s37, 8, 128), dtype=torch.bfloat16) at debug_level 0 before=False
create_graph_input s37 L['k'].size()[0] s37 at debug_level 0 before=True
_lift_symbols_in_symint s37 from L['k'].size()[0] at debug_level 0
TRACE FX call size_1 from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:867 in forward (_attention.forward)
            total_k, nheads_k, _ = k.shape
                                   ^^^^^^^
TRACE UNPACK_SEQUENCE 3 [SizeVariable(length=3)]
TRACE STORE_FAST total_k [ConstantVariable(int: 128), ConstantVariable(int: 8), SymNodeVariable()]
TRACE STORE_FAST nheads_k [ConstantVariable(int: 128), ConstantVariable(int: 8)]
TRACE STORE_FAST _ [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:868 in forward (_attention.forward)
                batch = len(cu_seqlens_q) - 1
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST cu_seqlens_q [NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
wrap_to_fake L['cu_seqlens_q'] (2,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='cu_seqlens_q', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_cu_seqlens_q_ L['cu_seqlens_q'] FakeTensor(..., device='cuda:0', size=(2,), dtype=torch.int32) at debug_level 0 before=False
TRACE LOAD_CONST 1 [ConstantVariable(int: 2)]
TRACE BINARY_OP 10 [ConstantVariable(int: 2), ConstantVariable(int: 1)]
TRACE STORE_DEREF batch [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:869 in forward (_attention.forward)
                q_strides = (0, q.stride(1), q.stride(0), q.stride(2))
TRACE LOAD_CONST 0 []
TRACE LOAD_FAST q [ConstantVariable(int: 0)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), TensorVariable()]
TRACE LOAD_CONST 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 1)]
TRACE LOAD_FAST q [ConstantVariable(int: 0), ConstantVariable(int: 128)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 0)]
TRACE LOAD_FAST q [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), TensorVariable()]
TRACE LOAD_CONST 2 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 2)]
TRACE BUILD_TUPLE 4 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), ConstantVariable(int: 1)]
TRACE STORE_FAST q_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:870 in forward (_attention.forward)
                k_strides = (0, k.stride(1), k.stride(0), k.stride(2))
TRACE LOAD_CONST 0 []
TRACE LOAD_FAST k [ConstantVariable(int: 0)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), TensorVariable()]
TRACE LOAD_CONST 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 1)]
TRACE LOAD_FAST k [ConstantVariable(int: 0), ConstantVariable(int: 128)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 0)]
TRACE LOAD_FAST k [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), TensorVariable()]
TRACE LOAD_CONST 2 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 2)]
TRACE BUILD_TUPLE 4 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), ConstantVariable(int: 1)]
TRACE STORE_FAST k_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:871 in forward (_attention.forward)
                v_strides = (0, v.stride(1), v.stride(0), v.stride(2))
TRACE LOAD_CONST 0 []
TRACE LOAD_FAST v [ConstantVariable(int: 0)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), LazyVariableTracker()]
wrap_to_fake L['v'] (1152, 8, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='v', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_v_ L['v'] FakeTensor(..., device='cuda:0', size=(s33, 8, 128), dtype=torch.bfloat16) at debug_level 0 before=False
create_graph_input s33 L['v'].size()[0] s33 at debug_level 0 before=True
_lift_symbols_in_symint s33 from L['v'].size()[0] at debug_level 0
TRACE LOAD_CONST 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 1)]
TRACE LOAD_FAST v [ConstantVariable(int: 0), ConstantVariable(int: 128)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 0)]
TRACE LOAD_FAST v [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), TensorVariable()]
TRACE LOAD_CONST 2 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 2)]
TRACE BUILD_TUPLE 4 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), ConstantVariable(int: 1)]
TRACE STORE_FAST v_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:872 in forward (_attention.forward)
                o_strides = (0, o.stride(1), o.stride(0), o.stride(2))
TRACE LOAD_CONST 0 []
TRACE LOAD_FAST o [ConstantVariable(int: 0)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), TensorVariable()]
TRACE LOAD_CONST 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 1)]
TRACE LOAD_FAST o [ConstantVariable(int: 0), ConstantVariable(int: 128)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 0)]
TRACE LOAD_FAST o [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), TensorVariable()]
TRACE LOAD_CONST 2 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 2)]
TRACE BUILD_TUPLE 4 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), ConstantVariable(int: 1)]
TRACE STORE_FAST o_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:882 in forward (_attention.forward)
            unpadded_head_dims = {32, 64, 128, 256}
TRACE BUILD_SET 0 []
TRACE LOAD_CONST frozenset({256, 32, 64, 128}) [SetVariable()]
TRACE SET_UPDATE 1 [SetVariable(), FrozensetVariable()]
TRACE inlined call set_update from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:882 in forward (_attention.forward)
        unpadded_head_dims = {32, 64, 128, 256}
                             ^^^^^^^^^^^^^^^^^^
INLINING <code object set_update at 0x7f7c332be630, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 210>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:210 in set_update (set_update) (inline depth: 1)
    def set_update(set1, *others):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:211 in set_update (set_update) (inline depth: 1)
        if len(others) == 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST others [NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=1)]
TRACE LOAD_CONST 0 [ConstantVariable(int: 1)]
TRACE COMPARE_OP == [ConstantVariable(int: 1), ConstantVariable(int: 0)]
TRACE POP_JUMP_IF_FALSE 34 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:214 in set_update (set_update) (inline depth: 1)
        for set2 in others:
TRACE LOAD_FAST others []
TRACE GET_ITER None [TupleVariable(length=1)]
TRACE FOR_ITER 104 [ListIteratorVariable(length=1, index=0)]
TRACE STORE_FAST set2 [ListIteratorVariable(length=1, index=1), FrozensetVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE LOAD_FAST set2 [ListIteratorVariable(length=1, index=1)]
TRACE GET_ITER None [ListIteratorVariable(length=1, index=1), FrozensetVariable()]
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=0)]
TRACE STORE_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(int: 256)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:216 in set_update (set_update) (inline depth: 1)
                if x not in set1:
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1)]
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(int: 256)]
TRACE CONTAINS_OP 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(int: 256), SetVariable()]
TRACE POP_JUMP_IF_TRUE 64 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:217 in set_update (set_update) (inline depth: 1)
                    set1.add(x)
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1)]
TRACE LOAD_ATTR add [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), SetVariable()]
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), NullVariable, GetAttrVariable(SetVariable(), add)]
TRACE CALL 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), NullVariable, GetAttrVariable(SetVariable(), add), ConstantVariable(int: 256)]
TRACE POP_TOP None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 48 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1)]
TRACE STORE_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(int: 32)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:216 in set_update (set_update) (inline depth: 1)
                if x not in set1:
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2)]
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(int: 32)]
TRACE CONTAINS_OP 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(int: 32), SetVariable()]
TRACE POP_JUMP_IF_TRUE 64 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:217 in set_update (set_update) (inline depth: 1)
                    set1.add(x)
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2)]
TRACE LOAD_ATTR add [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), SetVariable()]
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), NullVariable, GetAttrVariable(SetVariable(), add)]
TRACE CALL 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), NullVariable, GetAttrVariable(SetVariable(), add), ConstantVariable(int: 32)]
TRACE POP_TOP None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 48 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2)]
TRACE STORE_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(int: 64)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:216 in set_update (set_update) (inline depth: 1)
                if x not in set1:
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3)]
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(int: 64)]
TRACE CONTAINS_OP 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(int: 64), SetVariable()]
TRACE POP_JUMP_IF_TRUE 64 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:217 in set_update (set_update) (inline depth: 1)
                    set1.add(x)
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3)]
TRACE LOAD_ATTR add [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), SetVariable()]
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), NullVariable, GetAttrVariable(SetVariable(), add)]
TRACE CALL 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), NullVariable, GetAttrVariable(SetVariable(), add), ConstantVariable(int: 64)]
TRACE POP_TOP None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 48 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3)]
TRACE STORE_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(int: 128)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:216 in set_update (set_update) (inline depth: 1)
                if x not in set1:
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4)]
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(int: 128)]
TRACE CONTAINS_OP 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(int: 128), SetVariable()]
TRACE POP_JUMP_IF_TRUE 64 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:217 in set_update (set_update) (inline depth: 1)
                    set1.add(x)
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4)]
TRACE LOAD_ATTR add [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), SetVariable()]
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), NullVariable, GetAttrVariable(SetVariable(), add)]
TRACE CALL 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), NullVariable, GetAttrVariable(SetVariable(), add), ConstantVariable(int: 128)]
TRACE POP_TOP None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 48 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4)]
TRACE END_FOR None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 38 [ListIteratorVariable(length=1, index=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:214 in set_update (set_update) (inline depth: 1)
        for set2 in others:
TRACE FOR_ITER 104 [ListIteratorVariable(length=1, index=1)]
TRACE END_FOR None [ListIteratorVariable(length=1, index=1), ConstantVariable(NoneType: None)]
TRACE RETURN_CONST None []
DONE INLINING <code object set_update at 0x7f7c332be630, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 210>
TRACE STORE_FAST unpadded_head_dims [SetVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:883 in forward (_attention.forward)
            if head_size not in unpadded_head_dims:
TRACE LOAD_FAST head_size []
TRACE LOAD_FAST unpadded_head_dims [ConstantVariable(int: 128)]
TRACE CONTAINS_OP 1 [ConstantVariable(int: 128), SetVariable()]
TRACE POP_JUMP_IF_FALSE 676 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:891 in forward (_attention.forward)
                padded_d_model = head_size
TRACE LOAD_FAST head_size []
TRACE STORE_FAST padded_d_model [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in forward (_attention.forward)
            grid = lambda META: (
TRACE LOAD_CLOSURE batch []
TRACE LOAD_CLOSURE max_seqlens_q [CellVariable()]
TRACE LOAD_CLOSURE nheads_q [CellVariable(), CellVariable()]
TRACE BUILD_TUPLE 3 [CellVariable(), CellVariable(), CellVariable()]
TRACE LOAD_CONST <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893> [TupleVariable(length=3)]
TRACE MAKE_FUNCTION 8 [TupleVariable(length=3), ConstantVariable(code: <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>)]
TRACE STORE_FAST grid [NestedUserFunctionVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:899 in forward (_attention.forward)
            encoded_softmax = None
TRACE LOAD_CONST None []
TRACE STORE_FAST encoded_softmax [ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:902 in forward (_attention.forward)
            philox_seed = 0x1BF52
TRACE LOAD_CONST 114514 []
TRACE STORE_FAST philox_seed [ConstantVariable(int: 114514)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:903 in forward (_attention.forward)
            philox_offset = 0x1D4B42
TRACE LOAD_CONST 1919810 []
TRACE STORE_FAST philox_offset [ConstantVariable(int: 1919810)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:905 in forward (_attention.forward)
            if bias is not None:
TRACE LOAD_FAST bias []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 0 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 848 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:913 in forward (_attention.forward)
                bias_strides = (0, 0, 0, 0)
TRACE LOAD_CONST (0, 0, 0, 0) []
TRACE STORE_FAST bias_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:915 in forward (_attention.forward)
            p_descale = 1.0 / p_scale
TRACE LOAD_CONST 1.0 []
TRACE LOAD_FAST p_scale [ConstantVariable(float: 1.0)]
TRACE BINARY_OP 11 [ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE STORE_FAST p_descale [ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:917 in forward (_attention.forward)
            ) if fp8_out_scale is not None else 1.0
TRACE LOAD_FAST fp8_out_scale []
TRACE LOAD_CONST None [ConstantVariable(NoneType: None)]
TRACE IS_OP 0 [ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 908 [ConstantVariable(bool: True)]
TRACE LOAD_CONST 1.0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:916 in forward (_attention.forward)
            o_descale = 1.0 / fp8_out_scale.item(
TRACE STORE_FAST o_descale [ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:919 in forward (_attention.forward)
            arg_max_seqlens_q = 0 if on_gfx1x() else max_seqlens_q
TRACE LOAD_GLOBAL on_gfx1x []
TRACE CALL 0 [NullVariable, LazyVariableTracker()]
TRACE inlined call on_gfx1x from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:919 in forward (_attention.forward)
        arg_max_seqlens_q = 0 if on_gfx1x() else max_seqlens_q
                                 ~~~~~~~~^^
INLINING <code object on_gfx1x at 0x7f7c1d0ccd30, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 35>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:35 in on_gfx1x (on_gfx1x) (inline depth: 1)
    def on_gfx1x():
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:36 in on_gfx1x (on_gfx1x) (inline depth: 1)
        return True
TRACE RETURN_CONST True []
DONE INLINING <code object on_gfx1x at 0x7f7c1d0ccd30, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 35>
TRACE POP_JUMP_IF_FALSE 936 [ConstantVariable(bool: True)]
TRACE LOAD_CONST 0 []
TRACE JUMP_FORWARD 938 [ConstantVariable(int: 0)]
TRACE STORE_FAST arg_max_seqlens_q [ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:920 in forward (_attention.forward)
            arg_max_seqlens_k = 0 if on_gfx1x() else max_seqlens_k
TRACE LOAD_GLOBAL on_gfx1x []
TRACE CALL 0 [NullVariable, LazyVariableTracker()]
TRACE inlined call on_gfx1x from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:920 in forward (_attention.forward)
        arg_max_seqlens_k = 0 if on_gfx1x() else max_seqlens_k
                                 ~~~~~~~~^^
INLINING <code object on_gfx1x at 0x7f7c1d0ccd30, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 35>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:35 in on_gfx1x (on_gfx1x) (inline depth: 1)
    def on_gfx1x():
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:36 in on_gfx1x (on_gfx1x) (inline depth: 1)
        return True
TRACE RETURN_CONST True []
DONE INLINING <code object on_gfx1x at 0x7f7c1d0ccd30, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 35>
TRACE POP_JUMP_IF_FALSE 964 [ConstantVariable(bool: True)]
TRACE LOAD_CONST 0 []
TRACE JUMP_FORWARD 966 [ConstantVariable(int: 0)]
TRACE STORE_FAST arg_max_seqlens_k [ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_GLOBAL attn_fwd []
TRACE LOAD_FAST grid [NullVariable, LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), NestedUserFunctionVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:923 in forward (_attention.forward)
                q,
TRACE LOAD_FAST q [NullVariable, TritonKernelVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:924 in forward (_attention.forward)
                k,
TRACE LOAD_FAST k [NullVariable, TritonKernelVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:925 in forward (_attention.forward)
                v,
TRACE LOAD_FAST v [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:926 in forward (_attention.forward)
                bias,
TRACE LOAD_FAST bias [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:927 in forward (_attention.forward)
                sm_scale,
TRACE LOAD_FAST sm_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:928 in forward (_attention.forward)
                q_scale,
TRACE LOAD_FAST q_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:929 in forward (_attention.forward)
                k_scale,
TRACE LOAD_FAST k_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:930 in forward (_attention.forward)
                v_scale,
TRACE LOAD_FAST v_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:931 in forward (_attention.forward)
                p_scale,
TRACE LOAD_FAST p_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:932 in forward (_attention.forward)
                p_descale,
TRACE LOAD_FAST p_descale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:933 in forward (_attention.forward)
                o_descale,
TRACE LOAD_FAST o_descale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:934 in forward (_attention.forward)
                None,
TRACE LOAD_CONST None [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:935 in forward (_attention.forward)
                o,
TRACE LOAD_FAST o [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE BUILD_LIST 13 [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(NoneType: None), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:936 in forward (_attention.forward)
                *q_strides,
TRACE LOAD_FAST q_strides [NullVariable, TritonKernelVariable(), ListVariable(length=13)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=13), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:937 in forward (_attention.forward)
                *k_strides,
TRACE LOAD_FAST k_strides [NullVariable, TritonKernelVariable(), ListVariable(length=17)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=17), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:938 in forward (_attention.forward)
                *v_strides,
TRACE LOAD_FAST v_strides [NullVariable, TritonKernelVariable(), ListVariable(length=21)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=21), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:939 in forward (_attention.forward)
                *o_strides,
TRACE LOAD_FAST o_strides [NullVariable, TritonKernelVariable(), ListVariable(length=25)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=25), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:940 in forward (_attention.forward)
                *bias_strides,
TRACE LOAD_FAST bias_strides [NullVariable, TritonKernelVariable(), ListVariable(length=29)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=29), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:941 in forward (_attention.forward)
                cu_seqlens_q,
TRACE LOAD_FAST cu_seqlens_q [NullVariable, TritonKernelVariable(), ListVariable(length=33)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_APPEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=33), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:942 in forward (_attention.forward)
                cu_seqlens_k,
TRACE LOAD_FAST cu_seqlens_k [NullVariable, TritonKernelVariable(), ListVariable(length=34)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_APPEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=34), LazyVariableTracker()]
TRACE CALL_INTRINSIC_1 6 [NullVariable, TritonKernelVariable(), ListVariable(length=35)]
TRACE BUILD_MAP 0 [NullVariable, TritonKernelVariable(), TupleVariable(length=35)]
TRACE LOAD_CONST dropout_p [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:943 in forward (_attention.forward)
                dropout_p=0.0,
TRACE LOAD_CONST 0.0 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'dropout_p')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'dropout_p'), ConstantVariable(float: 0.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST philox_seed [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:944 in forward (_attention.forward)
                philox_seed=philox_seed,
TRACE LOAD_FAST philox_seed [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'philox_seed')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'philox_seed'), ConstantVariable(int: 114514)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST philox_offset_base [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:945 in forward (_attention.forward)
                philox_offset_base=philox_offset,
TRACE LOAD_FAST philox_offset [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'philox_offset_base')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'philox_offset_base'), ConstantVariable(int: 1919810)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST encoded_softmax [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:946 in forward (_attention.forward)
                encoded_softmax=encoded_softmax,
TRACE LOAD_FAST encoded_softmax [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'encoded_softmax')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'encoded_softmax'), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST HQ [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:947 in forward (_attention.forward)
                HQ=nheads_q,
TRACE LOAD_DEREF nheads_q [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'HQ')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'HQ'), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST HK [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:948 in forward (_attention.forward)
                HK=nheads_k,
TRACE LOAD_FAST nheads_k [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'HK')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'HK'), ConstantVariable(int: 8)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST ACTUAL_BLOCK_DMODEL [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:949 in forward (_attention.forward)
                ACTUAL_BLOCK_DMODEL=head_size,
TRACE LOAD_FAST head_size [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'ACTUAL_BLOCK_DMODEL')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'ACTUAL_BLOCK_DMODEL'), ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST MAX_SEQLENS_Q [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:950 in forward (_attention.forward)
                MAX_SEQLENS_Q=arg_max_seqlens_q,
TRACE LOAD_FAST arg_max_seqlens_q [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'MAX_SEQLENS_Q')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'MAX_SEQLENS_Q'), ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST MAX_SEQLENS_K [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:951 in forward (_attention.forward)
                MAX_SEQLENS_K=arg_max_seqlens_k,
TRACE LOAD_FAST arg_max_seqlens_k [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'MAX_SEQLENS_K')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'MAX_SEQLENS_K'), ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST IS_CAUSAL [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:952 in forward (_attention.forward)
                IS_CAUSAL=causal,
TRACE LOAD_FAST causal [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'IS_CAUSAL')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'IS_CAUSAL'), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST VARLEN [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:953 in forward (_attention.forward)
                VARLEN=True,
TRACE LOAD_CONST True [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'VARLEN')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'VARLEN'), ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST BLOCK_DMODEL [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:954 in forward (_attention.forward)
                BLOCK_DMODEL=padded_d_model,
TRACE LOAD_FAST padded_d_model [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BLOCK_DMODEL')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BLOCK_DMODEL'), ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST BIAS_TYPE [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:955 in forward (_attention.forward)
                BIAS_TYPE=0 if bias is None else 1,
TRACE LOAD_FAST bias [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE')]
TRACE LOAD_CONST None [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(NoneType: None)]
TRACE IS_OP 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 1130 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(bool: False)]
TRACE LOAD_CONST 0 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE')]
TRACE JUMP_FORWARD 1132 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(int: 0)]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST ENABLE_DROPOUT [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:956 in forward (_attention.forward)
                ENABLE_DROPOUT=False,
TRACE LOAD_CONST False [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'ENABLE_DROPOUT')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'ENABLE_DROPOUT'), ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST RETURN_ENCODED_SOFTMAX [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:957 in forward (_attention.forward)
                RETURN_ENCODED_SOFTMAX=False,
TRACE LOAD_CONST False [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'RETURN_ENCODED_SOFTMAX')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'RETURN_ENCODED_SOFTMAX'), ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST USE_FP8 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:958 in forward (_attention.forward)
                USE_FP8=use_fp8,
TRACE LOAD_FAST use_fp8 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8'), ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST USE_FP8_OUT [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:959 in forward (_attention.forward)
                USE_FP8_OUT=fp8_out_scale is not None,
TRACE LOAD_FAST fp8_out_scale [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8_OUT')]
TRACE LOAD_CONST None [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8_OUT'), ConstantVariable(NoneType: None)]
TRACE IS_OP 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8_OUT'), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8_OUT'), ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE CALL_FUNCTION_EX 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE inlined call <lambda> from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
                triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF max_seqlens_q [NullVariable, LazyVariableTracker()]
automatic dynamic int L['max_seqlens_q'] val 128 != 512
create_graph_input L_max_seqlens_q_ L['max_seqlens_q'] s30 at debug_level 0 before=False
TRACE LOAD_FAST META [NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE LOAD_CONST BLOCK_M [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstDictVariable(), ConstantVariable(str: 'BLOCK_M')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
            triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
            ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x7f7c3c064990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), SymNodeVariable()]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), SymNodeVariable()]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x7f7c3c0d01f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 3)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [SymNodeVariable()]
TRACE BINARY_OP 0 [SymNodeVariable(), ConstantVariable(int: 32)]
TRACE FX call add from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
            ~~^~~
TRACE LOAD_CONST 1 [SymNodeVariable()]
TRACE BINARY_OP 10 [SymNodeVariable(), ConstantVariable(int: 1)]
TRACE FX call sub from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
            ~~~~~~^~~
TRACE LOAD_FAST y [SymNodeVariable()]
TRACE BINARY_OP 2 [SymNodeVariable(), ConstantVariable(int: 32)]
TRACE FX call floordiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
           ~~~~~~~~~~~~^^~~
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object cdiv at 0x7f7c3c0d01f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [SymNodeVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object __call__ at 0x7f7c3c064990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:895 in <lambda> (_attention.forward) (inline depth: 1)
                nheads_q,
TRACE LOAD_DEREF nheads_q [SymNodeVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:896 in <lambda> (_attention.forward) (inline depth: 1)
                batch,
TRACE LOAD_DEREF batch [SymNodeVariable(), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE BUILD_TUPLE 3 [SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [TupleVariable(length=3)]
DONE INLINING <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>
TRACE inlined call <lambda> from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
                triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF max_seqlens_q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST META [NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE LOAD_CONST BLOCK_M [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstDictVariable(), ConstantVariable(str: 'BLOCK_M')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
            triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
            ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x7f7c3c064990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), SymNodeVariable()]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), SymNodeVariable()]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x7f7c3c0d01f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 3)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [SymNodeVariable()]
TRACE BINARY_OP 0 [SymNodeVariable(), ConstantVariable(int: 32)]
TRACE FX call add_1 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
            ~~^~~
TRACE LOAD_CONST 1 [SymNodeVariable()]
TRACE BINARY_OP 10 [SymNodeVariable(), ConstantVariable(int: 1)]
TRACE FX call sub_1 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
            ~~~~~~^~~
TRACE LOAD_FAST y [SymNodeVariable()]
TRACE BINARY_OP 2 [SymNodeVariable(), ConstantVariable(int: 32)]
TRACE FX call floordiv_1 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
           ~~~~~~~~~~~~^^~~
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object cdiv at 0x7f7c3c0d01f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [SymNodeVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object __call__ at 0x7f7c3c064990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:895 in <lambda> (_attention.forward) (inline depth: 1)
                nheads_q,
TRACE LOAD_DEREF nheads_q [SymNodeVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:896 in <lambda> (_attention.forward) (inline depth: 1)
                batch,
TRACE LOAD_DEREF batch [SymNodeVariable(), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE BUILD_TUPLE 3 [SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [TupleVariable(length=3)]
DONE INLINING <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>
TRACE inlined call <lambda> from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
                triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF max_seqlens_q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST META [NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE LOAD_CONST BLOCK_M [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstDictVariable(), ConstantVariable(str: 'BLOCK_M')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
            triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
            ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x7f7c3c064990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), SymNodeVariable()]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), SymNodeVariable()]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x7f7c3c0d01f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 3)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [SymNodeVariable()]
TRACE BINARY_OP 0 [SymNodeVariable(), ConstantVariable(int: 32)]
TRACE FX call add_2 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
            ~~^~~
TRACE LOAD_CONST 1 [SymNodeVariable()]
TRACE BINARY_OP 10 [SymNodeVariable(), ConstantVariable(int: 1)]
TRACE FX call sub_2 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
            ~~~~~~^~~
TRACE LOAD_FAST y [SymNodeVariable()]
TRACE BINARY_OP 2 [SymNodeVariable(), ConstantVariable(int: 32)]
TRACE FX call floordiv_2 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
           ~~~~~~~~~~~~^^~~
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object cdiv at 0x7f7c3c0d01f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [SymNodeVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object __call__ at 0x7f7c3c064990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:895 in <lambda> (_attention.forward) (inline depth: 1)
                nheads_q,
TRACE LOAD_DEREF nheads_q [SymNodeVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:896 in <lambda> (_attention.forward) (inline depth: 1)
                batch,
TRACE LOAD_DEREF batch [SymNodeVariable(), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE BUILD_TUPLE 3 [SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [TupleVariable(length=3)]
DONE INLINING <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>
TRACE inlined call <lambda> from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
                triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF max_seqlens_q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST META [NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE LOAD_CONST BLOCK_M [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstDictVariable(), ConstantVariable(str: 'BLOCK_M')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
            triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
            ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x7f7c3c064990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), SymNodeVariable()]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), SymNodeVariable()]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x7f7c3c0d01f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 3)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [SymNodeVariable()]
TRACE BINARY_OP 0 [SymNodeVariable(), ConstantVariable(int: 32)]
TRACE FX call add_3 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
            ~~^~~
TRACE LOAD_CONST 1 [SymNodeVariable()]
TRACE BINARY_OP 10 [SymNodeVariable(), ConstantVariable(int: 1)]
TRACE FX call sub_3 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
            ~~~~~~^~~
TRACE LOAD_FAST y [SymNodeVariable()]
TRACE BINARY_OP 2 [SymNodeVariable(), ConstantVariable(int: 32)]
TRACE FX call floordiv_3 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
           ~~~~~~~~~~~~^^~~
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object cdiv at 0x7f7c3c0d01f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [SymNodeVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object __call__ at 0x7f7c3c064990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:895 in <lambda> (_attention.forward) (inline depth: 1)
                nheads_q,
TRACE LOAD_DEREF nheads_q [SymNodeVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:896 in <lambda> (_attention.forward) (inline depth: 1)
                batch,
TRACE LOAD_DEREF batch [SymNodeVariable(), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE BUILD_TUPLE 3 [SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [TupleVariable(length=3)]
DONE INLINING <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>
wrap_to_fake L['cu_seqlens_k'] (2,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='cu_seqlens_k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_cu_seqlens_k_ L['cu_seqlens_k'] FakeTensor(..., device='cuda:0', size=(2,), dtype=torch.int32) at debug_level 0 before=False
TRACE FX call triton_kernel_wrapper_mutation from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
TRACE POP_TOP None [ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:962 in forward (_attention.forward)
            return o, encoded_softmax
TRACE LOAD_FAST o []
TRACE LOAD_FAST encoded_softmax [TensorVariable()]
TRACE BUILD_TUPLE 2 [TensorVariable(), ConstantVariable(NoneType: None)]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
Step 1: torchdynamo done tracing forward (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py, line 962 in forward>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_21_68a757ae_40b0_416b_ae91_f0faec42f668 =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, s45: "Sym(s45)", L_o_: "[31mbf16[0m[34m[s45, 64, 128][0m[2m[34m[8192, 128, 1][0m[2m[32mcuda:0[0m", s85: "Sym(s85)", L_q_: "[31mbf16[0m[34m[s85, 64, 128][0m[2m[34m[8192, 128, 1][0m[2m[32mcuda:0[0m", s37: "Sym(s37)", L_k_: "[31mbf16[0m[34m[s37, 8, 128][0m[2m[34m[1024, 128, 1][0m[2m[32mcuda:0[0m", L_cu_seqlens_q_: "[31mi32[0m[34m[2][0m[2m[34m[1][0m[2m[32mcuda:0[0m", s33: "Sym(s33)", L_v_: "[31mbf16[0m[34m[s33, 8, 128][0m[2m[34m[1024, 128, 1][0m[2m[32mcuda:0[0m", L_max_seqlens_q_: "Sym(s30)", L_cu_seqlens_k_: "[31mi32[0m[34m[2][0m[2m[34m[1][0m[2m[32mcuda:0[0m"):
        l_o_ = L_o_
        l_q_ = L_q_
        l_k_ = L_k_
        l_cu_seqlens_q_ = L_cu_seqlens_q_
        l_v_ = L_v_
        l_max_seqlens_q_ = L_max_seqlens_q_
        l_cu_seqlens_k_ = L_cu_seqlens_k_
        
         [2m# File: /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv, code: return (x + y - 1) // y[0m
        add: "Sym(s30 + 32)" = l_max_seqlens_q_ + [34m32[0m;  [2ml_max_seqlens_q_ = None[0m
        sub: "Sym(s30 + 31)" = add - [34m1[0m;  [2madd = None[0m
        floordiv: "Sym(((s30 + 31)//32))" = sub // [34m32[0m;  [2msub = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward, code: attn_fwd[grid]([0m
        triton_kernel_wrapper_mutation = torch.ops.higher_order.triton_kernel_wrapper_mutation(kernel_idx = [34m0[0m, constant_args_idx = [34m2[0m, grid = [(floordiv, [34m64[0m, [34m1[0m), (floordiv, [34m64[0m, [34m1[0m), (floordiv, [34m64[0m, [34m1[0m), (floordiv, [34m64[0m, [34m1[0m)], tma_descriptor_metadata = [34m{}[0m, kwargs = [34m{'Q': l_q_, 'K': l_k_, 'V': l_v_, 'Out': l_o_, 'cu_seqlens_q': l_cu_seqlens_q_, 'cu_seqlens_k': l_cu_seqlens_k_}[0m);  [2mfloordiv = l_q_ = l_k_ = l_v_ = l_o_ = l_cu_seqlens_q_ = l_cu_seqlens_k_ = triton_kernel_wrapper_mutation = None[0m
        return ()
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing fpx_matmul /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:420
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:420 in fpx_matmul (fpx_matmul)
    def fpx_matmul(x,weight,weight_state,ebits:int=3,mbits:int=2):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:421 in fpx_matmul (fpx_matmul)
        if ebits == -44: #hqq
TRACE LOAD_FAST ebits []
TRACE LOAD_CONST -44 [LazyVariableTracker()]
TRACE COMPARE_OP == [LazyVariableTracker(), ConstantVariable(int: -44)]
TRACE POP_JUMP_IF_FALSE 322 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul)
            S0=x.shape[0]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
automatic dynamic size L['x']._base size(0) 128 != 512
automatic dynamic size L['x'] size(1) 128 != 512
wrap_to_fake L['x'] (1, 128, 8192) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='x', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}), tensor_source=LocalSource(local_name='x', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_x_ L['x'] FakeTensor(..., device='cuda:0', size=(1, s27, 8192), dtype=torch.bfloat16) at debug_level 0 before=False
create_graph_input s27 L['x'].size()[1] s27 at debug_level 0 before=True
_lift_symbols_in_symint s27 from L['x'].size()[1] at debug_level 0
wrap_to_fake L['x']._base (128, 64, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='x', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
TRACE FX call size from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul)
        S0=x.shape[0]
           ^^^^^^^
TRACE LOAD_CONST 0 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 0)]
TRACE STORE_FAST S0 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul)
            S1=x.shape[1]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE FX call size_1 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul)
        S1=x.shape[1]
           ^^^^^^^
TRACE LOAD_CONST 1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 1)]
TRACE STORE_FAST S1 [SymNodeVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:424 in fpx_matmul (fpx_matmul)
            dtype = x.dtype
TRACE LOAD_FAST x []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul)
            x = x.to(dtype=torch.float16).view(-1,x.shape[2])
TRACE LOAD_FAST x []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float16 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST x [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1)]
TRACE LOAD_ATTR shape [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), TensorVariable()]
TRACE FX call size_2 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
                                              ^^^^^^^
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3), ConstantVariable(int: 2)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), ConstantVariable(int: 8192)]
TRACE FX call view from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul)
            out = weight.forward_manual(x).to(dtype=dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_ATTR forward_manual [LazyVariableTracker()]
TRACE LOAD_FAST x [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x7f7c1f9a11c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE CALL 1 [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x7f7c1f9a11c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton)), TensorVariable()]
TRACE inlined call forward_manual from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object forward_manual at 0x7f7c1fbe0cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:543 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
        def forward_manual(self, x: Tensor, matmul_type: str="GEMM") -> Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
            return forward_functional(
TRACE LOAD_GLOBAL forward_functional []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:545 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
                x,
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:546 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
                self.bias,
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR bias [NullVariable, LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
                self.get_tensor_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_ATTR get_tensor_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_tensor_args at 0x7f7c1f9a1080>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_tensor_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
            self.get_tensor_args(),
            ~~~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_tensor_args at 0x7f7c1fbc6560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:524 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 2)
        def get_tensor_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:525 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 2)
            return [self.W_q, self.scales, self.zeros]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR W_q [UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_FAST self [LazyVariableTracker()]
TRACE LOAD_ATTR scales [LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['weight']._parameters['scales'] (128, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='weight', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='scales'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_weight_parameters_scales_ L['weight']._parameters['scales'] Parameter(FakeTensor(..., device='cuda:0', size=(128, 5120), dtype=torch.float16)) at debug_level 0 before=False
TRACE LOAD_FAST self [LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR zeros [LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['weight']._parameters['zeros'] (128, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='weight', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='zeros'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_weight_parameters_zeros_ L['weight']._parameters['zeros'] Parameter(FakeTensor(..., device='cuda:0', size=(128, 5120), dtype=torch.float16)) at debug_level 0 before=False
TRACE BUILD_LIST 3 [LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [ListVariable(length=3)]
DONE INLINING <code object get_tensor_args at 0x7f7c1fbc6560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
                self.get_meta_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3)]
TRACE LOAD_ATTR get_meta_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_meta_args at 0x7f7c1f9a1120>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_meta_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
            self.get_meta_args(),
            ~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_meta_args at 0x3c1c0c40, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:527 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
        def get_meta_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
            return [int(self.scaled_activations),
TRACE LOAD_GLOBAL int []
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR scaled_activations [NullVariable, LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:529 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.W_nbits,
TRACE LOAD_FAST self [ConstantVariable(int: 0)]
TRACE LOAD_ATTR W_nbits [ConstantVariable(int: 0), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:530 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.group_size,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker()]
TRACE LOAD_ATTR group_size [ConstantVariable(int: 0), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:531 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.unpack_mask,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR unpack_mask [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:532 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.elements_per_sample,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR elements_per_sample [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:533 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.input_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR input_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:534 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.output_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR output_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:535 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.acc_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR acc_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:536 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.meta_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR meta_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:537 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.channel_scale_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR channel_scale_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:538 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.W_group_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR W_group_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:539 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    int(self.data_contiguous),
TRACE LOAD_GLOBAL int [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int)]
TRACE LOAD_ATTR data_contiguous [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
            return [int(self.scaled_activations),
TRACE BUILD_LIST 12 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [ListVariable(length=12)]
DONE INLINING <code object get_meta_args at 0x3c1c0c40, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:549 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
                GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
TRACE LOAD_GLOBAL GEMLITE_MATMUL_TYPES_MAPPING [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12)]
TRACE LOAD_FAST matmul_type [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker(), ConstantVariable(str: 'GEMM')]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
            return forward_functional(
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
        return forward_functional(
               ~~~~~~~~~~~~~~~~~~^
            x,
            ^^
            self.bias,
            ^^^^^^^^^^
            self.get_tensor_args(),
            ^^^^^^^^^^^^^^^^^^^^^^^
            self.get_meta_args(),
            ^^^^^^^^^^^^^^^^^^^^^
            GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object __call__ at 0x7f7c609ab960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:675 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 2)
        def __call__(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 2)
            return self._opoverload(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR _opoverload [NullVariable, UserDefinedObjectVariable(CustomOpDef)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=5)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
wrap_to_fake L['weight'].W_q (1024, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=AttrSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='weight', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='W_q'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_weight_W_q L['weight'].W_q FakeTensor(..., device='cuda:0', size=(1024, 5120), dtype=torch.int32) at debug_level 0 before=False
TRACE FX call forward_functional_default from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 2)
        return self._opoverload(*args, **kwargs)
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object __call__ at 0x7f7c609ab960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object forward_manual at 0x7f7c1fbe0cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_1 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE STORE_FAST out [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul)
            return out.view(S0,S1,-1)
TRACE LOAD_FAST out []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST S0 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST S1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: -1)]
TRACE FX call view_1 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul)
        return out.view(S0,S1,-1)
               ~~~~~~~~^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
Step 1: torchdynamo done tracing fpx_matmul (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py, line 440 in fpx_matmul>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_23_a5031b26_efe4_48dc_867f_8a3e43f4c5e4 =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, s27: "Sym(s27)", L_x_: "[31mbf16[0m[34m[1, s27, 8192][0m[2m[34m[8192*s27, 8192, 1][0m[2m[32mcuda:0[0m", L_weight_parameters_scales_: "[31mf16[0m[34m[128, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m", L_weight_parameters_zeros_: "[31mf16[0m[34m[128, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m", L_weight_W_q: "[31mi32[0m[34m[1024, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m"):
        l_x_ = L_x_
        l_weight_parameters_scales_ = L_weight_parameters_scales_
        l_weight_parameters_zeros_ = L_weight_parameters_zeros_
        l_weight_w_q = L_weight_W_q
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul, code: x = x.to(dtype=torch.float16).view(-1,x.shape[2])[0m
        to: "[31mf16[0m[34m[1, s27, 8192][0m[2m[34m[8192*s27, 8192, 1][0m[2m[32mcuda:0[0m" = l_x_.to(dtype = [34mtorch.float16[0m);  [2ml_x_ = None[0m
        x: "[31mf16[0m[34m[s27, 8192][0m[2m[34m[8192, 1][0m[2m[32mcuda:0[0m" = to.view([34m-1[0m, [34m8192[0m);  [2mto = None[0m
        
         [2m# File: /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__, code: return self._opoverload(*args, **kwargs)[0m
        forward_functional_default: "[31mf16[0m[34m[s27, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m" = torch.ops.gemlite.forward_functional.default(x, [34mNone[0m, [l_weight_w_q, l_weight_parameters_scales_, l_weight_parameters_zeros_], [[34m0[0m, [34m4[0m, [34m64[0m, [34m15[0m, [34m8[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m0[0m, [34m4[0m, [34m1[0m], [34m4[0m);  [2mx = l_weight_w_q = l_weight_parameters_scales_ = l_weight_parameters_zeros_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul, code: out = weight.forward_manual(x).to(dtype=dtype)[0m
        out: "[31mbf16[0m[34m[s27, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m" = forward_functional_default.to(dtype = [34mtorch.bfloat16[0m);  [2mforward_functional_default = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul, code: return out.view(S0,S1,-1)[0m
        view_1: "[31mbf16[0m[34m[1, s27, 5120][0m[2m[34m[5120*s27, 5120, 1][0m[2m[32mcuda:0[0m" = out.view([34m1[0m, s27, [34m-1[0m);  [2mout = s27 = None[0m
        return (view_1,)
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing T5RMSNorm /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [LazyVariableTracker()]
automatic dynamic size L['hidden_states'] size(1) 128 != 512
wrap_to_fake L['hidden_states'] (1, 128, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='hidden_states', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_hidden_states_ L['hidden_states'] FakeTensor(..., device='cuda:0', size=(1, s87, 5120), dtype=torch.bfloat16) at debug_level 0 before=False
create_graph_input s87 L['hidden_states'].size()[1] s87 at debug_level 0 before=True
_lift_symbols_in_symint s87 from L['hidden_states'].size()[1] at debug_level 0
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE FX call add from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['weight'] (5120,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='weight', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_weight_ L['weight'] FakeTensor(..., device='cuda:0', size=(5120,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
Step 1: torchdynamo done tracing T5RMSNorm (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py, line 378 in T5RMSNorm>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_25_f32ed0e3_3708_4d36_a49f_3c5efde702e0 =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, s87: "Sym(s87)", L_hidden_states_: "[31mbf16[0m[34m[1, s87, 5120][0m[2m[34m[5120*s87, 5120, 1][0m[2m[32mcuda:0[0m", L_weight_: "[31mbf16[0m[34m[5120][0m[2m[34m[1][0m[2m[32mcuda:0[0m"):
        l_hidden_states_ = L_hidden_states_
        l_weight_ = L_weight_
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states: "[31mf32[0m[34m[1, s87, 5120][0m[2m[34m[5120*s87, 5120, 1][0m[2m[32mcuda:0[0m" = l_hidden_states_.to([34mtorch.float32[0m);  [2ml_hidden_states_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_1: "[31mf32[0m[34m[1, s87, 5120][0m[2m[34m[5120*s87, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states.pow([34m2[0m)
        variance: "[31mf32[0m[34m[1, s87, 1][0m[2m[34m[s87, 1, 1][0m[2m[32mcuda:0[0m" = pow_1.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add: "[31mf32[0m[34m[1, s87, 1][0m[2m[34m[s87, 1, 1][0m[2m[32mcuda:0[0m" = variance + [34m1e-06[0m;  [2mvariance = None[0m
        rsqrt: "[31mf32[0m[34m[1, s87, 1][0m[2m[34m[s87, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add);  [2madd = None[0m
        hidden_states_1: "[31mf32[0m[34m[1, s87, 5120][0m[2m[34m[5120*s87, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states * rsqrt;  [2mhidden_states = rsqrt = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_1: "[31mf32[0m[34m[1, s87, 5120][0m[2m[34m[5120*s87, 5120, 1][0m[2m[32mcuda:0[0m" = l_weight_ * hidden_states_1;  [2ml_weight_ = hidden_states_1 = None[0m
        to_1: "[31mbf16[0m[34m[1, s87, 5120][0m[2m[34m[5120*s87, 5120, 1][0m[2m[32mcuda:0[0m" = mul_1.to([34mtorch.bfloat16[0m);  [2mmul_1 = None[0m
        return (to_1,)
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing reference_dequant_gemm /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:213
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:213 in reference_dequant_gemm ()
    @torch.compile
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:219 in reference_dequant_gemm (reference_dequant_gemm)
        W_fp16 = W_int8.to(torch.float16) * scale.view(-1, 1)
TRACE LOAD_FAST W_int8 []
TRACE LOAD_ATTR to [LazyVariableTracker()]
wrap_to_fake L['W_int8'] (5120, 151936) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='W_int8', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_W_int8_ L['W_int8'] FakeTensor(..., device='cuda:0', size=(5120, 151936), dtype=torch.int8) at debug_level 0 before=False
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float16 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to from /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:219 in reference_dequant_gemm (reference_dequant_gemm)
    W_fp16 = W_int8.to(torch.float16) * scale.view(-1, 1)
             ~~~~~~~~~^^^^^^^^^^^^^^^
TRACE LOAD_FAST scale [TensorVariable()]
TRACE LOAD_ATTR view [TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['scale'] (5120,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='scale', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_scale_ L['scale'] FakeTensor(..., device='cuda:0', size=(5120,), dtype=torch.float16) at debug_level 0 before=False
TRACE LOAD_CONST -1 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_CONST 1 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1)]
TRACE CALL 2 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), ConstantVariable(int: 1)]
TRACE FX call view from /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:219 in reference_dequant_gemm (reference_dequant_gemm)
    W_fp16 = W_int8.to(torch.float16) * scale.view(-1, 1)
                                        ~~~~~~~~~~^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul from /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:219 in reference_dequant_gemm (reference_dequant_gemm)
    W_fp16 = W_int8.to(torch.float16) * scale.view(-1, 1)
             ~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST W_fp16 [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:220 in reference_dequant_gemm (reference_dequant_gemm)
        return torch.matmul(A, W_fp16)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR matmul [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST A [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST W_fp16 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), LazyVariableTracker(), TensorVariable()]
automatic dynamic size L['A'] size(1) 128 != 512
wrap_to_fake L['A'] (1, 128, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='A', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_A_ L['A'] FakeTensor(..., device='cuda:0', size=(1, s84, 5120), dtype=torch.float16) at debug_level 0 before=False
create_graph_input s84 L['A'].size()[1] s84 at debug_level 0 before=True
_lift_symbols_in_symint s84 from L['A'].size()[1] at debug_level 0
TRACE FX call matmul from /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:220 in reference_dequant_gemm (reference_dequant_gemm)
    return torch.matmul(A, W_fp16)
           ~~~~~~~~~~~~^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
Step 1: torchdynamo done tracing reference_dequant_gemm (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py, line 220 in reference_dequant_gemm>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_27_f5116359_cace_47b3_8802_5660a72647d1 =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, L_W_int8_: "[31mi8[0m[34m[5120, 151936][0m[2m[34m[1, 5120][0m[2m[32mcuda:0[0m", L_scale_: "[31mf16[0m[34m[5120][0m[2m[34m[1][0m[2m[32mcuda:0[0m", s84: "Sym(s84)", L_A_: "[31mf16[0m[34m[1, s84, 5120][0m[2m[34m[5120*s84, 5120, 1][0m[2m[32mcuda:0[0m"):
        l_w_int8_ = L_W_int8_
        l_scale_ = L_scale_
        l_a_ = L_A_
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:219 in reference_dequant_gemm, code: W_fp16 = W_int8.to(torch.float16) * scale.view(-1, 1)[0m
        to: "[31mf16[0m[34m[5120, 151936][0m[2m[34m[1, 5120][0m[2m[32mcuda:0[0m" = l_w_int8_.to([34mtorch.float16[0m);  [2ml_w_int8_ = None[0m
        view: "[31mf16[0m[34m[5120, 1][0m[2m[34m[1, 1][0m[2m[32mcuda:0[0m" = l_scale_.view([34m-1[0m, [34m1[0m);  [2ml_scale_ = None[0m
        W_fp16: "[31mf16[0m[34m[5120, 151936][0m[2m[34m[1, 5120][0m[2m[32mcuda:0[0m" = to * view;  [2mto = view = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:220 in reference_dequant_gemm, code: return torch.matmul(A, W_fp16)[0m
        matmul: "[31mf16[0m[34m[1, s84, 151936][0m[2m[34m[151936*s84, 151936, 1][0m[2m[32mcuda:0[0m" = torch.matmul(l_a_, W_fp16);  [2ml_a_ = W_fp16 = None[0m
        return (matmul,)
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing nucleous_sample /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:501
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:501 in nucleous_sample (PIPELINE)
        @torch.compile
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:508 in nucleous_sample (PIPELINE.nucleous_sample)
            B, V = logits.shape
TRACE LOAD_FAST logits []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
wrap_to_fake L['logits'] (1, 151936) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='logits', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_logits_ L['logits'] FakeTensor(..., device='cuda:0', size=(1, 151936), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE UNPACK_SEQUENCE 2 [SizeVariable(length=2)]
TRACE STORE_FAST B [ConstantVariable(int: 151936), ConstantVariable(int: 1)]
TRACE STORE_FAST V [ConstantVariable(int: 151936)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:509 in nucleous_sample (PIPELINE.nucleous_sample)
            device = logits.device
TRACE LOAD_FAST logits []
TRACE LOAD_ATTR device [TensorVariable()]
TRACE STORE_FAST device [ConstantVariable(device: device(type='cuda', index=0))]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:510 in nucleous_sample (PIPELINE.nucleous_sample)
            dtype = logits.dtype
TRACE LOAD_FAST logits []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:513 in nucleous_sample (PIPELINE.nucleous_sample)
            temperature = temperature.view(-1, 1).to(device, dtype)
TRACE LOAD_FAST temperature []
TRACE LOAD_ATTR view [LazyVariableTracker()]
wrap_to_fake L['temperature'] (1, 1) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='temperature', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_temperature_ L['temperature'] FakeTensor(..., size=(1, 1)) at debug_level 0 before=False
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_CONST 1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), ConstantVariable(int: 1)]
TRACE FX call view from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:513 in nucleous_sample (PIPELINE.nucleous_sample)
        temperature = temperature.view(-1, 1).to(device, dtype)
                      ~~~~~~~~~~~~~~~~^^^^^^^
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST device [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_FAST dtype [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device: device(type='cuda', index=0))]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device: device(type='cuda', index=0)), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:513 in nucleous_sample (PIPELINE.nucleous_sample)
        temperature = temperature.view(-1, 1).to(device, dtype)
                      ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST temperature [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:515 in nucleous_sample (PIPELINE.nucleous_sample)
            temperature.masked_fill_(temperature == 0.0, 1.0)
TRACE LOAD_FAST temperature []
TRACE LOAD_ATTR masked_fill_ [TensorVariable()]
TRACE LOAD_FAST temperature [NullVariable, GetAttrVariable(TensorVariable(), masked_fill_)]
TRACE LOAD_CONST 0.0 [NullVariable, GetAttrVariable(TensorVariable(), masked_fill_), TensorVariable()]
TRACE COMPARE_OP == [NullVariable, GetAttrVariable(TensorVariable(), masked_fill_), TensorVariable(), ConstantVariable(float: 0.0)]
TRACE FX call eq from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:515 in nucleous_sample (PIPELINE.nucleous_sample)
        temperature.masked_fill_(temperature == 0.0, 1.0)
                                 ^^^^^^^^^^^^^^^^^^
TRACE LOAD_CONST 1.0 [NullVariable, GetAttrVariable(TensorVariable(), masked_fill_), TensorVariable()]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), masked_fill_), TensorVariable(), ConstantVariable(float: 1.0)]
TRACE FX call masked_fill_ from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:515 in nucleous_sample (PIPELINE.nucleous_sample)
        temperature.masked_fill_(temperature == 0.0, 1.0)
        ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:517 in nucleous_sample (PIPELINE.nucleous_sample)
            p = top_p.view(-1, 1).to(device, dtype)
TRACE LOAD_FAST top_p []
TRACE LOAD_ATTR view [LazyVariableTracker()]
wrap_to_fake L['top_p'] (1, 1) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='top_p', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_top_p_ L['top_p'] FakeTensor(..., size=(1, 1)) at debug_level 0 before=False
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_CONST 1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), ConstantVariable(int: 1)]
TRACE FX call view_1 from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:517 in nucleous_sample (PIPELINE.nucleous_sample)
        p = top_p.view(-1, 1).to(device, dtype)
            ~~~~~~~~~~^^^^^^^
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST device [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_FAST dtype [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device: device(type='cuda', index=0))]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device: device(type='cuda', index=0)), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_1 from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:517 in nucleous_sample (PIPELINE.nucleous_sample)
        p = top_p.view(-1, 1).to(device, dtype)
            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST p [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:520 in nucleous_sample (PIPELINE.nucleous_sample)
            probs = F.softmax(logits.to(torch.bfloat16), dim=-1)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR softmax [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST logits [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR to [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR bfloat16 [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_2 from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:520 in nucleous_sample (PIPELINE.nucleous_sample)
        probs = F.softmax(logits.to(torch.bfloat16), dim=-1)
                          ~~~~~~~~~^^^^^^^^^^^^^^^^
TRACE LOAD_CONST -1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: -1)]
TRACE FX call softmax from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:520 in nucleous_sample (PIPELINE.nucleous_sample)
        probs = F.softmax(logits.to(torch.bfloat16), dim=-1)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST probs [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:521 in nucleous_sample (PIPELINE.nucleous_sample)
            self.max_k = 1024
TRACE LOAD_CONST 1024 []
TRACE LOAD_FAST self [ConstantVariable(int: 1024)]
TRACE STORE_ATTR max_k [ConstantVariable(int: 1024), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:523 in nucleous_sample (PIPELINE.nucleous_sample)
            k = min(self.max_k, V)
TRACE LOAD_GLOBAL min []
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR max_k [NullVariable, LazyVariableTracker(), UserDefinedObjectVariable(PIPELINE)]
TRACE LOAD_FAST V [NullVariable, LazyVariableTracker(), ConstantVariable(int: 1024)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 1024), ConstantVariable(int: 151936)]
TRACE STORE_FAST k [ConstantVariable(int: 1024)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:524 in nucleous_sample (PIPELINE.nucleous_sample)
            topk_probs, topk_indices = torch.topk(probs, k, dim=-1, largest=True, sorted=True)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR topk [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST probs [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 1024)]
TRACE LOAD_CONST True [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 1024), ConstantVariable(int: -1)]
TRACE LOAD_CONST True [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 1024), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE KW_NAMES ('dim', 'largest', 'sorted') [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 1024), ConstantVariable(int: -1), ConstantVariable(bool: True), ConstantVariable(bool: True)]
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 1024), ConstantVariable(int: -1), ConstantVariable(bool: True), ConstantVariable(bool: True)]
TRACE FX call topk from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:524 in nucleous_sample (PIPELINE.nucleous_sample)
        topk_probs, topk_indices = torch.topk(probs, k, dim=-1, largest=True, sorted=True)
                                   ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE UNPACK_SEQUENCE 2 [NamedTupleVariable(length=2)]
TRACE STORE_FAST topk_probs [TensorVariable(), TensorVariable()]
TRACE STORE_FAST topk_indices [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:527 in nucleous_sample (PIPELINE.nucleous_sample)
            cum_probs = torch.cumsum(topk_probs, dim=-1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cumsum [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST topk_probs [NullVariable, LazyVariableTracker()]
TRACE LOAD_CONST -1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: -1)]
TRACE FX call cumsum from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:527 in nucleous_sample (PIPELINE.nucleous_sample)
        cum_probs = torch.cumsum(topk_probs, dim=-1)
                    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST cum_probs [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:531 in nucleous_sample (PIPELINE.nucleous_sample)
            mask = cum_probs > p
TRACE LOAD_FAST cum_probs []
TRACE LOAD_FAST p [TensorVariable()]
TRACE COMPARE_OP > [TensorVariable(), TensorVariable()]
TRACE FX call gt from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:531 in nucleous_sample (PIPELINE.nucleous_sample)
        mask = cum_probs > p
               ^^^^^^^^^^^^^
TRACE STORE_FAST mask [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:533 in nucleous_sample (PIPELINE.nucleous_sample)
            mask[..., 0] = False
TRACE LOAD_CONST False []
TRACE LOAD_FAST mask [ConstantVariable(bool: False)]
TRACE LOAD_CONST (Ellipsis, 0) [ConstantVariable(bool: False), TensorVariable()]
TRACE STORE_SUBSCR None [ConstantVariable(bool: False), TensorVariable(), TupleVariable(length=2)]
TRACE FX call setitem from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:533 in nucleous_sample (PIPELINE.nucleous_sample)
        mask[..., 0] = False
        ~~~~^^^^^^^^
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:535 in nucleous_sample (PIPELINE.nucleous_sample)
            mask[..., 1:] = mask[..., :-1].clone()
TRACE LOAD_FAST mask []
TRACE LOAD_CONST Ellipsis [TensorVariable()]
TRACE LOAD_CONST None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis)]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), ConstantVariable(int: -1)]
TRACE BUILD_TUPLE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SliceVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), TupleVariable(length=2)]
TRACE FX call getitem_2 from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:535 in nucleous_sample (PIPELINE.nucleous_sample)
        mask[..., 1:] = mask[..., :-1].clone()
                        ~~~~^^^^^^^^^^
TRACE LOAD_ATTR clone [TensorVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), clone)]
TRACE FX call clone from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:535 in nucleous_sample (PIPELINE.nucleous_sample)
        mask[..., 1:] = mask[..., :-1].clone()
                        ~~~~~~~~~~~~~~~~~~~~^^
TRACE LOAD_FAST mask [TensorVariable()]
TRACE LOAD_CONST Ellipsis [TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 1 [TensorVariable(), TensorVariable(), ConstantVariable(ellipsis: Ellipsis)]
TRACE LOAD_CONST None [TensorVariable(), TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 1)]
TRACE BUILD_SLICE 2 [TensorVariable(), TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 1), ConstantVariable(NoneType: None)]
TRACE BUILD_TUPLE 2 [TensorVariable(), TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SliceVariable()]
TRACE STORE_SUBSCR None [TensorVariable(), TensorVariable(), TupleVariable(length=2)]
TRACE FX call setitem_1 from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:535 in nucleous_sample (PIPELINE.nucleous_sample)
        mask[..., 1:] = mask[..., :-1].clone()
        ~~~~^^^^^^^^^
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:538 in nucleous_sample (PIPELINE.nucleous_sample)
            topk_probs.masked_fill_(mask, 0.0)
TRACE LOAD_FAST topk_probs []
TRACE LOAD_ATTR masked_fill_ [TensorVariable()]
TRACE LOAD_FAST mask [NullVariable, GetAttrVariable(TensorVariable(), masked_fill_)]
TRACE LOAD_CONST 0.0 [NullVariable, GetAttrVariable(TensorVariable(), masked_fill_), TensorVariable()]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), masked_fill_), TensorVariable(), ConstantVariable(float: 0.0)]
TRACE FX call masked_fill__1 from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:538 in nucleous_sample (PIPELINE.nucleous_sample)
        topk_probs.masked_fill_(mask, 0.0)
        ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:541 in nucleous_sample (PIPELINE.nucleous_sample)
            if not torch.all(temperature == 1.0):
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR all [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST temperature [NullVariable, LazyVariableTracker()]
TRACE LOAD_CONST 1.0 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE COMPARE_OP == [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1.0)]
TRACE FX call eq_1 from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:541 in nucleous_sample (PIPELINE.nucleous_sample)
        if not torch.all(temperature == 1.0):
                         ^^^^^^^^^^^^^^^^^^
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call all_1 from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:541 in nucleous_sample (PIPELINE.nucleous_sample)
        if not torch.all(temperature == 1.0):
               ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
TRACE POP_JUMP_IF_TRUE 762 [TensorVariable()]
Graph break in user code at /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:541
Graph Break Reason: Data-dependent branching
  Explanation: Detected data-dependent branching (e.g. `if my_tensor.sum() > 0:`). Dynamo does not support tracing dynamic control flow.
  Hint: This graph break is fundamental - it is unlikely that Dynamo will ever be able to trace through your code. Consider finding a workaround.
  Hint: Use `torch.cond` to express dynamic control flow.

  Developer debug context: attempted to jump with TensorVariable()

User code traceback:
  File "/home/client/Projects/RWKV-Infer/rwkv_server_fla_fastapi.py", line 1182, in <module>
    asyncio.run(main())
  File "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
  File "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/asyncio/base_events.py", line 678, in run_until_complete
    self.run_forever()
  File "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/asyncio/base_events.py", line 645, in run_forever
    self._run_once()
  File "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/asyncio/base_events.py", line 1999, in _run_once
    handle._run()
  File "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/home/client/Projects/RWKV-Infer/rwkvengine/rwkvinfer_fla.py", line 958, in RunLLM
    otokens = self.pipeline.nucleous_sample(BatchProbs, temperature=torch.stack(temperature), top_p=torch.stack(top_p)).tolist()
  File "/home/client/Projects/RWKV-Infer/rwkvengine/misc.py", line 541, in nucleous_sample
    if not torch.all(temperature == 1.0):

generic_jump triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='generic_jump TensorVariable()', user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/misc.py, line 541 in nucleous_sample>], graph_break=True)
TRACED GRAPH
 ===== __compiled_fn_29_0c4a52c1_9c19_4d9b_897c_0441573146a7 =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, L_logits_: "[31mbf16[0m[34m[1, 151936][0m[2m[34m[151936, 1][0m[2m[32mcuda:0[0m", L_temperature_: "[31mf32[0m[34m[1, 1][0m[2m[34m[1, 1][0m[2m[32mcpu[0m", L_top_p_: "[31mf32[0m[34m[1, 1][0m[2m[34m[1, 1][0m[2m[32mcpu[0m"):
        l_logits_ = L_logits_
        l_temperature_ = L_temperature_
        l_top_p_ = L_top_p_
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:513 in nucleous_sample, code: temperature = temperature.view(-1, 1).to(device, dtype)[0m
        view: "[31mf32[0m[34m[1, 1][0m[2m[34m[1, 1][0m[2m[32mcpu[0m" = l_temperature_.view([34m-1[0m, [34m1[0m);  [2ml_temperature_ = None[0m
        temperature: "[31mbf16[0m[34m[1, 1][0m[2m[34m[1, 1][0m[2m[32mcuda:0[0m" = view.to([34mdevice(type='cuda', index=0)[0m, [34mtorch.bfloat16[0m);  [2mview = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:515 in nucleous_sample, code: temperature.masked_fill_(temperature == 0.0, 1.0)[0m
        eq: "[31mb8[0m[34m[1, 1][0m[2m[34m[1, 1][0m[2m[32mcuda:0[0m" = temperature.__eq__([34m0.0[0m)
        masked_fill_: "[31mbf16[0m[34m[1, 1][0m[2m[34m[1, 1][0m[2m[32mcuda:0[0m" = temperature.masked_fill_(eq, [34m1.0[0m);  [2meq = masked_fill_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:517 in nucleous_sample, code: p = top_p.view(-1, 1).to(device, dtype)[0m
        view_1: "[31mf32[0m[34m[1, 1][0m[2m[34m[1, 1][0m[2m[32mcpu[0m" = l_top_p_.view([34m-1[0m, [34m1[0m);  [2ml_top_p_ = None[0m
        p: "[31mbf16[0m[34m[1, 1][0m[2m[34m[1, 1][0m[2m[32mcuda:0[0m" = view_1.to([34mdevice(type='cuda', index=0)[0m, [34mtorch.bfloat16[0m);  [2mview_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:520 in nucleous_sample, code: probs = F.softmax(logits.to(torch.bfloat16), dim=-1)[0m
        to_2: "[31mbf16[0m[34m[1, 151936][0m[2m[34m[151936, 1][0m[2m[32mcuda:0[0m" = l_logits_.to([34mtorch.bfloat16[0m);  [2ml_logits_ = None[0m
        probs: "[31mbf16[0m[34m[1, 151936][0m[2m[34m[151936, 1][0m[2m[32mcuda:0[0m" = torch.nn.functional.softmax(to_2, dim = [34m-1[0m);  [2mto_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:524 in nucleous_sample, code: topk_probs, topk_indices = torch.topk(probs, k, dim=-1, largest=True, sorted=True)[0m
        topk = torch.topk(probs, [34m1024[0m, dim = [34m-1[0m, largest = [34mTrue[0m, sorted = [34mTrue[0m);  [2mprobs = None[0m
        topk_probs: "[31mbf16[0m[34m[1, 1024][0m[2m[34m[1024, 1][0m[2m[32mcuda:0[0m" = topk[[34m0[0m]
        topk_indices: "[31mi64[0m[34m[1, 1024][0m[2m[34m[1024, 1][0m[2m[32mcuda:0[0m" = topk[[34m1[0m];  [2mtopk = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:527 in nucleous_sample, code: cum_probs = torch.cumsum(topk_probs, dim=-1)[0m
        cum_probs: "[31mbf16[0m[34m[1, 1024][0m[2m[34m[1024, 1][0m[2m[32mcuda:0[0m" = torch.cumsum(topk_probs, dim = [34m-1[0m)
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:531 in nucleous_sample, code: mask = cum_probs > p[0m
        mask: "[31mb8[0m[34m[1, 1024][0m[2m[34m[1024, 1][0m[2m[32mcuda:0[0m" = cum_probs > p;  [2mcum_probs = p = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:533 in nucleous_sample, code: mask[..., 0] = False[0m
        mask[([34mEllipsis[0m, [34m0[0m)] = [34mFalse[0m;  setitem = mask;  [2msetitem = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:535 in nucleous_sample, code: mask[..., 1:] = mask[..., :-1].clone()[0m
        getitem_2: "[31mb8[0m[34m[1, 1023][0m[2m[34m[1024, 1][0m[2m[32mcuda:0[0m" = mask[([34mEllipsis[0m, slice([34mNone[0m, [34m-1[0m, [34mNone[0m))]
        clone: "[31mb8[0m[34m[1, 1023][0m[2m[34m[1023, 1][0m[2m[32mcuda:0[0m" = getitem_2.clone();  [2mgetitem_2 = None[0m
        mask[([34mEllipsis[0m, slice([34m1[0m, [34mNone[0m, [34mNone[0m))] = clone;  setitem_1 = mask;  [2mclone = setitem_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:538 in nucleous_sample, code: topk_probs.masked_fill_(mask, 0.0)[0m
        masked_fill__1: "[31mbf16[0m[34m[1, 1024][0m[2m[34m[1024, 1][0m[2m[32mcuda:0[0m" = topk_probs.masked_fill_(mask, [34m0.0[0m);  [2mmask = masked_fill__1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:541 in nucleous_sample, code: if not torch.all(temperature == 1.0):[0m
        eq_1: "[31mb8[0m[34m[1, 1][0m[2m[34m[1, 1][0m[2m[32mcuda:0[0m" = temperature.__eq__([34m1.0[0m)
        all_1: "[31mb8[0m[34m[][0m[2m[34m[][0m[2m[32mcuda:0[0m" = torch.all(eq_1);  [2meq_1 = None[0m
        return (all_1, temperature, topk_probs, topk_indices)
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing torch_dynamo_resume_in_nucleous_sample_at_541 /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:541
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:541 in torch_dynamo_resume_in_nucleous_sample_at_541 (PIPELINE.nucleous_sample)
            if not torch.all(temperature == 1.0):
TRACE RESUME 0 []
TRACE LOAD_CONST True []
TRACE STORE_FAST __is_tracing_resume_prologue [ConstantVariable(bool: True)]
TRACE LOAD_CONST False []
TRACE STORE_FAST __is_tracing_resume_prologue [ConstantVariable(bool: False)]
TRACE JUMP_FORWARD 774 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:545 in torch_dynamo_resume_in_nucleous_sample_at_541 (PIPELINE.nucleous_sample)
            topk_probs.div_(topk_probs.sum(dim=-1, keepdim=True))
TRACE LOAD_FAST topk_probs []
TRACE LOAD_ATTR div_ [LazyVariableTracker()]
wrap_to_fake L['topk_probs'] (1, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='topk_probs', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_topk_probs_ L['topk_probs'] FakeTensor(..., device='cuda:0', size=(1, 1024), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE LOAD_FAST topk_probs [NullVariable, GetAttrVariable(TensorVariable(), div_)]
TRACE LOAD_ATTR sum [NullVariable, GetAttrVariable(TensorVariable(), div_), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), div_), NullVariable, GetAttrVariable(TensorVariable(), sum)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), div_), NullVariable, GetAttrVariable(TensorVariable(), sum), ConstantVariable(int: -1)]
TRACE KW_NAMES ('dim', 'keepdim') [NullVariable, GetAttrVariable(TensorVariable(), div_), NullVariable, GetAttrVariable(TensorVariable(), sum), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), div_), NullVariable, GetAttrVariable(TensorVariable(), sum), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call sum_1 from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:545 in torch_dynamo_resume_in_nucleous_sample_at_541 (PIPELINE.nucleous_sample)
        topk_probs.div_(topk_probs.sum(dim=-1, keepdim=True))
                        ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), div_), TensorVariable()]
TRACE FX call div_ from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:545 in torch_dynamo_resume_in_nucleous_sample_at_541 (PIPELINE.nucleous_sample)
        topk_probs.div_(topk_probs.sum(dim=-1, keepdim=True))
        ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:549 in torch_dynamo_resume_in_nucleous_sample_at_541 (PIPELINE.nucleous_sample)
            idx_in_topk = torch.multinomial(topk_probs, num_samples=1).squeeze(-1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR multinomial [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST topk_probs [NullVariable, LazyVariableTracker()]
TRACE LOAD_CONST 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE KW_NAMES ('num_samples',) [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 1)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 1)]
TRACE FX call multinomial from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:549 in torch_dynamo_resume_in_nucleous_sample_at_541 (PIPELINE.nucleous_sample)
        idx_in_topk = torch.multinomial(topk_probs, num_samples=1).squeeze(-1)
                      ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR squeeze [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), squeeze)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), squeeze), ConstantVariable(int: -1)]
TRACE FX call squeeze from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:549 in torch_dynamo_resume_in_nucleous_sample_at_541 (PIPELINE.nucleous_sample)
        idx_in_topk = torch.multinomial(topk_probs, num_samples=1).squeeze(-1)
                      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^
TRACE STORE_FAST idx_in_topk [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:550 in torch_dynamo_resume_in_nucleous_sample_at_541 (PIPELINE.nucleous_sample)
            samples = topk_indices.gather(1, idx_in_topk.unsqueeze(-1)).squeeze(-1)
TRACE LOAD_FAST topk_indices []
TRACE LOAD_ATTR gather [LazyVariableTracker()]
wrap_to_fake L['topk_indices'] (1, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='topk_indices', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_topk_indices_ L['topk_indices'] FakeTensor(..., device='cuda:0', size=(1, 1024), dtype=torch.int64) at debug_level 0 before=False
TRACE LOAD_CONST 1 [NullVariable, GetAttrVariable(TensorVariable(), gather)]
TRACE LOAD_FAST idx_in_topk [NullVariable, GetAttrVariable(TensorVariable(), gather), ConstantVariable(int: 1)]
TRACE LOAD_ATTR unsqueeze [NullVariable, GetAttrVariable(TensorVariable(), gather), ConstantVariable(int: 1), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), gather), ConstantVariable(int: 1), NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), gather), ConstantVariable(int: 1), NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int: -1)]
TRACE FX call unsqueeze from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:550 in torch_dynamo_resume_in_nucleous_sample_at_541 (PIPELINE.nucleous_sample)
        samples = topk_indices.gather(1, idx_in_topk.unsqueeze(-1)).squeeze(-1)
                                         ~~~~~~~~~~~~~~~~~~~~~^^^^
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), gather), ConstantVariable(int: 1), TensorVariable()]
TRACE FX call gather from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:550 in torch_dynamo_resume_in_nucleous_sample_at_541 (PIPELINE.nucleous_sample)
        samples = topk_indices.gather(1, idx_in_topk.unsqueeze(-1)).squeeze(-1)
                  ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR squeeze [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), squeeze)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), squeeze), ConstantVariable(int: -1)]
TRACE FX call squeeze_1 from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:550 in torch_dynamo_resume_in_nucleous_sample_at_541 (PIPELINE.nucleous_sample)
        samples = topk_indices.gather(1, idx_in_topk.unsqueeze(-1)).squeeze(-1)
                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^
TRACE STORE_FAST samples [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:552 in torch_dynamo_resume_in_nucleous_sample_at_541 (PIPELINE.nucleous_sample)
            return samples
TRACE LOAD_FAST samples []
TRACE RETURN_VALUE None [TensorVariable()]
Step 1: torchdynamo done tracing torch_dynamo_resume_in_nucleous_sample_at_541 (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/misc.py, line 552 in torch_dynamo_resume_in_nucleous_sample_at_541>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_33_b03cd437_9966_43d7_9a41_a8083df14bf0 =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, L_topk_probs_: "[31mbf16[0m[34m[1, 1024][0m[2m[34m[1024, 1][0m[2m[32mcuda:0[0m", L_topk_indices_: "[31mi64[0m[34m[1, 1024][0m[2m[34m[1024, 1][0m[2m[32mcuda:0[0m"):
        l_topk_probs_ = L_topk_probs_
        l_topk_indices_ = L_topk_indices_
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:545 in torch_dynamo_resume_in_nucleous_sample_at_541, code: topk_probs.div_(topk_probs.sum(dim=-1, keepdim=True))[0m
        sum_1: "[31mbf16[0m[34m[1, 1][0m[2m[34m[1, 1][0m[2m[32mcuda:0[0m" = l_topk_probs_.sum(dim = [34m-1[0m, keepdim = [34mTrue[0m)
        div_: "[31mbf16[0m[34m[1, 1024][0m[2m[34m[1024, 1][0m[2m[32mcuda:0[0m" = l_topk_probs_.div_(sum_1);  [2msum_1 = div_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:549 in torch_dynamo_resume_in_nucleous_sample_at_541, code: idx_in_topk = torch.multinomial(topk_probs, num_samples=1).squeeze(-1)[0m
        multinomial: "[31mi64[0m[34m[1, 1][0m[2m[34m[1, 1][0m[2m[32mcuda:0[0m" = torch.multinomial(l_topk_probs_, num_samples = [34m1[0m);  [2ml_topk_probs_ = None[0m
        idx_in_topk: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = multinomial.squeeze([34m-1[0m);  [2mmultinomial = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:550 in torch_dynamo_resume_in_nucleous_sample_at_541, code: samples = topk_indices.gather(1, idx_in_topk.unsqueeze(-1)).squeeze(-1)[0m
        unsqueeze: "[31mi64[0m[34m[1, 1][0m[2m[34m[1, 1][0m[2m[32mcuda:0[0m" = idx_in_topk.unsqueeze([34m-1[0m);  [2midx_in_topk = None[0m
        gather: "[31mi64[0m[34m[1, 1][0m[2m[34m[1, 1][0m[2m[32mcuda:0[0m" = l_topk_indices_.gather([34m1[0m, unsqueeze);  [2ml_topk_indices_ = unsqueeze = None[0m
        samples: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = gather.squeeze([34m-1[0m);  [2mgather = None[0m
        return (samples,)
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing GQA_Attention_Flash_ /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:875
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:875 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7)
        @torch.compile(mode="max-autotune-no-cudagraphs")
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:904 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            B, T, C = x_in.shape
TRACE LOAD_FAST x_in []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
automatic dynamic stride L['x_in'] stride(0) InferStride(dim=2) != InferStride(dim=1)
wrap_to_fake L['x_in'] (1, 1, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='x_in', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_x_in_ L['x_in'] FakeTensor(..., device='cuda:0', size=(1, 1, 5120), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE UNPACK_SEQUENCE 3 [SizeVariable(length=3)]
TRACE STORE_FAST B [ConstantVariable(int: 5120), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 5120), ConstantVariable(int: 1)]
TRACE STORE_FAST C [ConstantVariable(int: 5120)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:905 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            device = x_in.device
TRACE LOAD_FAST x_in []
TRACE LOAD_ATTR device [TensorVariable()]
TRACE STORE_FAST device [ConstantVariable(device: device(type='cuda', index=0))]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:906 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            Lmax = past_key_value.shape[3]
TRACE LOAD_FAST past_key_value []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
wrap_to_fake L['past_key_value'] (8, 1, 2, 8192, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='past_key_value', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}), tensor_source=LocalSource(local_name='past_key_value', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_past_key_value_ L['past_key_value'] FakeTensor(..., device='cuda:0', size=(8, 1, 2, 8192, 1024),
           dtype=torch.bfloat16) at debug_level 0 before=False
wrap_to_fake L['past_key_value']._base (8, 1, 2, 8192, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='past_key_value', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
TRACE LOAD_CONST 3 [SizeVariable(length=5)]
TRACE BINARY_SUBSCR None [SizeVariable(length=5), ConstantVariable(int: 3)]
TRACE STORE_FAST Lmax [ConstantVariable(int: 8192)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            starts = cache_position[:, 0].clone()
TRACE LOAD_FAST cache_position []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE LOAD_CONST None [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [LazyVariableTracker(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST 0 [LazyVariableTracker(), SliceVariable()]
TRACE BUILD_TUPLE 2 [LazyVariableTracker(), SliceVariable(), ConstantVariable(int: 0)]
TRACE BINARY_SUBSCR None [LazyVariableTracker(), TupleVariable(length=2)]
wrap_to_fake L['cache_position'] (1, 1) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='cache_position', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_cache_position_ L['cache_position'] FakeTensor(..., device='cuda:0', size=(1, 1), dtype=torch.int64) at debug_level 0 before=False
TRACE FX call getitem from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        starts = cache_position[:, 0].clone()
                 ~~~~~~~~~~~~~~^^^^^^
TRACE LOAD_ATTR clone [TensorVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), clone)]
TRACE FX call clone from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        starts = cache_position[:, 0].clone()
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST starts [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:910 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            starts.clamp_(min=0, max=Lmax)
TRACE LOAD_FAST starts []
TRACE LOAD_ATTR clamp_ [TensorVariable()]
TRACE LOAD_CONST 0 [NullVariable, GetAttrVariable(TensorVariable(), clamp_)]
TRACE LOAD_FAST Lmax [NullVariable, GetAttrVariable(TensorVariable(), clamp_), ConstantVariable(int: 0)]
TRACE KW_NAMES ('min', 'max') [NullVariable, GetAttrVariable(TensorVariable(), clamp_), ConstantVariable(int: 0), ConstantVariable(int: 8192)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), clamp_), ConstantVariable(int: 0), ConstantVariable(int: 8192)]
TRACE FX call clamp_ from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:910 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        starts.clamp_(min=0, max=Lmax)
        ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:913 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            x = T5RMSNorm(x_in, ln1, rmsnorm_epsilon)  # 実装は外部
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST x_in [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:913 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        x = T5RMSNorm(x_in, ln1, rmsnorm_epsilon)  # 実装は外部
            ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x7f7c1d008ab0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE FX call add from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln1'] (5120,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln1', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln1_ L['ln1'] FakeTensor(..., device='cuda:0', size=(5120,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x7f7c1d008ab0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:915 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            HN = H * N
TRACE LOAD_FAST H []
TRACE LOAD_FAST N [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), LazyVariableTracker()]
TRACE STORE_FAST HN [ConstantVariable(int: 8192)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:918 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            qkv = fpx_matmul(x, QKV_, QKV_state, ebits, mbits)  # [B,T, QHN + KVd + KVd]
TRACE LOAD_GLOBAL fpx_matmul []
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST QKV_ [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST QKV_state [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_FAST ebits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST mbits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call fpx_matmul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:918 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        qkv = fpx_matmul(x, QKV_, QKV_state, ebits, mbits)  # [B,T, QHN + KVd + KVd]
              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object fpx_matmul at 0x3c1ee490, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:420 in fpx_matmul (fpx_matmul) (inline depth: 1)
    def fpx_matmul(x,weight,weight_state,ebits:int=3,mbits:int=2):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:421 in fpx_matmul (fpx_matmul) (inline depth: 1)
        if ebits == -44: #hqq
TRACE LOAD_FAST ebits []
TRACE LOAD_CONST -44 [LazyVariableTracker()]
TRACE COMPARE_OP == [LazyVariableTracker(), ConstantVariable(int: -44)]
TRACE POP_JUMP_IF_FALSE 322 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S0=x.shape[0]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 0 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 0)]
TRACE STORE_FAST S0 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S1=x.shape[1]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 1)]
TRACE STORE_FAST S1 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:424 in fpx_matmul (fpx_matmul) (inline depth: 1)
            dtype = x.dtype
TRACE LOAD_FAST x []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
            x = x.to(dtype=torch.float16).view(-1,x.shape[2])
TRACE LOAD_FAST x []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float16 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_2 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST x [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1)]
TRACE LOAD_ATTR shape [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3), ConstantVariable(int: 2)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), ConstantVariable(int: 5120)]
TRACE FX call view from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
            out = weight.forward_manual(x).to(dtype=dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_ATTR forward_manual [LazyVariableTracker()]
TRACE LOAD_FAST x [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x7f7c1f9a11c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE CALL 1 [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x7f7c1f9a11c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton)), TensorVariable()]
TRACE inlined call forward_manual from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object forward_manual at 0x7f7c1fbe0cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:543 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        def forward_manual(self, x: Tensor, matmul_type: str="GEMM") -> Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE LOAD_GLOBAL forward_functional []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:545 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                x,
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:546 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.bias,
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR bias [NullVariable, LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_tensor_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_ATTR get_tensor_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_tensor_args at 0x7f7c1f9a1080>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_tensor_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_tensor_args(),
            ~~~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_tensor_args at 0x7f7c1fbc6560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:524 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
        def get_tensor_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:525 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
            return [self.W_q, self.scales, self.zeros]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR W_q [UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_FAST self [LazyVariableTracker()]
TRACE LOAD_ATTR scales [LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['QKV_']._parameters['scales'] (80, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='QKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='scales'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_QKV_parameters_scales_ L['QKV_']._parameters['scales'] Parameter(FakeTensor(..., device='cuda:0', size=(80, 10240), dtype=torch.float16)) at debug_level 0 before=False
TRACE LOAD_FAST self [LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR zeros [LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['QKV_']._parameters['zeros'] (80, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='QKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='zeros'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_QKV_parameters_zeros_ L['QKV_']._parameters['zeros'] Parameter(FakeTensor(..., device='cuda:0', size=(80, 10240), dtype=torch.float16)) at debug_level 0 before=False
TRACE BUILD_LIST 3 [LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [ListVariable(length=3)]
DONE INLINING <code object get_tensor_args at 0x7f7c1fbc6560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_meta_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3)]
TRACE LOAD_ATTR get_meta_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_meta_args at 0x7f7c1f9a1120>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_meta_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_meta_args(),
            ~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_meta_args at 0x3c1c0c40, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:527 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
        def get_meta_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE LOAD_GLOBAL int []
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR scaled_activations [NullVariable, LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:529 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_nbits,
TRACE LOAD_FAST self [ConstantVariable(int: 0)]
TRACE LOAD_ATTR W_nbits [ConstantVariable(int: 0), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:530 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.group_size,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker()]
TRACE LOAD_ATTR group_size [ConstantVariable(int: 0), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:531 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.unpack_mask,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR unpack_mask [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:532 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.elements_per_sample,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR elements_per_sample [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:533 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.input_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR input_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:534 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.output_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR output_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:535 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.acc_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR acc_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:536 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.meta_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR meta_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:537 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.channel_scale_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR channel_scale_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:538 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_group_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR W_group_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:539 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    int(self.data_contiguous),
TRACE LOAD_GLOBAL int [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int)]
TRACE LOAD_ATTR data_contiguous [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE BUILD_LIST 12 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [ListVariable(length=12)]
DONE INLINING <code object get_meta_args at 0x3c1c0c40, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:549 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
TRACE LOAD_GLOBAL GEMLITE_MATMUL_TYPES_MAPPING [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12)]
TRACE LOAD_FAST matmul_type [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker(), ConstantVariable(str: 'GEMM')]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        return forward_functional(
               ~~~~~~~~~~~~~~~~~~^
            x,
            ^^
            self.bias,
            ^^^^^^^^^^
            self.get_tensor_args(),
            ^^^^^^^^^^^^^^^^^^^^^^^
            self.get_meta_args(),
            ^^^^^^^^^^^^^^^^^^^^^
            GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object __call__ at 0x7f7c609ab960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:675 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        def __call__(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
            return self._opoverload(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR _opoverload [NullVariable, UserDefinedObjectVariable(CustomOpDef)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=5)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
wrap_to_fake L['QKV_'].W_q (640, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=AttrSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='QKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='W_q'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_QKV_W_q L['QKV_'].W_q FakeTensor(..., device='cuda:0', size=(640, 10240), dtype=torch.int32) at debug_level 0 before=False
TRACE FX call forward_functional_default from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        return self._opoverload(*args, **kwargs)
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object __call__ at 0x7f7c609ab960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object forward_manual at 0x7f7c1fbe0cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_3 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE STORE_FAST out [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
            return out.view(S0,S1,-1)
TRACE LOAD_FAST out []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST S0 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST S1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: -1)]
TRACE FX call view_1 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
        return out.view(S0,S1,-1)
               ~~~~~~~~^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object fpx_matmul at 0x3c1ee490, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>
TRACE STORE_FAST qkv [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:919 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q, k, v = qkv.split(qkv_split_list, dim=-1)
TRACE LOAD_FAST qkv []
TRACE LOAD_ATTR split [TensorVariable()]
TRACE LOAD_FAST qkv_split_list [NullVariable, GetAttrVariable(TensorVariable(), split)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker()]
TRACE KW_NAMES ('dim',) [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE FX call split from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:919 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        q, k, v = qkv.split(qkv_split_list, dim=-1)
                  ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
TRACE UNPACK_SEQUENCE 3 [TupleVariable(length=3)]
TRACE STORE_FAST q [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST k [TensorVariable(), TensorVariable()]
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:922 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q.add_(Q_bias)
TRACE LOAD_FAST q []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST Q_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
wrap_to_fake L['Q_bias'] () StatefulSymbolicContext(dynamic_sizes=[], dynamic_strides=[], constraint_sizes=[], constraint_strides=[], specialize_on=[], view_base_context=None, tensor_source=LocalSource(local_name='Q_bias', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_Q_bias_ L['Q_bias'] FakeTensor(..., device='cuda:0', size=(), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call add_ from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:922 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        q.add_(Q_bias)
        ~~~~~~^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:923 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k.add_(K_bias)
TRACE LOAD_FAST k []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST K_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
TRACE FX call add__1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:923 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        k.add_(K_bias)
        ~~~~~~^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:924 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            v.add_(V_bias)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST V_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
TRACE FX call add__2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:924 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        v.add_(V_bias)
        ~~~~~~^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:927 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q = q.view(B, T, H, N)  # [B,T,H,N]
TRACE LOAD_FAST q []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:927 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        q = q.view(B, T, H, N)  # [B,T,H,N]
            ~~~~~~^^^^^^^^^^^^
TRACE STORE_FAST q [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:928 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            kv_dim_flat = k.shape[-1]     # kv_heads * N
TRACE LOAD_FAST k []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST -1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: -1)]
TRACE STORE_FAST kv_dim_flat [ConstantVariable(int: 1024)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:929 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            kv_heads = kv_dim_flat // N
TRACE LOAD_FAST kv_dim_flat []
TRACE LOAD_FAST N [ConstantVariable(int: 1024)]
TRACE BINARY_OP 2 [ConstantVariable(int: 1024), ConstantVariable(int: 128)]
TRACE STORE_FAST kv_heads [ConstantVariable(int: 8)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:930 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k = k.view(B, T, kv_heads, N) # [B,T,kv_h,N]
TRACE LOAD_FAST k []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_heads [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:930 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        k = k.view(B, T, kv_heads, N) # [B,T,kv_h,N]
            ~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:931 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            v = v.view(B, T, kv_heads, N)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_heads [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:931 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        v = v.view(B, T, kv_heads, N)
            ~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:934 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            if ln_r is not None:
TRACE LOAD_FAST ln_r []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 0 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
wrap_to_fake L['ln_r'] (128,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln_r', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln_r_ L['ln_r'] FakeTensor(..., device='cuda:0', size=(128,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE POP_JUMP_IF_TRUE 606 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:935 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
                q = T5RMSNorm(q, ln_r, rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln_r [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:935 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q = T5RMSNorm(q, ln_r, rmsnorm_epsilon)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x7f7c1d008ab0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x7f7c1d008ab0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST q [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:936 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
                k = T5RMSNorm(k, ln_k, rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln_k [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:936 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k = T5RMSNorm(k, ln_k, rmsnorm_epsilon)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x7f7c1d008ab0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln_k'] (128,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln_k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln_k_ L['ln_k'] FakeTensor(..., device='cuda:0', size=(128,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x7f7c1d008ab0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:940 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k_write = k.view(B, T, -1)
TRACE LOAD_FAST k []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: -1)]
TRACE FX call view_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:940 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        k_write = k.view(B, T, -1)
                  ~~~~~~^^^^^^^^^^
TRACE STORE_FAST k_write [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:941 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            v_write = v.view(B, T, -1)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: -1)]
TRACE FX call view_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:941 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        v_write = v.view(B, T, -1)
                  ~~~~~~^^^^^^^^^^
TRACE STORE_FAST v_write [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:944 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            new_lengths = starts + T
TRACE LOAD_FAST starts []
TRACE LOAD_FAST T [TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), ConstantVariable(int: 1)]
TRACE FX call add_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:944 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        new_lengths = starts + T
                      ~~~~~~~^~~
TRACE STORE_FAST new_lengths [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            excess_tokens = torch.clamp(new_lengths - Lmax, min=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR clamp [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST new_lengths [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST Lmax [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 10 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 8192)]
TRACE FX call sub from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        excess_tokens = torch.clamp(new_lengths - Lmax, min=0)
                                    ~~~~~~~~~~~~^~~~~~
TRACE LOAD_CONST 0 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE KW_NAMES ('min',) [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 0)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 0)]
TRACE FX call clamp from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        excess_tokens = torch.clamp(new_lengths - Lmax, min=0)
                        ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST excess_tokens [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:946 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            batches_to_evict = excess_tokens > 0
TRACE LOAD_FAST excess_tokens []
TRACE LOAD_CONST 0 [TensorVariable()]
TRACE COMPARE_OP > [TensorVariable(), ConstantVariable(int: 0)]
TRACE FX call gt from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:946 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        batches_to_evict = excess_tokens > 0
                           ^^^^^^^^^^^^^^^^^
TRACE STORE_FAST batches_to_evict [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            if bool(batches_to_evict.any()):
TRACE LOAD_GLOBAL bool []
TRACE LOAD_FAST batches_to_evict [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR any [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), any)]
TRACE FX call any_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        if bool(batches_to_evict.any()):
                ~~~~~~~~~~~~~~~~~~~~^^
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
Graph break (user stack suppressed due to duplicate graph break) in user code at /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949
Graph Break Reason: Failed to trace builtin operator
  Explanation: Dynamo does not know how to trace builtin operator `bool` with argument types ['Tensor'] (has_kwargs False)
  Hint: Avoid calling builtin `bool` with argument types ['Tensor']. Consider using an equivalent alternative function/method to `bool`.
  Hint: If you are attempting to call a logging function (e.g. `print`), you can try adding it to `torch._dynamo.config.reorderable_logging_functions`.
  Hint: Please report an issue to PyTorch.

  Developer debug context: builtin bool [<class 'torch._dynamo.variables.tensor.TensorVariable'>] False

 For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0059.html
Step 1: torchdynamo start tracing GQA_Attention_Flash_ /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:875
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:875 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7)
        @torch.compile(mode="max-autotune-no-cudagraphs")
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:904 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            B, T, C = x_in.shape
TRACE LOAD_FAST x_in []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
wrap_to_fake L['x_in'] (1, 1, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='x_in', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_x_in_ L['x_in'] FakeTensor(..., device='cuda:0', size=(1, 1, 5120), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE UNPACK_SEQUENCE 3 [SizeVariable(length=3)]
TRACE STORE_FAST B [ConstantVariable(int: 5120), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 5120), ConstantVariable(int: 1)]
TRACE STORE_FAST C [ConstantVariable(int: 5120)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:905 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            device = x_in.device
TRACE LOAD_FAST x_in []
TRACE LOAD_ATTR device [TensorVariable()]
TRACE STORE_FAST device [ConstantVariable(device: device(type='cuda', index=0))]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:906 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            Lmax = past_key_value.shape[3]
TRACE LOAD_FAST past_key_value []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
wrap_to_fake L['past_key_value'] (8, 1, 2, 8192, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='past_key_value', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}), tensor_source=LocalSource(local_name='past_key_value', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_past_key_value_ L['past_key_value'] FakeTensor(..., device='cuda:0', size=(8, 1, 2, 8192, 1024),
           dtype=torch.bfloat16) at debug_level 0 before=False
wrap_to_fake L['past_key_value']._base (8, 1, 2, 8192, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='past_key_value', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
TRACE LOAD_CONST 3 [SizeVariable(length=5)]
TRACE BINARY_SUBSCR None [SizeVariable(length=5), ConstantVariable(int: 3)]
TRACE STORE_FAST Lmax [ConstantVariable(int: 8192)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            starts = cache_position[:, 0].clone()
TRACE LOAD_FAST cache_position []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE LOAD_CONST None [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [LazyVariableTracker(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST 0 [LazyVariableTracker(), SliceVariable()]
TRACE BUILD_TUPLE 2 [LazyVariableTracker(), SliceVariable(), ConstantVariable(int: 0)]
TRACE BINARY_SUBSCR None [LazyVariableTracker(), TupleVariable(length=2)]
wrap_to_fake L['cache_position'] (1, 1) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='cache_position', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_cache_position_ L['cache_position'] FakeTensor(..., device='cuda:0', size=(1, 1), dtype=torch.int64) at debug_level 0 before=False
TRACE FX call getitem from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        starts = cache_position[:, 0].clone()
                 ~~~~~~~~~~~~~~^^^^^^
TRACE LOAD_ATTR clone [TensorVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), clone)]
TRACE FX call clone from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        starts = cache_position[:, 0].clone()
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST starts [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:910 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            starts.clamp_(min=0, max=Lmax)
TRACE LOAD_FAST starts []
TRACE LOAD_ATTR clamp_ [TensorVariable()]
TRACE LOAD_CONST 0 [NullVariable, GetAttrVariable(TensorVariable(), clamp_)]
TRACE LOAD_FAST Lmax [NullVariable, GetAttrVariable(TensorVariable(), clamp_), ConstantVariable(int: 0)]
TRACE KW_NAMES ('min', 'max') [NullVariable, GetAttrVariable(TensorVariable(), clamp_), ConstantVariable(int: 0), ConstantVariable(int: 8192)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), clamp_), ConstantVariable(int: 0), ConstantVariable(int: 8192)]
TRACE FX call clamp_ from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:910 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        starts.clamp_(min=0, max=Lmax)
        ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:913 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            x = T5RMSNorm(x_in, ln1, rmsnorm_epsilon)  # 実装は外部
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST x_in [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:913 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        x = T5RMSNorm(x_in, ln1, rmsnorm_epsilon)  # 実装は外部
            ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x7f7c1d008ab0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE FX call add from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln1'] (5120,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln1', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln1_ L['ln1'] FakeTensor(..., device='cuda:0', size=(5120,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x7f7c1d008ab0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:915 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            HN = H * N
TRACE LOAD_FAST H []
TRACE LOAD_FAST N [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), LazyVariableTracker()]
TRACE STORE_FAST HN [ConstantVariable(int: 8192)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:918 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            qkv = fpx_matmul(x, QKV_, QKV_state, ebits, mbits)  # [B,T, QHN + KVd + KVd]
TRACE LOAD_GLOBAL fpx_matmul []
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST QKV_ [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST QKV_state [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_FAST ebits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST mbits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call fpx_matmul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:918 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        qkv = fpx_matmul(x, QKV_, QKV_state, ebits, mbits)  # [B,T, QHN + KVd + KVd]
              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object fpx_matmul at 0x3c1ee490, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:420 in fpx_matmul (fpx_matmul) (inline depth: 1)
    def fpx_matmul(x,weight,weight_state,ebits:int=3,mbits:int=2):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:421 in fpx_matmul (fpx_matmul) (inline depth: 1)
        if ebits == -44: #hqq
TRACE LOAD_FAST ebits []
TRACE LOAD_CONST -44 [LazyVariableTracker()]
TRACE COMPARE_OP == [LazyVariableTracker(), ConstantVariable(int: -44)]
TRACE POP_JUMP_IF_FALSE 322 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S0=x.shape[0]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 0 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 0)]
TRACE STORE_FAST S0 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S1=x.shape[1]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 1)]
TRACE STORE_FAST S1 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:424 in fpx_matmul (fpx_matmul) (inline depth: 1)
            dtype = x.dtype
TRACE LOAD_FAST x []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
            x = x.to(dtype=torch.float16).view(-1,x.shape[2])
TRACE LOAD_FAST x []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float16 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_2 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST x [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1)]
TRACE LOAD_ATTR shape [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3), ConstantVariable(int: 2)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), ConstantVariable(int: 5120)]
TRACE FX call view from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
            out = weight.forward_manual(x).to(dtype=dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_ATTR forward_manual [LazyVariableTracker()]
TRACE LOAD_FAST x [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x7f7c1f9a11c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE CALL 1 [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x7f7c1f9a11c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton)), TensorVariable()]
TRACE inlined call forward_manual from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object forward_manual at 0x7f7c1fbe0cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:543 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        def forward_manual(self, x: Tensor, matmul_type: str="GEMM") -> Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE LOAD_GLOBAL forward_functional []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:545 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                x,
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:546 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.bias,
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR bias [NullVariable, LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_tensor_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_ATTR get_tensor_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_tensor_args at 0x7f7c1f9a1080>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_tensor_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_tensor_args(),
            ~~~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_tensor_args at 0x7f7c1fbc6560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:524 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
        def get_tensor_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:525 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
            return [self.W_q, self.scales, self.zeros]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR W_q [UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_FAST self [LazyVariableTracker()]
TRACE LOAD_ATTR scales [LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['QKV_']._parameters['scales'] (80, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='QKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='scales'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_QKV_parameters_scales_ L['QKV_']._parameters['scales'] Parameter(FakeTensor(..., device='cuda:0', size=(80, 10240), dtype=torch.float16)) at debug_level 0 before=False
TRACE LOAD_FAST self [LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR zeros [LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['QKV_']._parameters['zeros'] (80, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='QKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='zeros'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_QKV_parameters_zeros_ L['QKV_']._parameters['zeros'] Parameter(FakeTensor(..., device='cuda:0', size=(80, 10240), dtype=torch.float16)) at debug_level 0 before=False
TRACE BUILD_LIST 3 [LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [ListVariable(length=3)]
DONE INLINING <code object get_tensor_args at 0x7f7c1fbc6560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_meta_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3)]
TRACE LOAD_ATTR get_meta_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_meta_args at 0x7f7c1f9a1120>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_meta_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_meta_args(),
            ~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_meta_args at 0x3c1c0c40, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:527 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
        def get_meta_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE LOAD_GLOBAL int []
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR scaled_activations [NullVariable, LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:529 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_nbits,
TRACE LOAD_FAST self [ConstantVariable(int: 0)]
TRACE LOAD_ATTR W_nbits [ConstantVariable(int: 0), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:530 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.group_size,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker()]
TRACE LOAD_ATTR group_size [ConstantVariable(int: 0), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:531 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.unpack_mask,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR unpack_mask [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:532 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.elements_per_sample,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR elements_per_sample [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:533 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.input_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR input_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:534 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.output_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR output_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:535 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.acc_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR acc_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:536 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.meta_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR meta_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:537 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.channel_scale_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR channel_scale_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:538 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_group_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR W_group_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:539 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    int(self.data_contiguous),
TRACE LOAD_GLOBAL int [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int)]
TRACE LOAD_ATTR data_contiguous [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE BUILD_LIST 12 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [ListVariable(length=12)]
DONE INLINING <code object get_meta_args at 0x3c1c0c40, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:549 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
TRACE LOAD_GLOBAL GEMLITE_MATMUL_TYPES_MAPPING [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12)]
TRACE LOAD_FAST matmul_type [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker(), ConstantVariable(str: 'GEMM')]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        return forward_functional(
               ~~~~~~~~~~~~~~~~~~^
            x,
            ^^
            self.bias,
            ^^^^^^^^^^
            self.get_tensor_args(),
            ^^^^^^^^^^^^^^^^^^^^^^^
            self.get_meta_args(),
            ^^^^^^^^^^^^^^^^^^^^^
            GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object __call__ at 0x7f7c609ab960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:675 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        def __call__(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
            return self._opoverload(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR _opoverload [NullVariable, UserDefinedObjectVariable(CustomOpDef)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=5)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
wrap_to_fake L['QKV_'].W_q (640, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=AttrSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='QKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='W_q'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_QKV_W_q L['QKV_'].W_q FakeTensor(..., device='cuda:0', size=(640, 10240), dtype=torch.int32) at debug_level 0 before=False
TRACE FX call forward_functional_default from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        return self._opoverload(*args, **kwargs)
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object __call__ at 0x7f7c609ab960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object forward_manual at 0x7f7c1fbe0cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_3 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE STORE_FAST out [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
            return out.view(S0,S1,-1)
TRACE LOAD_FAST out []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST S0 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST S1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: -1)]
TRACE FX call view_1 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
        return out.view(S0,S1,-1)
               ~~~~~~~~^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object fpx_matmul at 0x3c1ee490, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>
TRACE STORE_FAST qkv [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:919 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q, k, v = qkv.split(qkv_split_list, dim=-1)
TRACE LOAD_FAST qkv []
TRACE LOAD_ATTR split [TensorVariable()]
TRACE LOAD_FAST qkv_split_list [NullVariable, GetAttrVariable(TensorVariable(), split)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker()]
TRACE KW_NAMES ('dim',) [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE FX call split from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:919 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        q, k, v = qkv.split(qkv_split_list, dim=-1)
                  ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
TRACE UNPACK_SEQUENCE 3 [TupleVariable(length=3)]
TRACE STORE_FAST q [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST k [TensorVariable(), TensorVariable()]
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:922 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q.add_(Q_bias)
TRACE LOAD_FAST q []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST Q_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
wrap_to_fake L['Q_bias'] () StatefulSymbolicContext(dynamic_sizes=[], dynamic_strides=[], constraint_sizes=[], constraint_strides=[], specialize_on=[], view_base_context=None, tensor_source=LocalSource(local_name='Q_bias', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_Q_bias_ L['Q_bias'] FakeTensor(..., device='cuda:0', size=(), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call add_ from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:922 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        q.add_(Q_bias)
        ~~~~~~^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:923 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k.add_(K_bias)
TRACE LOAD_FAST k []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST K_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
TRACE FX call add__1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:923 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        k.add_(K_bias)
        ~~~~~~^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:924 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            v.add_(V_bias)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST V_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
TRACE FX call add__2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:924 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        v.add_(V_bias)
        ~~~~~~^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:927 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q = q.view(B, T, H, N)  # [B,T,H,N]
TRACE LOAD_FAST q []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:927 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        q = q.view(B, T, H, N)  # [B,T,H,N]
            ~~~~~~^^^^^^^^^^^^
TRACE STORE_FAST q [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:928 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            kv_dim_flat = k.shape[-1]     # kv_heads * N
TRACE LOAD_FAST k []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST -1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: -1)]
TRACE STORE_FAST kv_dim_flat [ConstantVariable(int: 1024)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:929 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            kv_heads = kv_dim_flat // N
TRACE LOAD_FAST kv_dim_flat []
TRACE LOAD_FAST N [ConstantVariable(int: 1024)]
TRACE BINARY_OP 2 [ConstantVariable(int: 1024), ConstantVariable(int: 128)]
TRACE STORE_FAST kv_heads [ConstantVariable(int: 8)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:930 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k = k.view(B, T, kv_heads, N) # [B,T,kv_h,N]
TRACE LOAD_FAST k []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_heads [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:930 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        k = k.view(B, T, kv_heads, N) # [B,T,kv_h,N]
            ~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:931 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            v = v.view(B, T, kv_heads, N)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_heads [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:931 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        v = v.view(B, T, kv_heads, N)
            ~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:934 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            if ln_r is not None:
TRACE LOAD_FAST ln_r []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 0 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
wrap_to_fake L['ln_r'] (128,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln_r', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln_r_ L['ln_r'] FakeTensor(..., device='cuda:0', size=(128,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE POP_JUMP_IF_TRUE 606 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:935 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
                q = T5RMSNorm(q, ln_r, rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln_r [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:935 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q = T5RMSNorm(q, ln_r, rmsnorm_epsilon)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x7f7c1d008ab0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x7f7c1d008ab0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST q [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:936 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
                k = T5RMSNorm(k, ln_k, rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln_k [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:936 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k = T5RMSNorm(k, ln_k, rmsnorm_epsilon)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x7f7c1d008ab0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln_k'] (128,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln_k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln_k_ L['ln_k'] FakeTensor(..., device='cuda:0', size=(128,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x7f7c1d008ab0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:940 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k_write = k.view(B, T, -1)
TRACE LOAD_FAST k []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: -1)]
TRACE FX call view_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:940 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        k_write = k.view(B, T, -1)
                  ~~~~~~^^^^^^^^^^
TRACE STORE_FAST k_write [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:941 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            v_write = v.view(B, T, -1)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: -1)]
TRACE FX call view_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:941 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        v_write = v.view(B, T, -1)
                  ~~~~~~^^^^^^^^^^
TRACE STORE_FAST v_write [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:944 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            new_lengths = starts + T
TRACE LOAD_FAST starts []
TRACE LOAD_FAST T [TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), ConstantVariable(int: 1)]
TRACE FX call add_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:944 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        new_lengths = starts + T
                      ~~~~~~~^~~
TRACE STORE_FAST new_lengths [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            excess_tokens = torch.clamp(new_lengths - Lmax, min=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR clamp [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST new_lengths [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST Lmax [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 10 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 8192)]
TRACE FX call sub from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        excess_tokens = torch.clamp(new_lengths - Lmax, min=0)
                                    ~~~~~~~~~~~~^~~~~~
TRACE LOAD_CONST 0 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE KW_NAMES ('min',) [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 0)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 0)]
TRACE FX call clamp from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        excess_tokens = torch.clamp(new_lengths - Lmax, min=0)
                        ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST excess_tokens [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:946 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            batches_to_evict = excess_tokens > 0
TRACE LOAD_FAST excess_tokens []
TRACE LOAD_CONST 0 [TensorVariable()]
TRACE COMPARE_OP > [TensorVariable(), ConstantVariable(int: 0)]
TRACE FX call gt from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:946 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        batches_to_evict = excess_tokens > 0
                           ^^^^^^^^^^^^^^^^^
TRACE STORE_FAST batches_to_evict [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            if bool(batches_to_evict.any()):
TRACE LOAD_GLOBAL bool []
TRACE LOAD_FAST batches_to_evict [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR any [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), any)]
TRACE FX call any_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        if bool(batches_to_evict.any()):
                ~~~~~~~~~~~~~~~~~~~~^^
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
COMPILING GRAPH due to GraphCompileReason(reason="Failed to trace builtin operator\n  Explanation: Dynamo does not know how to trace builtin operator `bool` with argument types ['Tensor'] (has_kwargs False)\n  Hint: Avoid calling builtin `bool` with argument types ['Tensor']. Consider using an equivalent alternative function/method to `bool`.\n  Hint: If you are attempting to call a logging function (e.g. `print`), you can try adding it to `torch._dynamo.config.reorderable_logging_functions`.\n  Hint: Please report an issue to PyTorch.\n\n  Developer debug context: builtin bool [<class 'torch._dynamo.variables.tensor.TensorVariable'>] False\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0059.html", user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py, line 949 in GQA_Attention_Flash_>], graph_break=True)
REMOVE UNUSED GRAPHARG L['past_key_value']
TRACED GRAPH
 ===== __compiled_fn_36_d9fb841e_e9e3_4683_a183_9865ee700853 =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, L_x_in_: "[31mbf16[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m", L_cache_position_: "[31mi64[0m[34m[1, 1][0m[2m[34m[1, 1][0m[2m[32mcuda:0[0m", L_ln1_: "[31mbf16[0m[34m[5120][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_QKV_parameters_scales_: "[31mf16[0m[34m[80, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m", L_QKV_parameters_zeros_: "[31mf16[0m[34m[80, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m", L_QKV_W_q: "[31mi32[0m[34m[640, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m", L_Q_bias_: "[31mbf16[0m[34m[][0m[2m[34m[][0m[2m[32mcuda:0[0m", L_ln_r_: "[31mbf16[0m[34m[128][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_ln_k_: "[31mbf16[0m[34m[128][0m[2m[34m[1][0m[2m[32mcuda:0[0m"):
        l_x_in_ = L_x_in_
        l_cache_position_ = L_cache_position_
        l_ln1_ = L_ln1_
        l_qkv_parameters_scales_ = L_QKV_parameters_scales_
        l_qkv_parameters_zeros_ = L_QKV_parameters_zeros_
        l_qkv_w_q = L_QKV_W_q
        l_q_bias_ = L_Q_bias_
        l_ln_r_ = L_ln_r_
        l_ln_k_ = L_ln_k_
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_, code: starts = cache_position[:, 0].clone()[0m
        getitem: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = l_cache_position_[(slice([34mNone[0m, [34mNone[0m, [34mNone[0m), [34m0[0m)];  [2ml_cache_position_ = None[0m
        starts: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = getitem.clone();  [2mgetitem = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:910 in GQA_Attention_Flash_, code: starts.clamp_(min=0, max=Lmax)[0m
        clamp_: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = starts.clamp_(min = [34m0[0m, max = [34m8192[0m);  [2mclamp_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states: "[31mf32[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = l_x_in_.to([34mtorch.float32[0m);  [2ml_x_in_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_1: "[31mf32[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states.pow([34m2[0m)
        variance: "[31mf32[0m[34m[1, 1, 1][0m[2m[34m[1, 1, 1][0m[2m[32mcuda:0[0m" = pow_1.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add: "[31mf32[0m[34m[1, 1, 1][0m[2m[34m[1, 1, 1][0m[2m[32mcuda:0[0m" = variance + [34m1e-06[0m;  [2mvariance = None[0m
        rsqrt: "[31mf32[0m[34m[1, 1, 1][0m[2m[34m[1, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add);  [2madd = None[0m
        hidden_states_1: "[31mf32[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states * rsqrt;  [2mhidden_states = rsqrt = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_1: "[31mf32[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = l_ln1_ * hidden_states_1;  [2ml_ln1_ = hidden_states_1 = None[0m
        x: "[31mbf16[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = mul_1.to([34mtorch.bfloat16[0m);  [2mmul_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul, code: x = x.to(dtype=torch.float16).view(-1,x.shape[2])[0m
        to_2: "[31mf16[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = x.to(dtype = [34mtorch.float16[0m);  [2mx = None[0m
        x_1: "[31mf16[0m[34m[1, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m" = to_2.view([34m-1[0m, [34m5120[0m);  [2mto_2 = None[0m
        
         [2m# File: /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__, code: return self._opoverload(*args, **kwargs)[0m
        forward_functional_default: "[31mf16[0m[34m[1, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m" = torch.ops.gemlite.forward_functional.default(x_1, [34mNone[0m, [l_qkv_w_q, l_qkv_parameters_scales_, l_qkv_parameters_zeros_], [[34m0[0m, [34m4[0m, [34m64[0m, [34m15[0m, [34m8[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m0[0m, [34m4[0m, [34m1[0m], [34m4[0m);  [2mx_1 = l_qkv_w_q = l_qkv_parameters_scales_ = l_qkv_parameters_zeros_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul, code: out = weight.forward_manual(x).to(dtype=dtype)[0m
        out: "[31mbf16[0m[34m[1, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m" = forward_functional_default.to(dtype = [34mtorch.bfloat16[0m);  [2mforward_functional_default = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul, code: return out.view(S0,S1,-1)[0m
        qkv: "[31mbf16[0m[34m[1, 1, 10240][0m[2m[34m[10240, 10240, 1][0m[2m[32mcuda:0[0m" = out.view([34m1[0m, [34m1[0m, [34m-1[0m);  [2mout = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:919 in GQA_Attention_Flash_, code: q, k, v = qkv.split(qkv_split_list, dim=-1)[0m
        split = qkv.split([[34m8192[0m, [34m1024[0m, [34m1024[0m], dim = [34m-1[0m);  [2mqkv = None[0m
        q: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[10240, 10240, 1][0m[2m[32mcuda:0[0m" = split[[34m0[0m]
        k: "[31mbf16[0m[34m[1, 1, 1024][0m[2m[34m[10240, 10240, 1][0m[2m[32mcuda:0[0m" = split[[34m1[0m]
        v: "[31mbf16[0m[34m[1, 1, 1024][0m[2m[34m[10240, 10240, 1][0m[2m[32mcuda:0[0m" = split[[34m2[0m];  [2msplit = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:922 in GQA_Attention_Flash_, code: q.add_(Q_bias)[0m
        add_: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[10240, 10240, 1][0m[2m[32mcuda:0[0m" = q.add_(l_q_bias_);  [2madd_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:923 in GQA_Attention_Flash_, code: k.add_(K_bias)[0m
        add__1: "[31mbf16[0m[34m[1, 1, 1024][0m[2m[34m[10240, 10240, 1][0m[2m[32mcuda:0[0m" = k.add_(l_q_bias_);  [2madd__1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:924 in GQA_Attention_Flash_, code: v.add_(V_bias)[0m
        add__2: "[31mbf16[0m[34m[1, 1, 1024][0m[2m[34m[10240, 10240, 1][0m[2m[32mcuda:0[0m" = v.add_(l_q_bias_);  [2ml_q_bias_ = add__2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:927 in GQA_Attention_Flash_, code: q = q.view(B, T, H, N)  # [B,T,H,N][0m
        q_1: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[10240, 10240, 128, 1][0m[2m[32mcuda:0[0m" = q.view([34m1[0m, [34m1[0m, [34m64[0m, [34m128[0m);  [2mq = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:930 in GQA_Attention_Flash_, code: k = k.view(B, T, kv_heads, N) # [B,T,kv_h,N][0m
        k_1: "[31mbf16[0m[34m[1, 1, 8, 128][0m[2m[34m[10240, 10240, 128, 1][0m[2m[32mcuda:0[0m" = k.view([34m1[0m, [34m1[0m, [34m8[0m, [34m128[0m);  [2mk = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:931 in GQA_Attention_Flash_, code: v = v.view(B, T, kv_heads, N)[0m
        v_1: "[31mbf16[0m[34m[1, 1, 8, 128][0m[2m[34m[10240, 10240, 128, 1][0m[2m[32mcuda:0[0m" = v.view([34m1[0m, [34m1[0m, [34m8[0m, [34m128[0m);  [2mv = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states_2: "[31mf32[0m[34m[1, 1, 64, 128][0m[2m[34m[10240, 10240, 128, 1][0m[2m[32mcuda:0[0m" = q_1.to([34mtorch.float32[0m);  [2mq_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_2: "[31mf32[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_2.pow([34m2[0m)
        variance_1: "[31mf32[0m[34m[1, 1, 64, 1][0m[2m[34m[64, 64, 1, 1][0m[2m[32mcuda:0[0m" = pow_2.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add_1: "[31mf32[0m[34m[1, 1, 64, 1][0m[2m[34m[64, 64, 1, 1][0m[2m[32mcuda:0[0m" = variance_1 + [34m1e-06[0m;  [2mvariance_1 = None[0m
        rsqrt_1: "[31mf32[0m[34m[1, 1, 64, 1][0m[2m[34m[64, 64, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add_1);  [2madd_1 = None[0m
        hidden_states_3: "[31mf32[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_2 * rsqrt_1;  [2mhidden_states_2 = rsqrt_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_3: "[31mf32[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = l_ln_r_ * hidden_states_3;  [2ml_ln_r_ = hidden_states_3 = None[0m
        q_2: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = mul_3.to([34mtorch.bfloat16[0m);  [2mmul_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states_4: "[31mf32[0m[34m[1, 1, 8, 128][0m[2m[34m[10240, 10240, 128, 1][0m[2m[32mcuda:0[0m" = k_1.to([34mtorch.float32[0m);  [2mk_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_3: "[31mf32[0m[34m[1, 1, 8, 128][0m[2m[34m[1024, 1024, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_4.pow([34m2[0m)
        variance_2: "[31mf32[0m[34m[1, 1, 8, 1][0m[2m[34m[8, 8, 1, 1][0m[2m[32mcuda:0[0m" = pow_3.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add_2: "[31mf32[0m[34m[1, 1, 8, 1][0m[2m[34m[8, 8, 1, 1][0m[2m[32mcuda:0[0m" = variance_2 + [34m1e-06[0m;  [2mvariance_2 = None[0m
        rsqrt_2: "[31mf32[0m[34m[1, 1, 8, 1][0m[2m[34m[8, 8, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add_2);  [2madd_2 = None[0m
        hidden_states_5: "[31mf32[0m[34m[1, 1, 8, 128][0m[2m[34m[1024, 1024, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_4 * rsqrt_2;  [2mhidden_states_4 = rsqrt_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_5: "[31mf32[0m[34m[1, 1, 8, 128][0m[2m[34m[1024, 1024, 128, 1][0m[2m[32mcuda:0[0m" = l_ln_k_ * hidden_states_5;  [2ml_ln_k_ = hidden_states_5 = None[0m
        k_2: "[31mbf16[0m[34m[1, 1, 8, 128][0m[2m[34m[1024, 1024, 128, 1][0m[2m[32mcuda:0[0m" = mul_5.to([34mtorch.bfloat16[0m);  [2mmul_5 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:940 in GQA_Attention_Flash_, code: k_write = k.view(B, T, -1)[0m
        k_write: "[31mbf16[0m[34m[1, 1, 1024][0m[2m[34m[1024, 1024, 1][0m[2m[32mcuda:0[0m" = k_2.view([34m1[0m, [34m1[0m, [34m-1[0m)
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:941 in GQA_Attention_Flash_, code: v_write = v.view(B, T, -1)[0m
        v_write: "[31mbf16[0m[34m[1, 1, 1024][0m[2m[34m[10240, 10240, 1][0m[2m[32mcuda:0[0m" = v_1.view([34m1[0m, [34m1[0m, [34m-1[0m)
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:944 in GQA_Attention_Flash_, code: new_lengths = starts + T[0m
        new_lengths: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = starts + [34m1[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_, code: excess_tokens = torch.clamp(new_lengths - Lmax, min=0)[0m
        sub: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = new_lengths - [34m8192[0m;  [2mnew_lengths = None[0m
        excess_tokens: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = torch.clamp(sub, min = [34m0[0m);  [2msub = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:946 in GQA_Attention_Flash_, code: batches_to_evict = excess_tokens > 0[0m
        batches_to_evict: "[31mb8[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = excess_tokens > [34m0[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949 in GQA_Attention_Flash_, code: if bool(batches_to_evict.any()):[0m
        any_1: "[31mb8[0m[34m[][0m[2m[34m[][0m[2m[32mcuda:0[0m" = batches_to_evict.any()
        return (any_1, starts, q_2, k_2, v_1, k_write, v_write, excess_tokens, batches_to_evict)
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing forward /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:831
TRACE MAKE_CELL max_seqlens_q []
TRACE MAKE_CELL batch []
TRACE MAKE_CELL nheads_q []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:831 in forward (_attention)
        @staticmethod
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:848 in forward (_attention.forward)
            use_fp8 = False
TRACE LOAD_CONST False []
TRACE STORE_FAST use_fp8 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:849 in forward (_attention.forward)
            fp8_out_scale=None
TRACE LOAD_CONST None []
TRACE STORE_FAST fp8_out_scale [ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:850 in forward (_attention.forward)
            fp8_scales=None
TRACE LOAD_CONST None []
TRACE STORE_FAST fp8_scales [ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:851 in forward (_attention.forward)
            q_scale = k_scale = v_scale = p_scale = 1.0
TRACE LOAD_CONST 1.0 []
TRACE COPY 1 [ConstantVariable(float: 1.0)]
TRACE STORE_FAST q_scale [ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE COPY 1 [ConstantVariable(float: 1.0)]
TRACE STORE_FAST k_scale [ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE COPY 1 [ConstantVariable(float: 1.0)]
TRACE STORE_FAST v_scale [ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE STORE_FAST p_scale [ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:853 in forward (_attention.forward)
            if o is None:
TRACE LOAD_FAST o []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
wrap_to_fake L['o'] (1, 64, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='o', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_o_ L['o'] FakeTensor(..., device='cuda:0', size=(1, 64, 128), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE POP_JUMP_IF_TRUE 110 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:865 in forward (_attention.forward)
            if True:  # varlen
TRACE NOP None []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:866 in forward (_attention.forward)
                total_q, nheads_q, head_size = q.shape
TRACE LOAD_FAST q []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
automatic dynamic stride L['q']._base stride(0) InferStride(dim=2) != InferStride(dim=1)
wrap_to_fake L['q'] (1, 64, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None, None], specialize_on=[[], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='q', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}), tensor_source=LocalSource(local_name='q', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_q_ L['q'] FakeTensor(..., device='cuda:0', size=(1, 64, 128), dtype=torch.bfloat16) at debug_level 0 before=False
wrap_to_fake L['q']._base (1, 1, 64, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None, None], specialize_on=[[], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='q', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
TRACE UNPACK_SEQUENCE 3 [SizeVariable(length=3)]
TRACE STORE_FAST total_q [ConstantVariable(int: 128), ConstantVariable(int: 64), ConstantVariable(int: 1)]
TRACE STORE_DEREF nheads_q [ConstantVariable(int: 128), ConstantVariable(int: 64)]
TRACE STORE_FAST head_size [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:867 in forward (_attention.forward)
                total_k, nheads_k, _ = k.shape
TRACE LOAD_FAST k []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
wrap_to_fake L['k'] (1223, 8, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_k_ L['k'] FakeTensor(..., device='cuda:0', size=(s37, 8, 128), dtype=torch.bfloat16) at debug_level 0 before=False
create_graph_input s37 L['k'].size()[0] s37 at debug_level 0 before=True
_lift_symbols_in_symint s37 from L['k'].size()[0] at debug_level 0
TRACE FX call size from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:867 in forward (_attention.forward)
            total_k, nheads_k, _ = k.shape
                                   ^^^^^^^
TRACE UNPACK_SEQUENCE 3 [SizeVariable(length=3)]
TRACE STORE_FAST total_k [ConstantVariable(int: 128), ConstantVariable(int: 8), SymNodeVariable()]
TRACE STORE_FAST nheads_k [ConstantVariable(int: 128), ConstantVariable(int: 8)]
TRACE STORE_FAST _ [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:868 in forward (_attention.forward)
                batch = len(cu_seqlens_q) - 1
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST cu_seqlens_q [NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
wrap_to_fake L['cu_seqlens_q'] (2,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='cu_seqlens_q', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_cu_seqlens_q_ L['cu_seqlens_q'] FakeTensor(..., device='cuda:0', size=(2,), dtype=torch.int32) at debug_level 0 before=False
TRACE LOAD_CONST 1 [ConstantVariable(int: 2)]
TRACE BINARY_OP 10 [ConstantVariable(int: 2), ConstantVariable(int: 1)]
TRACE STORE_DEREF batch [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:869 in forward (_attention.forward)
                q_strides = (0, q.stride(1), q.stride(0), q.stride(2))
TRACE LOAD_CONST 0 []
TRACE LOAD_FAST q [ConstantVariable(int: 0)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), TensorVariable()]
TRACE LOAD_CONST 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 1)]
TRACE LOAD_FAST q [ConstantVariable(int: 0), ConstantVariable(int: 128)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 0)]
TRACE LOAD_FAST q [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), TensorVariable()]
TRACE LOAD_CONST 2 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 2)]
TRACE BUILD_TUPLE 4 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), ConstantVariable(int: 1)]
TRACE STORE_FAST q_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:870 in forward (_attention.forward)
                k_strides = (0, k.stride(1), k.stride(0), k.stride(2))
TRACE LOAD_CONST 0 []
TRACE LOAD_FAST k [ConstantVariable(int: 0)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), TensorVariable()]
TRACE LOAD_CONST 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 1)]
TRACE LOAD_FAST k [ConstantVariable(int: 0), ConstantVariable(int: 128)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 0)]
TRACE LOAD_FAST k [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), TensorVariable()]
TRACE LOAD_CONST 2 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 2)]
TRACE BUILD_TUPLE 4 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), ConstantVariable(int: 1)]
TRACE STORE_FAST k_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:871 in forward (_attention.forward)
                v_strides = (0, v.stride(1), v.stride(0), v.stride(2))
TRACE LOAD_CONST 0 []
TRACE LOAD_FAST v [ConstantVariable(int: 0)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), LazyVariableTracker()]
wrap_to_fake L['v'] (1223, 8, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='v', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_v_ L['v'] FakeTensor(..., device='cuda:0', size=(s33, 8, 128), dtype=torch.bfloat16) at debug_level 0 before=False
create_graph_input s33 L['v'].size()[0] s33 at debug_level 0 before=True
_lift_symbols_in_symint s33 from L['v'].size()[0] at debug_level 0
TRACE LOAD_CONST 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 1)]
TRACE LOAD_FAST v [ConstantVariable(int: 0), ConstantVariable(int: 128)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 0)]
TRACE LOAD_FAST v [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), TensorVariable()]
TRACE LOAD_CONST 2 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 2)]
TRACE BUILD_TUPLE 4 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), ConstantVariable(int: 1)]
TRACE STORE_FAST v_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:872 in forward (_attention.forward)
                o_strides = (0, o.stride(1), o.stride(0), o.stride(2))
TRACE LOAD_CONST 0 []
TRACE LOAD_FAST o [ConstantVariable(int: 0)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), TensorVariable()]
TRACE LOAD_CONST 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 1)]
TRACE LOAD_FAST o [ConstantVariable(int: 0), ConstantVariable(int: 128)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 0)]
TRACE LOAD_FAST o [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), TensorVariable()]
TRACE LOAD_CONST 2 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 2)]
TRACE BUILD_TUPLE 4 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), ConstantVariable(int: 1)]
TRACE STORE_FAST o_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:882 in forward (_attention.forward)
            unpadded_head_dims = {32, 64, 128, 256}
TRACE BUILD_SET 0 []
TRACE LOAD_CONST frozenset({256, 32, 64, 128}) [SetVariable()]
TRACE SET_UPDATE 1 [SetVariable(), FrozensetVariable()]
TRACE inlined call set_update from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:882 in forward (_attention.forward)
        unpadded_head_dims = {32, 64, 128, 256}
                             ^^^^^^^^^^^^^^^^^^
INLINING <code object set_update at 0x7f7c332be630, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 210>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:210 in set_update (set_update) (inline depth: 1)
    def set_update(set1, *others):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:211 in set_update (set_update) (inline depth: 1)
        if len(others) == 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST others [NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=1)]
TRACE LOAD_CONST 0 [ConstantVariable(int: 1)]
TRACE COMPARE_OP == [ConstantVariable(int: 1), ConstantVariable(int: 0)]
TRACE POP_JUMP_IF_FALSE 34 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:214 in set_update (set_update) (inline depth: 1)
        for set2 in others:
TRACE LOAD_FAST others []
TRACE GET_ITER None [TupleVariable(length=1)]
TRACE FOR_ITER 104 [ListIteratorVariable(length=1, index=0)]
TRACE STORE_FAST set2 [ListIteratorVariable(length=1, index=1), FrozensetVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE LOAD_FAST set2 [ListIteratorVariable(length=1, index=1)]
TRACE GET_ITER None [ListIteratorVariable(length=1, index=1), FrozensetVariable()]
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=0)]
TRACE STORE_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(int: 256)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:216 in set_update (set_update) (inline depth: 1)
                if x not in set1:
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1)]
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(int: 256)]
TRACE CONTAINS_OP 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(int: 256), SetVariable()]
TRACE POP_JUMP_IF_TRUE 64 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:217 in set_update (set_update) (inline depth: 1)
                    set1.add(x)
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1)]
TRACE LOAD_ATTR add [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), SetVariable()]
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), NullVariable, GetAttrVariable(SetVariable(), add)]
TRACE CALL 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), NullVariable, GetAttrVariable(SetVariable(), add), ConstantVariable(int: 256)]
TRACE POP_TOP None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 48 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1)]
TRACE STORE_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(int: 32)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:216 in set_update (set_update) (inline depth: 1)
                if x not in set1:
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2)]
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(int: 32)]
TRACE CONTAINS_OP 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(int: 32), SetVariable()]
TRACE POP_JUMP_IF_TRUE 64 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:217 in set_update (set_update) (inline depth: 1)
                    set1.add(x)
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2)]
TRACE LOAD_ATTR add [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), SetVariable()]
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), NullVariable, GetAttrVariable(SetVariable(), add)]
TRACE CALL 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), NullVariable, GetAttrVariable(SetVariable(), add), ConstantVariable(int: 32)]
TRACE POP_TOP None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 48 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2)]
TRACE STORE_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(int: 64)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:216 in set_update (set_update) (inline depth: 1)
                if x not in set1:
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3)]
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(int: 64)]
TRACE CONTAINS_OP 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(int: 64), SetVariable()]
TRACE POP_JUMP_IF_TRUE 64 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:217 in set_update (set_update) (inline depth: 1)
                    set1.add(x)
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3)]
TRACE LOAD_ATTR add [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), SetVariable()]
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), NullVariable, GetAttrVariable(SetVariable(), add)]
TRACE CALL 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), NullVariable, GetAttrVariable(SetVariable(), add), ConstantVariable(int: 64)]
TRACE POP_TOP None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 48 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3)]
TRACE STORE_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(int: 128)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:216 in set_update (set_update) (inline depth: 1)
                if x not in set1:
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4)]
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(int: 128)]
TRACE CONTAINS_OP 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(int: 128), SetVariable()]
TRACE POP_JUMP_IF_TRUE 64 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:217 in set_update (set_update) (inline depth: 1)
                    set1.add(x)
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4)]
TRACE LOAD_ATTR add [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), SetVariable()]
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), NullVariable, GetAttrVariable(SetVariable(), add)]
TRACE CALL 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), NullVariable, GetAttrVariable(SetVariable(), add), ConstantVariable(int: 128)]
TRACE POP_TOP None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 48 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4)]
TRACE END_FOR None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 38 [ListIteratorVariable(length=1, index=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:214 in set_update (set_update) (inline depth: 1)
        for set2 in others:
TRACE FOR_ITER 104 [ListIteratorVariable(length=1, index=1)]
TRACE END_FOR None [ListIteratorVariable(length=1, index=1), ConstantVariable(NoneType: None)]
TRACE RETURN_CONST None []
DONE INLINING <code object set_update at 0x7f7c332be630, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 210>
TRACE STORE_FAST unpadded_head_dims [SetVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:883 in forward (_attention.forward)
            if head_size not in unpadded_head_dims:
TRACE LOAD_FAST head_size []
TRACE LOAD_FAST unpadded_head_dims [ConstantVariable(int: 128)]
TRACE CONTAINS_OP 1 [ConstantVariable(int: 128), SetVariable()]
TRACE POP_JUMP_IF_FALSE 676 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:891 in forward (_attention.forward)
                padded_d_model = head_size
TRACE LOAD_FAST head_size []
TRACE STORE_FAST padded_d_model [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in forward (_attention.forward)
            grid = lambda META: (
TRACE LOAD_CLOSURE batch []
TRACE LOAD_CLOSURE max_seqlens_q [CellVariable()]
TRACE LOAD_CLOSURE nheads_q [CellVariable(), CellVariable()]
TRACE BUILD_TUPLE 3 [CellVariable(), CellVariable(), CellVariable()]
TRACE LOAD_CONST <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893> [TupleVariable(length=3)]
TRACE MAKE_FUNCTION 8 [TupleVariable(length=3), ConstantVariable(code: <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>)]
TRACE STORE_FAST grid [NestedUserFunctionVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:899 in forward (_attention.forward)
            encoded_softmax = None
TRACE LOAD_CONST None []
TRACE STORE_FAST encoded_softmax [ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:902 in forward (_attention.forward)
            philox_seed = 0x1BF52
TRACE LOAD_CONST 114514 []
TRACE STORE_FAST philox_seed [ConstantVariable(int: 114514)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:903 in forward (_attention.forward)
            philox_offset = 0x1D4B42
TRACE LOAD_CONST 1919810 []
TRACE STORE_FAST philox_offset [ConstantVariable(int: 1919810)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:905 in forward (_attention.forward)
            if bias is not None:
TRACE LOAD_FAST bias []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 0 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 848 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:913 in forward (_attention.forward)
                bias_strides = (0, 0, 0, 0)
TRACE LOAD_CONST (0, 0, 0, 0) []
TRACE STORE_FAST bias_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:915 in forward (_attention.forward)
            p_descale = 1.0 / p_scale
TRACE LOAD_CONST 1.0 []
TRACE LOAD_FAST p_scale [ConstantVariable(float: 1.0)]
TRACE BINARY_OP 11 [ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE STORE_FAST p_descale [ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:917 in forward (_attention.forward)
            ) if fp8_out_scale is not None else 1.0
TRACE LOAD_FAST fp8_out_scale []
TRACE LOAD_CONST None [ConstantVariable(NoneType: None)]
TRACE IS_OP 0 [ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 908 [ConstantVariable(bool: True)]
TRACE LOAD_CONST 1.0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:916 in forward (_attention.forward)
            o_descale = 1.0 / fp8_out_scale.item(
TRACE STORE_FAST o_descale [ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:919 in forward (_attention.forward)
            arg_max_seqlens_q = 0 if on_gfx1x() else max_seqlens_q
TRACE LOAD_GLOBAL on_gfx1x []
TRACE CALL 0 [NullVariable, LazyVariableTracker()]
TRACE inlined call on_gfx1x from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:919 in forward (_attention.forward)
        arg_max_seqlens_q = 0 if on_gfx1x() else max_seqlens_q
                                 ~~~~~~~~^^
INLINING <code object on_gfx1x at 0x7f7c1d0ccd30, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 35>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:35 in on_gfx1x (on_gfx1x) (inline depth: 1)
    def on_gfx1x():
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:36 in on_gfx1x (on_gfx1x) (inline depth: 1)
        return True
TRACE RETURN_CONST True []
DONE INLINING <code object on_gfx1x at 0x7f7c1d0ccd30, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 35>
TRACE POP_JUMP_IF_FALSE 936 [ConstantVariable(bool: True)]
TRACE LOAD_CONST 0 []
TRACE JUMP_FORWARD 938 [ConstantVariable(int: 0)]
TRACE STORE_FAST arg_max_seqlens_q [ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:920 in forward (_attention.forward)
            arg_max_seqlens_k = 0 if on_gfx1x() else max_seqlens_k
TRACE LOAD_GLOBAL on_gfx1x []
TRACE CALL 0 [NullVariable, LazyVariableTracker()]
TRACE inlined call on_gfx1x from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:920 in forward (_attention.forward)
        arg_max_seqlens_k = 0 if on_gfx1x() else max_seqlens_k
                                 ~~~~~~~~^^
INLINING <code object on_gfx1x at 0x7f7c1d0ccd30, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 35>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:35 in on_gfx1x (on_gfx1x) (inline depth: 1)
    def on_gfx1x():
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:36 in on_gfx1x (on_gfx1x) (inline depth: 1)
        return True
TRACE RETURN_CONST True []
DONE INLINING <code object on_gfx1x at 0x7f7c1d0ccd30, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 35>
TRACE POP_JUMP_IF_FALSE 964 [ConstantVariable(bool: True)]
TRACE LOAD_CONST 0 []
TRACE JUMP_FORWARD 966 [ConstantVariable(int: 0)]
TRACE STORE_FAST arg_max_seqlens_k [ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_GLOBAL attn_fwd []
TRACE LOAD_FAST grid [NullVariable, LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), NestedUserFunctionVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:923 in forward (_attention.forward)
                q,
TRACE LOAD_FAST q [NullVariable, TritonKernelVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:924 in forward (_attention.forward)
                k,
TRACE LOAD_FAST k [NullVariable, TritonKernelVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:925 in forward (_attention.forward)
                v,
TRACE LOAD_FAST v [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:926 in forward (_attention.forward)
                bias,
TRACE LOAD_FAST bias [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:927 in forward (_attention.forward)
                sm_scale,
TRACE LOAD_FAST sm_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:928 in forward (_attention.forward)
                q_scale,
TRACE LOAD_FAST q_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:929 in forward (_attention.forward)
                k_scale,
TRACE LOAD_FAST k_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:930 in forward (_attention.forward)
                v_scale,
TRACE LOAD_FAST v_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:931 in forward (_attention.forward)
                p_scale,
TRACE LOAD_FAST p_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:932 in forward (_attention.forward)
                p_descale,
TRACE LOAD_FAST p_descale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:933 in forward (_attention.forward)
                o_descale,
TRACE LOAD_FAST o_descale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:934 in forward (_attention.forward)
                None,
TRACE LOAD_CONST None [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:935 in forward (_attention.forward)
                o,
TRACE LOAD_FAST o [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE BUILD_LIST 13 [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(NoneType: None), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:936 in forward (_attention.forward)
                *q_strides,
TRACE LOAD_FAST q_strides [NullVariable, TritonKernelVariable(), ListVariable(length=13)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=13), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:937 in forward (_attention.forward)
                *k_strides,
TRACE LOAD_FAST k_strides [NullVariable, TritonKernelVariable(), ListVariable(length=17)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=17), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:938 in forward (_attention.forward)
                *v_strides,
TRACE LOAD_FAST v_strides [NullVariable, TritonKernelVariable(), ListVariable(length=21)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=21), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:939 in forward (_attention.forward)
                *o_strides,
TRACE LOAD_FAST o_strides [NullVariable, TritonKernelVariable(), ListVariable(length=25)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=25), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:940 in forward (_attention.forward)
                *bias_strides,
TRACE LOAD_FAST bias_strides [NullVariable, TritonKernelVariable(), ListVariable(length=29)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=29), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:941 in forward (_attention.forward)
                cu_seqlens_q,
TRACE LOAD_FAST cu_seqlens_q [NullVariable, TritonKernelVariable(), ListVariable(length=33)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_APPEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=33), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:942 in forward (_attention.forward)
                cu_seqlens_k,
TRACE LOAD_FAST cu_seqlens_k [NullVariable, TritonKernelVariable(), ListVariable(length=34)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_APPEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=34), LazyVariableTracker()]
TRACE CALL_INTRINSIC_1 6 [NullVariable, TritonKernelVariable(), ListVariable(length=35)]
TRACE BUILD_MAP 0 [NullVariable, TritonKernelVariable(), TupleVariable(length=35)]
TRACE LOAD_CONST dropout_p [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:943 in forward (_attention.forward)
                dropout_p=0.0,
TRACE LOAD_CONST 0.0 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'dropout_p')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'dropout_p'), ConstantVariable(float: 0.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST philox_seed [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:944 in forward (_attention.forward)
                philox_seed=philox_seed,
TRACE LOAD_FAST philox_seed [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'philox_seed')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'philox_seed'), ConstantVariable(int: 114514)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST philox_offset_base [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:945 in forward (_attention.forward)
                philox_offset_base=philox_offset,
TRACE LOAD_FAST philox_offset [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'philox_offset_base')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'philox_offset_base'), ConstantVariable(int: 1919810)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST encoded_softmax [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:946 in forward (_attention.forward)
                encoded_softmax=encoded_softmax,
TRACE LOAD_FAST encoded_softmax [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'encoded_softmax')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'encoded_softmax'), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST HQ [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:947 in forward (_attention.forward)
                HQ=nheads_q,
TRACE LOAD_DEREF nheads_q [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'HQ')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'HQ'), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST HK [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:948 in forward (_attention.forward)
                HK=nheads_k,
TRACE LOAD_FAST nheads_k [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'HK')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'HK'), ConstantVariable(int: 8)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST ACTUAL_BLOCK_DMODEL [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:949 in forward (_attention.forward)
                ACTUAL_BLOCK_DMODEL=head_size,
TRACE LOAD_FAST head_size [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'ACTUAL_BLOCK_DMODEL')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'ACTUAL_BLOCK_DMODEL'), ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST MAX_SEQLENS_Q [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:950 in forward (_attention.forward)
                MAX_SEQLENS_Q=arg_max_seqlens_q,
TRACE LOAD_FAST arg_max_seqlens_q [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'MAX_SEQLENS_Q')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'MAX_SEQLENS_Q'), ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST MAX_SEQLENS_K [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:951 in forward (_attention.forward)
                MAX_SEQLENS_K=arg_max_seqlens_k,
TRACE LOAD_FAST arg_max_seqlens_k [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'MAX_SEQLENS_K')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'MAX_SEQLENS_K'), ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST IS_CAUSAL [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:952 in forward (_attention.forward)
                IS_CAUSAL=causal,
TRACE LOAD_FAST causal [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'IS_CAUSAL')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'IS_CAUSAL'), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST VARLEN [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:953 in forward (_attention.forward)
                VARLEN=True,
TRACE LOAD_CONST True [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'VARLEN')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'VARLEN'), ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST BLOCK_DMODEL [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:954 in forward (_attention.forward)
                BLOCK_DMODEL=padded_d_model,
TRACE LOAD_FAST padded_d_model [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BLOCK_DMODEL')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BLOCK_DMODEL'), ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST BIAS_TYPE [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:955 in forward (_attention.forward)
                BIAS_TYPE=0 if bias is None else 1,
TRACE LOAD_FAST bias [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE')]
TRACE LOAD_CONST None [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(NoneType: None)]
TRACE IS_OP 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 1130 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(bool: False)]
TRACE LOAD_CONST 0 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE')]
TRACE JUMP_FORWARD 1132 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(int: 0)]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST ENABLE_DROPOUT [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:956 in forward (_attention.forward)
                ENABLE_DROPOUT=False,
TRACE LOAD_CONST False [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'ENABLE_DROPOUT')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'ENABLE_DROPOUT'), ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST RETURN_ENCODED_SOFTMAX [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:957 in forward (_attention.forward)
                RETURN_ENCODED_SOFTMAX=False,
TRACE LOAD_CONST False [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'RETURN_ENCODED_SOFTMAX')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'RETURN_ENCODED_SOFTMAX'), ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST USE_FP8 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:958 in forward (_attention.forward)
                USE_FP8=use_fp8,
TRACE LOAD_FAST use_fp8 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8'), ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST USE_FP8_OUT [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:959 in forward (_attention.forward)
                USE_FP8_OUT=fp8_out_scale is not None,
TRACE LOAD_FAST fp8_out_scale [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8_OUT')]
TRACE LOAD_CONST None [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8_OUT'), ConstantVariable(NoneType: None)]
TRACE IS_OP 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8_OUT'), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8_OUT'), ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE CALL_FUNCTION_EX 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE inlined call <lambda> from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
                triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF max_seqlens_q [NullVariable, LazyVariableTracker()]
create_graph_input L_max_seqlens_q_ L['max_seqlens_q'] s30 at debug_level 0 before=False
TRACE LOAD_FAST META [NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE LOAD_CONST BLOCK_M [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstDictVariable(), ConstantVariable(str: 'BLOCK_M')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
            triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
            ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x7f7c3c064990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), SymNodeVariable()]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), SymNodeVariable()]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x7f7c3c0d01f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 3)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [SymNodeVariable()]
TRACE BINARY_OP 0 [SymNodeVariable(), ConstantVariable(int: 32)]
TRACE FX call add from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
            ~~^~~
TRACE LOAD_CONST 1 [SymNodeVariable()]
TRACE BINARY_OP 10 [SymNodeVariable(), ConstantVariable(int: 1)]
TRACE FX call sub from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
            ~~~~~~^~~
TRACE LOAD_FAST y [SymNodeVariable()]
TRACE BINARY_OP 2 [SymNodeVariable(), ConstantVariable(int: 32)]
TRACE FX call floordiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
           ~~~~~~~~~~~~^^~~
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object cdiv at 0x7f7c3c0d01f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [SymNodeVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object __call__ at 0x7f7c3c064990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:895 in <lambda> (_attention.forward) (inline depth: 1)
                nheads_q,
TRACE LOAD_DEREF nheads_q [SymNodeVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:896 in <lambda> (_attention.forward) (inline depth: 1)
                batch,
TRACE LOAD_DEREF batch [SymNodeVariable(), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE BUILD_TUPLE 3 [SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [TupleVariable(length=3)]
DONE INLINING <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>
TRACE inlined call <lambda> from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
                triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF max_seqlens_q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST META [NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE LOAD_CONST BLOCK_M [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstDictVariable(), ConstantVariable(str: 'BLOCK_M')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
            triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
            ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x7f7c3c064990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), SymNodeVariable()]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), SymNodeVariable()]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x7f7c3c0d01f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 3)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [SymNodeVariable()]
TRACE BINARY_OP 0 [SymNodeVariable(), ConstantVariable(int: 32)]
TRACE FX call add_1 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
            ~~^~~
TRACE LOAD_CONST 1 [SymNodeVariable()]
TRACE BINARY_OP 10 [SymNodeVariable(), ConstantVariable(int: 1)]
TRACE FX call sub_1 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
            ~~~~~~^~~
TRACE LOAD_FAST y [SymNodeVariable()]
TRACE BINARY_OP 2 [SymNodeVariable(), ConstantVariable(int: 32)]
TRACE FX call floordiv_1 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
           ~~~~~~~~~~~~^^~~
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object cdiv at 0x7f7c3c0d01f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [SymNodeVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object __call__ at 0x7f7c3c064990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:895 in <lambda> (_attention.forward) (inline depth: 1)
                nheads_q,
TRACE LOAD_DEREF nheads_q [SymNodeVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:896 in <lambda> (_attention.forward) (inline depth: 1)
                batch,
TRACE LOAD_DEREF batch [SymNodeVariable(), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE BUILD_TUPLE 3 [SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [TupleVariable(length=3)]
DONE INLINING <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>
TRACE inlined call <lambda> from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
                triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF max_seqlens_q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST META [NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE LOAD_CONST BLOCK_M [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstDictVariable(), ConstantVariable(str: 'BLOCK_M')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
            triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
            ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x7f7c3c064990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), SymNodeVariable()]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), SymNodeVariable()]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x7f7c3c0d01f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 3)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [SymNodeVariable()]
TRACE BINARY_OP 0 [SymNodeVariable(), ConstantVariable(int: 32)]
TRACE FX call add_2 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
            ~~^~~
TRACE LOAD_CONST 1 [SymNodeVariable()]
TRACE BINARY_OP 10 [SymNodeVariable(), ConstantVariable(int: 1)]
TRACE FX call sub_2 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
            ~~~~~~^~~
TRACE LOAD_FAST y [SymNodeVariable()]
TRACE BINARY_OP 2 [SymNodeVariable(), ConstantVariable(int: 32)]
TRACE FX call floordiv_2 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
           ~~~~~~~~~~~~^^~~
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object cdiv at 0x7f7c3c0d01f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [SymNodeVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object __call__ at 0x7f7c3c064990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:895 in <lambda> (_attention.forward) (inline depth: 1)
                nheads_q,
TRACE LOAD_DEREF nheads_q [SymNodeVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:896 in <lambda> (_attention.forward) (inline depth: 1)
                batch,
TRACE LOAD_DEREF batch [SymNodeVariable(), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE BUILD_TUPLE 3 [SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [TupleVariable(length=3)]
DONE INLINING <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>
TRACE inlined call <lambda> from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
                triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF max_seqlens_q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST META [NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE LOAD_CONST BLOCK_M [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstDictVariable(), ConstantVariable(str: 'BLOCK_M')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
            triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
            ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x7f7c3c064990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), SymNodeVariable()]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), SymNodeVariable()]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x39a31160, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x7f7c3c0d01f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 3)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [SymNodeVariable()]
TRACE BINARY_OP 0 [SymNodeVariable(), ConstantVariable(int: 32)]
TRACE FX call add_3 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
            ~~^~~
TRACE LOAD_CONST 1 [SymNodeVariable()]
TRACE BINARY_OP 10 [SymNodeVariable(), ConstantVariable(int: 1)]
TRACE FX call sub_3 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
            ~~~~~~^~~
TRACE LOAD_FAST y [SymNodeVariable()]
TRACE BINARY_OP 2 [SymNodeVariable(), ConstantVariable(int: 32)]
TRACE FX call floordiv_3 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
           ~~~~~~~~~~~~^^~~
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object cdiv at 0x7f7c3c0d01f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [SymNodeVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object __call__ at 0x7f7c3c064990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:895 in <lambda> (_attention.forward) (inline depth: 1)
                nheads_q,
TRACE LOAD_DEREF nheads_q [SymNodeVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:896 in <lambda> (_attention.forward) (inline depth: 1)
                batch,
TRACE LOAD_DEREF batch [SymNodeVariable(), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE BUILD_TUPLE 3 [SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [TupleVariable(length=3)]
DONE INLINING <code object <lambda> at 0x7f7c1cf04730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>
wrap_to_fake L['cu_seqlens_k'] (2,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='cu_seqlens_k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_cu_seqlens_k_ L['cu_seqlens_k'] FakeTensor(..., device='cuda:0', size=(2,), dtype=torch.int32) at debug_level 0 before=False
TRACE FX call triton_kernel_wrapper_mutation from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
TRACE POP_TOP None [ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:962 in forward (_attention.forward)
            return o, encoded_softmax
TRACE LOAD_FAST o []
TRACE LOAD_FAST encoded_softmax [TensorVariable()]
TRACE BUILD_TUPLE 2 [TensorVariable(), ConstantVariable(NoneType: None)]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
Step 1: torchdynamo done tracing forward (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py, line 962 in forward>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_39_7c3cc69c_eb38_4f2e_9c9a_9d01eb8384d7 =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, L_o_: "[31mbf16[0m[34m[1, 64, 128][0m[2m[34m[8192, 128, 1][0m[2m[32mcuda:0[0m", L_q_: "[31mbf16[0m[34m[1, 64, 128][0m[2m[34m[8192, 128, 1][0m[2m[32mcuda:0[0m", s37: "Sym(s37)", L_k_: "[31mbf16[0m[34m[s37, 8, 128][0m[2m[34m[1024, 128, 1][0m[2m[32mcuda:0[0m", L_cu_seqlens_q_: "[31mi32[0m[34m[2][0m[2m[34m[1][0m[2m[32mcuda:0[0m", s33: "Sym(s33)", L_v_: "[31mbf16[0m[34m[s33, 8, 128][0m[2m[34m[1024, 128, 1][0m[2m[32mcuda:0[0m", L_max_seqlens_q_: "Sym(s30)", L_cu_seqlens_k_: "[31mi32[0m[34m[2][0m[2m[34m[1][0m[2m[32mcuda:0[0m"):
        l_o_ = L_o_
        l_q_ = L_q_
        l_k_ = L_k_
        l_cu_seqlens_q_ = L_cu_seqlens_q_
        l_v_ = L_v_
        l_max_seqlens_q_ = L_max_seqlens_q_
        l_cu_seqlens_k_ = L_cu_seqlens_k_
        
         [2m# File: /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv, code: return (x + y - 1) // y[0m
        add: "Sym(s30 + 32)" = l_max_seqlens_q_ + [34m32[0m;  [2ml_max_seqlens_q_ = None[0m
        sub: "Sym(s30 + 31)" = add - [34m1[0m;  [2madd = None[0m
        floordiv: "Sym(((s30 + 31)//32))" = sub // [34m32[0m;  [2msub = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward, code: attn_fwd[grid]([0m
        triton_kernel_wrapper_mutation = torch.ops.higher_order.triton_kernel_wrapper_mutation(kernel_idx = [34m0[0m, constant_args_idx = [34m3[0m, grid = [(floordiv, [34m64[0m, [34m1[0m), (floordiv, [34m64[0m, [34m1[0m), (floordiv, [34m64[0m, [34m1[0m), (floordiv, [34m64[0m, [34m1[0m)], tma_descriptor_metadata = [34m{}[0m, kwargs = [34m{'Q': l_q_, 'K': l_k_, 'V': l_v_, 'Out': l_o_, 'cu_seqlens_q': l_cu_seqlens_q_, 'cu_seqlens_k': l_cu_seqlens_k_}[0m);  [2mfloordiv = l_q_ = l_k_ = l_v_ = l_o_ = l_cu_seqlens_q_ = l_cu_seqlens_k_ = triton_kernel_wrapper_mutation = None[0m
        return ()
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing fpx_matmul /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:420
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:420 in fpx_matmul (fpx_matmul)
    def fpx_matmul(x,weight,weight_state,ebits:int=3,mbits:int=2):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:421 in fpx_matmul (fpx_matmul)
        if ebits == -44: #hqq
TRACE LOAD_FAST ebits []
TRACE LOAD_CONST -44 [LazyVariableTracker()]
TRACE COMPARE_OP == [LazyVariableTracker(), ConstantVariable(int: -44)]
TRACE POP_JUMP_IF_FALSE 322 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul)
            S0=x.shape[0]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
automatic dynamic stride L['x'] stride(0) InferStride(dim=2) != InferStride(dim=1)
wrap_to_fake L['x'] (1, 1, 8192) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='x', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}), tensor_source=LocalSource(local_name='x', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_x_ L['x'] FakeTensor(..., device='cuda:0', size=(1, 1, 8192), dtype=torch.bfloat16) at debug_level 0 before=False
wrap_to_fake L['x']._base (1, 64, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='x', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
TRACE LOAD_CONST 0 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 0)]
TRACE STORE_FAST S0 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul)
            S1=x.shape[1]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 1)]
TRACE STORE_FAST S1 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:424 in fpx_matmul (fpx_matmul)
            dtype = x.dtype
TRACE LOAD_FAST x []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul)
            x = x.to(dtype=torch.float16).view(-1,x.shape[2])
TRACE LOAD_FAST x []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float16 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST x [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1)]
TRACE LOAD_ATTR shape [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3), ConstantVariable(int: 2)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), ConstantVariable(int: 8192)]
TRACE FX call view from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul)
            out = weight.forward_manual(x).to(dtype=dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_ATTR forward_manual [LazyVariableTracker()]
TRACE LOAD_FAST x [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x7f7c1f9a11c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE CALL 1 [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x7f7c1f9a11c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton)), TensorVariable()]
TRACE inlined call forward_manual from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object forward_manual at 0x7f7c1fbe0cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:543 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
        def forward_manual(self, x: Tensor, matmul_type: str="GEMM") -> Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
            return forward_functional(
TRACE LOAD_GLOBAL forward_functional []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:545 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
                x,
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:546 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
                self.bias,
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR bias [NullVariable, LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
                self.get_tensor_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_ATTR get_tensor_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_tensor_args at 0x7f7c1f9a1080>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_tensor_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
            self.get_tensor_args(),
            ~~~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_tensor_args at 0x7f7c1fbc6560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:524 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 2)
        def get_tensor_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:525 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 2)
            return [self.W_q, self.scales, self.zeros]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR W_q [UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_FAST self [LazyVariableTracker()]
TRACE LOAD_ATTR scales [LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['weight']._parameters['scales'] (128, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='weight', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='scales'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_weight_parameters_scales_ L['weight']._parameters['scales'] Parameter(FakeTensor(..., device='cuda:0', size=(128, 5120), dtype=torch.float16)) at debug_level 0 before=False
TRACE LOAD_FAST self [LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR zeros [LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['weight']._parameters['zeros'] (128, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='weight', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='zeros'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_weight_parameters_zeros_ L['weight']._parameters['zeros'] Parameter(FakeTensor(..., device='cuda:0', size=(128, 5120), dtype=torch.float16)) at debug_level 0 before=False
TRACE BUILD_LIST 3 [LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [ListVariable(length=3)]
DONE INLINING <code object get_tensor_args at 0x7f7c1fbc6560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
                self.get_meta_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3)]
TRACE LOAD_ATTR get_meta_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_meta_args at 0x7f7c1f9a1120>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_meta_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
            self.get_meta_args(),
            ~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_meta_args at 0x3c1c0c40, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:527 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
        def get_meta_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
            return [int(self.scaled_activations),
TRACE LOAD_GLOBAL int []
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR scaled_activations [NullVariable, LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:529 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.W_nbits,
TRACE LOAD_FAST self [ConstantVariable(int: 0)]
TRACE LOAD_ATTR W_nbits [ConstantVariable(int: 0), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:530 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.group_size,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker()]
TRACE LOAD_ATTR group_size [ConstantVariable(int: 0), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:531 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.unpack_mask,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR unpack_mask [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:532 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.elements_per_sample,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR elements_per_sample [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:533 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.input_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR input_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:534 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.output_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR output_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:535 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.acc_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR acc_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:536 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.meta_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR meta_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:537 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.channel_scale_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR channel_scale_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:538 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.W_group_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR W_group_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:539 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    int(self.data_contiguous),
TRACE LOAD_GLOBAL int [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int)]
TRACE LOAD_ATTR data_contiguous [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
            return [int(self.scaled_activations),
TRACE BUILD_LIST 12 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [ListVariable(length=12)]
DONE INLINING <code object get_meta_args at 0x3c1c0c40, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:549 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
                GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
TRACE LOAD_GLOBAL GEMLITE_MATMUL_TYPES_MAPPING [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12)]
TRACE LOAD_FAST matmul_type [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker(), ConstantVariable(str: 'GEMM')]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
            return forward_functional(
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
        return forward_functional(
               ~~~~~~~~~~~~~~~~~~^
            x,
            ^^
            self.bias,
            ^^^^^^^^^^
            self.get_tensor_args(),
            ^^^^^^^^^^^^^^^^^^^^^^^
            self.get_meta_args(),
            ^^^^^^^^^^^^^^^^^^^^^
            GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object __call__ at 0x7f7c609ab960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:675 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 2)
        def __call__(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 2)
            return self._opoverload(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR _opoverload [NullVariable, UserDefinedObjectVariable(CustomOpDef)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=5)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
wrap_to_fake L['weight'].W_q (1024, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=AttrSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='weight', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='W_q'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_weight_W_q L['weight'].W_q FakeTensor(..., device='cuda:0', size=(1024, 5120), dtype=torch.int32) at debug_level 0 before=False
TRACE FX call forward_functional_default from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 2)
        return self._opoverload(*args, **kwargs)
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object __call__ at 0x7f7c609ab960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object forward_manual at 0x7f7c1fbe0cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_1 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE STORE_FAST out [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul)
            return out.view(S0,S1,-1)
TRACE LOAD_FAST out []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST S0 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST S1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: -1)]
TRACE FX call view_1 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul)
        return out.view(S0,S1,-1)
               ~~~~~~~~^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
Step 1: torchdynamo done tracing fpx_matmul (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py, line 440 in fpx_matmul>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_41_ca8b0af6_f59c_4252_bb0e_519d1d18e07e =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, L_x_: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m", L_weight_parameters_scales_: "[31mf16[0m[34m[128, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m", L_weight_parameters_zeros_: "[31mf16[0m[34m[128, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m", L_weight_W_q: "[31mi32[0m[34m[1024, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m"):
        l_x_ = L_x_
        l_weight_parameters_scales_ = L_weight_parameters_scales_
        l_weight_parameters_zeros_ = L_weight_parameters_zeros_
        l_weight_w_q = L_weight_W_q
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul, code: x = x.to(dtype=torch.float16).view(-1,x.shape[2])[0m
        to: "[31mf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = l_x_.to(dtype = [34mtorch.float16[0m);  [2ml_x_ = None[0m
        x: "[31mf16[0m[34m[1, 8192][0m[2m[34m[8192, 1][0m[2m[32mcuda:0[0m" = to.view([34m-1[0m, [34m8192[0m);  [2mto = None[0m
        
         [2m# File: /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__, code: return self._opoverload(*args, **kwargs)[0m
        forward_functional_default: "[31mf16[0m[34m[1, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m" = torch.ops.gemlite.forward_functional.default(x, [34mNone[0m, [l_weight_w_q, l_weight_parameters_scales_, l_weight_parameters_zeros_], [[34m0[0m, [34m4[0m, [34m64[0m, [34m15[0m, [34m8[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m0[0m, [34m4[0m, [34m1[0m], [34m4[0m);  [2mx = l_weight_w_q = l_weight_parameters_scales_ = l_weight_parameters_zeros_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul, code: out = weight.forward_manual(x).to(dtype=dtype)[0m
        out: "[31mbf16[0m[34m[1, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m" = forward_functional_default.to(dtype = [34mtorch.bfloat16[0m);  [2mforward_functional_default = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul, code: return out.view(S0,S1,-1)[0m
        view_1: "[31mbf16[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = out.view([34m1[0m, [34m1[0m, [34m-1[0m);  [2mout = None[0m
        return (view_1,)
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing T5RMSNorm /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [LazyVariableTracker()]
automatic dynamic stride L['hidden_states'] stride(0) InferStride(dim=2) != InferStride(dim=1)
wrap_to_fake L['hidden_states'] (1, 1, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='hidden_states', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_hidden_states_ L['hidden_states'] FakeTensor(..., device='cuda:0', size=(1, 1, 5120), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE FX call add from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['weight'] (5120,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='weight', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_weight_ L['weight'] FakeTensor(..., device='cuda:0', size=(5120,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
Step 1: torchdynamo done tracing T5RMSNorm (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py, line 378 in T5RMSNorm>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_43_6be0a783_a8ab_4ef2_b3a4_19b0619627ef =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, L_hidden_states_: "[31mbf16[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m", L_weight_: "[31mbf16[0m[34m[5120][0m[2m[34m[1][0m[2m[32mcuda:0[0m"):
        l_hidden_states_ = L_hidden_states_
        l_weight_ = L_weight_
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states: "[31mf32[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = l_hidden_states_.to([34mtorch.float32[0m);  [2ml_hidden_states_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_1: "[31mf32[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states.pow([34m2[0m)
        variance: "[31mf32[0m[34m[1, 1, 1][0m[2m[34m[1, 1, 1][0m[2m[32mcuda:0[0m" = pow_1.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add: "[31mf32[0m[34m[1, 1, 1][0m[2m[34m[1, 1, 1][0m[2m[32mcuda:0[0m" = variance + [34m1e-06[0m;  [2mvariance = None[0m
        rsqrt: "[31mf32[0m[34m[1, 1, 1][0m[2m[34m[1, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add);  [2madd = None[0m
        hidden_states_1: "[31mf32[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states * rsqrt;  [2mhidden_states = rsqrt = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_1: "[31mf32[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = l_weight_ * hidden_states_1;  [2ml_weight_ = hidden_states_1 = None[0m
        to_1: "[31mbf16[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = mul_1.to([34mtorch.bfloat16[0m);  [2mmul_1 = None[0m
        return (to_1,)
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
