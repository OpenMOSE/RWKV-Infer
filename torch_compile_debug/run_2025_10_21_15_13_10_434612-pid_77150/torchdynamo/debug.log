Step 1: torchdynamo start tracing RunLLM /home/client/Projects/RWKV-Infer/rwkvengine/rwkvinfer_fla.py:473
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/rwkvinfer_fla.py:473 in RunLLM (LLMWorker)
        @torch.compile()
TRACE RETURN_GENERATOR None [BuiltinVariable(None)]
TRACE POP_TOP None [BuiltinVariable(None)]
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/rwkvinfer_fla.py:475 in RunLLM (LLMWorker.RunLLM)
            print('Start LLM Engine')
TRACE LOAD_GLOBAL print []
TRACE LOAD_CONST Start LLM Engine [NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), ConstantVariable(str: 'Start LLM Engine')]
empty checkpoint
Step 1: torchdynamo start tracing hxa079_TimeMix /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:524
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:524 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7)
        @torch.compile
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:550 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            x = T5RMSNorm(x_in,ln1,variance_epsilon=rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST x_in [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE KW_NAMES ('variance_epsilon',) [NullVariable, LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:550 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        x = T5RMSNorm(x_in,ln1,variance_epsilon=rmsnorm_epsilon)
            ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
wrap_to_fake L['x_in'] (1, 512, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='x_in', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_x_in_ L['x_in'] FakeTensor(..., device='cuda:0', size=(1, 512, 5120), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE FX call add from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln1'] (5120,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln1', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln1_ L['ln1'] FakeTensor(..., device='cuda:0', size=(5120,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:551 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            xw,xa,xv,xg,xk = (x @ wavgk1).split(wavgk_split_list, dim=-1)
TRACE LOAD_FAST x []
TRACE LOAD_FAST wavgk1 [TensorVariable()]
TRACE BINARY_OP 4 [TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['wavgk1'] (5120, 1376) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='wavgk1', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_wavgk1_ L['wavgk1'] FakeTensor(..., device='cuda:0', size=(5120, 1376), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call matmul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:551 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xw,xa,xv,xg,xk = (x @ wavgk1).split(wavgk_split_list, dim=-1)
                          ~~^~~~~~~~
TRACE LOAD_ATTR split [TensorVariable()]
TRACE LOAD_FAST wavgk_split_list [NullVariable, GetAttrVariable(TensorVariable(), split)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker()]
TRACE KW_NAMES ('dim',) [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE FX call split from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:551 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xw,xa,xv,xg,xk = (x @ wavgk1).split(wavgk_split_list, dim=-1)
                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE UNPACK_SEQUENCE 5 [TupleVariable(length=5)]
TRACE STORE_FAST xw [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST xa [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST xv [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST xg [TensorVariable(), TensorVariable()]
TRACE STORE_FAST xk [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:553 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            B, T, HN = x.shape
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 3 [SizeVariable(length=3)]
TRACE STORE_FAST B [ConstantVariable(int: 5120), ConstantVariable(int: 512), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 5120), ConstantVariable(int: 512)]
TRACE STORE_FAST HN [ConstantVariable(int: 5120)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:555 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            rkv = fpx_matmul(x, RKV_,RKV_state, ebits, mbits)
TRACE LOAD_GLOBAL fpx_matmul []
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST RKV_ [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST RKV_state [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_FAST ebits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST mbits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call fpx_matmul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:555 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        rkv = fpx_matmul(x, RKV_,RKV_state, ebits, mbits)
              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object fpx_matmul at 0x3063a810, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:420 in fpx_matmul (fpx_matmul) (inline depth: 1)
    def fpx_matmul(x,weight,weight_state,ebits:int=3,mbits:int=2):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:421 in fpx_matmul (fpx_matmul) (inline depth: 1)
        if ebits == -44: #hqq
TRACE LOAD_FAST ebits []
TRACE LOAD_CONST -44 [LazyVariableTracker()]
TRACE COMPARE_OP == [LazyVariableTracker(), ConstantVariable(int: -44)]
TRACE POP_JUMP_IF_FALSE 322 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S0=x.shape[0]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 0 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 0)]
TRACE STORE_FAST S0 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S1=x.shape[1]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 1)]
TRACE STORE_FAST S1 [ConstantVariable(int: 512)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:424 in fpx_matmul (fpx_matmul) (inline depth: 1)
            dtype = x.dtype
TRACE LOAD_FAST x []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
            x = x.to(dtype=torch.float16).view(-1,x.shape[2])
TRACE LOAD_FAST x []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float16 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_2 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST x [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1)]
TRACE LOAD_ATTR shape [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3), ConstantVariable(int: 2)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), ConstantVariable(int: 5120)]
TRACE FX call view from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
            out = weight.forward_manual(x).to(dtype=dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_ATTR forward_manual [LazyVariableTracker()]
TRACE LOAD_FAST x [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE CALL 1 [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton)), TensorVariable()]
TRACE inlined call forward_manual from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:543 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        def forward_manual(self, x: Tensor, matmul_type: str="GEMM") -> Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE LOAD_GLOBAL forward_functional []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:545 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                x,
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:546 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.bias,
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR bias [NullVariable, LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_tensor_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_ATTR get_tensor_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_tensor_args at 0x70c98a9e9080>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_tensor_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_tensor_args(),
            ~~~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:524 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
        def get_tensor_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:525 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
            return [self.W_q, self.scales, self.zeros]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR W_q [UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_FAST self [LazyVariableTracker()]
TRACE LOAD_ATTR scales [LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['RKV_']._parameters['scales'] (80, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='RKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='scales'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_RKV_parameters_scales_ L['RKV_']._parameters['scales'] Parameter(FakeTensor(..., device='cuda:0', size=(80, 10240), dtype=torch.float16)) at debug_level 0 before=False
TRACE LOAD_FAST self [LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR zeros [LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['RKV_']._parameters['zeros'] (80, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='RKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='zeros'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_RKV_parameters_zeros_ L['RKV_']._parameters['zeros'] Parameter(FakeTensor(..., device='cuda:0', size=(80, 10240), dtype=torch.float16)) at debug_level 0 before=False
TRACE BUILD_LIST 3 [LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [ListVariable(length=3)]
DONE INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_meta_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3)]
TRACE LOAD_ATTR get_meta_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_meta_args at 0x70c98a9e9120>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_meta_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_meta_args(),
            ~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:527 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
        def get_meta_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE LOAD_GLOBAL int []
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR scaled_activations [NullVariable, LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:529 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_nbits,
TRACE LOAD_FAST self [ConstantVariable(int: 0)]
TRACE LOAD_ATTR W_nbits [ConstantVariable(int: 0), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:530 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.group_size,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker()]
TRACE LOAD_ATTR group_size [ConstantVariable(int: 0), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:531 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.unpack_mask,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR unpack_mask [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:532 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.elements_per_sample,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR elements_per_sample [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:533 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.input_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR input_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:534 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.output_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR output_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:535 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.acc_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR acc_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:536 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.meta_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR meta_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:537 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.channel_scale_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR channel_scale_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:538 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_group_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR W_group_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:539 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    int(self.data_contiguous),
TRACE LOAD_GLOBAL int [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int)]
TRACE LOAD_ATTR data_contiguous [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE BUILD_LIST 12 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [ListVariable(length=12)]
DONE INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:549 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
TRACE LOAD_GLOBAL GEMLITE_MATMUL_TYPES_MAPPING [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12)]
TRACE LOAD_FAST matmul_type [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker(), ConstantVariable(str: 'GEMM')]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        return forward_functional(
               ~~~~~~~~~~~~~~~~~~^
            x,
            ^^
            self.bias,
            ^^^^^^^^^^
            self.get_tensor_args(),
            ^^^^^^^^^^^^^^^^^^^^^^^
            self.get_meta_args(),
            ^^^^^^^^^^^^^^^^^^^^^
            GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:675 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        def __call__(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
            return self._opoverload(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR _opoverload [NullVariable, UserDefinedObjectVariable(CustomOpDef)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=5)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
wrap_to_fake L['RKV_'].W_q (640, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=AttrSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='RKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='W_q'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_RKV_W_q L['RKV_'].W_q FakeTensor(..., device='cuda:0', size=(640, 10240), dtype=torch.int32) at debug_level 0 before=False
TRACE FX call forward_functional_default from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        return self._opoverload(*args, **kwargs)
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_3 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE STORE_FAST out [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
            return out.view(S0,S1,-1)
TRACE LOAD_FAST out []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST S0 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST S1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: -1)]
TRACE FX call view_1 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
        return out.view(S0,S1,-1)
               ~~~~~~~~^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object fpx_matmul at 0x3063a810, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>
TRACE STORE_FAST rkv [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:556 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            r,k,v = rkv.split(rkv_split_list,dim=-1)
TRACE LOAD_FAST rkv []
TRACE LOAD_ATTR split [TensorVariable()]
TRACE LOAD_FAST rkv_split_list [NullVariable, GetAttrVariable(TensorVariable(), split)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker()]
TRACE KW_NAMES ('dim',) [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE FX call split_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:556 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        r,k,v = rkv.split(rkv_split_list,dim=-1)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
TRACE UNPACK_SEQUENCE 3 [TupleVariable(length=3)]
TRACE STORE_FAST r [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST k [TensorVariable(), TensorVariable()]
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:558 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            kv_dim = k.shape[2] # B,T,kv_dim
TRACE LOAD_FAST k []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 2 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 2)]
TRACE STORE_FAST kv_dim [ConstantVariable(int: 1024)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:559 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            kv_repeat = H*N // kv_dim
TRACE LOAD_FAST H []
TRACE LOAD_FAST N [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST kv_dim [ConstantVariable(int: 8192)]
TRACE BINARY_OP 2 [ConstantVariable(int: 8192), ConstantVariable(int: 1024)]
TRACE STORE_FAST kv_repeat [ConstantVariable(int: 8)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:560 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            kv_per_head = kv_dim // N
TRACE LOAD_FAST kv_dim []
TRACE LOAD_FAST N [ConstantVariable(int: 1024)]
TRACE BINARY_OP 2 [ConstantVariable(int: 1024), ConstantVariable(int: 128)]
TRACE STORE_FAST kv_per_head [ConstantVariable(int: 8)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:562 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            r = r.add_(R_bias)
TRACE LOAD_FAST r []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST R_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
wrap_to_fake L['R_bias'] () StatefulSymbolicContext(dynamic_sizes=[], dynamic_strides=[], constraint_sizes=[], constraint_strides=[], specialize_on=[], view_base_context=None, tensor_source=LocalSource(local_name='R_bias', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_R_bias_ L['R_bias'] FakeTensor(..., device='cuda:0', size=(), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call add_ from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:562 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        r = r.add_(R_bias)
            ~~~~~~^^^^^^^^
TRACE STORE_FAST r [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:563 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = k.add_(K_bias).view(B, T, kv_per_head, N)
TRACE LOAD_FAST k []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST K_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
TRACE FX call add__1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:563 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = k.add_(K_bias).view(B, T, kv_per_head, N)
            ~~~~~~^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_per_head [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:563 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = k.add_(K_bias).view(B, T, kv_per_head, N)
            ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:564 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            v = v.add_(V_bias).view(B, T, kv_per_head, N)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST V_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
TRACE FX call add__2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:564 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        v = v.add_(V_bias).view(B, T, kv_per_head, N)
            ~~~~~~^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_per_head [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:564 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        v = v.add_(V_bias).view(B, T, kv_per_head, N)
            ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:568 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            if ln_r is None:
TRACE LOAD_FAST ln_r []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
wrap_to_fake L['ln_r'] (128,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln_r', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln_r_ L['ln_r'] FakeTensor(..., device='cuda:0', size=(128,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE POP_JUMP_IF_TRUE 478 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:572 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
                r = T5RMSNorm(r.view(B,T,H,N), ln_r, variance_epsilon=rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST r [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR view [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:572 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            r = T5RMSNorm(r.view(B,T,H,N), ln_r, variance_epsilon=rmsnorm_epsilon)
                          ~~~~~~^^^^^^^^^
TRACE LOAD_FAST ln_r [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE KW_NAMES ('variance_epsilon',) [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:572 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            r = T5RMSNorm(r.view(B,T,H,N), ln_r, variance_epsilon=rmsnorm_epsilon)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST r [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:573 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
                k = T5RMSNorm(k, ln_k, variance_epsilon=rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln_k [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE KW_NAMES ('variance_epsilon',) [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ConstantVariable(float: 1e-06)]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:573 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = T5RMSNorm(k, ln_k, variance_epsilon=rmsnorm_epsilon)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln_k'] (128,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln_k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln_k_ L['ln_k'] FakeTensor(..., device='cuda:0', size=(128,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:576 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            cos, sin = calc_cos.to(k.dtype), calc_sin.to(k.dtype)
TRACE LOAD_FAST calc_cos []
TRACE LOAD_ATTR to [LazyVariableTracker()]
wrap_to_fake L['calc_cos'] (1, 512, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='calc_cos', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_calc_cos_ L['calc_cos'] FakeTensor(..., device='cuda:0', size=(1, 512, 128)) at debug_level 0 before=False
TRACE LOAD_FAST k [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR dtype [NullVariable, GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_8 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:576 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        cos, sin = calc_cos.to(k.dtype), calc_sin.to(k.dtype)
                   ~~~~~~~~~~~^^^^^^^^^
TRACE LOAD_FAST calc_sin [TensorVariable()]
TRACE LOAD_ATTR to [TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['calc_sin'] (1, 512, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='calc_sin', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_calc_sin_ L['calc_sin'] FakeTensor(..., device='cuda:0', size=(1, 512, 128)) at debug_level 0 before=False
TRACE LOAD_FAST k [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR dtype [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE CALL 1 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_9 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:576 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        cos, sin = calc_cos.to(k.dtype), calc_sin.to(k.dtype)
                                         ~~~~~~~~~~~^^^^^^^^^
TRACE STORE_FAST sin [TensorVariable(), TensorVariable()]
TRACE STORE_FAST cos [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:577 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            r, k = apply_rotary_pos_emb(r, k, cos, sin,unsqueeze_dim=2)
TRACE LOAD_GLOBAL apply_rotary_pos_emb []
TRACE LOAD_FAST r [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST cos [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST sin [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE KW_NAMES ('unsqueeze_dim',) [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(int: 2)]
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(int: 2)]
TRACE inlined call apply_rotary_pos_emb from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:577 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        r, k = apply_rotary_pos_emb(r, k, cos, sin,unsqueeze_dim=2)
               ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object apply_rotary_pos_emb at 0x70c98a344710, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 473>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:473 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    def apply_rotary_pos_emb(q, k, cos, sin, position_ids=None, unsqueeze_dim=1):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:493 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
        cos = cos.unsqueeze(unsqueeze_dim)
TRACE LOAD_FAST cos []
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_FAST unsqueeze_dim [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int: 2)]
TRACE FX call unsqueeze from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:493 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    cos = cos.unsqueeze(unsqueeze_dim)
          ~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST cos [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:494 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
        sin = sin.unsqueeze(unsqueeze_dim)
TRACE LOAD_FAST sin []
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_FAST unsqueeze_dim [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int: 2)]
TRACE FX call unsqueeze_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:494 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    sin = sin.unsqueeze(unsqueeze_dim)
          ~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST sin [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
        q_embed = (q * cos) + (rotate_half(q) * sin)
TRACE LOAD_FAST q []
TRACE LOAD_FAST cos [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    q_embed = (q * cos) + (rotate_half(q) * sin)
               ~~^~~~~
TRACE LOAD_GLOBAL rotate_half [TensorVariable()]
TRACE LOAD_FAST q [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE inlined call rotate_half from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    q_embed = (q * cos) + (rotate_half(q) * sin)
                           ~~~~~~~~~~~^^^
INLINING <code object rotate_half at 0x70c98a344450, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 467>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:467 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    def rotate_half(x):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
        x1 = x[..., : x.shape[-1] // 2]
TRACE LOAD_FAST x []
TRACE LOAD_CONST Ellipsis [TensorVariable()]
TRACE LOAD_CONST None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis)]
TRACE LOAD_FAST x [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None)]
TRACE LOAD_ATTR shape [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), SizeVariable(length=4)]
TRACE BINARY_SUBSCR None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), SizeVariable(length=4), ConstantVariable(int: -1)]
TRACE LOAD_CONST 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), ConstantVariable(int: 128)]
TRACE BINARY_OP 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), ConstantVariable(int: 128), ConstantVariable(int: 2)]
TRACE BUILD_SLICE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), ConstantVariable(int: 64)]
TRACE BUILD_TUPLE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SliceVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), TupleVariable(length=2)]
TRACE FX call getitem_8 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    x1 = x[..., : x.shape[-1] // 2]
         ~^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST x1 [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
        x2 = x[..., x.shape[-1] // 2 :]
TRACE LOAD_FAST x []
TRACE LOAD_CONST Ellipsis [TensorVariable()]
TRACE LOAD_FAST x [TensorVariable(), ConstantVariable(ellipsis: Ellipsis)]
TRACE LOAD_ATTR shape [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SizeVariable(length=4)]
TRACE BINARY_SUBSCR None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SizeVariable(length=4), ConstantVariable(int: -1)]
TRACE LOAD_CONST 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 128)]
TRACE BINARY_OP 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 128), ConstantVariable(int: 2)]
TRACE LOAD_CONST None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 64)]
TRACE BUILD_SLICE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 64), ConstantVariable(NoneType: None)]
TRACE BUILD_TUPLE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SliceVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), TupleVariable(length=2)]
TRACE FX call getitem_9 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    x2 = x[..., x.shape[-1] // 2 :]
         ~^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST x2 [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
        return torch.cat((-x2, x1), dim=-1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST x2 [NullVariable, LazyVariableTracker()]
TRACE UNARY_NEGATIVE None [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call neg from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    return torch.cat((-x2, x1), dim=-1)
                      ^^^
TRACE LOAD_FAST x1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, LazyVariableTracker(), TupleVariable(length=2)]
TRACE KW_NAMES ('dim',) [NullVariable, LazyVariableTracker(), TupleVariable(length=2), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TupleVariable(length=2), ConstantVariable(int: -1)]
TRACE FX call cat from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    return torch.cat((-x2, x1), dim=-1)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object rotate_half at 0x70c98a344450, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 467>
TRACE LOAD_FAST sin [TensorVariable(), TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call mul_7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    q_embed = (q * cos) + (rotate_half(q) * sin)
                           ~~~~~~~~~~~~~~~^~~~~
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable()]
TRACE FX call add_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    q_embed = (q * cos) + (rotate_half(q) * sin)
              ~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST q_embed [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
        k_embed = (k * cos) + (rotate_half(k) * sin)
TRACE LOAD_FAST k []
TRACE LOAD_FAST cos [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_8 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    k_embed = (k * cos) + (rotate_half(k) * sin)
               ~~^~~~~
TRACE LOAD_GLOBAL rotate_half [TensorVariable()]
TRACE LOAD_FAST k [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE inlined call rotate_half from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    k_embed = (k * cos) + (rotate_half(k) * sin)
                           ~~~~~~~~~~~^^^
INLINING <code object rotate_half at 0x70c98a344450, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 467>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:467 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    def rotate_half(x):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
        x1 = x[..., : x.shape[-1] // 2]
TRACE LOAD_FAST x []
TRACE LOAD_CONST Ellipsis [TensorVariable()]
TRACE LOAD_CONST None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis)]
TRACE LOAD_FAST x [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None)]
TRACE LOAD_ATTR shape [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), SizeVariable(length=4)]
TRACE BINARY_SUBSCR None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), SizeVariable(length=4), ConstantVariable(int: -1)]
TRACE LOAD_CONST 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), ConstantVariable(int: 128)]
TRACE BINARY_OP 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), ConstantVariable(int: 128), ConstantVariable(int: 2)]
TRACE BUILD_SLICE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), ConstantVariable(int: 64)]
TRACE BUILD_TUPLE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SliceVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), TupleVariable(length=2)]
TRACE FX call getitem_10 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    x1 = x[..., : x.shape[-1] // 2]
         ~^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST x1 [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
        x2 = x[..., x.shape[-1] // 2 :]
TRACE LOAD_FAST x []
TRACE LOAD_CONST Ellipsis [TensorVariable()]
TRACE LOAD_FAST x [TensorVariable(), ConstantVariable(ellipsis: Ellipsis)]
TRACE LOAD_ATTR shape [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SizeVariable(length=4)]
TRACE BINARY_SUBSCR None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SizeVariable(length=4), ConstantVariable(int: -1)]
TRACE LOAD_CONST 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 128)]
TRACE BINARY_OP 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 128), ConstantVariable(int: 2)]
TRACE LOAD_CONST None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 64)]
TRACE BUILD_SLICE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 64), ConstantVariable(NoneType: None)]
TRACE BUILD_TUPLE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SliceVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), TupleVariable(length=2)]
TRACE FX call getitem_11 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    x2 = x[..., x.shape[-1] // 2 :]
         ~^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST x2 [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
        return torch.cat((-x2, x1), dim=-1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST x2 [NullVariable, LazyVariableTracker()]
TRACE UNARY_NEGATIVE None [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call neg_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    return torch.cat((-x2, x1), dim=-1)
                      ^^^
TRACE LOAD_FAST x1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, LazyVariableTracker(), TupleVariable(length=2)]
TRACE KW_NAMES ('dim',) [NullVariable, LazyVariableTracker(), TupleVariable(length=2), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TupleVariable(length=2), ConstantVariable(int: -1)]
TRACE FX call cat_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    return torch.cat((-x2, x1), dim=-1)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object rotate_half at 0x70c98a344450, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 467>
TRACE LOAD_FAST sin [TensorVariable(), TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call mul_9 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    k_embed = (k * cos) + (rotate_half(k) * sin)
                           ~~~~~~~~~~~~~~~^~~~~
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable()]
TRACE FX call add_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    k_embed = (k * cos) + (rotate_half(k) * sin)
              ~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST k_embed [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:497 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
        return q_embed, k_embed
TRACE LOAD_FAST q_embed []
TRACE LOAD_FAST k_embed [TensorVariable()]
TRACE BUILD_TUPLE 2 [TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object apply_rotary_pos_emb at 0x70c98a344710, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 473>
TRACE UNPACK_SEQUENCE 2 [TupleVariable(length=2)]
TRACE STORE_FAST r [TensorVariable(), TensorVariable()]
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:579 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            if layer_id == 0:
TRACE LOAD_FAST layer_id []
TRACE LOAD_CONST 0 [LazyVariableTracker()]
TRACE COMPARE_OP == [LazyVariableTracker(), ConstantVariable(int: 0)]
TRACE POP_JUMP_IF_FALSE 736 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:580 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
                v_first = v
TRACE LOAD_FAST v []
TRACE STORE_FAST v_first [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:581 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
                k_first = k
TRACE LOAD_FAST k []
TRACE STORE_FAST k_first [TensorVariable()]
TRACE JUMP_FORWARD 952 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:589 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = repeat_kv(k, kv_repeat).view(B, T, -1)
TRACE LOAD_GLOBAL repeat_kv []
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST kv_repeat [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 8)]
TRACE inlined call repeat_kv from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:589 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = repeat_kv(k, kv_repeat).view(B, T, -1)
            ~~~~~~~~~^^^^^^^^^^^^^^
INLINING <code object repeat_kv at 0x70c98a2f25b0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 347>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:347 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    def repeat_kv(hidden_states: torch.Tensor, n_rep: int) -> torch.Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:353 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        B, T, H_kv, D = hidden_states.shape
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 4 [SizeVariable(length=4)]
TRACE STORE_FAST B [ConstantVariable(int: 128), ConstantVariable(int: 8), ConstantVariable(int: 512), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 128), ConstantVariable(int: 8), ConstantVariable(int: 512)]
TRACE STORE_FAST H_kv [ConstantVariable(int: 128), ConstantVariable(int: 8)]
TRACE STORE_FAST D [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:354 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        if n_rep == 1:
TRACE LOAD_FAST n_rep []
TRACE LOAD_CONST 1 [ConstantVariable(int: 8)]
TRACE COMPARE_OP == [ConstantVariable(int: 8), ConstantVariable(int: 1)]
TRACE POP_JUMP_IF_FALSE 50 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:357 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        hidden_states = hidden_states[:, :, :, None, :]  # (B, T, H_kv, 1, D)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_CONST None [TensorVariable()]
TRACE LOAD_CONST None [TensorVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable()]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable()]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable()]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE BUILD_TUPLE 5 [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), SliceVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), TupleVariable(length=5)]
TRACE FX call getitem_12 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:357 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    hidden_states = hidden_states[:, :, :, None, :]  # (B, T, H_kv, 1, D)
                    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:358 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        hidden_states = hidden_states.expand(B, T, H_kv, n_rep, D)  # (B, T, H_kv, n_rep, D)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR expand [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), expand)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1)]
TRACE LOAD_FAST H_kv [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST n_rep [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8)]
TRACE LOAD_FAST D [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8), ConstantVariable(int: 8)]
TRACE CALL 5 [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call expand from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:358 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    hidden_states = hidden_states.expand(B, T, H_kv, n_rep, D)  # (B, T, H_kv, n_rep, D)
                    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR reshape [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), reshape)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1)]
TRACE LOAD_FAST H_kv [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST n_rep [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8)]
TRACE BINARY_OP 5 [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8), ConstantVariable(int: 8)]
TRACE LOAD_FAST D [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call reshape from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR contiguous [TensorVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE FX call contiguous from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object repeat_kv at 0x70c98a2f25b0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 347>
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: -1)]
TRACE FX call view_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:589 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = repeat_kv(k, kv_repeat).view(B, T, -1)
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:590 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            v = repeat_kv(v, kv_repeat).view(B, T, -1)
TRACE LOAD_GLOBAL repeat_kv []
TRACE LOAD_FAST v [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST kv_repeat [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 8)]
TRACE inlined call repeat_kv from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:590 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        v = repeat_kv(v, kv_repeat).view(B, T, -1)
            ~~~~~~~~~^^^^^^^^^^^^^^
INLINING <code object repeat_kv at 0x70c98a2f25b0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 347>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:347 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    def repeat_kv(hidden_states: torch.Tensor, n_rep: int) -> torch.Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:353 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        B, T, H_kv, D = hidden_states.shape
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 4 [SizeVariable(length=4)]
TRACE STORE_FAST B [ConstantVariable(int: 128), ConstantVariable(int: 8), ConstantVariable(int: 512), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 128), ConstantVariable(int: 8), ConstantVariable(int: 512)]
TRACE STORE_FAST H_kv [ConstantVariable(int: 128), ConstantVariable(int: 8)]
TRACE STORE_FAST D [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:354 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        if n_rep == 1:
TRACE LOAD_FAST n_rep []
TRACE LOAD_CONST 1 [ConstantVariable(int: 8)]
TRACE COMPARE_OP == [ConstantVariable(int: 8), ConstantVariable(int: 1)]
TRACE POP_JUMP_IF_FALSE 50 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:357 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        hidden_states = hidden_states[:, :, :, None, :]  # (B, T, H_kv, 1, D)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_CONST None [TensorVariable()]
TRACE LOAD_CONST None [TensorVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable()]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable()]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable()]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE BUILD_TUPLE 5 [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), SliceVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), TupleVariable(length=5)]
TRACE FX call getitem_13 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:357 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    hidden_states = hidden_states[:, :, :, None, :]  # (B, T, H_kv, 1, D)
                    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:358 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        hidden_states = hidden_states.expand(B, T, H_kv, n_rep, D)  # (B, T, H_kv, n_rep, D)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR expand [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), expand)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1)]
TRACE LOAD_FAST H_kv [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST n_rep [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8)]
TRACE LOAD_FAST D [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8), ConstantVariable(int: 8)]
TRACE CALL 5 [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call expand_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:358 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    hidden_states = hidden_states.expand(B, T, H_kv, n_rep, D)  # (B, T, H_kv, n_rep, D)
                    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR reshape [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), reshape)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1)]
TRACE LOAD_FAST H_kv [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST n_rep [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8)]
TRACE BINARY_OP 5 [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8), ConstantVariable(int: 8)]
TRACE LOAD_FAST D [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call reshape_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR contiguous [TensorVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE FX call contiguous_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object repeat_kv at 0x70c98a2f25b0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 347>
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: -1)]
TRACE FX call view_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:590 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        v = repeat_kv(v, kv_repeat).view(B, T, -1)
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:593 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            a = torch.sigmoid(xa @ a2 + a0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR sigmoid [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST xa [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST a2 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 4 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['a2'] (160, 8192) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='a2', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_a2_ L['a2'] FakeTensor(..., device='cuda:0', size=(160, 8192), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call matmul_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:593 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        a = torch.sigmoid(xa @ a2 + a0)
                          ~~~^~~~
TRACE LOAD_FAST a0 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['a0'] (1, 1, 8192) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='a0', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_a0_ L['a0'] FakeTensor(..., device='cuda:0', size=(1, 1, 8192), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call add_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:593 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        a = torch.sigmoid(xa @ a2 + a0)
                          ~~~~~~~~^~~~
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call sigmoid from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:593 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        a = torch.sigmoid(xa @ a2 + a0)
            ~~~~~~~~~~~~~^^^^^^^^^^^^^^
TRACE STORE_FAST a [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:595 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            kk = F.normalize(k.view(B, T, H, N), p=2.0, dim=-1).view(B, T, H*N)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR normalize [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR view [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:595 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        kk = F.normalize(k.view(B, T, H, N), p=2.0, dim=-1).view(B, T, H*N)
                         ~~~~~~^^^^^^^^^^^^
TRACE LOAD_CONST 2.0 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 2.0)]
TRACE KW_NAMES ('p', 'dim') [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 2.0), ConstantVariable(int: -1)]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 2.0), ConstantVariable(int: -1)]
TRACE FX call normalize from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:595 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        kk = F.normalize(k.view(B, T, H, N), p=2.0, dim=-1).view(B, T, H*N)
             ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64)]
TRACE BINARY_OP 5 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8192)]
TRACE FX call view_8 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:595 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        kk = F.normalize(k.view(B, T, H, N), p=2.0, dim=-1).view(B, T, H*N)
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
TRACE STORE_FAST kk [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:596 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            w = torch.tanh(xw) @ w2 + w0
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR tanh [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST xw [NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call tanh from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:596 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = torch.tanh(xw) @ w2 + w0
            ~~~~~~~~~~^^^^
TRACE LOAD_FAST w2 [TensorVariable()]
TRACE BINARY_OP 4 [TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['w2'] (480, 8192) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='w2', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_w2_ L['w2'] FakeTensor(..., device='cuda:0', size=(480, 8192), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call matmul_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:596 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = torch.tanh(xw) @ w2 + w0
            ~~~~~~~~~~~~~~~^~~~
TRACE LOAD_FAST w0 [TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['w0'] (1, 1, 8192) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='w0', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_w0_ L['w0'] FakeTensor(..., device='cuda:0', size=(1, 1, 8192), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call add_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:596 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = torch.tanh(xw) @ w2 + w0
            ~~~~~~~~~~~~~~~~~~~~^~~~
TRACE STORE_FAST w [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:597 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            w = -F.softplus(-w) - 0.5
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR softplus [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST w [NullVariable, LazyVariableTracker()]
TRACE UNARY_NEGATIVE None [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call neg_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:597 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = -F.softplus(-w) - 0.5
                        ^^
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call softplus from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:597 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = -F.softplus(-w) - 0.5
             ~~~~~~~~~~^^^^
TRACE UNARY_NEGATIVE None [TensorVariable()]
TRACE FX call neg_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:597 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = -F.softplus(-w) - 0.5
            ^^^^^^^^^^^^^^^
TRACE LOAD_CONST 0.5 [TensorVariable()]
TRACE BINARY_OP 10 [TensorVariable(), ConstantVariable(float: 0.5)]
TRACE FX call sub from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:597 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = -F.softplus(-w) - 0.5
            ~~~~~~~~~~~~~~~~^~~~~
TRACE STORE_FAST w [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:598 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = k * (1.0 - w + a)
TRACE LOAD_FAST k []
TRACE LOAD_CONST 1.0 [TensorVariable()]
TRACE LOAD_FAST w [TensorVariable(), ConstantVariable(float: 1.0)]
TRACE BINARY_OP 10 [TensorVariable(), ConstantVariable(float: 1.0), TensorVariable()]
TRACE FX call sub_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:598 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = k * (1.0 - w + a)
                 ~~~~^~~
TRACE LOAD_FAST a [TensorVariable(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call add_7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:598 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = k * (1.0 - w + a)
                 ~~~~~~~~^~~
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_10 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:598 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = k * (1.0 - w + a)
            ~~^~~~~~~~~~~~~~~
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:600 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            aa = -kk
TRACE LOAD_FAST kk []
TRACE UNARY_NEGATIVE None [TensorVariable()]
TRACE FX call neg_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:600 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        aa = -kk
             ^^^
TRACE STORE_FAST aa [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:601 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            bb = kk * a
TRACE LOAD_FAST kk []
TRACE LOAD_FAST a [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_11 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:601 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        bb = kk * a
             ~~~^~~
TRACE STORE_FAST bb [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:603 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            w = -w.exp()#.to(dtype=torch.float32).exp()
TRACE LOAD_FAST w []
TRACE LOAD_ATTR exp [TensorVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), exp)]
TRACE FX call exp from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:603 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = -w.exp()#.to(dtype=torch.float32).exp()
             ~~~~~^^
TRACE UNARY_NEGATIVE None [TensorVariable()]
TRACE FX call neg_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:603 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = -w.exp()#.to(dtype=torch.float32).exp()
            ^^^^^^^^
TRACE STORE_FAST w [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:604 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            r_,w_,k_,v_,aa_,bb_ = [i.view(B,T,H,N) for i in [r,w,k,v,aa,bb]]
TRACE LOAD_FAST r []
TRACE LOAD_FAST w [TensorVariable()]
TRACE LOAD_FAST k [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST v [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST aa [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST bb [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 6 [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE GET_ITER None [TupleVariable(length=6)]
TRACE LOAD_FAST_AND_CLEAR i [ListIteratorVariable(length=6, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=6, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=6, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=6, index=0), ListVariable(length=0)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=0)]
TRACE STORE_FAST i [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), TensorVariable()]
TRACE LOAD_FAST i [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1)]
TRACE LOAD_ATTR view [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_9 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:604 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        r_,w_,k_,v_,aa_,bb_ = [i.view(B,T,H,N) for i in [r,w,k,v,aa,bb]]
                               ~~~~~~^^^^^^^^^
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), TensorVariable()]
TRACE JUMP_BACKWARD 1448 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=1)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=1)]
TRACE STORE_FAST i [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), TensorVariable()]
TRACE LOAD_FAST i [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2)]
TRACE LOAD_ATTR view [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), TensorVariable()]
TRACE JUMP_BACKWARD 1448 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=2)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=2)]
TRACE STORE_FAST i [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), TensorVariable()]
TRACE LOAD_FAST i [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3)]
TRACE LOAD_ATTR view [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), TensorVariable()]
TRACE JUMP_BACKWARD 1448 [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=3)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=3)]
TRACE STORE_FAST i [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), TensorVariable()]
TRACE LOAD_FAST i [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4)]
TRACE LOAD_ATTR view [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), TensorVariable()]
TRACE JUMP_BACKWARD 1448 [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=4)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=4)]
TRACE STORE_FAST i [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), TensorVariable()]
TRACE LOAD_FAST i [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5)]
TRACE LOAD_ATTR view [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), TensorVariable()]
TRACE JUMP_BACKWARD 1448 [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=5)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=5)]
TRACE STORE_FAST i [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), TensorVariable()]
TRACE LOAD_FAST i [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6)]
TRACE LOAD_ATTR view [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), TensorVariable()]
TRACE JUMP_BACKWARD 1448 [NullVariable, ListVariable(length=6), ListIteratorVariable(length=6, index=6)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=6), ListIteratorVariable(length=6, index=6)]
TRACE END_FOR None [NullVariable, ListVariable(length=6), ListIteratorVariable(length=6, index=6), ConstantVariable(NoneType: None)]
TRACE SWAP 2 [NullVariable, ListVariable(length=6)]
TRACE STORE_FAST i [ListVariable(length=6), NullVariable]
TRACE UNPACK_SEQUENCE 6 [ListVariable(length=6)]
TRACE STORE_FAST r_ [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST w_ [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST k_ [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST v_ [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST aa_ [TensorVariable(), TensorVariable()]
TRACE STORE_FAST bb_ [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:605 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            B,T,_,_ = r_.shape
TRACE LOAD_FAST r_ []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 4 [SizeVariable(length=4)]
TRACE STORE_FAST B [ConstantVariable(int: 128), ConstantVariable(int: 64), ConstantVariable(int: 512), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 128), ConstantVariable(int: 64), ConstantVariable(int: 512)]
TRACE STORE_FAST _ [ConstantVariable(int: 128), ConstantVariable(int: 64)]
TRACE STORE_FAST _ [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:609 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            xx, state = fused_recurrent_rwkv7(r_, w_, k_, v_, aa_, bb_, scale=1.0, initial_state=state, output_final_state=True, head_first=False)
TRACE LOAD_GLOBAL fused_recurrent_rwkv7 []
TRACE LOAD_FAST r_ [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST w_ [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST k_ [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST v_ [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST aa_ [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST bb_ [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 1.0 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST state [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0)]
TRACE LOAD_CONST True [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker()]
TRACE LOAD_CONST False [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True)]
TRACE KW_NAMES ('scale', 'initial_state', 'output_final_state', 'head_first') [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(bool: False)]
TRACE CALL 10 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(bool: False)]
TRACE inlined call fused_recurrent_rwkv7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:609 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx, state = fused_recurrent_rwkv7(r_, w_, k_, v_, aa_, bb_, scale=1.0, initial_state=state, output_final_state=True, head_first=False)
                    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object fused_recurrent_rwkv7 at 0x70c98d0c9890, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py", line 11>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:11 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
    def fused_recurrent_rwkv7(
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:50 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
        return fused_recurrent_dplr_delta_rule(
TRACE LOAD_GLOBAL fused_recurrent_dplr_delta_rule []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:51 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            q=r,
TRACE LOAD_FAST r [NullVariable, LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:52 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            k=k,
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:53 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            v=v,
TRACE LOAD_FAST v [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:54 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            a=a,
TRACE LOAD_FAST a [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:55 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            b=b,
TRACE LOAD_FAST b [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:56 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            gk=log_w,
TRACE LOAD_FAST log_w [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:57 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            scale=scale,
TRACE LOAD_FAST scale [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:58 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            initial_state=initial_state,
TRACE LOAD_FAST initial_state [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:59 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            output_final_state=output_final_state,
TRACE LOAD_FAST output_final_state [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:60 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            cu_seqlens=cu_seqlens,
TRACE LOAD_FAST cu_seqlens [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:61 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            head_first=head_first
TRACE LOAD_FAST head_first [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:50 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
        return fused_recurrent_dplr_delta_rule(
TRACE KW_NAMES ('q', 'k', 'v', 'a', 'b', 'gk', 'scale', 'initial_state', 'output_final_state', 'cu_seqlens', 'head_first') [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(NoneType: None), ConstantVariable(bool: False)]
TRACE CALL 11 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(NoneType: None), ConstantVariable(bool: False)]
TRACE inlined call fused_recurrent_dplr_delta_rule from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:50 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
    return fused_recurrent_dplr_delta_rule(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        q=r,
        ^^^^
        k=k,
        ^^^^
        v=v,
        ^^^^
        a=a,
        ^^^^
        b=b,
        ^^^^
        gk=log_w,
        ^^^^^^^^^
        scale=scale,
        ^^^^^^^^^^^^
        initial_state=initial_state,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        output_final_state=output_final_state,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        cu_seqlens=cu_seqlens,
        ^^^^^^^^^^^^^^^^^^^^^^
        head_first=head_first
        ^^^^^^^^^^^^^^^^^^^^^
    )
    ^
INLINING <code object fused_recurrent_dplr_delta_rule at 0x305fb4e0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 188>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:188 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
    def fused_recurrent_dplr_delta_rule(
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:231 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
        if cu_seqlens is not None:
TRACE LOAD_FAST cu_seqlens []
TRACE LOAD_CONST None [ConstantVariable(NoneType: None)]
TRACE IS_OP 0 [ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 282 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:240 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
        if scale is None:
TRACE LOAD_FAST scale []
TRACE LOAD_CONST None [ConstantVariable(float: 1.0)]
TRACE IS_OP 1 [ConstantVariable(float: 1.0), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 328 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:243 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            assert scale > 0, "scale must be positive"
TRACE LOAD_FAST scale []
TRACE LOAD_CONST 0 [ConstantVariable(float: 1.0)]
TRACE COMPARE_OP > [ConstantVariable(float: 1.0), ConstantVariable(int: 0)]
TRACE POP_JUMP_IF_TRUE 352 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:244 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
        o, final_state = FusedRecurrentDPLRDeltaRuleFunction.apply(
TRACE LOAD_GLOBAL FusedRecurrentDPLRDeltaRuleFunction []
TRACE LOAD_ATTR apply [LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:245 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            q,
TRACE LOAD_FAST q [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:246 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            k,
TRACE LOAD_FAST k [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:247 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            v,
TRACE LOAD_FAST v [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:248 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            a,
TRACE LOAD_FAST a [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:249 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            b,
TRACE LOAD_FAST b [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:250 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            gk,
TRACE LOAD_FAST gk [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:251 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            scale,
TRACE LOAD_FAST scale [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:252 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            initial_state,
TRACE LOAD_FAST initial_state [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:253 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            output_final_state,
TRACE LOAD_FAST output_final_state [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:254 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            cu_seqlens,
TRACE LOAD_FAST cu_seqlens [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:255 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            head_first
TRACE LOAD_FAST head_first [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:244 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
        o, final_state = FusedRecurrentDPLRDeltaRuleFunction.apply(
TRACE CALL 11 [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(NoneType: None), ConstantVariable(bool: False)]
wrap_to_fake L['state'] (1, 64, 128, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None], constraint_strides=[None, None, None, None], specialize_on=[[], [], [], []], view_base_context=StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='state', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}), tensor_source=LocalSource(local_name='state', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_state_ L['state'] FakeTensor(..., device='cuda:0', size=(1, 64, 128, 128), dtype=torch.bfloat16) at debug_level 0 before=False
wrap_to_fake L['state']._base (56, 1, 64, 128, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='state', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
TRACE inlined call wrapper from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:244 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
    o, final_state = FusedRecurrentDPLRDeltaRuleFunction.apply(
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        q,
        ^^
        k,
        ^^
        v,
        ^^
        a,
        ^^
        b,
        ^^
        gk,
        ^^^
        scale,
        ^^^^^^
        initial_state,
        ^^^^^^^^^^^^^^
        output_final_state,
        ^^^^^^^^^^^^^^^^^^^
        cu_seqlens,
        ^^^^^^^^^^^
        head_first
        ^^^^^^^^^^
    )
    ^
INLINING <code object wrapper at 0x70c98d04f0a0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 16>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 1 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:16 in wrapper (contiguous) (inline depth: 3)
        @functools.wraps(fn)
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:18 in wrapper (contiguous.wrapper) (inline depth: 3)
            return fn(ctx,
TRACE PUSH_NULL None []
TRACE LOAD_DEREF fn [NullVariable]
TRACE LOAD_FAST ctx [NullVariable, LazyVariableTracker()]
TRACE BUILD_LIST 1 [NullVariable, LazyVariableTracker(), AutogradFunctionContextVariable(Function)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:19 in wrapper (contiguous.wrapper) (inline depth: 3)
                      *(i if not isinstance(i, torch.Tensor) else i.contiguous() for i in args),
TRACE LOAD_CONST <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19> [NullVariable, LazyVariableTracker(), ListVariable(length=1)]
TRACE MAKE_FUNCTION 0 [NullVariable, LazyVariableTracker(), ListVariable(length=1), ConstantVariable(code: <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker(), ListVariable(length=1), NestedUserFunctionVariable()]
TRACE GET_ITER None [NullVariable, LazyVariableTracker(), ListVariable(length=1), NestedUserFunctionVariable(), TupleVariable(length=11)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), ListVariable(length=1), NestedUserFunctionVariable(), ListIteratorVariable(length=11, index=0)]
TRACE inlined call <genexpr> from /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:19 in wrapper (contiguous.wrapper) (inline depth: 3)
                  *(i if not isinstance(i, torch.Tensor) else i.contiguous() for i in args),
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:18 in wrapper (contiguous.wrapper) (inline depth: 3)
            return fn(ctx,
TRACE LIST_EXTEND 1 [NullVariable, LazyVariableTracker(), ListVariable(length=1), LocalGeneratorObjectVariable(<genexpr>)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:19 in <genexpr> (contiguous.wrapper) (inline depth: 4)
                      *(i if not isinstance(i, torch.Tensor) else i.contiguous() for i in args),
TRACE RETURN_GENERATOR None [BuiltinVariable(None)]
TRACE POP_TOP None [BuiltinVariable(None)]
TRACE RESUME 0 []
TRACE LOAD_FAST .0 []
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=0)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=1), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=1)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=1), NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=1), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=1), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=1), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=1), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=1)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=1), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=1), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE FX call contiguous_2 from /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:19 in <genexpr> (contiguous.wrapper) (inline depth: 4)
                  *(i if not isinstance(i, torch.Tensor) else i.contiguous() for i in args),
                                                              ~~~~~~~~~~~~^^
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=1), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=1), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=1), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=1)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=1)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=2), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=2)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=2), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=2), NullVariable, BuiltinVariable(isinstance), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=2), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=2), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=2), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=2)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=2), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=2), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=2), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=2), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=2), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=2)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=2)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=3), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=3)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=3), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=3), NullVariable, BuiltinVariable(isinstance), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=3), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=3), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=3), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=3)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=3), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=3), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=3), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=3), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=3), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=3)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=3)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=4), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=4)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=4), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=4), NullVariable, BuiltinVariable(isinstance), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=4), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=4), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=4), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=4)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=4), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=4), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=4), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=4), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=4), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=4)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=4)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=5), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=5)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=5), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=5), NullVariable, BuiltinVariable(isinstance), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=5), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=5), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=5), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=5)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=5), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=5), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=5), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=5), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=5), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=5)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=5)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=6), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=6)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=6), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=6), NullVariable, BuiltinVariable(isinstance), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=6), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=6), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=6), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=6)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=6), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=6), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=6), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=6), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=6), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=6)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=6)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=7), ConstantVariable(float: 1.0)]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=7)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=7), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=7), NullVariable, BuiltinVariable(isinstance), ConstantVariable(float: 1.0)]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=7), NullVariable, BuiltinVariable(isinstance), ConstantVariable(float: 1.0), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=7), NullVariable, BuiltinVariable(isinstance), ConstantVariable(float: 1.0), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=7), ConstantVariable(bool: False)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=7)]
TRACE JUMP_FORWARD 100 [ListIteratorVariable(length=11, index=7), ConstantVariable(float: 1.0)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=7), ConstantVariable(float: 1.0)]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=7), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=7), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=7)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=7)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=8), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=8)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=8), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=8), NullVariable, BuiltinVariable(isinstance), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=8), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=8), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=8), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=8)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=8), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=8), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=8), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=8), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=8), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=8)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=8)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=9), ConstantVariable(bool: True)]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=9)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=9), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=9), NullVariable, BuiltinVariable(isinstance), ConstantVariable(bool: True)]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=9), NullVariable, BuiltinVariable(isinstance), ConstantVariable(bool: True), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=9), NullVariable, BuiltinVariable(isinstance), ConstantVariable(bool: True), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=9), ConstantVariable(bool: False)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=9)]
TRACE JUMP_FORWARD 100 [ListIteratorVariable(length=11, index=9), ConstantVariable(bool: True)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=9), ConstantVariable(bool: True)]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=9), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=9), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=9)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=9)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=10), ConstantVariable(NoneType: None)]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=10)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=10), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=10), NullVariable, BuiltinVariable(isinstance), ConstantVariable(NoneType: None)]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=10), NullVariable, BuiltinVariable(isinstance), ConstantVariable(NoneType: None), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=10), NullVariable, BuiltinVariable(isinstance), ConstantVariable(NoneType: None), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=10), ConstantVariable(bool: False)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=10)]
TRACE JUMP_FORWARD 100 [ListIteratorVariable(length=11, index=10), ConstantVariable(NoneType: None)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=10), ConstantVariable(NoneType: None)]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=10), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=10), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=10)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=10)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=11), ConstantVariable(bool: False)]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=11)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=11), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=11), NullVariable, BuiltinVariable(isinstance), ConstantVariable(bool: False)]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=11), NullVariable, BuiltinVariable(isinstance), ConstantVariable(bool: False), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=11), NullVariable, BuiltinVariable(isinstance), ConstantVariable(bool: False), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=11), ConstantVariable(bool: False)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=11)]
TRACE JUMP_FORWARD 100 [ListIteratorVariable(length=11, index=11), ConstantVariable(bool: False)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=11), ConstantVariable(bool: False)]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=11), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=11), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=11)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=11)]
TRACE END_FOR None [ListIteratorVariable(length=11, index=11), ConstantVariable(NoneType: None)]
TRACE RETURN_CONST None []
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE CALL_INTRINSIC_1 6 [NullVariable, LazyVariableTracker(), ListVariable(length=12)]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=12)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:20 in wrapper (contiguous.wrapper) (inline depth: 3)
                      **{k: (v if not isinstance(v, torch.Tensor) else v.contiguous()) for k, v in kwargs.items()})
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable()]
TRACE LOAD_ATTR items [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ConstDictVariable()]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 180 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE SWAP 3 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST v [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ConstDictVariable(), NullVariable, NullVariable]
TRACE STORE_FAST k [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ConstDictVariable(), NullVariable]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:18 in wrapper (contiguous.wrapper) (inline depth: 3)
            return fn(ctx,
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable()]
TRACE inlined call forward from /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:18 in wrapper (contiguous.wrapper) (inline depth: 3)
        return fn(ctx,
               ~~^^^^^
                  *(i if not isinstance(i, torch.Tensor) else i.contiguous() for i in args),
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                  **{k: (v if not isinstance(v, torch.Tensor) else v.contiguous()) for k, v in kwargs.items()})
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object forward at 0x3060e8b0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 124>, inlined according trace_rules.lookup inlined by default
TRACE MAKE_CELL H []
TRACE MAKE_CELL N []
TRACE MAKE_CELL V []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:124 in forward (FusedRecurrentDPLRDeltaRuleFunction) (inline depth: 4)
        @staticmethod
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:140 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            if head_first:
TRACE LOAD_FAST head_first []
TRACE POP_JUMP_IF_FALSE 86 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:143 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
                B, T, H, K, V = *k.shape, v.shape[-1]
TRACE BUILD_LIST 0 []
TRACE LOAD_FAST k [ListVariable(length=0)]
TRACE LOAD_ATTR shape [ListVariable(length=0), TensorVariable()]
TRACE LIST_EXTEND 1 [ListVariable(length=0), SizeVariable(length=4)]
TRACE LOAD_FAST v [ListVariable(length=4)]
TRACE LOAD_ATTR shape [ListVariable(length=4), TensorVariable()]
TRACE LOAD_CONST -1 [ListVariable(length=4), SizeVariable(length=4)]
TRACE BINARY_SUBSCR None [ListVariable(length=4), SizeVariable(length=4), ConstantVariable(int: -1)]
TRACE LIST_APPEND 1 [ListVariable(length=4), ConstantVariable(int: 128)]
TRACE CALL_INTRINSIC_1 6 [ListVariable(length=5)]
TRACE UNPACK_SEQUENCE 5 [TupleVariable(length=5)]
TRACE STORE_FAST B [ConstantVariable(int: 128), ConstantVariable(int: 128), ConstantVariable(int: 64), ConstantVariable(int: 512), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 128), ConstantVariable(int: 128), ConstantVariable(int: 64), ConstantVariable(int: 512)]
TRACE STORE_DEREF H [ConstantVariable(int: 128), ConstantVariable(int: 128), ConstantVariable(int: 64)]
TRACE STORE_FAST K [ConstantVariable(int: 128), ConstantVariable(int: 128)]
TRACE STORE_DEREF V [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:144 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            N = B if offsets is None else len(offsets) - 1
TRACE LOAD_FAST offsets []
TRACE LOAD_CONST None [ConstantVariable(NoneType: None)]
TRACE IS_OP 1 [ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 170 [ConstantVariable(bool: False)]
TRACE LOAD_FAST B []
TRACE JUMP_FORWARD 196 [ConstantVariable(int: 1)]
TRACE STORE_DEREF N [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:146 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            BK = triton.next_power_of_2(K)
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR next_power_of_2 [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST K [NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:146 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
        BK = triton.next_power_of_2(K)
             ~~~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=1)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=1, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=1, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=1, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=1, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=1), ConstantVariable(int: 128)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 6)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 6)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 6)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 6)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 6)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 128)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=1), ConstantVariable(int: 128)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=1, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=1, index=1)]
TRACE END_FOR None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=1, index=1), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=1)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=1)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=1), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=1), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=1), ConstDictVariable()]
TRACE inlined call next_power_of_2 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object next_power_of_2 at 0x70c9a955f730, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 71>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:71 in next_power_of_2 () (inline depth: 6)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:74 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n -= 1
TRACE LOAD_FAST n []
TRACE LOAD_CONST 1 [ConstantVariable(int: 128)]
TRACE BINARY_OP 23 [ConstantVariable(int: 128), ConstantVariable(int: 1)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:75 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n |= n >> 1
TRACE LOAD_FAST n []
TRACE LOAD_FAST n [ConstantVariable(int: 127)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 127), ConstantVariable(int: 127)]
TRACE BINARY_OP 9 [ConstantVariable(int: 127), ConstantVariable(int: 127), ConstantVariable(int: 1)]
TRACE BINARY_OP 20 [ConstantVariable(int: 127), ConstantVariable(int: 63)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:76 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n |= n >> 2
TRACE LOAD_FAST n []
TRACE LOAD_FAST n [ConstantVariable(int: 127)]
TRACE LOAD_CONST 2 [ConstantVariable(int: 127), ConstantVariable(int: 127)]
TRACE BINARY_OP 9 [ConstantVariable(int: 127), ConstantVariable(int: 127), ConstantVariable(int: 2)]
TRACE BINARY_OP 20 [ConstantVariable(int: 127), ConstantVariable(int: 31)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:77 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n |= n >> 4
TRACE LOAD_FAST n []
TRACE LOAD_FAST n [ConstantVariable(int: 127)]
TRACE LOAD_CONST 4 [ConstantVariable(int: 127), ConstantVariable(int: 127)]
TRACE BINARY_OP 9 [ConstantVariable(int: 127), ConstantVariable(int: 127), ConstantVariable(int: 4)]
TRACE BINARY_OP 20 [ConstantVariable(int: 127), ConstantVariable(int: 7)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:78 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n |= n >> 8
TRACE LOAD_FAST n []
TRACE LOAD_FAST n [ConstantVariable(int: 127)]
TRACE LOAD_CONST 8 [ConstantVariable(int: 127), ConstantVariable(int: 127)]
TRACE BINARY_OP 9 [ConstantVariable(int: 127), ConstantVariable(int: 127), ConstantVariable(int: 8)]
TRACE BINARY_OP 20 [ConstantVariable(int: 127), ConstantVariable(int: 0)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:79 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n |= n >> 16
TRACE LOAD_FAST n []
TRACE LOAD_FAST n [ConstantVariable(int: 127)]
TRACE LOAD_CONST 16 [ConstantVariable(int: 127), ConstantVariable(int: 127)]
TRACE BINARY_OP 9 [ConstantVariable(int: 127), ConstantVariable(int: 127), ConstantVariable(int: 16)]
TRACE BINARY_OP 20 [ConstantVariable(int: 127), ConstantVariable(int: 0)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:80 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n |= n >> 32
TRACE LOAD_FAST n []
TRACE LOAD_FAST n [ConstantVariable(int: 127)]
TRACE LOAD_CONST 32 [ConstantVariable(int: 127), ConstantVariable(int: 127)]
TRACE BINARY_OP 9 [ConstantVariable(int: 127), ConstantVariable(int: 127), ConstantVariable(int: 32)]
TRACE BINARY_OP 20 [ConstantVariable(int: 127), ConstantVariable(int: 0)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:81 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n += 1
TRACE LOAD_FAST n []
TRACE LOAD_CONST 1 [ConstantVariable(int: 127)]
TRACE BINARY_OP 13 [ConstantVariable(int: 127), ConstantVariable(int: 1)]
TRACE STORE_FAST n [ConstantVariable(int: 128)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:82 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        return n
TRACE LOAD_FAST n []
TRACE RETURN_VALUE None [ConstantVariable(int: 128)]
DONE INLINING <code object next_power_of_2 at 0x70c9a955f730, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 71>
TRACE STORE_FAST res [ConstantVariable(int: 128)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 128)]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE STORE_FAST BK [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:147 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            if output_final_state:
TRACE LOAD_FAST output_final_state []
TRACE POP_JUMP_IF_FALSE 318 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:148 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
                final_state = q.new_empty(B, H, K, V, dtype=torch.float32)
TRACE LOAD_FAST q []
TRACE LOAD_ATTR new_empty [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), new_empty)]
TRACE LOAD_DEREF H [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1)]
TRACE LOAD_FAST K [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE LOAD_DEREF V [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128), ConstantVariable(int: 128)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE CALL 5 [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE FX call new_empty from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:148 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            final_state = q.new_empty(B, H, K, V, dtype=torch.float32)
                          ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST final_state [TensorVariable()]
TRACE JUMP_FORWARD 322 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:152 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            ha = torch.empty_like(v, dtype=torch.float32)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR empty_like [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST v [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL torch [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR float32 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE FX call empty_like from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:152 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
        ha = torch.empty_like(v, dtype=torch.float32)
             ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST ha [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
TRACE LOAD_CLOSURE H []
TRACE LOAD_CLOSURE N [CellVariable()]
TRACE LOAD_CLOSURE V [CellVariable(), CellVariable()]
TRACE BUILD_TUPLE 3 [CellVariable(), CellVariable(), CellVariable()]
TRACE LOAD_CONST <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154> [TupleVariable(length=3)]
TRACE MAKE_FUNCTION 8 [TupleVariable(length=3), ConstantVariable(code: <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>)]
TRACE STORE_FAST grid [NestedUserFunctionVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:155 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            o = torch.empty_like(v)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR empty_like [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST v [NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call empty_like_1 from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:155 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
        o = torch.empty_like(v)
            ~~~~~~~~~~~~~~~~^^^
TRACE STORE_FAST o [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_GLOBAL fused_recurrent_fwd_kernel []
TRACE LOAD_FAST grid [NullVariable, LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), NestedUserFunctionVariable()]
TRACE inlined call __getitem__ from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
        fused_recurrent_fwd_kernel[grid](
        ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
INLINING <code object __getitem__ at 0x70c9a94dd6f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 413>, inlined according trace_rules.lookup inlined by default
TRACE MAKE_CELL self []
TRACE MAKE_CELL grid []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:413 in __getitem__ (KernelInterface.__getitem__) (inline depth: 5)
        def __getitem__(self, grid) -> T:
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:419 in __getitem__ (KernelInterface.__getitem__) (inline depth: 5)
            return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
TRACE LOAD_CLOSURE grid []
TRACE LOAD_CLOSURE self [CellVariable()]
TRACE BUILD_TUPLE 2 [CellVariable(), CellVariable()]
TRACE LOAD_CONST <code object <lambda> at 0x70c9a9437780, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 419> [TupleVariable(length=2)]
TRACE MAKE_FUNCTION 8 [TupleVariable(length=2), ConstantVariable(code: <code object <lambda> at 0x70c9a9437780, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 419>)]
TRACE RETURN_VALUE None [NestedUserFunctionVariable()]
DONE INLINING <code object __getitem__ at 0x70c9a94dd6f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 413>
TRACE LOAD_CONST () [NullVariable, NestedUserFunctionVariable()]
TRACE BUILD_MAP 0 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0)]
TRACE LOAD_CONST q [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:157 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                q=q,
TRACE LOAD_FAST q [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'q')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'q'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST k [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:158 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                k=k,
TRACE LOAD_FAST k [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'k')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'k'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST v [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:159 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                v=v,
TRACE LOAD_FAST v [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'v')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'v'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST a [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:160 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                a=a,
TRACE LOAD_FAST a [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'a')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'a'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST b [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:161 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                b=b,
TRACE LOAD_FAST b [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'b')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'b'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST gk [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:162 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                gk=gk,
TRACE LOAD_FAST gk [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'gk')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'gk'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST o [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:163 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                o=o,
TRACE LOAD_FAST o [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'o')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'o'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST ha [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:164 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                ha=ha,
TRACE LOAD_FAST ha [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'ha')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'ha'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST h0 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:165 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                h0=initial_state,
TRACE LOAD_FAST initial_state [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'h0')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'h0'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST ht [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:166 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                ht=final_state,
TRACE LOAD_FAST final_state [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'ht')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'ht'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST scale [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:167 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                scale=scale,
TRACE LOAD_FAST scale [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'scale')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'scale'), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST offsets [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:168 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                offsets=offsets,
TRACE LOAD_FAST offsets [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'offsets')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'offsets'), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST H [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:169 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                H=H,
TRACE LOAD_DEREF H [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'H')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'H'), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST T [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:170 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                T=T,
TRACE LOAD_FAST T [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'T')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'T'), ConstantVariable(int: 512)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST K [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:171 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                K=K,
TRACE LOAD_FAST K [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'K')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'K'), ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST V [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:172 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                V=V,
TRACE LOAD_DEREF V [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'V')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'V'), ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST BK [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:173 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                BK=BK,
TRACE LOAD_FAST BK [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'BK')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'BK'), ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST HEAD_FIRST [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:174 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                HEAD_FIRST=head_first
TRACE LOAD_FAST head_first [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'HEAD_FIRST')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'HEAD_FIRST'), ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE CALL_FUNCTION_EX 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE inlined call <lambda> from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
        fused_recurrent_fwd_kernel[grid](
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
            q=q,
            ^^^^
            k=k,
            ^^^^
            v=v,
            ^^^^
            a=a,
            ^^^^
            b=b,
            ^^^^
            gk=gk,
            ^^^^^^
            o=o,
            ^^^^
            ha=ha,
            ^^^^^^
            h0=initial_state,
            ^^^^^^^^^^^^^^^^^
            ht=final_state,
            ^^^^^^^^^^^^^^^
            scale=scale,
            ^^^^^^^^^^^^
            offsets=offsets,
            ^^^^^^^^^^^^^^^^
            H=H,
            ^^^^
            T=T,
            ^^^^
            K=K,
            ^^^^
            V=V,
            ^^^^
            BK=BK,
            ^^^^^^
            HEAD_FIRST=head_first
            ^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object <lambda> at 0x70c9a9437780, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 419>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 2 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:419 in <lambda> (KernelInterface.__getitem__) (inline depth: 5)
            return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
TRACE RESUME 0 []
TRACE PUSH_NULL None []
TRACE LOAD_DEREF self [NullVariable]
TRACE LOAD_ATTR run [NullVariable, UserDefinedObjectVariable(Heuristics)]
TRACE LOAD_FAST args [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics))]
TRACE LOAD_DEREF grid [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0)]
TRACE LOAD_CONST False [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0), NestedUserFunctionVariable()]
TRACE LOAD_CONST ('grid', 'warmup') [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0), NestedUserFunctionVariable(), ConstantVariable(bool: False)]
TRACE BUILD_CONST_KEY_MAP 2 [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0), NestedUserFunctionVariable(), ConstantVariable(bool: False), TupleVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0), ConstDictVariable()]
TRACE inlined call run from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:419 in <lambda> (KernelInterface.__getitem__) (inline depth: 5)
        return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
                                       ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object run at 0x70c9a971df10, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py", line 449>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:449 in run (Heuristics.run) (inline depth: 6)
        def run(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:450 in run (Heuristics.run) (inline depth: 6)
            for v, heur in self.values.items():
TRACE LOAD_FAST self []
TRACE LOAD_ATTR values [UserDefinedObjectVariable(Heuristics)]
TRACE LOAD_ATTR items [LazyVariableTracker()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE FOR_ITER 156 [ListIteratorVariable(length=3, index=0)]
TRACE UNPACK_SEQUENCE 2 [ListIteratorVariable(length=3, index=1), TupleVariable(length=2)]
TRACE STORE_FAST v [ListIteratorVariable(length=3, index=1), LazyVariableTracker(), ConstantVariable(str: 'USE_INITIAL_STATE')]
TRACE STORE_FAST heur [ListIteratorVariable(length=3, index=1), LazyVariableTracker()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
                kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
TRACE PUSH_NULL None [ListIteratorVariable(length=3, index=1)]
TRACE LOAD_FAST heur [ListIteratorVariable(length=3, index=1), NullVariable]
TRACE BUILD_MAP 0 [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL dict [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE LOAD_GLOBAL zip [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST self [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, LazyVariableTracker(), NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR arg_names [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, LazyVariableTracker(), NullVariable, LazyVariableTracker(), UserDefinedObjectVariable(Heuristics)]
TRACE LOAD_FAST args [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, LazyVariableTracker(), NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, LazyVariableTracker(), NullVariable, LazyVariableTracker(), LazyVariableTracker(), TupleVariable(length=0)]
TRACE CALL 1 [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, LazyVariableTracker(), ZipVariable()]
TRACE inlined call construct_dict from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
            kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
                                ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object construct_dict at 0x70c9a070b0a0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 285>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:285 in construct_dict (construct_dict) (inline depth: 7)
    def construct_dict(cls, /, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:286 in construct_dict (construct_dict) (inline depth: 7)
        dst = cls.__new__(cls)
TRACE LOAD_FAST cls []
TRACE LOAD_ATTR __new__ [BuiltinVariable(dict)]
TRACE LOAD_FAST cls [NullVariable, GetAttrVariable(BuiltinVariable(dict), __new__)]
TRACE CALL 1 [NullVariable, GetAttrVariable(BuiltinVariable(dict), __new__), BuiltinVariable(dict)]
TRACE STORE_FAST dst [ConstDictVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:288 in construct_dict (construct_dict) (inline depth: 7)
        if args:
TRACE LOAD_FAST args []
TRACE POP_JUMP_IF_FALSE 264 [TupleVariable(length=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:289 in construct_dict (construct_dict) (inline depth: 7)
            src = args[0]
TRACE LOAD_FAST args []
TRACE LOAD_CONST 0 [TupleVariable(length=1)]
TRACE BINARY_SUBSCR None [TupleVariable(length=1), ConstantVariable(int: 0)]
TRACE STORE_FAST src [ZipVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:291 in construct_dict (construct_dict) (inline depth: 7)
            if not isinstance(src, Iterable):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST src [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL Iterable [NullVariable, LazyVariableTracker(), ZipVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ZipVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 128 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:295 in construct_dict (construct_dict) (inline depth: 7)
            if isinstance(src, (dict, MutableMapping, types.MappingProxyType)):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST src [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL dict [NullVariable, BuiltinVariable(isinstance), ZipVariable()]
TRACE LOAD_GLOBAL MutableMapping [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker()]
TRACE LOAD_GLOBAL types [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR MappingProxyType [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE BUILD_TUPLE 3 [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ZipVariable(), TupleVariable(length=3)]
TRACE POP_JUMP_IF_FALSE 234 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:301 in construct_dict (construct_dict) (inline depth: 7)
                for key, value in src:
TRACE LOAD_FAST src []
TRACE GET_ITER None [ZipVariable()]
TRACE FOR_ITER 262 [ZipVariable()]
TRACE END_FOR None [ZipVariable(), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:304 in construct_dict (construct_dict) (inline depth: 7)
        if kwargs:
TRACE LOAD_FAST kwargs []
TRACE POP_JUMP_IF_FALSE 298 [ConstDictVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:308 in construct_dict (construct_dict) (inline depth: 7)
        return dst
TRACE LOAD_FAST dst []
TRACE RETURN_VALUE None [ConstDictVariable()]
DONE INLINING <code object construct_dict at 0x70c9a070b0a0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 285>
TRACE DICT_UPDATE 1 [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), ConstDictVariable()]
TRACE LOAD_FAST kwargs [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE DICT_UPDATE 1 [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), ConstDictVariable()]
TRACE CALL 1 [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE inlined call <lambda> from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
            kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
                        ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object <lambda> at 0x70c98ce24d30, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 14>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:14 in <lambda> () (inline depth: 7)
        'USE_INITIAL_STATE': lambda args: args['h0'] is not None,
TRACE RESUME 0 []
TRACE LOAD_FAST args []
TRACE LOAD_CONST h0 [ConstDictVariable()]
TRACE BINARY_SUBSCR None [ConstDictVariable(), ConstantVariable(str: 'h0')]
TRACE LOAD_CONST None [TensorVariable()]
TRACE IS_OP 1 [TensorVariable(), ConstantVariable(NoneType: None)]
TRACE RETURN_VALUE None [ConstantVariable(bool: True)]
DONE INLINING <code object <lambda> at 0x70c98ce24d30, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 14>
TRACE LOAD_FAST kwargs [ListIteratorVariable(length=3, index=1), ConstantVariable(bool: True)]
TRACE LOAD_FAST v [ListIteratorVariable(length=3, index=1), ConstantVariable(bool: True), ConstDictVariable()]
TRACE STORE_SUBSCR None [ListIteratorVariable(length=3, index=1), ConstantVariable(bool: True), ConstDictVariable(), ConstantVariable(str: 'USE_INITIAL_STATE')]
TRACE JUMP_BACKWARD 54 [ListIteratorVariable(length=3, index=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:450 in run (Heuristics.run) (inline depth: 6)
            for v, heur in self.values.items():
TRACE FOR_ITER 156 [ListIteratorVariable(length=3, index=1)]
TRACE UNPACK_SEQUENCE 2 [ListIteratorVariable(length=3, index=2), TupleVariable(length=2)]
TRACE STORE_FAST v [ListIteratorVariable(length=3, index=2), LazyVariableTracker(), ConstantVariable(str: 'STORE_FINAL_STATE')]
TRACE STORE_FAST heur [ListIteratorVariable(length=3, index=2), LazyVariableTracker()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
                kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
TRACE PUSH_NULL None [ListIteratorVariable(length=3, index=2)]
TRACE LOAD_FAST heur [ListIteratorVariable(length=3, index=2), NullVariable]
TRACE BUILD_MAP 0 [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL dict [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE LOAD_GLOBAL zip [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict)]
TRACE LOAD_FAST self [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip)]
TRACE LOAD_ATTR arg_names [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip), UserDefinedObjectVariable(Heuristics)]
TRACE LOAD_FAST args [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip), LazyVariableTracker(), TupleVariable(length=0)]
TRACE CALL 1 [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), ZipVariable()]
TRACE inlined call construct_dict from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
            kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
                                ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object construct_dict at 0x70c9a070b0a0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 285>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:285 in construct_dict (construct_dict) (inline depth: 7)
    def construct_dict(cls, /, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:286 in construct_dict (construct_dict) (inline depth: 7)
        dst = cls.__new__(cls)
TRACE LOAD_FAST cls []
TRACE LOAD_ATTR __new__ [BuiltinVariable(dict)]
TRACE LOAD_FAST cls [NullVariable, GetAttrVariable(BuiltinVariable(dict), __new__)]
TRACE CALL 1 [NullVariable, GetAttrVariable(BuiltinVariable(dict), __new__), BuiltinVariable(dict)]
TRACE STORE_FAST dst [ConstDictVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:288 in construct_dict (construct_dict) (inline depth: 7)
        if args:
TRACE LOAD_FAST args []
TRACE POP_JUMP_IF_FALSE 264 [TupleVariable(length=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:289 in construct_dict (construct_dict) (inline depth: 7)
            src = args[0]
TRACE LOAD_FAST args []
TRACE LOAD_CONST 0 [TupleVariable(length=1)]
TRACE BINARY_SUBSCR None [TupleVariable(length=1), ConstantVariable(int: 0)]
TRACE STORE_FAST src [ZipVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:291 in construct_dict (construct_dict) (inline depth: 7)
            if not isinstance(src, Iterable):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST src [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL Iterable [NullVariable, LazyVariableTracker(), ZipVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ZipVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 128 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:295 in construct_dict (construct_dict) (inline depth: 7)
            if isinstance(src, (dict, MutableMapping, types.MappingProxyType)):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST src [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL dict [NullVariable, BuiltinVariable(isinstance), ZipVariable()]
TRACE LOAD_GLOBAL MutableMapping [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker()]
TRACE LOAD_GLOBAL types [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR MappingProxyType [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE BUILD_TUPLE 3 [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ZipVariable(), TupleVariable(length=3)]
TRACE POP_JUMP_IF_FALSE 234 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:301 in construct_dict (construct_dict) (inline depth: 7)
                for key, value in src:
TRACE LOAD_FAST src []
TRACE GET_ITER None [ZipVariable()]
TRACE FOR_ITER 262 [ZipVariable()]
TRACE END_FOR None [ZipVariable(), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:304 in construct_dict (construct_dict) (inline depth: 7)
        if kwargs:
TRACE LOAD_FAST kwargs []
TRACE POP_JUMP_IF_FALSE 298 [ConstDictVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:308 in construct_dict (construct_dict) (inline depth: 7)
        return dst
TRACE LOAD_FAST dst []
TRACE RETURN_VALUE None [ConstDictVariable()]
DONE INLINING <code object construct_dict at 0x70c9a070b0a0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 285>
TRACE DICT_UPDATE 1 [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), ConstDictVariable()]
TRACE LOAD_FAST kwargs [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE DICT_UPDATE 1 [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), ConstDictVariable()]
TRACE CALL 1 [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE inlined call <lambda> from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
            kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
                        ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object <lambda> at 0x70c98ce257c0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 15>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:15 in <lambda> () (inline depth: 7)
        'STORE_FINAL_STATE': lambda args: args['ht'] is not None,
TRACE RESUME 0 []
TRACE LOAD_FAST args []
TRACE LOAD_CONST ht [ConstDictVariable()]
TRACE BINARY_SUBSCR None [ConstDictVariable(), ConstantVariable(str: 'ht')]
TRACE LOAD_CONST None [TensorVariable()]
TRACE IS_OP 1 [TensorVariable(), ConstantVariable(NoneType: None)]
TRACE RETURN_VALUE None [ConstantVariable(bool: True)]
DONE INLINING <code object <lambda> at 0x70c98ce257c0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 15>
TRACE LOAD_FAST kwargs [ListIteratorVariable(length=3, index=2), ConstantVariable(bool: True)]
TRACE LOAD_FAST v [ListIteratorVariable(length=3, index=2), ConstantVariable(bool: True), ConstDictVariable()]
TRACE STORE_SUBSCR None [ListIteratorVariable(length=3, index=2), ConstantVariable(bool: True), ConstDictVariable(), ConstantVariable(str: 'STORE_FINAL_STATE')]
TRACE JUMP_BACKWARD 54 [ListIteratorVariable(length=3, index=2)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:450 in run (Heuristics.run) (inline depth: 6)
            for v, heur in self.values.items():
TRACE FOR_ITER 156 [ListIteratorVariable(length=3, index=2)]
TRACE UNPACK_SEQUENCE 2 [ListIteratorVariable(length=3, index=3), TupleVariable(length=2)]
TRACE STORE_FAST v [ListIteratorVariable(length=3, index=3), LazyVariableTracker(), ConstantVariable(str: 'USE_OFFSETS')]
TRACE STORE_FAST heur [ListIteratorVariable(length=3, index=3), LazyVariableTracker()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
                kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
TRACE PUSH_NULL None [ListIteratorVariable(length=3, index=3)]
TRACE LOAD_FAST heur [ListIteratorVariable(length=3, index=3), NullVariable]
TRACE BUILD_MAP 0 [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL dict [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE LOAD_GLOBAL zip [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict)]
TRACE LOAD_FAST self [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip)]
TRACE LOAD_ATTR arg_names [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip), UserDefinedObjectVariable(Heuristics)]
TRACE LOAD_FAST args [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip), LazyVariableTracker(), TupleVariable(length=0)]
TRACE CALL 1 [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), ZipVariable()]
TRACE inlined call construct_dict from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
            kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
                                ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object construct_dict at 0x70c9a070b0a0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 285>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:285 in construct_dict (construct_dict) (inline depth: 7)
    def construct_dict(cls, /, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:286 in construct_dict (construct_dict) (inline depth: 7)
        dst = cls.__new__(cls)
TRACE LOAD_FAST cls []
TRACE LOAD_ATTR __new__ [BuiltinVariable(dict)]
TRACE LOAD_FAST cls [NullVariable, GetAttrVariable(BuiltinVariable(dict), __new__)]
TRACE CALL 1 [NullVariable, GetAttrVariable(BuiltinVariable(dict), __new__), BuiltinVariable(dict)]
TRACE STORE_FAST dst [ConstDictVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:288 in construct_dict (construct_dict) (inline depth: 7)
        if args:
TRACE LOAD_FAST args []
TRACE POP_JUMP_IF_FALSE 264 [TupleVariable(length=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:289 in construct_dict (construct_dict) (inline depth: 7)
            src = args[0]
TRACE LOAD_FAST args []
TRACE LOAD_CONST 0 [TupleVariable(length=1)]
TRACE BINARY_SUBSCR None [TupleVariable(length=1), ConstantVariable(int: 0)]
TRACE STORE_FAST src [ZipVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:291 in construct_dict (construct_dict) (inline depth: 7)
            if not isinstance(src, Iterable):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST src [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL Iterable [NullVariable, LazyVariableTracker(), ZipVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ZipVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 128 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:295 in construct_dict (construct_dict) (inline depth: 7)
            if isinstance(src, (dict, MutableMapping, types.MappingProxyType)):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST src [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL dict [NullVariable, BuiltinVariable(isinstance), ZipVariable()]
TRACE LOAD_GLOBAL MutableMapping [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker()]
TRACE LOAD_GLOBAL types [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR MappingProxyType [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE BUILD_TUPLE 3 [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ZipVariable(), TupleVariable(length=3)]
TRACE POP_JUMP_IF_FALSE 234 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:301 in construct_dict (construct_dict) (inline depth: 7)
                for key, value in src:
TRACE LOAD_FAST src []
TRACE GET_ITER None [ZipVariable()]
TRACE FOR_ITER 262 [ZipVariable()]
TRACE END_FOR None [ZipVariable(), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:304 in construct_dict (construct_dict) (inline depth: 7)
        if kwargs:
TRACE LOAD_FAST kwargs []
TRACE POP_JUMP_IF_FALSE 298 [ConstDictVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:308 in construct_dict (construct_dict) (inline depth: 7)
        return dst
TRACE LOAD_FAST dst []
TRACE RETURN_VALUE None [ConstDictVariable()]
DONE INLINING <code object construct_dict at 0x70c9a070b0a0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 285>
TRACE DICT_UPDATE 1 [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), ConstDictVariable()]
TRACE LOAD_FAST kwargs [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE DICT_UPDATE 1 [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), ConstDictVariable()]
TRACE CALL 1 [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE inlined call <lambda> from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
            kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
                        ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object <lambda> at 0x70c98ce25a30, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 16>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:16 in <lambda> () (inline depth: 7)
        'USE_OFFSETS': lambda args: args['offsets'] is not None
TRACE RESUME 0 []
TRACE LOAD_FAST args []
TRACE LOAD_CONST offsets [ConstDictVariable()]
TRACE BINARY_SUBSCR None [ConstDictVariable(), ConstantVariable(str: 'offsets')]
TRACE LOAD_CONST None [ConstantVariable(NoneType: None)]
TRACE IS_OP 1 [ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE RETURN_VALUE None [ConstantVariable(bool: False)]
DONE INLINING <code object <lambda> at 0x70c98ce25a30, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 16>
TRACE LOAD_FAST kwargs [ListIteratorVariable(length=3, index=3), ConstantVariable(bool: False)]
TRACE LOAD_FAST v [ListIteratorVariable(length=3, index=3), ConstantVariable(bool: False), ConstDictVariable()]
TRACE STORE_SUBSCR None [ListIteratorVariable(length=3, index=3), ConstantVariable(bool: False), ConstDictVariable(), ConstantVariable(str: 'USE_OFFSETS')]
TRACE JUMP_BACKWARD 54 [ListIteratorVariable(length=3, index=3)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:450 in run (Heuristics.run) (inline depth: 6)
            for v, heur in self.values.items():
TRACE FOR_ITER 156 [ListIteratorVariable(length=3, index=3)]
TRACE END_FOR None [ListIteratorVariable(length=3, index=3), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:452 in run (Heuristics.run) (inline depth: 6)
            return self.fn.run(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(Heuristics)]
TRACE LOAD_ATTR run [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST args [NullVariable, GetAttrVariable(TritonKernelVariable(), run)]
TRACE BUILD_MAP 0 [NullVariable, GetAttrVariable(TritonKernelVariable(), run), TupleVariable(length=0)]
TRACE LOAD_FAST kwargs [NullVariable, GetAttrVariable(TritonKernelVariable(), run), TupleVariable(length=0), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, GetAttrVariable(TritonKernelVariable(), run), TupleVariable(length=0), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, GetAttrVariable(TritonKernelVariable(), run), TupleVariable(length=0), ConstDictVariable()]
TRACE inlined call grid from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:452 in run (Heuristics.run) (inline depth: 6)
        return self.fn.run(*args, **kwargs)
               ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in grid (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 7)
            def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
TRACE RESUME 0 []
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF V [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST meta [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE LOAD_CONST BV [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstDictVariable(), ConstantVariable(str: 'BV')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in grid (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 7)
        def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
                                ~~~~~~~~~~~^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 128)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 128)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 128)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 9)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 9)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [ConstantVariable(int: 128)]
TRACE BINARY_OP 0 [ConstantVariable(int: 128), ConstantVariable(int: 32)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 160)]
TRACE BINARY_OP 10 [ConstantVariable(int: 160), ConstantVariable(int: 1)]
TRACE LOAD_FAST y [ConstantVariable(int: 159)]
TRACE BINARY_OP 2 [ConstantVariable(int: 159), ConstantVariable(int: 32)]
TRACE RETURN_VALUE None [ConstantVariable(int: 4)]
DONE INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [ConstantVariable(int: 4)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 4)]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE LOAD_DEREF N [ConstantVariable(int: 4)]
TRACE LOAD_DEREF H [ConstantVariable(int: 4), ConstantVariable(int: 1)]
TRACE BINARY_OP 5 [ConstantVariable(int: 4), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE BUILD_TUPLE 2 [ConstantVariable(int: 4), ConstantVariable(int: 64)]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>
TRACE inlined call grid from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:452 in run (Heuristics.run) (inline depth: 6)
        return self.fn.run(*args, **kwargs)
               ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in grid (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 7)
            def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
TRACE RESUME 0 []
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF V [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST meta [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE LOAD_CONST BV [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstDictVariable(), ConstantVariable(str: 'BV')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in grid (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 7)
        def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
                                ~~~~~~~~~~~^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 128)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 128)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 128)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 9)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 9)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [ConstantVariable(int: 128)]
TRACE BINARY_OP 0 [ConstantVariable(int: 128), ConstantVariable(int: 32)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 160)]
TRACE BINARY_OP 10 [ConstantVariable(int: 160), ConstantVariable(int: 1)]
TRACE LOAD_FAST y [ConstantVariable(int: 159)]
TRACE BINARY_OP 2 [ConstantVariable(int: 159), ConstantVariable(int: 32)]
TRACE RETURN_VALUE None [ConstantVariable(int: 4)]
DONE INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [ConstantVariable(int: 4)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 4)]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE LOAD_DEREF N [ConstantVariable(int: 4)]
TRACE LOAD_DEREF H [ConstantVariable(int: 4), ConstantVariable(int: 1)]
TRACE BINARY_OP 5 [ConstantVariable(int: 4), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE BUILD_TUPLE 2 [ConstantVariable(int: 4), ConstantVariable(int: 64)]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>
TRACE inlined call grid from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:452 in run (Heuristics.run) (inline depth: 6)
        return self.fn.run(*args, **kwargs)
               ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in grid (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 7)
            def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
TRACE RESUME 0 []
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF V [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST meta [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE LOAD_CONST BV [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstDictVariable(), ConstantVariable(str: 'BV')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in grid (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 7)
        def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
                                ~~~~~~~~~~~^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 128)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 128)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 128)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 9)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 9)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [ConstantVariable(int: 128)]
TRACE BINARY_OP 0 [ConstantVariable(int: 128), ConstantVariable(int: 32)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 160)]
TRACE BINARY_OP 10 [ConstantVariable(int: 160), ConstantVariable(int: 1)]
TRACE LOAD_FAST y [ConstantVariable(int: 159)]
TRACE BINARY_OP 2 [ConstantVariable(int: 159), ConstantVariable(int: 32)]
TRACE RETURN_VALUE None [ConstantVariable(int: 4)]
DONE INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [ConstantVariable(int: 4)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 4)]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE LOAD_DEREF N [ConstantVariable(int: 4)]
TRACE LOAD_DEREF H [ConstantVariable(int: 4), ConstantVariable(int: 1)]
TRACE BINARY_OP 5 [ConstantVariable(int: 4), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE BUILD_TUPLE 2 [ConstantVariable(int: 4), ConstantVariable(int: 64)]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>
TRACE FX call triton_kernel_wrapper_mutation from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:452 in run (Heuristics.run) (inline depth: 6)
        return self.fn.run(*args, **kwargs)
               ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [ConstantVariable(NoneType: None)]
DONE INLINING <code object run at 0x70c9a971df10, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py", line 449>
TRACE RETURN_VALUE None [ConstantVariable(NoneType: None)]
DONE INLINING <code object <lambda> at 0x70c9a9437780, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 419>
TRACE POP_TOP None [ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:176 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            return o, final_state
TRACE LOAD_FAST o []
TRACE LOAD_FAST final_state [TensorVariable()]
TRACE BUILD_TUPLE 2 [TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object forward at 0x3060e8b0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 124>
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object wrapper at 0x70c98d04f0a0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 16>
TRACE UNPACK_SEQUENCE 2 [TupleVariable(length=2)]
TRACE STORE_FAST o [TensorVariable(), TensorVariable()]
TRACE STORE_FAST final_state [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:258 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
        return o, final_state
TRACE LOAD_FAST o []
TRACE LOAD_FAST final_state [TensorVariable()]
TRACE BUILD_TUPLE 2 [TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object fused_recurrent_dplr_delta_rule at 0x305fb4e0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 188>
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object fused_recurrent_rwkv7 at 0x70c98d0c9890, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py", line 11>
TRACE UNPACK_SEQUENCE 2 [TupleVariable(length=2)]
TRACE STORE_FAST xx [TensorVariable(), TensorVariable()]
TRACE STORE_FAST state [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:612 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            xx = xx.view(B,T,-1) * (float(N) ** -0.5)
TRACE LOAD_FAST xx []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: -1)]
TRACE FX call view_15 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:612 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.view(B,T,-1) * (float(N) ** -0.5)
             ~~~~~~~^^^^^^^^
TRACE LOAD_GLOBAL float [TensorVariable()]
TRACE LOAD_FAST N [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE LOAD_CONST -0.5 [TensorVariable(), ConstantVariable(float: 128.0)]
TRACE BINARY_OP 8 [TensorVariable(), ConstantVariable(float: 128.0), ConstantVariable(float: -0.5)]
TRACE BINARY_OP 5 [TensorVariable(), ConstantVariable(float: 0.08838834764831845)]
TRACE FX call mul_12 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:612 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.view(B,T,-1) * (float(N) ** -0.5)
             ~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST xx [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
TRACE LOAD_FAST xx []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST r [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR dtype [NullVariable, GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_10 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
             ~~~~~^^^^^^^^^^^^^^^
TRACE LOAD_FAST r [TensorVariable()]
TRACE LOAD_ATTR view [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST B [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64)]
TRACE CALL 4 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_16 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                      ~~~~~~^^^^^^^^^
TRACE LOAD_FAST k [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR view [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST B [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64)]
TRACE CALL 4 [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_17 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                                      ~~~~~~^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call mul_13 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                      ~~~~~~~~~~~~~~~^^~~~~~~~~~~~~~~
TRACE LOAD_FAST r_k [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR view [TensorVariable(), TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['r_k'] (8192,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='r_k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_r_k_ L['r_k'] FakeTensor(..., device='cuda:0', size=(8192,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE LOAD_FAST H [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST N [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 64)]
TRACE CALL 2 [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_18 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                                                      ~~~~~~~~^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call mul_14 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^~~~~~~~~~~~~
TRACE LOAD_ATTR sum [TensorVariable(), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), sum)]
TRACE LOAD_CONST True [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), sum), ConstantVariable(int: -1)]
TRACE KW_NAMES ('dim', 'keepdim') [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), sum), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), sum), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call sum_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_FAST v [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR view [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST B [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64)]
TRACE CALL 4 [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_19 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                                                                                                 ~~~~~~^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call mul_15 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~
TRACE LOAD_ATTR view [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST B [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64)]
TRACE BINARY_OP 5 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE CALL 3 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8192)]
TRACE FX call view_20 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable()]
TRACE FX call add_8 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
             ~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST xx [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:616 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            output = fpx_matmul((xx * (torch.sigmoid(xg) @ g2)), O_, O_state,ebits,mbits)
TRACE LOAD_GLOBAL fpx_matmul []
TRACE LOAD_FAST xx [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL torch [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR sigmoid [NullVariable, LazyVariableTracker(), TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST xg [NullVariable, LazyVariableTracker(), TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call sigmoid_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:616 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        output = fpx_matmul((xx * (torch.sigmoid(xg) @ g2)), O_, O_state,ebits,mbits)
                                   ~~~~~~~~~~~~~^^^^
TRACE LOAD_FAST g2 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE BINARY_OP 4 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['g2'] (480, 8192) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='g2', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_g2_ L['g2'] FakeTensor(..., device='cuda:0', size=(480, 8192), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call matmul_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:616 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        output = fpx_matmul((xx * (torch.sigmoid(xg) @ g2)), O_, O_state,ebits,mbits)
                                   ~~~~~~~~~~~~~~~~~~^~~~
TRACE BINARY_OP 5 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE FX call mul_16 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:616 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        output = fpx_matmul((xx * (torch.sigmoid(xg) @ g2)), O_, O_state,ebits,mbits)
                             ~~~^~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_FAST O_ [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST O_state [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_FAST ebits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST mbits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: -44)]
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: -44), LazyVariableTracker()]
TRACE inlined call fpx_matmul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:616 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        output = fpx_matmul((xx * (torch.sigmoid(xg) @ g2)), O_, O_state,ebits,mbits)
                 ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object fpx_matmul at 0x3063a810, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:420 in fpx_matmul (fpx_matmul) (inline depth: 1)
    def fpx_matmul(x,weight,weight_state,ebits:int=3,mbits:int=2):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:421 in fpx_matmul (fpx_matmul) (inline depth: 1)
        if ebits == -44: #hqq
TRACE LOAD_FAST ebits []
TRACE LOAD_CONST -44 [ConstantVariable(int: -44)]
TRACE COMPARE_OP == [ConstantVariable(int: -44), ConstantVariable(int: -44)]
TRACE POP_JUMP_IF_FALSE 322 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S0=x.shape[0]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 0 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 0)]
TRACE STORE_FAST S0 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S1=x.shape[1]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 1)]
TRACE STORE_FAST S1 [ConstantVariable(int: 512)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:424 in fpx_matmul (fpx_matmul) (inline depth: 1)
            dtype = x.dtype
TRACE LOAD_FAST x []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
            x = x.to(dtype=torch.float16).view(-1,x.shape[2])
TRACE LOAD_FAST x []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float16 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_11 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST x [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1)]
TRACE LOAD_ATTR shape [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3), ConstantVariable(int: 2)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), ConstantVariable(int: 8192)]
TRACE FX call view_21 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
            out = weight.forward_manual(x).to(dtype=dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_ATTR forward_manual [LazyVariableTracker()]
TRACE LOAD_FAST x [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE CALL 1 [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton)), TensorVariable()]
TRACE inlined call forward_manual from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:543 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        def forward_manual(self, x: Tensor, matmul_type: str="GEMM") -> Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE LOAD_GLOBAL forward_functional []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:545 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                x,
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:546 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.bias,
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR bias [NullVariable, LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_tensor_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_ATTR get_tensor_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_tensor_args at 0x70c98a9e9080>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_tensor_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_tensor_args(),
            ~~~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:524 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
        def get_tensor_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:525 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
            return [self.W_q, self.scales, self.zeros]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR W_q [UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_FAST self [LazyVariableTracker()]
TRACE LOAD_ATTR scales [LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['O_']._parameters['scales'] (128, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='O_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='scales'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_O_parameters_scales_ L['O_']._parameters['scales'] Parameter(FakeTensor(..., device='cuda:0', size=(128, 5120), dtype=torch.float16)) at debug_level 0 before=False
TRACE LOAD_FAST self [LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR zeros [LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['O_']._parameters['zeros'] (128, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='O_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='zeros'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_O_parameters_zeros_ L['O_']._parameters['zeros'] Parameter(FakeTensor(..., device='cuda:0', size=(128, 5120), dtype=torch.float16)) at debug_level 0 before=False
TRACE BUILD_LIST 3 [LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [ListVariable(length=3)]
DONE INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_meta_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3)]
TRACE LOAD_ATTR get_meta_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_meta_args at 0x70c98a9e9120>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_meta_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_meta_args(),
            ~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:527 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
        def get_meta_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE LOAD_GLOBAL int []
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR scaled_activations [NullVariable, LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:529 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_nbits,
TRACE LOAD_FAST self [ConstantVariable(int: 0)]
TRACE LOAD_ATTR W_nbits [ConstantVariable(int: 0), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:530 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.group_size,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker()]
TRACE LOAD_ATTR group_size [ConstantVariable(int: 0), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:531 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.unpack_mask,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR unpack_mask [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:532 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.elements_per_sample,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR elements_per_sample [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:533 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.input_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR input_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:534 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.output_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR output_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:535 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.acc_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR acc_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:536 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.meta_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR meta_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:537 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.channel_scale_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR channel_scale_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:538 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_group_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR W_group_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:539 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    int(self.data_contiguous),
TRACE LOAD_GLOBAL int [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int)]
TRACE LOAD_ATTR data_contiguous [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE BUILD_LIST 12 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [ListVariable(length=12)]
DONE INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:549 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
TRACE LOAD_GLOBAL GEMLITE_MATMUL_TYPES_MAPPING [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12)]
TRACE LOAD_FAST matmul_type [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker(), ConstantVariable(str: 'GEMM')]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), ConstantVariable(int: 4)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        return forward_functional(
               ~~~~~~~~~~~~~~~~~~^
            x,
            ^^
            self.bias,
            ^^^^^^^^^^
            self.get_tensor_args(),
            ^^^^^^^^^^^^^^^^^^^^^^^
            self.get_meta_args(),
            ^^^^^^^^^^^^^^^^^^^^^
            GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:675 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        def __call__(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
            return self._opoverload(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR _opoverload [NullVariable, UserDefinedObjectVariable(CustomOpDef)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=5)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
wrap_to_fake L['O_'].W_q (1024, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=AttrSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='O_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='W_q'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_O_W_q L['O_'].W_q FakeTensor(..., device='cuda:0', size=(1024, 5120), dtype=torch.int32) at debug_level 0 before=False
TRACE FX call forward_functional_default_1 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        return self._opoverload(*args, **kwargs)
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_12 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE STORE_FAST out [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
            return out.view(S0,S1,-1)
TRACE LOAD_FAST out []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST S0 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST S1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: -1)]
TRACE FX call view_22 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
        return out.view(S0,S1,-1)
               ~~~~~~~~^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object fpx_matmul at 0x3063a810, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>
TRACE STORE_FAST output [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:618 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            x_in = x_in + output
TRACE LOAD_FAST x_in []
TRACE LOAD_FAST output [TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable()]
TRACE FX call add_9 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:618 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        x_in = x_in + output
               ~~~~~^~~~~~~~
TRACE STORE_FAST x_in [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:619 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            output = T5RMSNorm(x_in,ln2,variance_epsilon=rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST x_in [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln2 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE KW_NAMES ('variance_epsilon',) [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ConstantVariable(float: 1e-06)]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:619 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        output = T5RMSNorm(x_in,ln2,variance_epsilon=rmsnorm_epsilon)
                 ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_13 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_10 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_17 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln2'] (5120,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln2', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln2_ L['ln2'] FakeTensor(..., device='cuda:0', size=(5120,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_18 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_14 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST output [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:621 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            return  output, x[:,-1], state, v_first, k_first, x_in
TRACE LOAD_FAST output []
TRACE LOAD_FAST x [TensorVariable()]
TRACE LOAD_CONST None [TensorVariable(), TensorVariable()]
TRACE LOAD_CONST None [TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST -1 [TensorVariable(), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [TensorVariable(), TensorVariable(), SliceVariable(), ConstantVariable(int: -1)]
TRACE BINARY_SUBSCR None [TensorVariable(), TensorVariable(), TupleVariable(length=2)]
TRACE FX call getitem_14 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:621 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        return  output, x[:,-1], state, v_first, k_first, x_in
                        ~^^^^^^
TRACE LOAD_FAST state [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST v_first [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST k_first [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST x_in [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 6 [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [TupleVariable(length=6)]
Step 1: torchdynamo done tracing hxa079_TimeMix (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py, line 621 in hxa079_TimeMix>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_2_1a61ecec_7610_418f_bfcd_5d92c3a08593 =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, L_x_in_: "[31mbf16[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m", L_ln1_: "[31mbf16[0m[34m[5120][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_wavgk1_: "[31mbf16[0m[34m[5120, 1376][0m[2m[34m[1376, 1][0m[2m[32mcuda:0[0m", L_RKV_parameters_scales_: "[31mf16[0m[34m[80, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m", L_RKV_parameters_zeros_: "[31mf16[0m[34m[80, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m", L_RKV_W_q: "[31mi32[0m[34m[640, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m", L_R_bias_: "[31mbf16[0m[34m[][0m[2m[34m[][0m[2m[32mcuda:0[0m", L_ln_r_: "[31mbf16[0m[34m[128][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_ln_k_: "[31mbf16[0m[34m[128][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_calc_cos_: "[31mf32[0m[34m[1, 512, 128][0m[2m[34m[65536, 128, 1][0m[2m[32mcuda:0[0m", L_calc_sin_: "[31mf32[0m[34m[1, 512, 128][0m[2m[34m[65536, 128, 1][0m[2m[32mcuda:0[0m", L_a2_: "[31mbf16[0m[34m[160, 8192][0m[2m[34m[8192, 1][0m[2m[32mcuda:0[0m", L_a0_: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m", L_w2_: "[31mbf16[0m[34m[480, 8192][0m[2m[34m[8192, 1][0m[2m[32mcuda:0[0m", L_w0_: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m", L_state_: "[31mbf16[0m[34m[1, 64, 128, 128][0m[2m[34m[1048576, 16384, 128, 1][0m[2m[32mcuda:0[0m", L_r_k_: "[31mbf16[0m[34m[8192][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_g2_: "[31mbf16[0m[34m[480, 8192][0m[2m[34m[8192, 1][0m[2m[32mcuda:0[0m", L_O_parameters_scales_: "[31mf16[0m[34m[128, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m", L_O_parameters_zeros_: "[31mf16[0m[34m[128, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m", L_O_W_q: "[31mi32[0m[34m[1024, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m", L_ln2_: "[31mbf16[0m[34m[5120][0m[2m[34m[1][0m[2m[32mcuda:0[0m"):
        l_x_in_ = L_x_in_
        l_ln1_ = L_ln1_
        l_wavgk1_ = L_wavgk1_
        l_rkv_parameters_scales_ = L_RKV_parameters_scales_
        l_rkv_parameters_zeros_ = L_RKV_parameters_zeros_
        l_rkv_w_q = L_RKV_W_q
        l_r_bias_ = L_R_bias_
        l_ln_r_ = L_ln_r_
        l_ln_k_ = L_ln_k_
        l_calc_cos_ = L_calc_cos_
        l_calc_sin_ = L_calc_sin_
        l_a2_ = L_a2_
        l_a0_ = L_a0_
        l_w2_ = L_w2_
        l_w0_ = L_w0_
        l_state_ = L_state_
        l_r_k_ = L_r_k_
        l_g2_ = L_g2_
        l_o_parameters_scales_ = L_O_parameters_scales_
        l_o_parameters_zeros_ = L_O_parameters_zeros_
        l_o_w_q = L_O_W_q
        l_ln2_ = L_ln2_
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states: "[31mf32[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = l_x_in_.to([34mtorch.float32[0m)
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_1: "[31mf32[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states.pow([34m2[0m)
        variance: "[31mf32[0m[34m[1, 512, 1][0m[2m[34m[512, 1, 1][0m[2m[32mcuda:0[0m" = pow_1.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add: "[31mf32[0m[34m[1, 512, 1][0m[2m[34m[512, 1, 1][0m[2m[32mcuda:0[0m" = variance + [34m1e-06[0m;  [2mvariance = None[0m
        rsqrt: "[31mf32[0m[34m[1, 512, 1][0m[2m[34m[512, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add);  [2madd = None[0m
        hidden_states_1: "[31mf32[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states * rsqrt;  [2mhidden_states = rsqrt = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_1: "[31mf32[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = l_ln1_ * hidden_states_1;  [2ml_ln1_ = hidden_states_1 = None[0m
        x: "[31mbf16[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = mul_1.to([34mtorch.bfloat16[0m);  [2mmul_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:551 in hxa079_TimeMix, code: xw,xa,xv,xg,xk = (x @ wavgk1).split(wavgk_split_list, dim=-1)[0m
        matmul: "[31mbf16[0m[34m[1, 512, 1376][0m[2m[34m[704512, 1376, 1][0m[2m[32mcuda:0[0m" = x @ l_wavgk1_;  [2ml_wavgk1_ = None[0m
        split = matmul.split([[34m480[0m, [34m160[0m, [34m128[0m, [34m480[0m, [34m128[0m], dim = [34m-1[0m);  [2mmatmul = None[0m
        xw: "[31mbf16[0m[34m[1, 512, 480][0m[2m[34m[704512, 1376, 1][0m[2m[32mcuda:0[0m" = split[[34m0[0m]
        xa: "[31mbf16[0m[34m[1, 512, 160][0m[2m[34m[704512, 1376, 1][0m[2m[32mcuda:0[0m" = split[[34m1[0m]
        xg: "[31mbf16[0m[34m[1, 512, 480][0m[2m[34m[704512, 1376, 1][0m[2m[32mcuda:0[0m" = split[[34m3[0m];  [2msplit = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul, code: x = x.to(dtype=torch.float16).view(-1,x.shape[2])[0m
        to_2: "[31mf16[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = x.to(dtype = [34mtorch.float16[0m)
        x_1: "[31mf16[0m[34m[512, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m" = to_2.view([34m-1[0m, [34m5120[0m);  [2mto_2 = None[0m
        
         [2m# File: /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__, code: return self._opoverload(*args, **kwargs)[0m
        forward_functional_default: "[31mf16[0m[34m[512, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m" = torch.ops.gemlite.forward_functional.default(x_1, [34mNone[0m, [l_rkv_w_q, l_rkv_parameters_scales_, l_rkv_parameters_zeros_], [[34m0[0m, [34m4[0m, [34m64[0m, [34m15[0m, [34m8[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m0[0m, [34m4[0m, [34m1[0m], [34m4[0m);  [2mx_1 = l_rkv_w_q = l_rkv_parameters_scales_ = l_rkv_parameters_zeros_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul, code: out = weight.forward_manual(x).to(dtype=dtype)[0m
        out: "[31mbf16[0m[34m[512, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m" = forward_functional_default.to(dtype = [34mtorch.bfloat16[0m);  [2mforward_functional_default = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul, code: return out.view(S0,S1,-1)[0m
        rkv: "[31mbf16[0m[34m[1, 512, 10240][0m[2m[34m[5242880, 10240, 1][0m[2m[32mcuda:0[0m" = out.view([34m1[0m, [34m512[0m, [34m-1[0m);  [2mout = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:556 in hxa079_TimeMix, code: r,k,v = rkv.split(rkv_split_list,dim=-1)[0m
        split_1 = rkv.split([[34m8192[0m, [34m1024[0m, [34m1024[0m], dim = [34m-1[0m);  [2mrkv = None[0m
        r: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[5242880, 10240, 1][0m[2m[32mcuda:0[0m" = split_1[[34m0[0m]
        k: "[31mbf16[0m[34m[1, 512, 1024][0m[2m[34m[5242880, 10240, 1][0m[2m[32mcuda:0[0m" = split_1[[34m1[0m]
        v: "[31mbf16[0m[34m[1, 512, 1024][0m[2m[34m[5242880, 10240, 1][0m[2m[32mcuda:0[0m" = split_1[[34m2[0m];  [2msplit_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:562 in hxa079_TimeMix, code: r = r.add_(R_bias)[0m
        r_1: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[5242880, 10240, 1][0m[2m[32mcuda:0[0m" = r.add_(l_r_bias_);  [2mr = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:563 in hxa079_TimeMix, code: k = k.add_(K_bias).view(B, T, kv_per_head, N)[0m
        add__1: "[31mbf16[0m[34m[1, 512, 1024][0m[2m[34m[5242880, 10240, 1][0m[2m[32mcuda:0[0m" = k.add_(l_r_bias_);  [2mk = None[0m
        k_1: "[31mbf16[0m[34m[1, 512, 8, 128][0m[2m[34m[5242880, 10240, 128, 1][0m[2m[32mcuda:0[0m" = add__1.view([34m1[0m, [34m512[0m, [34m8[0m, [34m128[0m);  [2madd__1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:564 in hxa079_TimeMix, code: v = v.add_(V_bias).view(B, T, kv_per_head, N)[0m
        add__2: "[31mbf16[0m[34m[1, 512, 1024][0m[2m[34m[5242880, 10240, 1][0m[2m[32mcuda:0[0m" = v.add_(l_r_bias_);  [2mv = l_r_bias_ = None[0m
        v_1: "[31mbf16[0m[34m[1, 512, 8, 128][0m[2m[34m[5242880, 10240, 128, 1][0m[2m[32mcuda:0[0m" = add__2.view([34m1[0m, [34m512[0m, [34m8[0m, [34m128[0m);  [2madd__2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:572 in hxa079_TimeMix, code: r = T5RMSNorm(r.view(B,T,H,N), ln_r, variance_epsilon=rmsnorm_epsilon)[0m
        view_4: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[5242880, 10240, 128, 1][0m[2m[32mcuda:0[0m" = r_1.view([34m1[0m, [34m512[0m, [34m64[0m, [34m128[0m);  [2mr_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states_2: "[31mf32[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = view_4.to([34mtorch.float32[0m);  [2mview_4 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_2: "[31mf32[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_2.pow([34m2[0m)
        variance_1: "[31mf32[0m[34m[1, 512, 64, 1][0m[2m[34m[32768, 64, 1, 1][0m[2m[32mcuda:0[0m" = pow_2.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add_1: "[31mf32[0m[34m[1, 512, 64, 1][0m[2m[34m[32768, 64, 1, 1][0m[2m[32mcuda:0[0m" = variance_1 + [34m1e-06[0m;  [2mvariance_1 = None[0m
        rsqrt_1: "[31mf32[0m[34m[1, 512, 64, 1][0m[2m[34m[32768, 64, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add_1);  [2madd_1 = None[0m
        hidden_states_3: "[31mf32[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_2 * rsqrt_1;  [2mhidden_states_2 = rsqrt_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_3: "[31mf32[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = l_ln_r_ * hidden_states_3;  [2ml_ln_r_ = hidden_states_3 = None[0m
        r_2: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = mul_3.to([34mtorch.bfloat16[0m);  [2mmul_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states_4: "[31mf32[0m[34m[1, 512, 8, 128][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = k_1.to([34mtorch.float32[0m);  [2mk_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_3: "[31mf32[0m[34m[1, 512, 8, 128][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_4.pow([34m2[0m)
        variance_2: "[31mf32[0m[34m[1, 512, 8, 1][0m[2m[34m[4096, 8, 1, 1][0m[2m[32mcuda:0[0m" = pow_3.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add_2: "[31mf32[0m[34m[1, 512, 8, 1][0m[2m[34m[4096, 8, 1, 1][0m[2m[32mcuda:0[0m" = variance_2 + [34m1e-06[0m;  [2mvariance_2 = None[0m
        rsqrt_2: "[31mf32[0m[34m[1, 512, 8, 1][0m[2m[34m[4096, 8, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add_2);  [2madd_2 = None[0m
        hidden_states_5: "[31mf32[0m[34m[1, 512, 8, 128][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_4 * rsqrt_2;  [2mhidden_states_4 = rsqrt_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_5: "[31mf32[0m[34m[1, 512, 8, 128][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = l_ln_k_ * hidden_states_5;  [2ml_ln_k_ = hidden_states_5 = None[0m
        k_2: "[31mbf16[0m[34m[1, 512, 8, 128][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = mul_5.to([34mtorch.bfloat16[0m);  [2mmul_5 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:576 in hxa079_TimeMix, code: cos, sin = calc_cos.to(k.dtype), calc_sin.to(k.dtype)[0m
        cos: "[31mbf16[0m[34m[1, 512, 128][0m[2m[34m[65536, 128, 1][0m[2m[32mcuda:0[0m" = l_calc_cos_.to([34mtorch.bfloat16[0m);  [2ml_calc_cos_ = None[0m
        sin: "[31mbf16[0m[34m[1, 512, 128][0m[2m[34m[65536, 128, 1][0m[2m[32mcuda:0[0m" = l_calc_sin_.to([34mtorch.bfloat16[0m);  [2ml_calc_sin_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:493 in apply_rotary_pos_emb, code: cos = cos.unsqueeze(unsqueeze_dim)[0m
        cos_1: "[31mbf16[0m[34m[1, 512, 1, 128][0m[2m[34m[65536, 128, 128, 1][0m[2m[32mcuda:0[0m" = cos.unsqueeze([34m2[0m);  [2mcos = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:494 in apply_rotary_pos_emb, code: sin = sin.unsqueeze(unsqueeze_dim)[0m
        sin_1: "[31mbf16[0m[34m[1, 512, 1, 128][0m[2m[34m[65536, 128, 128, 1][0m[2m[32mcuda:0[0m" = sin.unsqueeze([34m2[0m);  [2msin = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb, code: q_embed = (q * cos) + (rotate_half(q) * sin)[0m
        mul_6: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = r_2 * cos_1
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half, code: x1 = x[..., : x.shape[-1] // 2][0m
        x1: "[31mbf16[0m[34m[1, 512, 64, 64][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = r_2[([34mEllipsis[0m, slice([34mNone[0m, [34m64[0m, [34mNone[0m))]
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half, code: x2 = x[..., x.shape[-1] // 2 :][0m
        x2: "[31mbf16[0m[34m[1, 512, 64, 64][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = r_2[([34mEllipsis[0m, slice([34m64[0m, [34mNone[0m, [34mNone[0m))];  [2mr_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half, code: return torch.cat((-x2, x1), dim=-1)[0m
        neg: "[31mbf16[0m[34m[1, 512, 64, 64][0m[2m[34m[2097152, 4096, 64, 1][0m[2m[32mcuda:0[0m" = -x2;  [2mx2 = None[0m
        cat: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = torch.cat((neg, x1), dim = [34m-1[0m);  [2mneg = x1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb, code: q_embed = (q * cos) + (rotate_half(q) * sin)[0m
        mul_7: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = cat * sin_1;  [2mcat = None[0m
        q_embed: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = mul_6 + mul_7;  [2mmul_6 = mul_7 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb, code: k_embed = (k * cos) + (rotate_half(k) * sin)[0m
        mul_8: "[31mbf16[0m[34m[1, 512, 8, 128][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = k_2 * cos_1;  [2mcos_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half, code: x1 = x[..., : x.shape[-1] // 2][0m
        x1_1: "[31mbf16[0m[34m[1, 512, 8, 64][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = k_2[([34mEllipsis[0m, slice([34mNone[0m, [34m64[0m, [34mNone[0m))]
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half, code: x2 = x[..., x.shape[-1] // 2 :][0m
        x2_1: "[31mbf16[0m[34m[1, 512, 8, 64][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = k_2[([34mEllipsis[0m, slice([34m64[0m, [34mNone[0m, [34mNone[0m))];  [2mk_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half, code: return torch.cat((-x2, x1), dim=-1)[0m
        neg_1: "[31mbf16[0m[34m[1, 512, 8, 64][0m[2m[34m[262144, 512, 64, 1][0m[2m[32mcuda:0[0m" = -x2_1;  [2mx2_1 = None[0m
        cat_1: "[31mbf16[0m[34m[1, 512, 8, 128][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = torch.cat((neg_1, x1_1), dim = [34m-1[0m);  [2mneg_1 = x1_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb, code: k_embed = (k * cos) + (rotate_half(k) * sin)[0m
        mul_9: "[31mbf16[0m[34m[1, 512, 8, 128][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = cat_1 * sin_1;  [2mcat_1 = sin_1 = None[0m
        k_embed: "[31mbf16[0m[34m[1, 512, 8, 128][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = mul_8 + mul_9;  [2mmul_8 = mul_9 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:357 in repeat_kv, code: hidden_states = hidden_states[:, :, :, None, :]  # (B, T, H_kv, 1, D)[0m
        hidden_states_6: "[31mbf16[0m[34m[1, 512, 8, 1, 128][0m[2m[34m[524288, 1024, 128, 128, 1][0m[2m[32mcuda:0[0m" = k_embed[(slice([34mNone[0m, [34mNone[0m, [34mNone[0m), slice([34mNone[0m, [34mNone[0m, [34mNone[0m), slice([34mNone[0m, [34mNone[0m, [34mNone[0m), [34mNone[0m, slice([34mNone[0m, [34mNone[0m, [34mNone[0m))]
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:358 in repeat_kv, code: hidden_states = hidden_states.expand(B, T, H_kv, n_rep, D)  # (B, T, H_kv, n_rep, D)[0m
        hidden_states_7: "[31mbf16[0m[34m[1, 512, 8, 8, 128][0m[2m[34m[524288, 1024, 128, 0, 1][0m[2m[32mcuda:0[0m" = hidden_states_6.expand([34m1[0m, [34m512[0m, [34m8[0m, [34m8[0m, [34m128[0m);  [2mhidden_states_6 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv, code: return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()[0m
        reshape: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_7.reshape([34m1[0m, [34m512[0m, [34m64[0m, [34m128[0m);  [2mhidden_states_7 = None[0m
        contiguous: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = reshape.contiguous();  [2mreshape = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:589 in hxa079_TimeMix, code: k = repeat_kv(k, kv_repeat).view(B, T, -1)[0m
        k_3: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = contiguous.view([34m1[0m, [34m512[0m, [34m-1[0m);  [2mcontiguous = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:357 in repeat_kv, code: hidden_states = hidden_states[:, :, :, None, :]  # (B, T, H_kv, 1, D)[0m
        hidden_states_8: "[31mbf16[0m[34m[1, 512, 8, 1, 128][0m[2m[34m[5242880, 10240, 128, 128, 1][0m[2m[32mcuda:0[0m" = v_1[(slice([34mNone[0m, [34mNone[0m, [34mNone[0m), slice([34mNone[0m, [34mNone[0m, [34mNone[0m), slice([34mNone[0m, [34mNone[0m, [34mNone[0m), [34mNone[0m, slice([34mNone[0m, [34mNone[0m, [34mNone[0m))]
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:358 in repeat_kv, code: hidden_states = hidden_states.expand(B, T, H_kv, n_rep, D)  # (B, T, H_kv, n_rep, D)[0m
        hidden_states_9: "[31mbf16[0m[34m[1, 512, 8, 8, 128][0m[2m[34m[5242880, 10240, 128, 0, 1][0m[2m[32mcuda:0[0m" = hidden_states_8.expand([34m1[0m, [34m512[0m, [34m8[0m, [34m8[0m, [34m128[0m);  [2mhidden_states_8 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv, code: return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()[0m
        reshape_1: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_9.reshape([34m1[0m, [34m512[0m, [34m64[0m, [34m128[0m);  [2mhidden_states_9 = None[0m
        contiguous_1: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = reshape_1.contiguous();  [2mreshape_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:590 in hxa079_TimeMix, code: v = repeat_kv(v, kv_repeat).view(B, T, -1)[0m
        v_2: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = contiguous_1.view([34m1[0m, [34m512[0m, [34m-1[0m);  [2mcontiguous_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:593 in hxa079_TimeMix, code: a = torch.sigmoid(xa @ a2 + a0)[0m
        matmul_1: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = xa @ l_a2_;  [2mxa = l_a2_ = None[0m
        add_5: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = matmul_1 + l_a0_;  [2mmatmul_1 = l_a0_ = None[0m
        a: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = torch.sigmoid(add_5);  [2madd_5 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:595 in hxa079_TimeMix, code: kk = F.normalize(k.view(B, T, H, N), p=2.0, dim=-1).view(B, T, H*N)[0m
        view_7: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = k_3.view([34m1[0m, [34m512[0m, [34m64[0m, [34m128[0m)
        normalize: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = torch.nn.functional.normalize(view_7, p = [34m2.0[0m, dim = [34m-1[0m);  [2mview_7 = None[0m
        kk: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = normalize.view([34m1[0m, [34m512[0m, [34m8192[0m);  [2mnormalize = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:596 in hxa079_TimeMix, code: w = torch.tanh(xw) @ w2 + w0[0m
        tanh: "[31mbf16[0m[34m[1, 512, 480][0m[2m[34m[245760, 480, 1][0m[2m[32mcuda:0[0m" = torch.tanh(xw);  [2mxw = None[0m
        matmul_2: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = tanh @ l_w2_;  [2mtanh = l_w2_ = None[0m
        w: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = matmul_2 + l_w0_;  [2mmatmul_2 = l_w0_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:597 in hxa079_TimeMix, code: w = -F.softplus(-w) - 0.5[0m
        neg_2: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = -w;  [2mw = None[0m
        softplus: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = torch._C._nn.softplus(neg_2);  [2mneg_2 = None[0m
        neg_3: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = -softplus;  [2msoftplus = None[0m
        w_1: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = neg_3 - [34m0.5[0m;  [2mneg_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:598 in hxa079_TimeMix, code: k = k * (1.0 - w + a)[0m
        sub_1: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = [34m1.0[0m - w_1
        add_7: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = sub_1 + a;  [2msub_1 = None[0m
        k_4: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = k_3 * add_7;  [2mk_3 = add_7 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:600 in hxa079_TimeMix, code: aa = -kk[0m
        aa: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = -kk
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:601 in hxa079_TimeMix, code: bb = kk * a[0m
        bb: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = kk * a;  [2mkk = a = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:603 in hxa079_TimeMix, code: w = -w.exp()#.to(dtype=torch.float32).exp()[0m
        exp: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = w_1.exp();  [2mw_1 = None[0m
        w_2: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = -exp;  [2mexp = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:604 in hxa079_TimeMix, code: r_,w_,k_,v_,aa_,bb_ = [i.view(B,T,H,N) for i in [r,w,k,v,aa,bb]][0m
        r_: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = q_embed.view([34m1[0m, [34m512[0m, [34m64[0m, [34m128[0m)
        w_: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = w_2.view([34m1[0m, [34m512[0m, [34m64[0m, [34m128[0m);  [2mw_2 = None[0m
        k_: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = k_4.view([34m1[0m, [34m512[0m, [34m64[0m, [34m128[0m)
        v_: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = v_2.view([34m1[0m, [34m512[0m, [34m64[0m, [34m128[0m)
        aa_: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = aa.view([34m1[0m, [34m512[0m, [34m64[0m, [34m128[0m);  [2maa = None[0m
        bb_: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = bb.view([34m1[0m, [34m512[0m, [34m64[0m, [34m128[0m);  [2mbb = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:19 in <genexpr>, code: *(i if not isinstance(i, torch.Tensor) else i.contiguous() for i in args),[0m
        contiguous_2: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = r_.contiguous();  [2mr_ = None[0m
        contiguous_3: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = k_.contiguous();  [2mk_ = None[0m
        contiguous_4: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = v_.contiguous();  [2mv_ = None[0m
        contiguous_5: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = aa_.contiguous();  [2maa_ = None[0m
        contiguous_6: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = bb_.contiguous();  [2mbb_ = None[0m
        contiguous_7: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = w_.contiguous();  [2mw_ = None[0m
        contiguous_8: "[31mbf16[0m[34m[1, 64, 128, 128][0m[2m[34m[1048576, 16384, 128, 1][0m[2m[32mcuda:0[0m" = l_state_.contiguous();  [2ml_state_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:148 in forward, code: final_state = q.new_empty(B, H, K, V, dtype=torch.float32)[0m
        final_state: "[31mf32[0m[34m[1, 64, 128, 128][0m[2m[34m[1048576, 16384, 128, 1][0m[2m[32mcuda:0[0m" = contiguous_2.new_empty([34m1[0m, [34m64[0m, [34m128[0m, [34m128[0m, dtype = [34mtorch.float32[0m)
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:152 in forward, code: ha = torch.empty_like(v, dtype=torch.float32)[0m
        ha: "[31mf32[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = torch.empty_like(contiguous_4, dtype = [34mtorch.float32[0m)
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:155 in forward, code: o = torch.empty_like(v)[0m
        o: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = torch.empty_like(contiguous_4)
        
         [2m# File: /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:452 in run, code: return self.fn.run(*args, **kwargs)[0m
        triton_kernel_wrapper_mutation = torch.ops.higher_order.triton_kernel_wrapper_mutation(kernel_idx = [34m0[0m, constant_args_idx = [34m0[0m, grid = [([34m4[0m, [34m64[0m, [34m1[0m), ([34m4[0m, [34m64[0m, [34m1[0m), ([34m4[0m, [34m64[0m, [34m1[0m)], tma_descriptor_metadata = [34m{}[0m, kwargs = [34m{'q': contiguous_2, 'k': contiguous_3, 'v': contiguous_4, 'a': contiguous_5, 'b': contiguous_6, 'gk': contiguous_7, 'o': o, 'ha': ha, 'h0': contiguous_8, 'ht': final_state}[0m);  [2mcontiguous_2 = contiguous_3 = contiguous_4 = contiguous_5 = contiguous_6 = contiguous_7 = ha = contiguous_8 = triton_kernel_wrapper_mutation = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:612 in hxa079_TimeMix, code: xx = xx.view(B,T,-1) * (float(N) ** -0.5)[0m
        view_15: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = o.view([34m1[0m, [34m512[0m, [34m-1[0m);  [2mo = None[0m
        xx: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = view_15 * [34m0.08838834764831845[0m;  [2mview_15 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix, code: xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)[0m
        to_10: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = xx.to(dtype = [34mtorch.bfloat16[0m);  [2mxx = None[0m
        view_16: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = q_embed.view([34m1[0m, [34m512[0m, [34m64[0m, [34m128[0m);  [2mq_embed = None[0m
        view_17: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = k_4.view([34m1[0m, [34m512[0m, [34m64[0m, [34m128[0m);  [2mk_4 = None[0m
        mul_13: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = view_16 * view_17;  [2mview_16 = view_17 = None[0m
        view_18: "[31mbf16[0m[34m[64, 128][0m[2m[34m[128, 1][0m[2m[32mcuda:0[0m" = l_r_k_.view([34m64[0m, [34m128[0m);  [2ml_r_k_ = None[0m
        mul_14: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = mul_13 * view_18;  [2mmul_13 = view_18 = None[0m
        sum_1: "[31mbf16[0m[34m[1, 512, 64, 1][0m[2m[34m[32768, 64, 1, 1][0m[2m[32mcuda:0[0m" = mul_14.sum(dim = [34m-1[0m, keepdim = [34mTrue[0m);  [2mmul_14 = None[0m
        view_19: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = v_2.view([34m1[0m, [34m512[0m, [34m64[0m, [34m128[0m);  [2mv_2 = None[0m
        mul_15: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = sum_1 * view_19;  [2msum_1 = view_19 = None[0m
        view_20: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = mul_15.view([34m1[0m, [34m512[0m, [34m8192[0m);  [2mmul_15 = None[0m
        xx_1: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = to_10 + view_20;  [2mto_10 = view_20 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:616 in hxa079_TimeMix, code: output = fpx_matmul((xx * (torch.sigmoid(xg) @ g2)), O_, O_state,ebits,mbits)[0m
        sigmoid_1: "[31mbf16[0m[34m[1, 512, 480][0m[2m[34m[245760, 480, 1][0m[2m[32mcuda:0[0m" = torch.sigmoid(xg);  [2mxg = None[0m
        matmul_3: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = sigmoid_1 @ l_g2_;  [2msigmoid_1 = l_g2_ = None[0m
        mul_16: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = xx_1 * matmul_3;  [2mxx_1 = matmul_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul, code: x = x.to(dtype=torch.float16).view(-1,x.shape[2])[0m
        to_11: "[31mf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = mul_16.to(dtype = [34mtorch.float16[0m);  [2mmul_16 = None[0m
        x_2: "[31mf16[0m[34m[512, 8192][0m[2m[34m[8192, 1][0m[2m[32mcuda:0[0m" = to_11.view([34m-1[0m, [34m8192[0m);  [2mto_11 = None[0m
        
         [2m# File: /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__, code: return self._opoverload(*args, **kwargs)[0m
        forward_functional_default_1: "[31mf16[0m[34m[512, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m" = torch.ops.gemlite.forward_functional.default(x_2, [34mNone[0m, [l_o_w_q, l_o_parameters_scales_, l_o_parameters_zeros_], [[34m0[0m, [34m4[0m, [34m64[0m, [34m15[0m, [34m8[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m0[0m, [34m4[0m, [34m1[0m], [34m4[0m);  [2mx_2 = l_o_w_q = l_o_parameters_scales_ = l_o_parameters_zeros_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul, code: out = weight.forward_manual(x).to(dtype=dtype)[0m
        out_1: "[31mbf16[0m[34m[512, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m" = forward_functional_default_1.to(dtype = [34mtorch.bfloat16[0m);  [2mforward_functional_default_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul, code: return out.view(S0,S1,-1)[0m
        output: "[31mbf16[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = out_1.view([34m1[0m, [34m512[0m, [34m-1[0m);  [2mout_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:618 in hxa079_TimeMix, code: x_in = x_in + output[0m
        x_in: "[31mbf16[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = l_x_in_ + output;  [2ml_x_in_ = output = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states_10: "[31mf32[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = x_in.to([34mtorch.float32[0m)
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_4: "[31mf32[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states_10.pow([34m2[0m)
        variance_3: "[31mf32[0m[34m[1, 512, 1][0m[2m[34m[512, 1, 1][0m[2m[32mcuda:0[0m" = pow_4.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_4 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add_10: "[31mf32[0m[34m[1, 512, 1][0m[2m[34m[512, 1, 1][0m[2m[32mcuda:0[0m" = variance_3 + [34m1e-06[0m;  [2mvariance_3 = None[0m
        rsqrt_3: "[31mf32[0m[34m[1, 512, 1][0m[2m[34m[512, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add_10);  [2madd_10 = None[0m
        hidden_states_11: "[31mf32[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states_10 * rsqrt_3;  [2mhidden_states_10 = rsqrt_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_18: "[31mf32[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = l_ln2_ * hidden_states_11;  [2ml_ln2_ = hidden_states_11 = None[0m
        output_1: "[31mbf16[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = mul_18.to([34mtorch.bfloat16[0m);  [2mmul_18 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:621 in hxa079_TimeMix, code: return  output, x[:,-1], state, v_first, k_first, x_in[0m
        getitem_14: "[31mbf16[0m[34m[1, 5120][0m[2m[34m[2621440, 1][0m[2m[32mcuda:0[0m" = x[(slice([34mNone[0m, [34mNone[0m, [34mNone[0m), [34m-1[0m)];  [2mx = None[0m
        return (output_1, getitem_14, final_state, v_1, k_embed, x_in)
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing hxa079_TimeMix /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:524
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:524 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7)
        @torch.compile
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:550 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            x = T5RMSNorm(x_in,ln1,variance_epsilon=rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST x_in [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE KW_NAMES ('variance_epsilon',) [NullVariable, LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:550 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        x = T5RMSNorm(x_in,ln1,variance_epsilon=rmsnorm_epsilon)
            ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
wrap_to_fake L['x_in'] (1, 512, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='x_in', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_x_in_ L['x_in'] FakeTensor(..., device='cuda:0', size=(1, 512, 5120), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE FX call add from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln1'] (5120,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln1', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln1_ L['ln1'] FakeTensor(..., device='cuda:0', size=(5120,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:551 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            xw,xa,xv,xg,xk = (x @ wavgk1).split(wavgk_split_list, dim=-1)
TRACE LOAD_FAST x []
TRACE LOAD_FAST wavgk1 [TensorVariable()]
TRACE BINARY_OP 4 [TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['wavgk1'] (5120, 1376) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='wavgk1', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_wavgk1_ L['wavgk1'] FakeTensor(..., device='cuda:0', size=(5120, 1376), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call matmul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:551 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xw,xa,xv,xg,xk = (x @ wavgk1).split(wavgk_split_list, dim=-1)
                          ~~^~~~~~~~
TRACE LOAD_ATTR split [TensorVariable()]
TRACE LOAD_FAST wavgk_split_list [NullVariable, GetAttrVariable(TensorVariable(), split)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker()]
TRACE KW_NAMES ('dim',) [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE FX call split from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:551 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xw,xa,xv,xg,xk = (x @ wavgk1).split(wavgk_split_list, dim=-1)
                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE UNPACK_SEQUENCE 5 [TupleVariable(length=5)]
TRACE STORE_FAST xw [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST xa [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST xv [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST xg [TensorVariable(), TensorVariable()]
TRACE STORE_FAST xk [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:553 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            B, T, HN = x.shape
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 3 [SizeVariable(length=3)]
TRACE STORE_FAST B [ConstantVariable(int: 5120), ConstantVariable(int: 512), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 5120), ConstantVariable(int: 512)]
TRACE STORE_FAST HN [ConstantVariable(int: 5120)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:555 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            rkv = fpx_matmul(x, RKV_,RKV_state, ebits, mbits)
TRACE LOAD_GLOBAL fpx_matmul []
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST RKV_ [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST RKV_state [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_FAST ebits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST mbits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call fpx_matmul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:555 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        rkv = fpx_matmul(x, RKV_,RKV_state, ebits, mbits)
              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object fpx_matmul at 0x3063a810, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:420 in fpx_matmul (fpx_matmul) (inline depth: 1)
    def fpx_matmul(x,weight,weight_state,ebits:int=3,mbits:int=2):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:421 in fpx_matmul (fpx_matmul) (inline depth: 1)
        if ebits == -44: #hqq
TRACE LOAD_FAST ebits []
TRACE LOAD_CONST -44 [LazyVariableTracker()]
TRACE COMPARE_OP == [LazyVariableTracker(), ConstantVariable(int: -44)]
TRACE POP_JUMP_IF_FALSE 322 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S0=x.shape[0]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 0 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 0)]
TRACE STORE_FAST S0 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S1=x.shape[1]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 1)]
TRACE STORE_FAST S1 [ConstantVariable(int: 512)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:424 in fpx_matmul (fpx_matmul) (inline depth: 1)
            dtype = x.dtype
TRACE LOAD_FAST x []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
            x = x.to(dtype=torch.float16).view(-1,x.shape[2])
TRACE LOAD_FAST x []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float16 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_2 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST x [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1)]
TRACE LOAD_ATTR shape [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3), ConstantVariable(int: 2)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), ConstantVariable(int: 5120)]
TRACE FX call view from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
            out = weight.forward_manual(x).to(dtype=dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_ATTR forward_manual [LazyVariableTracker()]
TRACE LOAD_FAST x [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE CALL 1 [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton)), TensorVariable()]
TRACE inlined call forward_manual from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:543 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        def forward_manual(self, x: Tensor, matmul_type: str="GEMM") -> Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE LOAD_GLOBAL forward_functional []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:545 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                x,
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:546 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.bias,
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR bias [NullVariable, LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_tensor_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_ATTR get_tensor_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_tensor_args at 0x70c98a9e9080>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_tensor_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_tensor_args(),
            ~~~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:524 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
        def get_tensor_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:525 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
            return [self.W_q, self.scales, self.zeros]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR W_q [UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_FAST self [LazyVariableTracker()]
TRACE LOAD_ATTR scales [LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['RKV_']._parameters['scales'] (80, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='RKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='scales'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_RKV_parameters_scales_ L['RKV_']._parameters['scales'] Parameter(FakeTensor(..., device='cuda:0', size=(80, 10240), dtype=torch.float16)) at debug_level 0 before=False
TRACE LOAD_FAST self [LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR zeros [LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['RKV_']._parameters['zeros'] (80, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='RKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='zeros'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_RKV_parameters_zeros_ L['RKV_']._parameters['zeros'] Parameter(FakeTensor(..., device='cuda:0', size=(80, 10240), dtype=torch.float16)) at debug_level 0 before=False
TRACE BUILD_LIST 3 [LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [ListVariable(length=3)]
DONE INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_meta_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3)]
TRACE LOAD_ATTR get_meta_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_meta_args at 0x70c98a9e9120>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_meta_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_meta_args(),
            ~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:527 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
        def get_meta_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE LOAD_GLOBAL int []
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR scaled_activations [NullVariable, LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:529 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_nbits,
TRACE LOAD_FAST self [ConstantVariable(int: 0)]
TRACE LOAD_ATTR W_nbits [ConstantVariable(int: 0), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:530 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.group_size,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker()]
TRACE LOAD_ATTR group_size [ConstantVariable(int: 0), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:531 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.unpack_mask,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR unpack_mask [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:532 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.elements_per_sample,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR elements_per_sample [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:533 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.input_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR input_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:534 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.output_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR output_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:535 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.acc_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR acc_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:536 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.meta_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR meta_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:537 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.channel_scale_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR channel_scale_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:538 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_group_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR W_group_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:539 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    int(self.data_contiguous),
TRACE LOAD_GLOBAL int [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int)]
TRACE LOAD_ATTR data_contiguous [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE BUILD_LIST 12 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [ListVariable(length=12)]
DONE INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:549 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
TRACE LOAD_GLOBAL GEMLITE_MATMUL_TYPES_MAPPING [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12)]
TRACE LOAD_FAST matmul_type [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker(), ConstantVariable(str: 'GEMM')]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        return forward_functional(
               ~~~~~~~~~~~~~~~~~~^
            x,
            ^^
            self.bias,
            ^^^^^^^^^^
            self.get_tensor_args(),
            ^^^^^^^^^^^^^^^^^^^^^^^
            self.get_meta_args(),
            ^^^^^^^^^^^^^^^^^^^^^
            GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:675 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        def __call__(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
            return self._opoverload(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR _opoverload [NullVariable, UserDefinedObjectVariable(CustomOpDef)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=5)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
wrap_to_fake L['RKV_'].W_q (640, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=AttrSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='RKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='W_q'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_RKV_W_q L['RKV_'].W_q FakeTensor(..., device='cuda:0', size=(640, 10240), dtype=torch.int32) at debug_level 0 before=False
TRACE FX call forward_functional_default from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        return self._opoverload(*args, **kwargs)
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_3 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE STORE_FAST out [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
            return out.view(S0,S1,-1)
TRACE LOAD_FAST out []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST S0 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST S1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: -1)]
TRACE FX call view_1 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
        return out.view(S0,S1,-1)
               ~~~~~~~~^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object fpx_matmul at 0x3063a810, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>
TRACE STORE_FAST rkv [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:556 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            r,k,v = rkv.split(rkv_split_list,dim=-1)
TRACE LOAD_FAST rkv []
TRACE LOAD_ATTR split [TensorVariable()]
TRACE LOAD_FAST rkv_split_list [NullVariable, GetAttrVariable(TensorVariable(), split)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker()]
TRACE KW_NAMES ('dim',) [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE FX call split_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:556 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        r,k,v = rkv.split(rkv_split_list,dim=-1)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
TRACE UNPACK_SEQUENCE 3 [TupleVariable(length=3)]
TRACE STORE_FAST r [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST k [TensorVariable(), TensorVariable()]
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:558 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            kv_dim = k.shape[2] # B,T,kv_dim
TRACE LOAD_FAST k []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 2 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 2)]
TRACE STORE_FAST kv_dim [ConstantVariable(int: 1024)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:559 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            kv_repeat = H*N // kv_dim
TRACE LOAD_FAST H []
TRACE LOAD_FAST N [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST kv_dim [ConstantVariable(int: 8192)]
TRACE BINARY_OP 2 [ConstantVariable(int: 8192), ConstantVariable(int: 1024)]
TRACE STORE_FAST kv_repeat [ConstantVariable(int: 8)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:560 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            kv_per_head = kv_dim // N
TRACE LOAD_FAST kv_dim []
TRACE LOAD_FAST N [ConstantVariable(int: 1024)]
TRACE BINARY_OP 2 [ConstantVariable(int: 1024), ConstantVariable(int: 128)]
TRACE STORE_FAST kv_per_head [ConstantVariable(int: 8)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:562 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            r = r.add_(R_bias)
TRACE LOAD_FAST r []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST R_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
wrap_to_fake L['R_bias'] () StatefulSymbolicContext(dynamic_sizes=[], dynamic_strides=[], constraint_sizes=[], constraint_strides=[], specialize_on=[], view_base_context=None, tensor_source=LocalSource(local_name='R_bias', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_R_bias_ L['R_bias'] FakeTensor(..., device='cuda:0', size=(), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call add_ from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:562 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        r = r.add_(R_bias)
            ~~~~~~^^^^^^^^
TRACE STORE_FAST r [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:563 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = k.add_(K_bias).view(B, T, kv_per_head, N)
TRACE LOAD_FAST k []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST K_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
TRACE FX call add__1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:563 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = k.add_(K_bias).view(B, T, kv_per_head, N)
            ~~~~~~^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_per_head [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:563 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = k.add_(K_bias).view(B, T, kv_per_head, N)
            ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:564 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            v = v.add_(V_bias).view(B, T, kv_per_head, N)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST V_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
TRACE FX call add__2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:564 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        v = v.add_(V_bias).view(B, T, kv_per_head, N)
            ~~~~~~^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_per_head [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:564 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        v = v.add_(V_bias).view(B, T, kv_per_head, N)
            ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:568 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            if ln_r is None:
TRACE LOAD_FAST ln_r []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
wrap_to_fake L['ln_r'] (128,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln_r', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln_r_ L['ln_r'] FakeTensor(..., device='cuda:0', size=(128,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE POP_JUMP_IF_TRUE 478 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:572 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
                r = T5RMSNorm(r.view(B,T,H,N), ln_r, variance_epsilon=rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST r [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR view [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:572 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            r = T5RMSNorm(r.view(B,T,H,N), ln_r, variance_epsilon=rmsnorm_epsilon)
                          ~~~~~~^^^^^^^^^
TRACE LOAD_FAST ln_r [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE KW_NAMES ('variance_epsilon',) [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:572 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            r = T5RMSNorm(r.view(B,T,H,N), ln_r, variance_epsilon=rmsnorm_epsilon)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST r [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:573 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
                k = T5RMSNorm(k, ln_k, variance_epsilon=rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln_k [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE KW_NAMES ('variance_epsilon',) [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ConstantVariable(float: 1e-06)]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:573 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = T5RMSNorm(k, ln_k, variance_epsilon=rmsnorm_epsilon)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln_k'] (128,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln_k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln_k_ L['ln_k'] FakeTensor(..., device='cuda:0', size=(128,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:576 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            cos, sin = calc_cos.to(k.dtype), calc_sin.to(k.dtype)
TRACE LOAD_FAST calc_cos []
TRACE LOAD_ATTR to [LazyVariableTracker()]
wrap_to_fake L['calc_cos'] (1, 512, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='calc_cos', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_calc_cos_ L['calc_cos'] FakeTensor(..., device='cuda:0', size=(1, 512, 128)) at debug_level 0 before=False
TRACE LOAD_FAST k [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR dtype [NullVariable, GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_8 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:576 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        cos, sin = calc_cos.to(k.dtype), calc_sin.to(k.dtype)
                   ~~~~~~~~~~~^^^^^^^^^
TRACE LOAD_FAST calc_sin [TensorVariable()]
TRACE LOAD_ATTR to [TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['calc_sin'] (1, 512, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='calc_sin', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_calc_sin_ L['calc_sin'] FakeTensor(..., device='cuda:0', size=(1, 512, 128)) at debug_level 0 before=False
TRACE LOAD_FAST k [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR dtype [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE CALL 1 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_9 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:576 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        cos, sin = calc_cos.to(k.dtype), calc_sin.to(k.dtype)
                                         ~~~~~~~~~~~^^^^^^^^^
TRACE STORE_FAST sin [TensorVariable(), TensorVariable()]
TRACE STORE_FAST cos [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:577 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            r, k = apply_rotary_pos_emb(r, k, cos, sin,unsqueeze_dim=2)
TRACE LOAD_GLOBAL apply_rotary_pos_emb []
TRACE LOAD_FAST r [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST cos [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST sin [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE KW_NAMES ('unsqueeze_dim',) [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(int: 2)]
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(int: 2)]
TRACE inlined call apply_rotary_pos_emb from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:577 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        r, k = apply_rotary_pos_emb(r, k, cos, sin,unsqueeze_dim=2)
               ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object apply_rotary_pos_emb at 0x70c98a344710, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 473>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:473 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    def apply_rotary_pos_emb(q, k, cos, sin, position_ids=None, unsqueeze_dim=1):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:493 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
        cos = cos.unsqueeze(unsqueeze_dim)
TRACE LOAD_FAST cos []
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_FAST unsqueeze_dim [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int: 2)]
TRACE FX call unsqueeze from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:493 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    cos = cos.unsqueeze(unsqueeze_dim)
          ~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST cos [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:494 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
        sin = sin.unsqueeze(unsqueeze_dim)
TRACE LOAD_FAST sin []
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_FAST unsqueeze_dim [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int: 2)]
TRACE FX call unsqueeze_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:494 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    sin = sin.unsqueeze(unsqueeze_dim)
          ~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST sin [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
        q_embed = (q * cos) + (rotate_half(q) * sin)
TRACE LOAD_FAST q []
TRACE LOAD_FAST cos [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    q_embed = (q * cos) + (rotate_half(q) * sin)
               ~~^~~~~
TRACE LOAD_GLOBAL rotate_half [TensorVariable()]
TRACE LOAD_FAST q [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE inlined call rotate_half from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    q_embed = (q * cos) + (rotate_half(q) * sin)
                           ~~~~~~~~~~~^^^
INLINING <code object rotate_half at 0x70c98a344450, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 467>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:467 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    def rotate_half(x):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
        x1 = x[..., : x.shape[-1] // 2]
TRACE LOAD_FAST x []
TRACE LOAD_CONST Ellipsis [TensorVariable()]
TRACE LOAD_CONST None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis)]
TRACE LOAD_FAST x [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None)]
TRACE LOAD_ATTR shape [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), SizeVariable(length=4)]
TRACE BINARY_SUBSCR None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), SizeVariable(length=4), ConstantVariable(int: -1)]
TRACE LOAD_CONST 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), ConstantVariable(int: 128)]
TRACE BINARY_OP 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), ConstantVariable(int: 128), ConstantVariable(int: 2)]
TRACE BUILD_SLICE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), ConstantVariable(int: 64)]
TRACE BUILD_TUPLE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SliceVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), TupleVariable(length=2)]
TRACE FX call getitem_8 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    x1 = x[..., : x.shape[-1] // 2]
         ~^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST x1 [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
        x2 = x[..., x.shape[-1] // 2 :]
TRACE LOAD_FAST x []
TRACE LOAD_CONST Ellipsis [TensorVariable()]
TRACE LOAD_FAST x [TensorVariable(), ConstantVariable(ellipsis: Ellipsis)]
TRACE LOAD_ATTR shape [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SizeVariable(length=4)]
TRACE BINARY_SUBSCR None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SizeVariable(length=4), ConstantVariable(int: -1)]
TRACE LOAD_CONST 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 128)]
TRACE BINARY_OP 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 128), ConstantVariable(int: 2)]
TRACE LOAD_CONST None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 64)]
TRACE BUILD_SLICE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 64), ConstantVariable(NoneType: None)]
TRACE BUILD_TUPLE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SliceVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), TupleVariable(length=2)]
TRACE FX call getitem_9 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    x2 = x[..., x.shape[-1] // 2 :]
         ~^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST x2 [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
        return torch.cat((-x2, x1), dim=-1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST x2 [NullVariable, LazyVariableTracker()]
TRACE UNARY_NEGATIVE None [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call neg from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    return torch.cat((-x2, x1), dim=-1)
                      ^^^
TRACE LOAD_FAST x1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, LazyVariableTracker(), TupleVariable(length=2)]
TRACE KW_NAMES ('dim',) [NullVariable, LazyVariableTracker(), TupleVariable(length=2), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TupleVariable(length=2), ConstantVariable(int: -1)]
TRACE FX call cat from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    return torch.cat((-x2, x1), dim=-1)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object rotate_half at 0x70c98a344450, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 467>
TRACE LOAD_FAST sin [TensorVariable(), TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call mul_7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    q_embed = (q * cos) + (rotate_half(q) * sin)
                           ~~~~~~~~~~~~~~~^~~~~
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable()]
TRACE FX call add_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    q_embed = (q * cos) + (rotate_half(q) * sin)
              ~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST q_embed [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
        k_embed = (k * cos) + (rotate_half(k) * sin)
TRACE LOAD_FAST k []
TRACE LOAD_FAST cos [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_8 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    k_embed = (k * cos) + (rotate_half(k) * sin)
               ~~^~~~~
TRACE LOAD_GLOBAL rotate_half [TensorVariable()]
TRACE LOAD_FAST k [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE inlined call rotate_half from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    k_embed = (k * cos) + (rotate_half(k) * sin)
                           ~~~~~~~~~~~^^^
INLINING <code object rotate_half at 0x70c98a344450, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 467>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:467 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    def rotate_half(x):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
        x1 = x[..., : x.shape[-1] // 2]
TRACE LOAD_FAST x []
TRACE LOAD_CONST Ellipsis [TensorVariable()]
TRACE LOAD_CONST None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis)]
TRACE LOAD_FAST x [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None)]
TRACE LOAD_ATTR shape [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), SizeVariable(length=4)]
TRACE BINARY_SUBSCR None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), SizeVariable(length=4), ConstantVariable(int: -1)]
TRACE LOAD_CONST 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), ConstantVariable(int: 128)]
TRACE BINARY_OP 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), ConstantVariable(int: 128), ConstantVariable(int: 2)]
TRACE BUILD_SLICE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), ConstantVariable(int: 64)]
TRACE BUILD_TUPLE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SliceVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), TupleVariable(length=2)]
TRACE FX call getitem_10 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    x1 = x[..., : x.shape[-1] // 2]
         ~^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST x1 [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
        x2 = x[..., x.shape[-1] // 2 :]
TRACE LOAD_FAST x []
TRACE LOAD_CONST Ellipsis [TensorVariable()]
TRACE LOAD_FAST x [TensorVariable(), ConstantVariable(ellipsis: Ellipsis)]
TRACE LOAD_ATTR shape [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SizeVariable(length=4)]
TRACE BINARY_SUBSCR None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SizeVariable(length=4), ConstantVariable(int: -1)]
TRACE LOAD_CONST 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 128)]
TRACE BINARY_OP 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 128), ConstantVariable(int: 2)]
TRACE LOAD_CONST None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 64)]
TRACE BUILD_SLICE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 64), ConstantVariable(NoneType: None)]
TRACE BUILD_TUPLE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SliceVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), TupleVariable(length=2)]
TRACE FX call getitem_11 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    x2 = x[..., x.shape[-1] // 2 :]
         ~^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST x2 [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
        return torch.cat((-x2, x1), dim=-1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST x2 [NullVariable, LazyVariableTracker()]
TRACE UNARY_NEGATIVE None [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call neg_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    return torch.cat((-x2, x1), dim=-1)
                      ^^^
TRACE LOAD_FAST x1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, LazyVariableTracker(), TupleVariable(length=2)]
TRACE KW_NAMES ('dim',) [NullVariable, LazyVariableTracker(), TupleVariable(length=2), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TupleVariable(length=2), ConstantVariable(int: -1)]
TRACE FX call cat_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    return torch.cat((-x2, x1), dim=-1)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object rotate_half at 0x70c98a344450, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 467>
TRACE LOAD_FAST sin [TensorVariable(), TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call mul_9 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    k_embed = (k * cos) + (rotate_half(k) * sin)
                           ~~~~~~~~~~~~~~~^~~~~
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable()]
TRACE FX call add_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    k_embed = (k * cos) + (rotate_half(k) * sin)
              ~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST k_embed [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:497 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
        return q_embed, k_embed
TRACE LOAD_FAST q_embed []
TRACE LOAD_FAST k_embed [TensorVariable()]
TRACE BUILD_TUPLE 2 [TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object apply_rotary_pos_emb at 0x70c98a344710, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 473>
TRACE UNPACK_SEQUENCE 2 [TupleVariable(length=2)]
TRACE STORE_FAST r [TensorVariable(), TensorVariable()]
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:579 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            if layer_id == 0:
TRACE LOAD_FAST layer_id []
TRACE LOAD_CONST 0 [LazyVariableTracker()]
TRACE COMPARE_OP == [LazyVariableTracker(), ConstantVariable(int: 0)]
automatic dynamic int L['layer_id'] val 1 != 0
create_graph_input L_layer_id_ L['layer_id'] s56 at debug_level 0 before=False
TRACE FX call eq from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:579 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        if layer_id == 0:
           ^^^^^^^^^^^^^
TRACE POP_JUMP_IF_FALSE 736 [SymNodeVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:584 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
                v = v + (v_first - v) * torch.sigmoid(xv@v2 + v0).view(B, T, kv_per_head, N)
TRACE LOAD_FAST v []
TRACE LOAD_FAST v_first [TensorVariable()]
TRACE LOAD_FAST v [TensorVariable(), LazyVariableTracker()]
TRACE BINARY_OP 10 [TensorVariable(), LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['v_first'] (1, 512, 8, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None], constraint_strides=[None, None, None, None], specialize_on=[[], [], [], []], view_base_context=None, tensor_source=LocalSource(local_name='v_first', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_v_first_ L['v_first'] FakeTensor(..., device='cuda:0', size=(1, 512, 8, 128), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call sub from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:584 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            v = v + (v_first - v) * torch.sigmoid(xv@v2 + v0).view(B, T, kv_per_head, N)
                     ~~~~~~~~^~~
TRACE LOAD_GLOBAL torch [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR sigmoid [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST xv [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST v2 [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 4 [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['v2'] (128, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='v2', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_v2_ L['v2'] FakeTensor(..., device='cuda:0', size=(128, 1024), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call matmul_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:584 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            v = v + (v_first - v) * torch.sigmoid(xv@v2 + v0).view(B, T, kv_per_head, N)
                                                  ~~^^~
TRACE LOAD_FAST v0 [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['v0'] (1, 1, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='v0', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_v0_ L['v0'] FakeTensor(..., device='cuda:0', size=(1, 1, 1024), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call add_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:584 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            v = v + (v_first - v) * torch.sigmoid(xv@v2 + v0).view(B, T, kv_per_head, N)
                                                  ~~~~~~^~~~
TRACE CALL 1 [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call sigmoid from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:584 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            v = v + (v_first - v) * torch.sigmoid(xv@v2 + v0).view(B, T, kv_per_head, N)
                                    ~~~~~~~~~~~~~^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST B [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_per_head [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8)]
TRACE CALL 4 [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:584 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            v = v + (v_first - v) * torch.sigmoid(xv@v2 + v0).view(B, T, kv_per_head, N)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call mul_10 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:584 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            v = v + (v_first - v) * torch.sigmoid(xv@v2 + v0).view(B, T, kv_per_head, N)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable()]
TRACE FX call add_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:584 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            v = v + (v_first - v) * torch.sigmoid(xv@v2 + v0).view(B, T, kv_per_head, N)
                ~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:585 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
                k = k + (k_first - k) * torch.sigmoid(xk@k2 + k0).view(B, T, kv_per_head, N)
TRACE LOAD_FAST k []
TRACE LOAD_FAST k_first [TensorVariable()]
TRACE LOAD_FAST k [TensorVariable(), LazyVariableTracker()]
TRACE BINARY_OP 10 [TensorVariable(), LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['k_first'] (1, 512, 8, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None], constraint_strides=[None, None, None, None], specialize_on=[[], [], [], []], view_base_context=None, tensor_source=LocalSource(local_name='k_first', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_k_first_ L['k_first'] FakeTensor(..., device='cuda:0', size=(1, 512, 8, 128), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call sub_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:585 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = k + (k_first - k) * torch.sigmoid(xk@k2 + k0).view(B, T, kv_per_head, N)
                     ~~~~~~~~^~~
TRACE LOAD_GLOBAL torch [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR sigmoid [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST xk [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST k2 [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 4 [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['k2'] (128, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='k2', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_k2_ L['k2'] FakeTensor(..., device='cuda:0', size=(128, 1024), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call matmul_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:585 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = k + (k_first - k) * torch.sigmoid(xk@k2 + k0).view(B, T, kv_per_head, N)
                                                  ~~^^~
TRACE LOAD_FAST k0 [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['k0'] (1, 1, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='k0', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_k0_ L['k0'] FakeTensor(..., device='cuda:0', size=(1, 1, 1024), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call add_7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:585 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = k + (k_first - k) * torch.sigmoid(xk@k2 + k0).view(B, T, kv_per_head, N)
                                                  ~~~~~~^~~~
TRACE CALL 1 [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call sigmoid_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:585 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = k + (k_first - k) * torch.sigmoid(xk@k2 + k0).view(B, T, kv_per_head, N)
                                    ~~~~~~~~~~~~~^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST B [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_per_head [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8)]
TRACE CALL 4 [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:585 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = k + (k_first - k) * torch.sigmoid(xk@k2 + k0).view(B, T, kv_per_head, N)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call mul_11 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:585 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = k + (k_first - k) * torch.sigmoid(xk@k2 + k0).view(B, T, kv_per_head, N)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable()]
TRACE FX call add_8 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:585 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = k + (k_first - k) * torch.sigmoid(xk@k2 + k0).view(B, T, kv_per_head, N)
                ~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:589 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = repeat_kv(k, kv_repeat).view(B, T, -1)
TRACE LOAD_GLOBAL repeat_kv []
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST kv_repeat [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 8)]
TRACE inlined call repeat_kv from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:589 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = repeat_kv(k, kv_repeat).view(B, T, -1)
            ~~~~~~~~~^^^^^^^^^^^^^^
INLINING <code object repeat_kv at 0x70c98a2f25b0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 347>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:347 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    def repeat_kv(hidden_states: torch.Tensor, n_rep: int) -> torch.Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:353 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        B, T, H_kv, D = hidden_states.shape
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 4 [SizeVariable(length=4)]
TRACE STORE_FAST B [ConstantVariable(int: 128), ConstantVariable(int: 8), ConstantVariable(int: 512), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 128), ConstantVariable(int: 8), ConstantVariable(int: 512)]
TRACE STORE_FAST H_kv [ConstantVariable(int: 128), ConstantVariable(int: 8)]
TRACE STORE_FAST D [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:354 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        if n_rep == 1:
TRACE LOAD_FAST n_rep []
TRACE LOAD_CONST 1 [ConstantVariable(int: 8)]
TRACE COMPARE_OP == [ConstantVariable(int: 8), ConstantVariable(int: 1)]
TRACE POP_JUMP_IF_FALSE 50 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:357 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        hidden_states = hidden_states[:, :, :, None, :]  # (B, T, H_kv, 1, D)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_CONST None [TensorVariable()]
TRACE LOAD_CONST None [TensorVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable()]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable()]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable()]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE BUILD_TUPLE 5 [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), SliceVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), TupleVariable(length=5)]
TRACE FX call getitem_12 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:357 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    hidden_states = hidden_states[:, :, :, None, :]  # (B, T, H_kv, 1, D)
                    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:358 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        hidden_states = hidden_states.expand(B, T, H_kv, n_rep, D)  # (B, T, H_kv, n_rep, D)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR expand [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), expand)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1)]
TRACE LOAD_FAST H_kv [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST n_rep [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8)]
TRACE LOAD_FAST D [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8), ConstantVariable(int: 8)]
TRACE CALL 5 [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call expand from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:358 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    hidden_states = hidden_states.expand(B, T, H_kv, n_rep, D)  # (B, T, H_kv, n_rep, D)
                    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR reshape [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), reshape)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1)]
TRACE LOAD_FAST H_kv [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST n_rep [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8)]
TRACE BINARY_OP 5 [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8), ConstantVariable(int: 8)]
TRACE LOAD_FAST D [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call reshape from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR contiguous [TensorVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE FX call contiguous from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object repeat_kv at 0x70c98a2f25b0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 347>
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: -1)]
TRACE FX call view_7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:589 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = repeat_kv(k, kv_repeat).view(B, T, -1)
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:590 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            v = repeat_kv(v, kv_repeat).view(B, T, -1)
TRACE LOAD_GLOBAL repeat_kv []
TRACE LOAD_FAST v [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST kv_repeat [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 8)]
TRACE inlined call repeat_kv from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:590 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        v = repeat_kv(v, kv_repeat).view(B, T, -1)
            ~~~~~~~~~^^^^^^^^^^^^^^
INLINING <code object repeat_kv at 0x70c98a2f25b0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 347>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:347 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    def repeat_kv(hidden_states: torch.Tensor, n_rep: int) -> torch.Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:353 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        B, T, H_kv, D = hidden_states.shape
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 4 [SizeVariable(length=4)]
TRACE STORE_FAST B [ConstantVariable(int: 128), ConstantVariable(int: 8), ConstantVariable(int: 512), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 128), ConstantVariable(int: 8), ConstantVariable(int: 512)]
TRACE STORE_FAST H_kv [ConstantVariable(int: 128), ConstantVariable(int: 8)]
TRACE STORE_FAST D [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:354 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        if n_rep == 1:
TRACE LOAD_FAST n_rep []
TRACE LOAD_CONST 1 [ConstantVariable(int: 8)]
TRACE COMPARE_OP == [ConstantVariable(int: 8), ConstantVariable(int: 1)]
TRACE POP_JUMP_IF_FALSE 50 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:357 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        hidden_states = hidden_states[:, :, :, None, :]  # (B, T, H_kv, 1, D)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_CONST None [TensorVariable()]
TRACE LOAD_CONST None [TensorVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable()]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable()]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable()]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE BUILD_TUPLE 5 [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), SliceVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), TupleVariable(length=5)]
TRACE FX call getitem_13 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:357 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    hidden_states = hidden_states[:, :, :, None, :]  # (B, T, H_kv, 1, D)
                    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:358 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        hidden_states = hidden_states.expand(B, T, H_kv, n_rep, D)  # (B, T, H_kv, n_rep, D)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR expand [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), expand)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1)]
TRACE LOAD_FAST H_kv [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST n_rep [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8)]
TRACE LOAD_FAST D [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8), ConstantVariable(int: 8)]
TRACE CALL 5 [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call expand_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:358 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    hidden_states = hidden_states.expand(B, T, H_kv, n_rep, D)  # (B, T, H_kv, n_rep, D)
                    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR reshape [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), reshape)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1)]
TRACE LOAD_FAST H_kv [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST n_rep [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8)]
TRACE BINARY_OP 5 [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8), ConstantVariable(int: 8)]
TRACE LOAD_FAST D [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call reshape_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR contiguous [TensorVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE FX call contiguous_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object repeat_kv at 0x70c98a2f25b0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 347>
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: -1)]
TRACE FX call view_8 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:590 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        v = repeat_kv(v, kv_repeat).view(B, T, -1)
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:593 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            a = torch.sigmoid(xa @ a2 + a0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR sigmoid [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST xa [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST a2 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 4 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['a2'] (160, 8192) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='a2', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_a2_ L['a2'] FakeTensor(..., device='cuda:0', size=(160, 8192), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call matmul_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:593 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        a = torch.sigmoid(xa @ a2 + a0)
                          ~~~^~~~
TRACE LOAD_FAST a0 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['a0'] (1, 1, 8192) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='a0', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_a0_ L['a0'] FakeTensor(..., device='cuda:0', size=(1, 1, 8192), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call add_9 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:593 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        a = torch.sigmoid(xa @ a2 + a0)
                          ~~~~~~~~^~~~
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call sigmoid_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:593 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        a = torch.sigmoid(xa @ a2 + a0)
            ~~~~~~~~~~~~~^^^^^^^^^^^^^^
TRACE STORE_FAST a [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:595 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            kk = F.normalize(k.view(B, T, H, N), p=2.0, dim=-1).view(B, T, H*N)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR normalize [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR view [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_9 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:595 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        kk = F.normalize(k.view(B, T, H, N), p=2.0, dim=-1).view(B, T, H*N)
                         ~~~~~~^^^^^^^^^^^^
TRACE LOAD_CONST 2.0 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 2.0)]
TRACE KW_NAMES ('p', 'dim') [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 2.0), ConstantVariable(int: -1)]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 2.0), ConstantVariable(int: -1)]
TRACE FX call normalize from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:595 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        kk = F.normalize(k.view(B, T, H, N), p=2.0, dim=-1).view(B, T, H*N)
             ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64)]
TRACE BINARY_OP 5 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8192)]
TRACE FX call view_10 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:595 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        kk = F.normalize(k.view(B, T, H, N), p=2.0, dim=-1).view(B, T, H*N)
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
TRACE STORE_FAST kk [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:596 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            w = torch.tanh(xw) @ w2 + w0
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR tanh [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST xw [NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call tanh from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:596 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = torch.tanh(xw) @ w2 + w0
            ~~~~~~~~~~^^^^
TRACE LOAD_FAST w2 [TensorVariable()]
TRACE BINARY_OP 4 [TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['w2'] (480, 8192) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='w2', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_w2_ L['w2'] FakeTensor(..., device='cuda:0', size=(480, 8192), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call matmul_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:596 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = torch.tanh(xw) @ w2 + w0
            ~~~~~~~~~~~~~~~^~~~
TRACE LOAD_FAST w0 [TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['w0'] (1, 1, 8192) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='w0', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_w0_ L['w0'] FakeTensor(..., device='cuda:0', size=(1, 1, 8192), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call add_10 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:596 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = torch.tanh(xw) @ w2 + w0
            ~~~~~~~~~~~~~~~~~~~~^~~~
TRACE STORE_FAST w [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:597 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            w = -F.softplus(-w) - 0.5
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR softplus [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST w [NullVariable, LazyVariableTracker()]
TRACE UNARY_NEGATIVE None [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call neg_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:597 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = -F.softplus(-w) - 0.5
                        ^^
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call softplus from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:597 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = -F.softplus(-w) - 0.5
             ~~~~~~~~~~^^^^
TRACE UNARY_NEGATIVE None [TensorVariable()]
TRACE FX call neg_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:597 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = -F.softplus(-w) - 0.5
            ^^^^^^^^^^^^^^^
TRACE LOAD_CONST 0.5 [TensorVariable()]
TRACE BINARY_OP 10 [TensorVariable(), ConstantVariable(float: 0.5)]
TRACE FX call sub_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:597 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = -F.softplus(-w) - 0.5
            ~~~~~~~~~~~~~~~~^~~~~
TRACE STORE_FAST w [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:598 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = k * (1.0 - w + a)
TRACE LOAD_FAST k []
TRACE LOAD_CONST 1.0 [TensorVariable()]
TRACE LOAD_FAST w [TensorVariable(), ConstantVariable(float: 1.0)]
TRACE BINARY_OP 10 [TensorVariable(), ConstantVariable(float: 1.0), TensorVariable()]
TRACE FX call sub_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:598 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = k * (1.0 - w + a)
                 ~~~~^~~
TRACE LOAD_FAST a [TensorVariable(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call add_11 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:598 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = k * (1.0 - w + a)
                 ~~~~~~~~^~~
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_12 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:598 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = k * (1.0 - w + a)
            ~~^~~~~~~~~~~~~~~
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:600 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            aa = -kk
TRACE LOAD_FAST kk []
TRACE UNARY_NEGATIVE None [TensorVariable()]
TRACE FX call neg_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:600 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        aa = -kk
             ^^^
TRACE STORE_FAST aa [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:601 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            bb = kk * a
TRACE LOAD_FAST kk []
TRACE LOAD_FAST a [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_13 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:601 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        bb = kk * a
             ~~~^~~
TRACE STORE_FAST bb [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:603 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            w = -w.exp()#.to(dtype=torch.float32).exp()
TRACE LOAD_FAST w []
TRACE LOAD_ATTR exp [TensorVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), exp)]
TRACE FX call exp from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:603 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = -w.exp()#.to(dtype=torch.float32).exp()
             ~~~~~^^
TRACE UNARY_NEGATIVE None [TensorVariable()]
TRACE FX call neg_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:603 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = -w.exp()#.to(dtype=torch.float32).exp()
            ^^^^^^^^
TRACE STORE_FAST w [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:604 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            r_,w_,k_,v_,aa_,bb_ = [i.view(B,T,H,N) for i in [r,w,k,v,aa,bb]]
TRACE LOAD_FAST r []
TRACE LOAD_FAST w [TensorVariable()]
TRACE LOAD_FAST k [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST v [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST aa [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST bb [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 6 [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE GET_ITER None [TupleVariable(length=6)]
TRACE LOAD_FAST_AND_CLEAR i [ListIteratorVariable(length=6, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=6, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=6, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=6, index=0), ListVariable(length=0)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=0)]
TRACE STORE_FAST i [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), TensorVariable()]
TRACE LOAD_FAST i [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1)]
TRACE LOAD_ATTR view [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_11 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:604 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        r_,w_,k_,v_,aa_,bb_ = [i.view(B,T,H,N) for i in [r,w,k,v,aa,bb]]
                               ~~~~~~^^^^^^^^^
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), TensorVariable()]
TRACE JUMP_BACKWARD 1448 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=1)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=1)]
TRACE STORE_FAST i [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), TensorVariable()]
TRACE LOAD_FAST i [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2)]
TRACE LOAD_ATTR view [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), TensorVariable()]
TRACE JUMP_BACKWARD 1448 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=2)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=2)]
TRACE STORE_FAST i [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), TensorVariable()]
TRACE LOAD_FAST i [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3)]
TRACE LOAD_ATTR view [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), TensorVariable()]
TRACE JUMP_BACKWARD 1448 [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=3)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=3)]
TRACE STORE_FAST i [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), TensorVariable()]
TRACE LOAD_FAST i [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4)]
TRACE LOAD_ATTR view [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), TensorVariable()]
TRACE JUMP_BACKWARD 1448 [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=4)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=4)]
TRACE STORE_FAST i [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), TensorVariable()]
TRACE LOAD_FAST i [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5)]
TRACE LOAD_ATTR view [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), TensorVariable()]
TRACE JUMP_BACKWARD 1448 [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=5)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=5)]
TRACE STORE_FAST i [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), TensorVariable()]
TRACE LOAD_FAST i [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6)]
TRACE LOAD_ATTR view [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), TensorVariable()]
TRACE JUMP_BACKWARD 1448 [NullVariable, ListVariable(length=6), ListIteratorVariable(length=6, index=6)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=6), ListIteratorVariable(length=6, index=6)]
TRACE END_FOR None [NullVariable, ListVariable(length=6), ListIteratorVariable(length=6, index=6), ConstantVariable(NoneType: None)]
TRACE SWAP 2 [NullVariable, ListVariable(length=6)]
TRACE STORE_FAST i [ListVariable(length=6), NullVariable]
TRACE UNPACK_SEQUENCE 6 [ListVariable(length=6)]
TRACE STORE_FAST r_ [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST w_ [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST k_ [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST v_ [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST aa_ [TensorVariable(), TensorVariable()]
TRACE STORE_FAST bb_ [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:605 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            B,T,_,_ = r_.shape
TRACE LOAD_FAST r_ []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 4 [SizeVariable(length=4)]
TRACE STORE_FAST B [ConstantVariable(int: 128), ConstantVariable(int: 64), ConstantVariable(int: 512), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 128), ConstantVariable(int: 64), ConstantVariable(int: 512)]
TRACE STORE_FAST _ [ConstantVariable(int: 128), ConstantVariable(int: 64)]
TRACE STORE_FAST _ [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:609 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            xx, state = fused_recurrent_rwkv7(r_, w_, k_, v_, aa_, bb_, scale=1.0, initial_state=state, output_final_state=True, head_first=False)
TRACE LOAD_GLOBAL fused_recurrent_rwkv7 []
TRACE LOAD_FAST r_ [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST w_ [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST k_ [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST v_ [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST aa_ [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST bb_ [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 1.0 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST state [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0)]
TRACE LOAD_CONST True [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker()]
TRACE LOAD_CONST False [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True)]
TRACE KW_NAMES ('scale', 'initial_state', 'output_final_state', 'head_first') [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(bool: False)]
TRACE CALL 10 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(bool: False)]
TRACE inlined call fused_recurrent_rwkv7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:609 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx, state = fused_recurrent_rwkv7(r_, w_, k_, v_, aa_, bb_, scale=1.0, initial_state=state, output_final_state=True, head_first=False)
                    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object fused_recurrent_rwkv7 at 0x70c98d0c9890, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py", line 11>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:11 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
    def fused_recurrent_rwkv7(
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:50 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
        return fused_recurrent_dplr_delta_rule(
TRACE LOAD_GLOBAL fused_recurrent_dplr_delta_rule []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:51 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            q=r,
TRACE LOAD_FAST r [NullVariable, LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:52 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            k=k,
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:53 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            v=v,
TRACE LOAD_FAST v [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:54 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            a=a,
TRACE LOAD_FAST a [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:55 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            b=b,
TRACE LOAD_FAST b [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:56 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            gk=log_w,
TRACE LOAD_FAST log_w [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:57 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            scale=scale,
TRACE LOAD_FAST scale [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:58 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            initial_state=initial_state,
TRACE LOAD_FAST initial_state [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:59 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            output_final_state=output_final_state,
TRACE LOAD_FAST output_final_state [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:60 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            cu_seqlens=cu_seqlens,
TRACE LOAD_FAST cu_seqlens [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:61 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            head_first=head_first
TRACE LOAD_FAST head_first [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:50 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
        return fused_recurrent_dplr_delta_rule(
TRACE KW_NAMES ('q', 'k', 'v', 'a', 'b', 'gk', 'scale', 'initial_state', 'output_final_state', 'cu_seqlens', 'head_first') [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(NoneType: None), ConstantVariable(bool: False)]
TRACE CALL 11 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(NoneType: None), ConstantVariable(bool: False)]
TRACE inlined call fused_recurrent_dplr_delta_rule from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:50 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
    return fused_recurrent_dplr_delta_rule(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        q=r,
        ^^^^
        k=k,
        ^^^^
        v=v,
        ^^^^
        a=a,
        ^^^^
        b=b,
        ^^^^
        gk=log_w,
        ^^^^^^^^^
        scale=scale,
        ^^^^^^^^^^^^
        initial_state=initial_state,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        output_final_state=output_final_state,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        cu_seqlens=cu_seqlens,
        ^^^^^^^^^^^^^^^^^^^^^^
        head_first=head_first
        ^^^^^^^^^^^^^^^^^^^^^
    )
    ^
INLINING <code object fused_recurrent_dplr_delta_rule at 0x305fb4e0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 188>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:188 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
    def fused_recurrent_dplr_delta_rule(
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:231 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
        if cu_seqlens is not None:
TRACE LOAD_FAST cu_seqlens []
TRACE LOAD_CONST None [ConstantVariable(NoneType: None)]
TRACE IS_OP 0 [ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 282 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:240 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
        if scale is None:
TRACE LOAD_FAST scale []
TRACE LOAD_CONST None [ConstantVariable(float: 1.0)]
TRACE IS_OP 1 [ConstantVariable(float: 1.0), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 328 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:243 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            assert scale > 0, "scale must be positive"
TRACE LOAD_FAST scale []
TRACE LOAD_CONST 0 [ConstantVariable(float: 1.0)]
TRACE COMPARE_OP > [ConstantVariable(float: 1.0), ConstantVariable(int: 0)]
TRACE POP_JUMP_IF_TRUE 352 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:244 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
        o, final_state = FusedRecurrentDPLRDeltaRuleFunction.apply(
TRACE LOAD_GLOBAL FusedRecurrentDPLRDeltaRuleFunction []
TRACE LOAD_ATTR apply [LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:245 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            q,
TRACE LOAD_FAST q [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:246 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            k,
TRACE LOAD_FAST k [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:247 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            v,
TRACE LOAD_FAST v [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:248 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            a,
TRACE LOAD_FAST a [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:249 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            b,
TRACE LOAD_FAST b [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:250 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            gk,
TRACE LOAD_FAST gk [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:251 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            scale,
TRACE LOAD_FAST scale [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:252 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            initial_state,
TRACE LOAD_FAST initial_state [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:253 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            output_final_state,
TRACE LOAD_FAST output_final_state [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:254 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            cu_seqlens,
TRACE LOAD_FAST cu_seqlens [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:255 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            head_first
TRACE LOAD_FAST head_first [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:244 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
        o, final_state = FusedRecurrentDPLRDeltaRuleFunction.apply(
TRACE CALL 11 [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(NoneType: None), ConstantVariable(bool: False)]
wrap_to_fake L['state'] (1, 64, 128, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None], constraint_strides=[None, None, None, None], specialize_on=[[], [], [], []], view_base_context=StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='state', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}), tensor_source=LocalSource(local_name='state', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_state_ L['state'] FakeTensor(..., device='cuda:0', size=(1, 64, 128, 128), dtype=torch.bfloat16) at debug_level 0 before=False
wrap_to_fake L['state']._base (56, 1, 64, 128, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='state', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
TRACE inlined call wrapper from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:244 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
    o, final_state = FusedRecurrentDPLRDeltaRuleFunction.apply(
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        q,
        ^^
        k,
        ^^
        v,
        ^^
        a,
        ^^
        b,
        ^^
        gk,
        ^^^
        scale,
        ^^^^^^
        initial_state,
        ^^^^^^^^^^^^^^
        output_final_state,
        ^^^^^^^^^^^^^^^^^^^
        cu_seqlens,
        ^^^^^^^^^^^
        head_first
        ^^^^^^^^^^
    )
    ^
INLINING <code object wrapper at 0x70c98d04f0a0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 16>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 1 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:16 in wrapper (contiguous) (inline depth: 3)
        @functools.wraps(fn)
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:18 in wrapper (contiguous.wrapper) (inline depth: 3)
            return fn(ctx,
TRACE PUSH_NULL None []
TRACE LOAD_DEREF fn [NullVariable]
TRACE LOAD_FAST ctx [NullVariable, LazyVariableTracker()]
TRACE BUILD_LIST 1 [NullVariable, LazyVariableTracker(), AutogradFunctionContextVariable(Function)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:19 in wrapper (contiguous.wrapper) (inline depth: 3)
                      *(i if not isinstance(i, torch.Tensor) else i.contiguous() for i in args),
TRACE LOAD_CONST <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19> [NullVariable, LazyVariableTracker(), ListVariable(length=1)]
TRACE MAKE_FUNCTION 0 [NullVariable, LazyVariableTracker(), ListVariable(length=1), ConstantVariable(code: <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker(), ListVariable(length=1), NestedUserFunctionVariable()]
TRACE GET_ITER None [NullVariable, LazyVariableTracker(), ListVariable(length=1), NestedUserFunctionVariable(), TupleVariable(length=11)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), ListVariable(length=1), NestedUserFunctionVariable(), ListIteratorVariable(length=11, index=0)]
TRACE inlined call <genexpr> from /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:19 in wrapper (contiguous.wrapper) (inline depth: 3)
                  *(i if not isinstance(i, torch.Tensor) else i.contiguous() for i in args),
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:18 in wrapper (contiguous.wrapper) (inline depth: 3)
            return fn(ctx,
TRACE LIST_EXTEND 1 [NullVariable, LazyVariableTracker(), ListVariable(length=1), LocalGeneratorObjectVariable(<genexpr>)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:19 in <genexpr> (contiguous.wrapper) (inline depth: 4)
                      *(i if not isinstance(i, torch.Tensor) else i.contiguous() for i in args),
TRACE RETURN_GENERATOR None [BuiltinVariable(None)]
TRACE POP_TOP None [BuiltinVariable(None)]
TRACE RESUME 0 []
TRACE LOAD_FAST .0 []
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=0)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=1), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=1)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=1), NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=1), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=1), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=1), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=1), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=1)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=1), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=1), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE FX call contiguous_2 from /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:19 in <genexpr> (contiguous.wrapper) (inline depth: 4)
                  *(i if not isinstance(i, torch.Tensor) else i.contiguous() for i in args),
                                                              ~~~~~~~~~~~~^^
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=1), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=1), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=1), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=1)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=1)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=2), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=2)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=2), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=2), NullVariable, BuiltinVariable(isinstance), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=2), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=2), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=2), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=2)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=2), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=2), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=2), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=2), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=2), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=2)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=2)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=3), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=3)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=3), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=3), NullVariable, BuiltinVariable(isinstance), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=3), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=3), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=3), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=3)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=3), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=3), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=3), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=3), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=3), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=3)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=3)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=4), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=4)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=4), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=4), NullVariable, BuiltinVariable(isinstance), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=4), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=4), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=4), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=4)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=4), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=4), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=4), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=4), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=4), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=4)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=4)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=5), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=5)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=5), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=5), NullVariable, BuiltinVariable(isinstance), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=5), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=5), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=5), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=5)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=5), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=5), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=5), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=5), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=5), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=5)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=5)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=6), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=6)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=6), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=6), NullVariable, BuiltinVariable(isinstance), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=6), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=6), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=6), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=6)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=6), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=6), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=6), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=6), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=6), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=6)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=6)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=7), ConstantVariable(float: 1.0)]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=7)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=7), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=7), NullVariable, BuiltinVariable(isinstance), ConstantVariable(float: 1.0)]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=7), NullVariable, BuiltinVariable(isinstance), ConstantVariable(float: 1.0), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=7), NullVariable, BuiltinVariable(isinstance), ConstantVariable(float: 1.0), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=7), ConstantVariable(bool: False)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=7)]
TRACE JUMP_FORWARD 100 [ListIteratorVariable(length=11, index=7), ConstantVariable(float: 1.0)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=7), ConstantVariable(float: 1.0)]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=7), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=7), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=7)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=7)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=8), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=8)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=8), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=8), NullVariable, BuiltinVariable(isinstance), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=8), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=8), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=8), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=8)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=8), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=8), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=8), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=8), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=8), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=8)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=8)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=9), ConstantVariable(bool: True)]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=9)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=9), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=9), NullVariable, BuiltinVariable(isinstance), ConstantVariable(bool: True)]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=9), NullVariable, BuiltinVariable(isinstance), ConstantVariable(bool: True), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=9), NullVariable, BuiltinVariable(isinstance), ConstantVariable(bool: True), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=9), ConstantVariable(bool: False)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=9)]
TRACE JUMP_FORWARD 100 [ListIteratorVariable(length=11, index=9), ConstantVariable(bool: True)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=9), ConstantVariable(bool: True)]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=9), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=9), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=9)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=9)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=10), ConstantVariable(NoneType: None)]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=10)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=10), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=10), NullVariable, BuiltinVariable(isinstance), ConstantVariable(NoneType: None)]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=10), NullVariable, BuiltinVariable(isinstance), ConstantVariable(NoneType: None), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=10), NullVariable, BuiltinVariable(isinstance), ConstantVariable(NoneType: None), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=10), ConstantVariable(bool: False)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=10)]
TRACE JUMP_FORWARD 100 [ListIteratorVariable(length=11, index=10), ConstantVariable(NoneType: None)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=10), ConstantVariable(NoneType: None)]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=10), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=10), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=10)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=10)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=11), ConstantVariable(bool: False)]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=11)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=11), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=11), NullVariable, BuiltinVariable(isinstance), ConstantVariable(bool: False)]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=11), NullVariable, BuiltinVariable(isinstance), ConstantVariable(bool: False), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=11), NullVariable, BuiltinVariable(isinstance), ConstantVariable(bool: False), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=11), ConstantVariable(bool: False)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=11)]
TRACE JUMP_FORWARD 100 [ListIteratorVariable(length=11, index=11), ConstantVariable(bool: False)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=11), ConstantVariable(bool: False)]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=11), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=11), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=11)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=11)]
TRACE END_FOR None [ListIteratorVariable(length=11, index=11), ConstantVariable(NoneType: None)]
TRACE RETURN_CONST None []
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE CALL_INTRINSIC_1 6 [NullVariable, LazyVariableTracker(), ListVariable(length=12)]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=12)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:20 in wrapper (contiguous.wrapper) (inline depth: 3)
                      **{k: (v if not isinstance(v, torch.Tensor) else v.contiguous()) for k, v in kwargs.items()})
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable()]
TRACE LOAD_ATTR items [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ConstDictVariable()]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 180 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE SWAP 3 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST v [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ConstDictVariable(), NullVariable, NullVariable]
TRACE STORE_FAST k [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ConstDictVariable(), NullVariable]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:18 in wrapper (contiguous.wrapper) (inline depth: 3)
            return fn(ctx,
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable()]
TRACE inlined call forward from /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:18 in wrapper (contiguous.wrapper) (inline depth: 3)
        return fn(ctx,
               ~~^^^^^
                  *(i if not isinstance(i, torch.Tensor) else i.contiguous() for i in args),
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                  **{k: (v if not isinstance(v, torch.Tensor) else v.contiguous()) for k, v in kwargs.items()})
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object forward at 0x3060e8b0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 124>, inlined according trace_rules.lookup inlined by default
TRACE MAKE_CELL H []
TRACE MAKE_CELL N []
TRACE MAKE_CELL V []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:124 in forward (FusedRecurrentDPLRDeltaRuleFunction) (inline depth: 4)
        @staticmethod
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:140 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            if head_first:
TRACE LOAD_FAST head_first []
TRACE POP_JUMP_IF_FALSE 86 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:143 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
                B, T, H, K, V = *k.shape, v.shape[-1]
TRACE BUILD_LIST 0 []
TRACE LOAD_FAST k [ListVariable(length=0)]
TRACE LOAD_ATTR shape [ListVariable(length=0), TensorVariable()]
TRACE LIST_EXTEND 1 [ListVariable(length=0), SizeVariable(length=4)]
TRACE LOAD_FAST v [ListVariable(length=4)]
TRACE LOAD_ATTR shape [ListVariable(length=4), TensorVariable()]
TRACE LOAD_CONST -1 [ListVariable(length=4), SizeVariable(length=4)]
TRACE BINARY_SUBSCR None [ListVariable(length=4), SizeVariable(length=4), ConstantVariable(int: -1)]
TRACE LIST_APPEND 1 [ListVariable(length=4), ConstantVariable(int: 128)]
TRACE CALL_INTRINSIC_1 6 [ListVariable(length=5)]
TRACE UNPACK_SEQUENCE 5 [TupleVariable(length=5)]
TRACE STORE_FAST B [ConstantVariable(int: 128), ConstantVariable(int: 128), ConstantVariable(int: 64), ConstantVariable(int: 512), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 128), ConstantVariable(int: 128), ConstantVariable(int: 64), ConstantVariable(int: 512)]
TRACE STORE_DEREF H [ConstantVariable(int: 128), ConstantVariable(int: 128), ConstantVariable(int: 64)]
TRACE STORE_FAST K [ConstantVariable(int: 128), ConstantVariable(int: 128)]
TRACE STORE_DEREF V [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:144 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            N = B if offsets is None else len(offsets) - 1
TRACE LOAD_FAST offsets []
TRACE LOAD_CONST None [ConstantVariable(NoneType: None)]
TRACE IS_OP 1 [ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 170 [ConstantVariable(bool: False)]
TRACE LOAD_FAST B []
TRACE JUMP_FORWARD 196 [ConstantVariable(int: 1)]
TRACE STORE_DEREF N [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:146 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            BK = triton.next_power_of_2(K)
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR next_power_of_2 [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST K [NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:146 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
        BK = triton.next_power_of_2(K)
             ~~~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=1)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=1, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=1, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=1, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=1, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=1), ConstantVariable(int: 128)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 6)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 6)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 6)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 6)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 6)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 128)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=1), ConstantVariable(int: 128)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=1, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=1, index=1)]
TRACE END_FOR None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=1, index=1), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=1)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=1)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=1), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=1), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=1), ConstDictVariable()]
TRACE inlined call next_power_of_2 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object next_power_of_2 at 0x70c9a955f730, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 71>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:71 in next_power_of_2 () (inline depth: 6)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:74 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n -= 1
TRACE LOAD_FAST n []
TRACE LOAD_CONST 1 [ConstantVariable(int: 128)]
TRACE BINARY_OP 23 [ConstantVariable(int: 128), ConstantVariable(int: 1)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:75 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n |= n >> 1
TRACE LOAD_FAST n []
TRACE LOAD_FAST n [ConstantVariable(int: 127)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 127), ConstantVariable(int: 127)]
TRACE BINARY_OP 9 [ConstantVariable(int: 127), ConstantVariable(int: 127), ConstantVariable(int: 1)]
TRACE BINARY_OP 20 [ConstantVariable(int: 127), ConstantVariable(int: 63)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:76 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n |= n >> 2
TRACE LOAD_FAST n []
TRACE LOAD_FAST n [ConstantVariable(int: 127)]
TRACE LOAD_CONST 2 [ConstantVariable(int: 127), ConstantVariable(int: 127)]
TRACE BINARY_OP 9 [ConstantVariable(int: 127), ConstantVariable(int: 127), ConstantVariable(int: 2)]
TRACE BINARY_OP 20 [ConstantVariable(int: 127), ConstantVariable(int: 31)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:77 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n |= n >> 4
TRACE LOAD_FAST n []
TRACE LOAD_FAST n [ConstantVariable(int: 127)]
TRACE LOAD_CONST 4 [ConstantVariable(int: 127), ConstantVariable(int: 127)]
TRACE BINARY_OP 9 [ConstantVariable(int: 127), ConstantVariable(int: 127), ConstantVariable(int: 4)]
TRACE BINARY_OP 20 [ConstantVariable(int: 127), ConstantVariable(int: 7)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:78 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n |= n >> 8
TRACE LOAD_FAST n []
TRACE LOAD_FAST n [ConstantVariable(int: 127)]
TRACE LOAD_CONST 8 [ConstantVariable(int: 127), ConstantVariable(int: 127)]
TRACE BINARY_OP 9 [ConstantVariable(int: 127), ConstantVariable(int: 127), ConstantVariable(int: 8)]
TRACE BINARY_OP 20 [ConstantVariable(int: 127), ConstantVariable(int: 0)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:79 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n |= n >> 16
TRACE LOAD_FAST n []
TRACE LOAD_FAST n [ConstantVariable(int: 127)]
TRACE LOAD_CONST 16 [ConstantVariable(int: 127), ConstantVariable(int: 127)]
TRACE BINARY_OP 9 [ConstantVariable(int: 127), ConstantVariable(int: 127), ConstantVariable(int: 16)]
TRACE BINARY_OP 20 [ConstantVariable(int: 127), ConstantVariable(int: 0)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:80 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n |= n >> 32
TRACE LOAD_FAST n []
TRACE LOAD_FAST n [ConstantVariable(int: 127)]
TRACE LOAD_CONST 32 [ConstantVariable(int: 127), ConstantVariable(int: 127)]
TRACE BINARY_OP 9 [ConstantVariable(int: 127), ConstantVariable(int: 127), ConstantVariable(int: 32)]
TRACE BINARY_OP 20 [ConstantVariable(int: 127), ConstantVariable(int: 0)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:81 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n += 1
TRACE LOAD_FAST n []
TRACE LOAD_CONST 1 [ConstantVariable(int: 127)]
TRACE BINARY_OP 13 [ConstantVariable(int: 127), ConstantVariable(int: 1)]
TRACE STORE_FAST n [ConstantVariable(int: 128)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:82 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        return n
TRACE LOAD_FAST n []
TRACE RETURN_VALUE None [ConstantVariable(int: 128)]
DONE INLINING <code object next_power_of_2 at 0x70c9a955f730, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 71>
TRACE STORE_FAST res [ConstantVariable(int: 128)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 128)]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE STORE_FAST BK [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:147 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            if output_final_state:
TRACE LOAD_FAST output_final_state []
TRACE POP_JUMP_IF_FALSE 318 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:148 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
                final_state = q.new_empty(B, H, K, V, dtype=torch.float32)
TRACE LOAD_FAST q []
TRACE LOAD_ATTR new_empty [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), new_empty)]
TRACE LOAD_DEREF H [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1)]
TRACE LOAD_FAST K [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE LOAD_DEREF V [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128), ConstantVariable(int: 128)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE CALL 5 [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE FX call new_empty from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:148 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            final_state = q.new_empty(B, H, K, V, dtype=torch.float32)
                          ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST final_state [TensorVariable()]
TRACE JUMP_FORWARD 322 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:152 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            ha = torch.empty_like(v, dtype=torch.float32)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR empty_like [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST v [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL torch [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR float32 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE FX call empty_like from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:152 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
        ha = torch.empty_like(v, dtype=torch.float32)
             ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST ha [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
TRACE LOAD_CLOSURE H []
TRACE LOAD_CLOSURE N [CellVariable()]
TRACE LOAD_CLOSURE V [CellVariable(), CellVariable()]
TRACE BUILD_TUPLE 3 [CellVariable(), CellVariable(), CellVariable()]
TRACE LOAD_CONST <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154> [TupleVariable(length=3)]
TRACE MAKE_FUNCTION 8 [TupleVariable(length=3), ConstantVariable(code: <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>)]
TRACE STORE_FAST grid [NestedUserFunctionVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:155 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            o = torch.empty_like(v)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR empty_like [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST v [NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call empty_like_1 from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:155 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
        o = torch.empty_like(v)
            ~~~~~~~~~~~~~~~~^^^
TRACE STORE_FAST o [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_GLOBAL fused_recurrent_fwd_kernel []
TRACE LOAD_FAST grid [NullVariable, LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), NestedUserFunctionVariable()]
TRACE inlined call __getitem__ from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
        fused_recurrent_fwd_kernel[grid](
        ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
INLINING <code object __getitem__ at 0x70c9a94dd6f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 413>, inlined according trace_rules.lookup inlined by default
TRACE MAKE_CELL self []
TRACE MAKE_CELL grid []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:413 in __getitem__ (KernelInterface.__getitem__) (inline depth: 5)
        def __getitem__(self, grid) -> T:
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:419 in __getitem__ (KernelInterface.__getitem__) (inline depth: 5)
            return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
TRACE LOAD_CLOSURE grid []
TRACE LOAD_CLOSURE self [CellVariable()]
TRACE BUILD_TUPLE 2 [CellVariable(), CellVariable()]
TRACE LOAD_CONST <code object <lambda> at 0x70c9a9437780, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 419> [TupleVariable(length=2)]
TRACE MAKE_FUNCTION 8 [TupleVariable(length=2), ConstantVariable(code: <code object <lambda> at 0x70c9a9437780, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 419>)]
TRACE RETURN_VALUE None [NestedUserFunctionVariable()]
DONE INLINING <code object __getitem__ at 0x70c9a94dd6f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 413>
TRACE LOAD_CONST () [NullVariable, NestedUserFunctionVariable()]
TRACE BUILD_MAP 0 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0)]
TRACE LOAD_CONST q [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:157 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                q=q,
TRACE LOAD_FAST q [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'q')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'q'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST k [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:158 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                k=k,
TRACE LOAD_FAST k [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'k')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'k'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST v [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:159 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                v=v,
TRACE LOAD_FAST v [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'v')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'v'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST a [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:160 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                a=a,
TRACE LOAD_FAST a [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'a')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'a'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST b [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:161 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                b=b,
TRACE LOAD_FAST b [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'b')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'b'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST gk [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:162 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                gk=gk,
TRACE LOAD_FAST gk [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'gk')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'gk'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST o [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:163 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                o=o,
TRACE LOAD_FAST o [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'o')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'o'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST ha [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:164 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                ha=ha,
TRACE LOAD_FAST ha [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'ha')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'ha'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST h0 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:165 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                h0=initial_state,
TRACE LOAD_FAST initial_state [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'h0')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'h0'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST ht [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:166 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                ht=final_state,
TRACE LOAD_FAST final_state [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'ht')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'ht'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST scale [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:167 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                scale=scale,
TRACE LOAD_FAST scale [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'scale')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'scale'), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST offsets [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:168 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                offsets=offsets,
TRACE LOAD_FAST offsets [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'offsets')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'offsets'), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST H [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:169 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                H=H,
TRACE LOAD_DEREF H [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'H')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'H'), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST T [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:170 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                T=T,
TRACE LOAD_FAST T [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'T')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'T'), ConstantVariable(int: 512)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST K [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:171 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                K=K,
TRACE LOAD_FAST K [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'K')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'K'), ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST V [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:172 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                V=V,
TRACE LOAD_DEREF V [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'V')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'V'), ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST BK [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:173 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                BK=BK,
TRACE LOAD_FAST BK [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'BK')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'BK'), ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST HEAD_FIRST [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:174 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                HEAD_FIRST=head_first
TRACE LOAD_FAST head_first [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'HEAD_FIRST')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'HEAD_FIRST'), ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE CALL_FUNCTION_EX 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE inlined call <lambda> from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
        fused_recurrent_fwd_kernel[grid](
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
            q=q,
            ^^^^
            k=k,
            ^^^^
            v=v,
            ^^^^
            a=a,
            ^^^^
            b=b,
            ^^^^
            gk=gk,
            ^^^^^^
            o=o,
            ^^^^
            ha=ha,
            ^^^^^^
            h0=initial_state,
            ^^^^^^^^^^^^^^^^^
            ht=final_state,
            ^^^^^^^^^^^^^^^
            scale=scale,
            ^^^^^^^^^^^^
            offsets=offsets,
            ^^^^^^^^^^^^^^^^
            H=H,
            ^^^^
            T=T,
            ^^^^
            K=K,
            ^^^^
            V=V,
            ^^^^
            BK=BK,
            ^^^^^^
            HEAD_FIRST=head_first
            ^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object <lambda> at 0x70c9a9437780, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 419>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 2 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:419 in <lambda> (KernelInterface.__getitem__) (inline depth: 5)
            return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
TRACE RESUME 0 []
TRACE PUSH_NULL None []
TRACE LOAD_DEREF self [NullVariable]
TRACE LOAD_ATTR run [NullVariable, UserDefinedObjectVariable(Heuristics)]
TRACE LOAD_FAST args [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics))]
TRACE LOAD_DEREF grid [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0)]
TRACE LOAD_CONST False [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0), NestedUserFunctionVariable()]
TRACE LOAD_CONST ('grid', 'warmup') [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0), NestedUserFunctionVariable(), ConstantVariable(bool: False)]
TRACE BUILD_CONST_KEY_MAP 2 [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0), NestedUserFunctionVariable(), ConstantVariable(bool: False), TupleVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0), ConstDictVariable()]
TRACE inlined call run from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:419 in <lambda> (KernelInterface.__getitem__) (inline depth: 5)
        return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
                                       ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object run at 0x70c9a971df10, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py", line 449>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:449 in run (Heuristics.run) (inline depth: 6)
        def run(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:450 in run (Heuristics.run) (inline depth: 6)
            for v, heur in self.values.items():
TRACE LOAD_FAST self []
TRACE LOAD_ATTR values [UserDefinedObjectVariable(Heuristics)]
TRACE LOAD_ATTR items [LazyVariableTracker()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE FOR_ITER 156 [ListIteratorVariable(length=3, index=0)]
TRACE UNPACK_SEQUENCE 2 [ListIteratorVariable(length=3, index=1), TupleVariable(length=2)]
TRACE STORE_FAST v [ListIteratorVariable(length=3, index=1), LazyVariableTracker(), ConstantVariable(str: 'USE_INITIAL_STATE')]
TRACE STORE_FAST heur [ListIteratorVariable(length=3, index=1), LazyVariableTracker()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
                kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
TRACE PUSH_NULL None [ListIteratorVariable(length=3, index=1)]
TRACE LOAD_FAST heur [ListIteratorVariable(length=3, index=1), NullVariable]
TRACE BUILD_MAP 0 [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL dict [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE LOAD_GLOBAL zip [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST self [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, LazyVariableTracker(), NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR arg_names [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, LazyVariableTracker(), NullVariable, LazyVariableTracker(), UserDefinedObjectVariable(Heuristics)]
TRACE LOAD_FAST args [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, LazyVariableTracker(), NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, LazyVariableTracker(), NullVariable, LazyVariableTracker(), LazyVariableTracker(), TupleVariable(length=0)]
TRACE CALL 1 [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, LazyVariableTracker(), ZipVariable()]
TRACE inlined call construct_dict from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
            kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
                                ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object construct_dict at 0x70c9a070b0a0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 285>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:285 in construct_dict (construct_dict) (inline depth: 7)
    def construct_dict(cls, /, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:286 in construct_dict (construct_dict) (inline depth: 7)
        dst = cls.__new__(cls)
TRACE LOAD_FAST cls []
TRACE LOAD_ATTR __new__ [BuiltinVariable(dict)]
TRACE LOAD_FAST cls [NullVariable, GetAttrVariable(BuiltinVariable(dict), __new__)]
TRACE CALL 1 [NullVariable, GetAttrVariable(BuiltinVariable(dict), __new__), BuiltinVariable(dict)]
TRACE STORE_FAST dst [ConstDictVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:288 in construct_dict (construct_dict) (inline depth: 7)
        if args:
TRACE LOAD_FAST args []
TRACE POP_JUMP_IF_FALSE 264 [TupleVariable(length=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:289 in construct_dict (construct_dict) (inline depth: 7)
            src = args[0]
TRACE LOAD_FAST args []
TRACE LOAD_CONST 0 [TupleVariable(length=1)]
TRACE BINARY_SUBSCR None [TupleVariable(length=1), ConstantVariable(int: 0)]
TRACE STORE_FAST src [ZipVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:291 in construct_dict (construct_dict) (inline depth: 7)
            if not isinstance(src, Iterable):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST src [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL Iterable [NullVariable, LazyVariableTracker(), ZipVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ZipVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 128 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:295 in construct_dict (construct_dict) (inline depth: 7)
            if isinstance(src, (dict, MutableMapping, types.MappingProxyType)):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST src [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL dict [NullVariable, BuiltinVariable(isinstance), ZipVariable()]
TRACE LOAD_GLOBAL MutableMapping [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker()]
TRACE LOAD_GLOBAL types [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR MappingProxyType [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE BUILD_TUPLE 3 [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ZipVariable(), TupleVariable(length=3)]
TRACE POP_JUMP_IF_FALSE 234 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:301 in construct_dict (construct_dict) (inline depth: 7)
                for key, value in src:
TRACE LOAD_FAST src []
TRACE GET_ITER None [ZipVariable()]
TRACE FOR_ITER 262 [ZipVariable()]
TRACE END_FOR None [ZipVariable(), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:304 in construct_dict (construct_dict) (inline depth: 7)
        if kwargs:
TRACE LOAD_FAST kwargs []
TRACE POP_JUMP_IF_FALSE 298 [ConstDictVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:308 in construct_dict (construct_dict) (inline depth: 7)
        return dst
TRACE LOAD_FAST dst []
TRACE RETURN_VALUE None [ConstDictVariable()]
DONE INLINING <code object construct_dict at 0x70c9a070b0a0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 285>
TRACE DICT_UPDATE 1 [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), ConstDictVariable()]
TRACE LOAD_FAST kwargs [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE DICT_UPDATE 1 [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), ConstDictVariable()]
TRACE CALL 1 [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE inlined call <lambda> from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
            kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
                        ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object <lambda> at 0x70c98ce24d30, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 14>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:14 in <lambda> () (inline depth: 7)
        'USE_INITIAL_STATE': lambda args: args['h0'] is not None,
TRACE RESUME 0 []
TRACE LOAD_FAST args []
TRACE LOAD_CONST h0 [ConstDictVariable()]
TRACE BINARY_SUBSCR None [ConstDictVariable(), ConstantVariable(str: 'h0')]
TRACE LOAD_CONST None [TensorVariable()]
TRACE IS_OP 1 [TensorVariable(), ConstantVariable(NoneType: None)]
TRACE RETURN_VALUE None [ConstantVariable(bool: True)]
DONE INLINING <code object <lambda> at 0x70c98ce24d30, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 14>
TRACE LOAD_FAST kwargs [ListIteratorVariable(length=3, index=1), ConstantVariable(bool: True)]
TRACE LOAD_FAST v [ListIteratorVariable(length=3, index=1), ConstantVariable(bool: True), ConstDictVariable()]
TRACE STORE_SUBSCR None [ListIteratorVariable(length=3, index=1), ConstantVariable(bool: True), ConstDictVariable(), ConstantVariable(str: 'USE_INITIAL_STATE')]
TRACE JUMP_BACKWARD 54 [ListIteratorVariable(length=3, index=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:450 in run (Heuristics.run) (inline depth: 6)
            for v, heur in self.values.items():
TRACE FOR_ITER 156 [ListIteratorVariable(length=3, index=1)]
TRACE UNPACK_SEQUENCE 2 [ListIteratorVariable(length=3, index=2), TupleVariable(length=2)]
TRACE STORE_FAST v [ListIteratorVariable(length=3, index=2), LazyVariableTracker(), ConstantVariable(str: 'STORE_FINAL_STATE')]
TRACE STORE_FAST heur [ListIteratorVariable(length=3, index=2), LazyVariableTracker()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
                kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
TRACE PUSH_NULL None [ListIteratorVariable(length=3, index=2)]
TRACE LOAD_FAST heur [ListIteratorVariable(length=3, index=2), NullVariable]
TRACE BUILD_MAP 0 [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL dict [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE LOAD_GLOBAL zip [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict)]
TRACE LOAD_FAST self [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip)]
TRACE LOAD_ATTR arg_names [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip), UserDefinedObjectVariable(Heuristics)]
TRACE LOAD_FAST args [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip), LazyVariableTracker(), TupleVariable(length=0)]
TRACE CALL 1 [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), ZipVariable()]
TRACE inlined call construct_dict from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
            kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
                                ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object construct_dict at 0x70c9a070b0a0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 285>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:285 in construct_dict (construct_dict) (inline depth: 7)
    def construct_dict(cls, /, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:286 in construct_dict (construct_dict) (inline depth: 7)
        dst = cls.__new__(cls)
TRACE LOAD_FAST cls []
TRACE LOAD_ATTR __new__ [BuiltinVariable(dict)]
TRACE LOAD_FAST cls [NullVariable, GetAttrVariable(BuiltinVariable(dict), __new__)]
TRACE CALL 1 [NullVariable, GetAttrVariable(BuiltinVariable(dict), __new__), BuiltinVariable(dict)]
TRACE STORE_FAST dst [ConstDictVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:288 in construct_dict (construct_dict) (inline depth: 7)
        if args:
TRACE LOAD_FAST args []
TRACE POP_JUMP_IF_FALSE 264 [TupleVariable(length=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:289 in construct_dict (construct_dict) (inline depth: 7)
            src = args[0]
TRACE LOAD_FAST args []
TRACE LOAD_CONST 0 [TupleVariable(length=1)]
TRACE BINARY_SUBSCR None [TupleVariable(length=1), ConstantVariable(int: 0)]
TRACE STORE_FAST src [ZipVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:291 in construct_dict (construct_dict) (inline depth: 7)
            if not isinstance(src, Iterable):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST src [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL Iterable [NullVariable, LazyVariableTracker(), ZipVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ZipVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 128 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:295 in construct_dict (construct_dict) (inline depth: 7)
            if isinstance(src, (dict, MutableMapping, types.MappingProxyType)):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST src [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL dict [NullVariable, BuiltinVariable(isinstance), ZipVariable()]
TRACE LOAD_GLOBAL MutableMapping [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker()]
TRACE LOAD_GLOBAL types [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR MappingProxyType [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE BUILD_TUPLE 3 [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ZipVariable(), TupleVariable(length=3)]
TRACE POP_JUMP_IF_FALSE 234 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:301 in construct_dict (construct_dict) (inline depth: 7)
                for key, value in src:
TRACE LOAD_FAST src []
TRACE GET_ITER None [ZipVariable()]
TRACE FOR_ITER 262 [ZipVariable()]
TRACE END_FOR None [ZipVariable(), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:304 in construct_dict (construct_dict) (inline depth: 7)
        if kwargs:
TRACE LOAD_FAST kwargs []
TRACE POP_JUMP_IF_FALSE 298 [ConstDictVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:308 in construct_dict (construct_dict) (inline depth: 7)
        return dst
TRACE LOAD_FAST dst []
TRACE RETURN_VALUE None [ConstDictVariable()]
DONE INLINING <code object construct_dict at 0x70c9a070b0a0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 285>
TRACE DICT_UPDATE 1 [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), ConstDictVariable()]
TRACE LOAD_FAST kwargs [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE DICT_UPDATE 1 [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), ConstDictVariable()]
TRACE CALL 1 [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE inlined call <lambda> from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
            kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
                        ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object <lambda> at 0x70c98ce257c0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 15>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:15 in <lambda> () (inline depth: 7)
        'STORE_FINAL_STATE': lambda args: args['ht'] is not None,
TRACE RESUME 0 []
TRACE LOAD_FAST args []
TRACE LOAD_CONST ht [ConstDictVariable()]
TRACE BINARY_SUBSCR None [ConstDictVariable(), ConstantVariable(str: 'ht')]
TRACE LOAD_CONST None [TensorVariable()]
TRACE IS_OP 1 [TensorVariable(), ConstantVariable(NoneType: None)]
TRACE RETURN_VALUE None [ConstantVariable(bool: True)]
DONE INLINING <code object <lambda> at 0x70c98ce257c0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 15>
TRACE LOAD_FAST kwargs [ListIteratorVariable(length=3, index=2), ConstantVariable(bool: True)]
TRACE LOAD_FAST v [ListIteratorVariable(length=3, index=2), ConstantVariable(bool: True), ConstDictVariable()]
TRACE STORE_SUBSCR None [ListIteratorVariable(length=3, index=2), ConstantVariable(bool: True), ConstDictVariable(), ConstantVariable(str: 'STORE_FINAL_STATE')]
TRACE JUMP_BACKWARD 54 [ListIteratorVariable(length=3, index=2)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:450 in run (Heuristics.run) (inline depth: 6)
            for v, heur in self.values.items():
TRACE FOR_ITER 156 [ListIteratorVariable(length=3, index=2)]
TRACE UNPACK_SEQUENCE 2 [ListIteratorVariable(length=3, index=3), TupleVariable(length=2)]
TRACE STORE_FAST v [ListIteratorVariable(length=3, index=3), LazyVariableTracker(), ConstantVariable(str: 'USE_OFFSETS')]
TRACE STORE_FAST heur [ListIteratorVariable(length=3, index=3), LazyVariableTracker()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
                kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
TRACE PUSH_NULL None [ListIteratorVariable(length=3, index=3)]
TRACE LOAD_FAST heur [ListIteratorVariable(length=3, index=3), NullVariable]
TRACE BUILD_MAP 0 [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL dict [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE LOAD_GLOBAL zip [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict)]
TRACE LOAD_FAST self [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip)]
TRACE LOAD_ATTR arg_names [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip), UserDefinedObjectVariable(Heuristics)]
TRACE LOAD_FAST args [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip), LazyVariableTracker(), TupleVariable(length=0)]
TRACE CALL 1 [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), ZipVariable()]
TRACE inlined call construct_dict from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
            kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
                                ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object construct_dict at 0x70c9a070b0a0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 285>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:285 in construct_dict (construct_dict) (inline depth: 7)
    def construct_dict(cls, /, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:286 in construct_dict (construct_dict) (inline depth: 7)
        dst = cls.__new__(cls)
TRACE LOAD_FAST cls []
TRACE LOAD_ATTR __new__ [BuiltinVariable(dict)]
TRACE LOAD_FAST cls [NullVariable, GetAttrVariable(BuiltinVariable(dict), __new__)]
TRACE CALL 1 [NullVariable, GetAttrVariable(BuiltinVariable(dict), __new__), BuiltinVariable(dict)]
TRACE STORE_FAST dst [ConstDictVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:288 in construct_dict (construct_dict) (inline depth: 7)
        if args:
TRACE LOAD_FAST args []
TRACE POP_JUMP_IF_FALSE 264 [TupleVariable(length=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:289 in construct_dict (construct_dict) (inline depth: 7)
            src = args[0]
TRACE LOAD_FAST args []
TRACE LOAD_CONST 0 [TupleVariable(length=1)]
TRACE BINARY_SUBSCR None [TupleVariable(length=1), ConstantVariable(int: 0)]
TRACE STORE_FAST src [ZipVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:291 in construct_dict (construct_dict) (inline depth: 7)
            if not isinstance(src, Iterable):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST src [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL Iterable [NullVariable, LazyVariableTracker(), ZipVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ZipVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 128 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:295 in construct_dict (construct_dict) (inline depth: 7)
            if isinstance(src, (dict, MutableMapping, types.MappingProxyType)):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST src [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL dict [NullVariable, BuiltinVariable(isinstance), ZipVariable()]
TRACE LOAD_GLOBAL MutableMapping [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker()]
TRACE LOAD_GLOBAL types [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR MappingProxyType [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE BUILD_TUPLE 3 [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ZipVariable(), TupleVariable(length=3)]
TRACE POP_JUMP_IF_FALSE 234 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:301 in construct_dict (construct_dict) (inline depth: 7)
                for key, value in src:
TRACE LOAD_FAST src []
TRACE GET_ITER None [ZipVariable()]
TRACE FOR_ITER 262 [ZipVariable()]
TRACE END_FOR None [ZipVariable(), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:304 in construct_dict (construct_dict) (inline depth: 7)
        if kwargs:
TRACE LOAD_FAST kwargs []
TRACE POP_JUMP_IF_FALSE 298 [ConstDictVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:308 in construct_dict (construct_dict) (inline depth: 7)
        return dst
TRACE LOAD_FAST dst []
TRACE RETURN_VALUE None [ConstDictVariable()]
DONE INLINING <code object construct_dict at 0x70c9a070b0a0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 285>
TRACE DICT_UPDATE 1 [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), ConstDictVariable()]
TRACE LOAD_FAST kwargs [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE DICT_UPDATE 1 [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), ConstDictVariable()]
TRACE CALL 1 [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE inlined call <lambda> from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
            kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
                        ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object <lambda> at 0x70c98ce25a30, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 16>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:16 in <lambda> () (inline depth: 7)
        'USE_OFFSETS': lambda args: args['offsets'] is not None
TRACE RESUME 0 []
TRACE LOAD_FAST args []
TRACE LOAD_CONST offsets [ConstDictVariable()]
TRACE BINARY_SUBSCR None [ConstDictVariable(), ConstantVariable(str: 'offsets')]
TRACE LOAD_CONST None [ConstantVariable(NoneType: None)]
TRACE IS_OP 1 [ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE RETURN_VALUE None [ConstantVariable(bool: False)]
DONE INLINING <code object <lambda> at 0x70c98ce25a30, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 16>
TRACE LOAD_FAST kwargs [ListIteratorVariable(length=3, index=3), ConstantVariable(bool: False)]
TRACE LOAD_FAST v [ListIteratorVariable(length=3, index=3), ConstantVariable(bool: False), ConstDictVariable()]
TRACE STORE_SUBSCR None [ListIteratorVariable(length=3, index=3), ConstantVariable(bool: False), ConstDictVariable(), ConstantVariable(str: 'USE_OFFSETS')]
TRACE JUMP_BACKWARD 54 [ListIteratorVariable(length=3, index=3)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:450 in run (Heuristics.run) (inline depth: 6)
            for v, heur in self.values.items():
TRACE FOR_ITER 156 [ListIteratorVariable(length=3, index=3)]
TRACE END_FOR None [ListIteratorVariable(length=3, index=3), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:452 in run (Heuristics.run) (inline depth: 6)
            return self.fn.run(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(Heuristics)]
TRACE LOAD_ATTR run [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST args [NullVariable, GetAttrVariable(TritonKernelVariable(), run)]
TRACE BUILD_MAP 0 [NullVariable, GetAttrVariable(TritonKernelVariable(), run), TupleVariable(length=0)]
TRACE LOAD_FAST kwargs [NullVariable, GetAttrVariable(TritonKernelVariable(), run), TupleVariable(length=0), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, GetAttrVariable(TritonKernelVariable(), run), TupleVariable(length=0), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, GetAttrVariable(TritonKernelVariable(), run), TupleVariable(length=0), ConstDictVariable()]
TRACE inlined call grid from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:452 in run (Heuristics.run) (inline depth: 6)
        return self.fn.run(*args, **kwargs)
               ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in grid (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 7)
            def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
TRACE RESUME 0 []
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF V [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST meta [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE LOAD_CONST BV [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstDictVariable(), ConstantVariable(str: 'BV')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in grid (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 7)
        def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
                                ~~~~~~~~~~~^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 128)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 128)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 128)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 9)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 9)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [ConstantVariable(int: 128)]
TRACE BINARY_OP 0 [ConstantVariable(int: 128), ConstantVariable(int: 32)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 160)]
TRACE BINARY_OP 10 [ConstantVariable(int: 160), ConstantVariable(int: 1)]
TRACE LOAD_FAST y [ConstantVariable(int: 159)]
TRACE BINARY_OP 2 [ConstantVariable(int: 159), ConstantVariable(int: 32)]
TRACE RETURN_VALUE None [ConstantVariable(int: 4)]
DONE INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [ConstantVariable(int: 4)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 4)]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE LOAD_DEREF N [ConstantVariable(int: 4)]
TRACE LOAD_DEREF H [ConstantVariable(int: 4), ConstantVariable(int: 1)]
TRACE BINARY_OP 5 [ConstantVariable(int: 4), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE BUILD_TUPLE 2 [ConstantVariable(int: 4), ConstantVariable(int: 64)]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>
TRACE inlined call grid from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:452 in run (Heuristics.run) (inline depth: 6)
        return self.fn.run(*args, **kwargs)
               ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in grid (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 7)
            def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
TRACE RESUME 0 []
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF V [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST meta [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE LOAD_CONST BV [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstDictVariable(), ConstantVariable(str: 'BV')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in grid (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 7)
        def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
                                ~~~~~~~~~~~^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 128)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 128)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 128)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 9)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 9)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [ConstantVariable(int: 128)]
TRACE BINARY_OP 0 [ConstantVariable(int: 128), ConstantVariable(int: 32)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 160)]
TRACE BINARY_OP 10 [ConstantVariable(int: 160), ConstantVariable(int: 1)]
TRACE LOAD_FAST y [ConstantVariable(int: 159)]
TRACE BINARY_OP 2 [ConstantVariable(int: 159), ConstantVariable(int: 32)]
TRACE RETURN_VALUE None [ConstantVariable(int: 4)]
DONE INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [ConstantVariable(int: 4)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 4)]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE LOAD_DEREF N [ConstantVariable(int: 4)]
TRACE LOAD_DEREF H [ConstantVariable(int: 4), ConstantVariable(int: 1)]
TRACE BINARY_OP 5 [ConstantVariable(int: 4), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE BUILD_TUPLE 2 [ConstantVariable(int: 4), ConstantVariable(int: 64)]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>
TRACE inlined call grid from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:452 in run (Heuristics.run) (inline depth: 6)
        return self.fn.run(*args, **kwargs)
               ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in grid (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 7)
            def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
TRACE RESUME 0 []
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF V [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST meta [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE LOAD_CONST BV [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstDictVariable(), ConstantVariable(str: 'BV')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in grid (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 7)
        def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
                                ~~~~~~~~~~~^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 128)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 128)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 128)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 9)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 9)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [ConstantVariable(int: 128)]
TRACE BINARY_OP 0 [ConstantVariable(int: 128), ConstantVariable(int: 32)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 160)]
TRACE BINARY_OP 10 [ConstantVariable(int: 160), ConstantVariable(int: 1)]
TRACE LOAD_FAST y [ConstantVariable(int: 159)]
TRACE BINARY_OP 2 [ConstantVariable(int: 159), ConstantVariable(int: 32)]
TRACE RETURN_VALUE None [ConstantVariable(int: 4)]
DONE INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [ConstantVariable(int: 4)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 4)]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE LOAD_DEREF N [ConstantVariable(int: 4)]
TRACE LOAD_DEREF H [ConstantVariable(int: 4), ConstantVariable(int: 1)]
TRACE BINARY_OP 5 [ConstantVariable(int: 4), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE BUILD_TUPLE 2 [ConstantVariable(int: 4), ConstantVariable(int: 64)]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>
TRACE FX call triton_kernel_wrapper_mutation from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:452 in run (Heuristics.run) (inline depth: 6)
        return self.fn.run(*args, **kwargs)
               ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [ConstantVariable(NoneType: None)]
DONE INLINING <code object run at 0x70c9a971df10, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py", line 449>
TRACE RETURN_VALUE None [ConstantVariable(NoneType: None)]
DONE INLINING <code object <lambda> at 0x70c9a9437780, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 419>
TRACE POP_TOP None [ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:176 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            return o, final_state
TRACE LOAD_FAST o []
TRACE LOAD_FAST final_state [TensorVariable()]
TRACE BUILD_TUPLE 2 [TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object forward at 0x3060e8b0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 124>
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object wrapper at 0x70c98d04f0a0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 16>
TRACE UNPACK_SEQUENCE 2 [TupleVariable(length=2)]
TRACE STORE_FAST o [TensorVariable(), TensorVariable()]
TRACE STORE_FAST final_state [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:258 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
        return o, final_state
TRACE LOAD_FAST o []
TRACE LOAD_FAST final_state [TensorVariable()]
TRACE BUILD_TUPLE 2 [TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object fused_recurrent_dplr_delta_rule at 0x305fb4e0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 188>
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object fused_recurrent_rwkv7 at 0x70c98d0c9890, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py", line 11>
TRACE UNPACK_SEQUENCE 2 [TupleVariable(length=2)]
TRACE STORE_FAST xx [TensorVariable(), TensorVariable()]
TRACE STORE_FAST state [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:612 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            xx = xx.view(B,T,-1) * (float(N) ** -0.5)
TRACE LOAD_FAST xx []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: -1)]
TRACE FX call view_17 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:612 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.view(B,T,-1) * (float(N) ** -0.5)
             ~~~~~~~^^^^^^^^
TRACE LOAD_GLOBAL float [TensorVariable()]
TRACE LOAD_FAST N [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE LOAD_CONST -0.5 [TensorVariable(), ConstantVariable(float: 128.0)]
TRACE BINARY_OP 8 [TensorVariable(), ConstantVariable(float: 128.0), ConstantVariable(float: -0.5)]
TRACE BINARY_OP 5 [TensorVariable(), ConstantVariable(float: 0.08838834764831845)]
TRACE FX call mul_14 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:612 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.view(B,T,-1) * (float(N) ** -0.5)
             ~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST xx [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
TRACE LOAD_FAST xx []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST r [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR dtype [NullVariable, GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_10 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
             ~~~~~^^^^^^^^^^^^^^^
TRACE LOAD_FAST r [TensorVariable()]
TRACE LOAD_ATTR view [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST B [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64)]
TRACE CALL 4 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_18 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                      ~~~~~~^^^^^^^^^
TRACE LOAD_FAST k [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR view [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST B [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64)]
TRACE CALL 4 [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_19 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                                      ~~~~~~^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call mul_15 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                      ~~~~~~~~~~~~~~~^^~~~~~~~~~~~~~~
TRACE LOAD_FAST r_k [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR view [TensorVariable(), TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['r_k'] (8192,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='r_k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_r_k_ L['r_k'] FakeTensor(..., device='cuda:0', size=(8192,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE LOAD_FAST H [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST N [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 64)]
TRACE CALL 2 [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_20 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                                                      ~~~~~~~~^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call mul_16 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^~~~~~~~~~~~~
TRACE LOAD_ATTR sum [TensorVariable(), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), sum)]
TRACE LOAD_CONST True [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), sum), ConstantVariable(int: -1)]
TRACE KW_NAMES ('dim', 'keepdim') [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), sum), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), sum), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call sum_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_FAST v [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR view [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST B [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64)]
TRACE CALL 4 [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_21 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                                                                                                 ~~~~~~^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call mul_17 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~
TRACE LOAD_ATTR view [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST B [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64)]
TRACE BINARY_OP 5 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE CALL 3 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8192)]
TRACE FX call view_22 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable()]
TRACE FX call add_12 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
             ~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST xx [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:616 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            output = fpx_matmul((xx * (torch.sigmoid(xg) @ g2)), O_, O_state,ebits,mbits)
TRACE LOAD_GLOBAL fpx_matmul []
TRACE LOAD_FAST xx [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL torch [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR sigmoid [NullVariable, LazyVariableTracker(), TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST xg [NullVariable, LazyVariableTracker(), TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call sigmoid_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:616 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        output = fpx_matmul((xx * (torch.sigmoid(xg) @ g2)), O_, O_state,ebits,mbits)
                                   ~~~~~~~~~~~~~^^^^
TRACE LOAD_FAST g2 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE BINARY_OP 4 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['g2'] (480, 8192) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='g2', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_g2_ L['g2'] FakeTensor(..., device='cuda:0', size=(480, 8192), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call matmul_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:616 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        output = fpx_matmul((xx * (torch.sigmoid(xg) @ g2)), O_, O_state,ebits,mbits)
                                   ~~~~~~~~~~~~~~~~~~^~~~
TRACE BINARY_OP 5 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE FX call mul_18 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:616 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        output = fpx_matmul((xx * (torch.sigmoid(xg) @ g2)), O_, O_state,ebits,mbits)
                             ~~~^~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_FAST O_ [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST O_state [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_FAST ebits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST mbits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: -44)]
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: -44), LazyVariableTracker()]
TRACE inlined call fpx_matmul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:616 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        output = fpx_matmul((xx * (torch.sigmoid(xg) @ g2)), O_, O_state,ebits,mbits)
                 ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object fpx_matmul at 0x3063a810, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:420 in fpx_matmul (fpx_matmul) (inline depth: 1)
    def fpx_matmul(x,weight,weight_state,ebits:int=3,mbits:int=2):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:421 in fpx_matmul (fpx_matmul) (inline depth: 1)
        if ebits == -44: #hqq
TRACE LOAD_FAST ebits []
TRACE LOAD_CONST -44 [ConstantVariable(int: -44)]
TRACE COMPARE_OP == [ConstantVariable(int: -44), ConstantVariable(int: -44)]
TRACE POP_JUMP_IF_FALSE 322 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S0=x.shape[0]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 0 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 0)]
TRACE STORE_FAST S0 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S1=x.shape[1]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 1)]
TRACE STORE_FAST S1 [ConstantVariable(int: 512)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:424 in fpx_matmul (fpx_matmul) (inline depth: 1)
            dtype = x.dtype
TRACE LOAD_FAST x []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
            x = x.to(dtype=torch.float16).view(-1,x.shape[2])
TRACE LOAD_FAST x []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float16 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_11 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST x [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1)]
TRACE LOAD_ATTR shape [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3), ConstantVariable(int: 2)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), ConstantVariable(int: 8192)]
TRACE FX call view_23 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
            out = weight.forward_manual(x).to(dtype=dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_ATTR forward_manual [LazyVariableTracker()]
TRACE LOAD_FAST x [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE CALL 1 [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton)), TensorVariable()]
TRACE inlined call forward_manual from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:543 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        def forward_manual(self, x: Tensor, matmul_type: str="GEMM") -> Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE LOAD_GLOBAL forward_functional []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:545 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                x,
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:546 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.bias,
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR bias [NullVariable, LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_tensor_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_ATTR get_tensor_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_tensor_args at 0x70c98a9e9080>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_tensor_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_tensor_args(),
            ~~~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:524 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
        def get_tensor_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:525 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
            return [self.W_q, self.scales, self.zeros]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR W_q [UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_FAST self [LazyVariableTracker()]
TRACE LOAD_ATTR scales [LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['O_']._parameters['scales'] (128, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='O_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='scales'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_O_parameters_scales_ L['O_']._parameters['scales'] Parameter(FakeTensor(..., device='cuda:0', size=(128, 5120), dtype=torch.float16)) at debug_level 0 before=False
TRACE LOAD_FAST self [LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR zeros [LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['O_']._parameters['zeros'] (128, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='O_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='zeros'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_O_parameters_zeros_ L['O_']._parameters['zeros'] Parameter(FakeTensor(..., device='cuda:0', size=(128, 5120), dtype=torch.float16)) at debug_level 0 before=False
TRACE BUILD_LIST 3 [LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [ListVariable(length=3)]
DONE INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_meta_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3)]
TRACE LOAD_ATTR get_meta_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_meta_args at 0x70c98a9e9120>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_meta_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_meta_args(),
            ~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:527 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
        def get_meta_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE LOAD_GLOBAL int []
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR scaled_activations [NullVariable, LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:529 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_nbits,
TRACE LOAD_FAST self [ConstantVariable(int: 0)]
TRACE LOAD_ATTR W_nbits [ConstantVariable(int: 0), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:530 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.group_size,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker()]
TRACE LOAD_ATTR group_size [ConstantVariable(int: 0), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:531 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.unpack_mask,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR unpack_mask [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:532 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.elements_per_sample,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR elements_per_sample [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:533 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.input_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR input_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:534 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.output_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR output_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:535 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.acc_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR acc_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:536 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.meta_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR meta_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:537 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.channel_scale_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR channel_scale_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:538 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_group_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR W_group_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:539 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    int(self.data_contiguous),
TRACE LOAD_GLOBAL int [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int)]
TRACE LOAD_ATTR data_contiguous [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE BUILD_LIST 12 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [ListVariable(length=12)]
DONE INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:549 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
TRACE LOAD_GLOBAL GEMLITE_MATMUL_TYPES_MAPPING [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12)]
TRACE LOAD_FAST matmul_type [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker(), ConstantVariable(str: 'GEMM')]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), ConstantVariable(int: 4)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        return forward_functional(
               ~~~~~~~~~~~~~~~~~~^
            x,
            ^^
            self.bias,
            ^^^^^^^^^^
            self.get_tensor_args(),
            ^^^^^^^^^^^^^^^^^^^^^^^
            self.get_meta_args(),
            ^^^^^^^^^^^^^^^^^^^^^
            GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:675 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        def __call__(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
            return self._opoverload(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR _opoverload [NullVariable, UserDefinedObjectVariable(CustomOpDef)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=5)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
wrap_to_fake L['O_'].W_q (1024, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=AttrSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='O_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='W_q'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_O_W_q L['O_'].W_q FakeTensor(..., device='cuda:0', size=(1024, 5120), dtype=torch.int32) at debug_level 0 before=False
TRACE FX call forward_functional_default_1 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        return self._opoverload(*args, **kwargs)
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_12 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE STORE_FAST out [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
            return out.view(S0,S1,-1)
TRACE LOAD_FAST out []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST S0 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST S1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: -1)]
TRACE FX call view_24 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
        return out.view(S0,S1,-1)
               ~~~~~~~~^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object fpx_matmul at 0x3063a810, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>
TRACE STORE_FAST output [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:618 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            x_in = x_in + output
TRACE LOAD_FAST x_in []
TRACE LOAD_FAST output [TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable()]
TRACE FX call add_13 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:618 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        x_in = x_in + output
               ~~~~~^~~~~~~~
TRACE STORE_FAST x_in [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:619 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            output = T5RMSNorm(x_in,ln2,variance_epsilon=rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST x_in [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln2 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE KW_NAMES ('variance_epsilon',) [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ConstantVariable(float: 1e-06)]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:619 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        output = T5RMSNorm(x_in,ln2,variance_epsilon=rmsnorm_epsilon)
                 ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_13 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_14 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_19 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln2'] (5120,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln2', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln2_ L['ln2'] FakeTensor(..., device='cuda:0', size=(5120,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_20 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_14 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST output [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:621 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            return  output, x[:,-1], state, v_first, k_first, x_in
TRACE LOAD_FAST output []
TRACE LOAD_FAST x [TensorVariable()]
TRACE LOAD_CONST None [TensorVariable(), TensorVariable()]
TRACE LOAD_CONST None [TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST -1 [TensorVariable(), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [TensorVariable(), TensorVariable(), SliceVariable(), ConstantVariable(int: -1)]
TRACE BINARY_SUBSCR None [TensorVariable(), TensorVariable(), TupleVariable(length=2)]
TRACE FX call getitem_14 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:621 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        return  output, x[:,-1], state, v_first, k_first, x_in
                        ~^^^^^^
TRACE LOAD_FAST state [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST v_first [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST k_first [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST x_in [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 6 [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [TupleVariable(length=6)]
Step 1: torchdynamo done tracing hxa079_TimeMix (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py, line 621 in hxa079_TimeMix>], graph_break=False)
REMOVE UNUSED GRAPHARG L['layer_id']
TRACED GRAPH
 ===== __compiled_fn_4_816843fd_1282_4e83_82cc_6d5b457895f9 =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, L_x_in_: "[31mbf16[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m", L_ln1_: "[31mbf16[0m[34m[5120][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_wavgk1_: "[31mbf16[0m[34m[5120, 1376][0m[2m[34m[1376, 1][0m[2m[32mcuda:0[0m", L_RKV_parameters_scales_: "[31mf16[0m[34m[80, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m", L_RKV_parameters_zeros_: "[31mf16[0m[34m[80, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m", L_RKV_W_q: "[31mi32[0m[34m[640, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m", L_R_bias_: "[31mbf16[0m[34m[][0m[2m[34m[][0m[2m[32mcuda:0[0m", L_ln_r_: "[31mbf16[0m[34m[128][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_ln_k_: "[31mbf16[0m[34m[128][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_calc_cos_: "[31mf32[0m[34m[1, 512, 128][0m[2m[34m[65536, 128, 1][0m[2m[32mcuda:0[0m", L_calc_sin_: "[31mf32[0m[34m[1, 512, 128][0m[2m[34m[65536, 128, 1][0m[2m[32mcuda:0[0m", L_v_first_: "[31mbf16[0m[34m[1, 512, 8, 128][0m[2m[34m[5242880, 10240, 128, 1][0m[2m[32mcuda:0[0m", L_v2_: "[31mbf16[0m[34m[128, 1024][0m[2m[34m[1024, 1][0m[2m[32mcuda:0[0m", L_v0_: "[31mbf16[0m[34m[1, 1, 1024][0m[2m[34m[1024, 1024, 1][0m[2m[32mcuda:0[0m", L_k_first_: "[31mbf16[0m[34m[1, 512, 8, 128][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m", L_k2_: "[31mbf16[0m[34m[128, 1024][0m[2m[34m[1024, 1][0m[2m[32mcuda:0[0m", L_k0_: "[31mbf16[0m[34m[1, 1, 1024][0m[2m[34m[1024, 1024, 1][0m[2m[32mcuda:0[0m", L_a2_: "[31mbf16[0m[34m[160, 8192][0m[2m[34m[8192, 1][0m[2m[32mcuda:0[0m", L_a0_: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m", L_w2_: "[31mbf16[0m[34m[480, 8192][0m[2m[34m[8192, 1][0m[2m[32mcuda:0[0m", L_w0_: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m", L_state_: "[31mbf16[0m[34m[1, 64, 128, 128][0m[2m[34m[1048576, 16384, 128, 1][0m[2m[32mcuda:0[0m", L_r_k_: "[31mbf16[0m[34m[8192][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_g2_: "[31mbf16[0m[34m[480, 8192][0m[2m[34m[8192, 1][0m[2m[32mcuda:0[0m", L_O_parameters_scales_: "[31mf16[0m[34m[128, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m", L_O_parameters_zeros_: "[31mf16[0m[34m[128, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m", L_O_W_q: "[31mi32[0m[34m[1024, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m", L_ln2_: "[31mbf16[0m[34m[5120][0m[2m[34m[1][0m[2m[32mcuda:0[0m"):
        l_x_in_ = L_x_in_
        l_ln1_ = L_ln1_
        l_wavgk1_ = L_wavgk1_
        l_rkv_parameters_scales_ = L_RKV_parameters_scales_
        l_rkv_parameters_zeros_ = L_RKV_parameters_zeros_
        l_rkv_w_q = L_RKV_W_q
        l_r_bias_ = L_R_bias_
        l_ln_r_ = L_ln_r_
        l_ln_k_ = L_ln_k_
        l_calc_cos_ = L_calc_cos_
        l_calc_sin_ = L_calc_sin_
        l_v_first_ = L_v_first_
        l_v2_ = L_v2_
        l_v0_ = L_v0_
        l_k_first_ = L_k_first_
        l_k2_ = L_k2_
        l_k0_ = L_k0_
        l_a2_ = L_a2_
        l_a0_ = L_a0_
        l_w2_ = L_w2_
        l_w0_ = L_w0_
        l_state_ = L_state_
        l_r_k_ = L_r_k_
        l_g2_ = L_g2_
        l_o_parameters_scales_ = L_O_parameters_scales_
        l_o_parameters_zeros_ = L_O_parameters_zeros_
        l_o_w_q = L_O_W_q
        l_ln2_ = L_ln2_
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states: "[31mf32[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = l_x_in_.to([34mtorch.float32[0m)
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_1: "[31mf32[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states.pow([34m2[0m)
        variance: "[31mf32[0m[34m[1, 512, 1][0m[2m[34m[512, 1, 1][0m[2m[32mcuda:0[0m" = pow_1.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add: "[31mf32[0m[34m[1, 512, 1][0m[2m[34m[512, 1, 1][0m[2m[32mcuda:0[0m" = variance + [34m1e-06[0m;  [2mvariance = None[0m
        rsqrt: "[31mf32[0m[34m[1, 512, 1][0m[2m[34m[512, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add);  [2madd = None[0m
        hidden_states_1: "[31mf32[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states * rsqrt;  [2mhidden_states = rsqrt = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_1: "[31mf32[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = l_ln1_ * hidden_states_1;  [2ml_ln1_ = hidden_states_1 = None[0m
        x: "[31mbf16[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = mul_1.to([34mtorch.bfloat16[0m);  [2mmul_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:551 in hxa079_TimeMix, code: xw,xa,xv,xg,xk = (x @ wavgk1).split(wavgk_split_list, dim=-1)[0m
        matmul: "[31mbf16[0m[34m[1, 512, 1376][0m[2m[34m[704512, 1376, 1][0m[2m[32mcuda:0[0m" = x @ l_wavgk1_;  [2ml_wavgk1_ = None[0m
        split = matmul.split([[34m480[0m, [34m160[0m, [34m128[0m, [34m480[0m, [34m128[0m], dim = [34m-1[0m);  [2mmatmul = None[0m
        xw: "[31mbf16[0m[34m[1, 512, 480][0m[2m[34m[704512, 1376, 1][0m[2m[32mcuda:0[0m" = split[[34m0[0m]
        xa: "[31mbf16[0m[34m[1, 512, 160][0m[2m[34m[704512, 1376, 1][0m[2m[32mcuda:0[0m" = split[[34m1[0m]
        xv: "[31mbf16[0m[34m[1, 512, 128][0m[2m[34m[704512, 1376, 1][0m[2m[32mcuda:0[0m" = split[[34m2[0m]
        xg: "[31mbf16[0m[34m[1, 512, 480][0m[2m[34m[704512, 1376, 1][0m[2m[32mcuda:0[0m" = split[[34m3[0m]
        xk: "[31mbf16[0m[34m[1, 512, 128][0m[2m[34m[704512, 1376, 1][0m[2m[32mcuda:0[0m" = split[[34m4[0m];  [2msplit = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul, code: x = x.to(dtype=torch.float16).view(-1,x.shape[2])[0m
        to_2: "[31mf16[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = x.to(dtype = [34mtorch.float16[0m)
        x_1: "[31mf16[0m[34m[512, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m" = to_2.view([34m-1[0m, [34m5120[0m);  [2mto_2 = None[0m
        
         [2m# File: /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__, code: return self._opoverload(*args, **kwargs)[0m
        forward_functional_default: "[31mf16[0m[34m[512, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m" = torch.ops.gemlite.forward_functional.default(x_1, [34mNone[0m, [l_rkv_w_q, l_rkv_parameters_scales_, l_rkv_parameters_zeros_], [[34m0[0m, [34m4[0m, [34m64[0m, [34m15[0m, [34m8[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m0[0m, [34m4[0m, [34m1[0m], [34m4[0m);  [2mx_1 = l_rkv_w_q = l_rkv_parameters_scales_ = l_rkv_parameters_zeros_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul, code: out = weight.forward_manual(x).to(dtype=dtype)[0m
        out: "[31mbf16[0m[34m[512, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m" = forward_functional_default.to(dtype = [34mtorch.bfloat16[0m);  [2mforward_functional_default = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul, code: return out.view(S0,S1,-1)[0m
        rkv: "[31mbf16[0m[34m[1, 512, 10240][0m[2m[34m[5242880, 10240, 1][0m[2m[32mcuda:0[0m" = out.view([34m1[0m, [34m512[0m, [34m-1[0m);  [2mout = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:556 in hxa079_TimeMix, code: r,k,v = rkv.split(rkv_split_list,dim=-1)[0m
        split_1 = rkv.split([[34m8192[0m, [34m1024[0m, [34m1024[0m], dim = [34m-1[0m);  [2mrkv = None[0m
        r: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[5242880, 10240, 1][0m[2m[32mcuda:0[0m" = split_1[[34m0[0m]
        k: "[31mbf16[0m[34m[1, 512, 1024][0m[2m[34m[5242880, 10240, 1][0m[2m[32mcuda:0[0m" = split_1[[34m1[0m]
        v: "[31mbf16[0m[34m[1, 512, 1024][0m[2m[34m[5242880, 10240, 1][0m[2m[32mcuda:0[0m" = split_1[[34m2[0m];  [2msplit_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:562 in hxa079_TimeMix, code: r = r.add_(R_bias)[0m
        r_1: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[5242880, 10240, 1][0m[2m[32mcuda:0[0m" = r.add_(l_r_bias_);  [2mr = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:563 in hxa079_TimeMix, code: k = k.add_(K_bias).view(B, T, kv_per_head, N)[0m
        add__1: "[31mbf16[0m[34m[1, 512, 1024][0m[2m[34m[5242880, 10240, 1][0m[2m[32mcuda:0[0m" = k.add_(l_r_bias_);  [2mk = None[0m
        k_1: "[31mbf16[0m[34m[1, 512, 8, 128][0m[2m[34m[5242880, 10240, 128, 1][0m[2m[32mcuda:0[0m" = add__1.view([34m1[0m, [34m512[0m, [34m8[0m, [34m128[0m);  [2madd__1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:564 in hxa079_TimeMix, code: v = v.add_(V_bias).view(B, T, kv_per_head, N)[0m
        add__2: "[31mbf16[0m[34m[1, 512, 1024][0m[2m[34m[5242880, 10240, 1][0m[2m[32mcuda:0[0m" = v.add_(l_r_bias_);  [2mv = l_r_bias_ = None[0m
        v_1: "[31mbf16[0m[34m[1, 512, 8, 128][0m[2m[34m[5242880, 10240, 128, 1][0m[2m[32mcuda:0[0m" = add__2.view([34m1[0m, [34m512[0m, [34m8[0m, [34m128[0m);  [2madd__2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:572 in hxa079_TimeMix, code: r = T5RMSNorm(r.view(B,T,H,N), ln_r, variance_epsilon=rmsnorm_epsilon)[0m
        view_4: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[5242880, 10240, 128, 1][0m[2m[32mcuda:0[0m" = r_1.view([34m1[0m, [34m512[0m, [34m64[0m, [34m128[0m);  [2mr_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states_2: "[31mf32[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = view_4.to([34mtorch.float32[0m);  [2mview_4 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_2: "[31mf32[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_2.pow([34m2[0m)
        variance_1: "[31mf32[0m[34m[1, 512, 64, 1][0m[2m[34m[32768, 64, 1, 1][0m[2m[32mcuda:0[0m" = pow_2.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add_1: "[31mf32[0m[34m[1, 512, 64, 1][0m[2m[34m[32768, 64, 1, 1][0m[2m[32mcuda:0[0m" = variance_1 + [34m1e-06[0m;  [2mvariance_1 = None[0m
        rsqrt_1: "[31mf32[0m[34m[1, 512, 64, 1][0m[2m[34m[32768, 64, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add_1);  [2madd_1 = None[0m
        hidden_states_3: "[31mf32[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_2 * rsqrt_1;  [2mhidden_states_2 = rsqrt_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_3: "[31mf32[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = l_ln_r_ * hidden_states_3;  [2ml_ln_r_ = hidden_states_3 = None[0m
        r_2: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = mul_3.to([34mtorch.bfloat16[0m);  [2mmul_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states_4: "[31mf32[0m[34m[1, 512, 8, 128][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = k_1.to([34mtorch.float32[0m);  [2mk_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_3: "[31mf32[0m[34m[1, 512, 8, 128][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_4.pow([34m2[0m)
        variance_2: "[31mf32[0m[34m[1, 512, 8, 1][0m[2m[34m[4096, 8, 1, 1][0m[2m[32mcuda:0[0m" = pow_3.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add_2: "[31mf32[0m[34m[1, 512, 8, 1][0m[2m[34m[4096, 8, 1, 1][0m[2m[32mcuda:0[0m" = variance_2 + [34m1e-06[0m;  [2mvariance_2 = None[0m
        rsqrt_2: "[31mf32[0m[34m[1, 512, 8, 1][0m[2m[34m[4096, 8, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add_2);  [2madd_2 = None[0m
        hidden_states_5: "[31mf32[0m[34m[1, 512, 8, 128][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_4 * rsqrt_2;  [2mhidden_states_4 = rsqrt_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_5: "[31mf32[0m[34m[1, 512, 8, 128][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = l_ln_k_ * hidden_states_5;  [2ml_ln_k_ = hidden_states_5 = None[0m
        k_2: "[31mbf16[0m[34m[1, 512, 8, 128][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = mul_5.to([34mtorch.bfloat16[0m);  [2mmul_5 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:576 in hxa079_TimeMix, code: cos, sin = calc_cos.to(k.dtype), calc_sin.to(k.dtype)[0m
        cos: "[31mbf16[0m[34m[1, 512, 128][0m[2m[34m[65536, 128, 1][0m[2m[32mcuda:0[0m" = l_calc_cos_.to([34mtorch.bfloat16[0m);  [2ml_calc_cos_ = None[0m
        sin: "[31mbf16[0m[34m[1, 512, 128][0m[2m[34m[65536, 128, 1][0m[2m[32mcuda:0[0m" = l_calc_sin_.to([34mtorch.bfloat16[0m);  [2ml_calc_sin_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:493 in apply_rotary_pos_emb, code: cos = cos.unsqueeze(unsqueeze_dim)[0m
        cos_1: "[31mbf16[0m[34m[1, 512, 1, 128][0m[2m[34m[65536, 128, 128, 1][0m[2m[32mcuda:0[0m" = cos.unsqueeze([34m2[0m);  [2mcos = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:494 in apply_rotary_pos_emb, code: sin = sin.unsqueeze(unsqueeze_dim)[0m
        sin_1: "[31mbf16[0m[34m[1, 512, 1, 128][0m[2m[34m[65536, 128, 128, 1][0m[2m[32mcuda:0[0m" = sin.unsqueeze([34m2[0m);  [2msin = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb, code: q_embed = (q * cos) + (rotate_half(q) * sin)[0m
        mul_6: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = r_2 * cos_1
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half, code: x1 = x[..., : x.shape[-1] // 2][0m
        x1: "[31mbf16[0m[34m[1, 512, 64, 64][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = r_2[([34mEllipsis[0m, slice([34mNone[0m, [34m64[0m, [34mNone[0m))]
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half, code: x2 = x[..., x.shape[-1] // 2 :][0m
        x2: "[31mbf16[0m[34m[1, 512, 64, 64][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = r_2[([34mEllipsis[0m, slice([34m64[0m, [34mNone[0m, [34mNone[0m))];  [2mr_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half, code: return torch.cat((-x2, x1), dim=-1)[0m
        neg: "[31mbf16[0m[34m[1, 512, 64, 64][0m[2m[34m[2097152, 4096, 64, 1][0m[2m[32mcuda:0[0m" = -x2;  [2mx2 = None[0m
        cat: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = torch.cat((neg, x1), dim = [34m-1[0m);  [2mneg = x1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb, code: q_embed = (q * cos) + (rotate_half(q) * sin)[0m
        mul_7: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = cat * sin_1;  [2mcat = None[0m
        q_embed: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = mul_6 + mul_7;  [2mmul_6 = mul_7 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb, code: k_embed = (k * cos) + (rotate_half(k) * sin)[0m
        mul_8: "[31mbf16[0m[34m[1, 512, 8, 128][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = k_2 * cos_1;  [2mcos_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half, code: x1 = x[..., : x.shape[-1] // 2][0m
        x1_1: "[31mbf16[0m[34m[1, 512, 8, 64][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = k_2[([34mEllipsis[0m, slice([34mNone[0m, [34m64[0m, [34mNone[0m))]
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half, code: x2 = x[..., x.shape[-1] // 2 :][0m
        x2_1: "[31mbf16[0m[34m[1, 512, 8, 64][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = k_2[([34mEllipsis[0m, slice([34m64[0m, [34mNone[0m, [34mNone[0m))];  [2mk_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half, code: return torch.cat((-x2, x1), dim=-1)[0m
        neg_1: "[31mbf16[0m[34m[1, 512, 8, 64][0m[2m[34m[262144, 512, 64, 1][0m[2m[32mcuda:0[0m" = -x2_1;  [2mx2_1 = None[0m
        cat_1: "[31mbf16[0m[34m[1, 512, 8, 128][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = torch.cat((neg_1, x1_1), dim = [34m-1[0m);  [2mneg_1 = x1_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb, code: k_embed = (k * cos) + (rotate_half(k) * sin)[0m
        mul_9: "[31mbf16[0m[34m[1, 512, 8, 128][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = cat_1 * sin_1;  [2mcat_1 = sin_1 = None[0m
        k_embed: "[31mbf16[0m[34m[1, 512, 8, 128][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = mul_8 + mul_9;  [2mmul_8 = mul_9 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:584 in hxa079_TimeMix, code: v = v + (v_first - v) * torch.sigmoid(xv@v2 + v0).view(B, T, kv_per_head, N)[0m
        sub: "[31mbf16[0m[34m[1, 512, 8, 128][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = l_v_first_ - v_1;  [2ml_v_first_ = None[0m
        matmul_1: "[31mbf16[0m[34m[1, 512, 1024][0m[2m[34m[524288, 1024, 1][0m[2m[32mcuda:0[0m" = xv @ l_v2_;  [2mxv = l_v2_ = None[0m
        add_5: "[31mbf16[0m[34m[1, 512, 1024][0m[2m[34m[524288, 1024, 1][0m[2m[32mcuda:0[0m" = matmul_1 + l_v0_;  [2mmatmul_1 = l_v0_ = None[0m
        sigmoid: "[31mbf16[0m[34m[1, 512, 1024][0m[2m[34m[524288, 1024, 1][0m[2m[32mcuda:0[0m" = torch.sigmoid(add_5);  [2madd_5 = None[0m
        view_5: "[31mbf16[0m[34m[1, 512, 8, 128][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = sigmoid.view([34m1[0m, [34m512[0m, [34m8[0m, [34m128[0m);  [2msigmoid = None[0m
        mul_10: "[31mbf16[0m[34m[1, 512, 8, 128][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = sub * view_5;  [2msub = view_5 = None[0m
        v_2: "[31mbf16[0m[34m[1, 512, 8, 128][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = v_1 + mul_10;  [2mv_1 = mul_10 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:585 in hxa079_TimeMix, code: k = k + (k_first - k) * torch.sigmoid(xk@k2 + k0).view(B, T, kv_per_head, N)[0m
        sub_1: "[31mbf16[0m[34m[1, 512, 8, 128][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = l_k_first_ - k_embed;  [2ml_k_first_ = None[0m
        matmul_2: "[31mbf16[0m[34m[1, 512, 1024][0m[2m[34m[524288, 1024, 1][0m[2m[32mcuda:0[0m" = xk @ l_k2_;  [2mxk = l_k2_ = None[0m
        add_7: "[31mbf16[0m[34m[1, 512, 1024][0m[2m[34m[524288, 1024, 1][0m[2m[32mcuda:0[0m" = matmul_2 + l_k0_;  [2mmatmul_2 = l_k0_ = None[0m
        sigmoid_1: "[31mbf16[0m[34m[1, 512, 1024][0m[2m[34m[524288, 1024, 1][0m[2m[32mcuda:0[0m" = torch.sigmoid(add_7);  [2madd_7 = None[0m
        view_6: "[31mbf16[0m[34m[1, 512, 8, 128][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = sigmoid_1.view([34m1[0m, [34m512[0m, [34m8[0m, [34m128[0m);  [2msigmoid_1 = None[0m
        mul_11: "[31mbf16[0m[34m[1, 512, 8, 128][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = sub_1 * view_6;  [2msub_1 = view_6 = None[0m
        k_3: "[31mbf16[0m[34m[1, 512, 8, 128][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = k_embed + mul_11;  [2mk_embed = mul_11 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:357 in repeat_kv, code: hidden_states = hidden_states[:, :, :, None, :]  # (B, T, H_kv, 1, D)[0m
        hidden_states_6: "[31mbf16[0m[34m[1, 512, 8, 1, 128][0m[2m[34m[524288, 1024, 128, 128, 1][0m[2m[32mcuda:0[0m" = k_3[(slice([34mNone[0m, [34mNone[0m, [34mNone[0m), slice([34mNone[0m, [34mNone[0m, [34mNone[0m), slice([34mNone[0m, [34mNone[0m, [34mNone[0m), [34mNone[0m, slice([34mNone[0m, [34mNone[0m, [34mNone[0m))];  [2mk_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:358 in repeat_kv, code: hidden_states = hidden_states.expand(B, T, H_kv, n_rep, D)  # (B, T, H_kv, n_rep, D)[0m
        hidden_states_7: "[31mbf16[0m[34m[1, 512, 8, 8, 128][0m[2m[34m[524288, 1024, 128, 0, 1][0m[2m[32mcuda:0[0m" = hidden_states_6.expand([34m1[0m, [34m512[0m, [34m8[0m, [34m8[0m, [34m128[0m);  [2mhidden_states_6 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv, code: return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()[0m
        reshape: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_7.reshape([34m1[0m, [34m512[0m, [34m64[0m, [34m128[0m);  [2mhidden_states_7 = None[0m
        contiguous: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = reshape.contiguous();  [2mreshape = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:589 in hxa079_TimeMix, code: k = repeat_kv(k, kv_repeat).view(B, T, -1)[0m
        k_4: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = contiguous.view([34m1[0m, [34m512[0m, [34m-1[0m);  [2mcontiguous = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:357 in repeat_kv, code: hidden_states = hidden_states[:, :, :, None, :]  # (B, T, H_kv, 1, D)[0m
        hidden_states_8: "[31mbf16[0m[34m[1, 512, 8, 1, 128][0m[2m[34m[524288, 1024, 128, 128, 1][0m[2m[32mcuda:0[0m" = v_2[(slice([34mNone[0m, [34mNone[0m, [34mNone[0m), slice([34mNone[0m, [34mNone[0m, [34mNone[0m), slice([34mNone[0m, [34mNone[0m, [34mNone[0m), [34mNone[0m, slice([34mNone[0m, [34mNone[0m, [34mNone[0m))];  [2mv_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:358 in repeat_kv, code: hidden_states = hidden_states.expand(B, T, H_kv, n_rep, D)  # (B, T, H_kv, n_rep, D)[0m
        hidden_states_9: "[31mbf16[0m[34m[1, 512, 8, 8, 128][0m[2m[34m[524288, 1024, 128, 0, 1][0m[2m[32mcuda:0[0m" = hidden_states_8.expand([34m1[0m, [34m512[0m, [34m8[0m, [34m8[0m, [34m128[0m);  [2mhidden_states_8 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv, code: return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()[0m
        reshape_1: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_9.reshape([34m1[0m, [34m512[0m, [34m64[0m, [34m128[0m);  [2mhidden_states_9 = None[0m
        contiguous_1: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = reshape_1.contiguous();  [2mreshape_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:590 in hxa079_TimeMix, code: v = repeat_kv(v, kv_repeat).view(B, T, -1)[0m
        v_3: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = contiguous_1.view([34m1[0m, [34m512[0m, [34m-1[0m);  [2mcontiguous_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:593 in hxa079_TimeMix, code: a = torch.sigmoid(xa @ a2 + a0)[0m
        matmul_3: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = xa @ l_a2_;  [2mxa = l_a2_ = None[0m
        add_9: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = matmul_3 + l_a0_;  [2mmatmul_3 = l_a0_ = None[0m
        a: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = torch.sigmoid(add_9);  [2madd_9 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:595 in hxa079_TimeMix, code: kk = F.normalize(k.view(B, T, H, N), p=2.0, dim=-1).view(B, T, H*N)[0m
        view_9: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = k_4.view([34m1[0m, [34m512[0m, [34m64[0m, [34m128[0m)
        normalize: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = torch.nn.functional.normalize(view_9, p = [34m2.0[0m, dim = [34m-1[0m);  [2mview_9 = None[0m
        kk: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = normalize.view([34m1[0m, [34m512[0m, [34m8192[0m);  [2mnormalize = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:596 in hxa079_TimeMix, code: w = torch.tanh(xw) @ w2 + w0[0m
        tanh: "[31mbf16[0m[34m[1, 512, 480][0m[2m[34m[245760, 480, 1][0m[2m[32mcuda:0[0m" = torch.tanh(xw);  [2mxw = None[0m
        matmul_4: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = tanh @ l_w2_;  [2mtanh = l_w2_ = None[0m
        w: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = matmul_4 + l_w0_;  [2mmatmul_4 = l_w0_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:597 in hxa079_TimeMix, code: w = -F.softplus(-w) - 0.5[0m
        neg_2: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = -w;  [2mw = None[0m
        softplus: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = torch._C._nn.softplus(neg_2);  [2mneg_2 = None[0m
        neg_3: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = -softplus;  [2msoftplus = None[0m
        w_1: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = neg_3 - [34m0.5[0m;  [2mneg_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:598 in hxa079_TimeMix, code: k = k * (1.0 - w + a)[0m
        sub_3: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = [34m1.0[0m - w_1
        add_11: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = sub_3 + a;  [2msub_3 = None[0m
        k_5: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = k_4 * add_11;  [2mk_4 = add_11 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:600 in hxa079_TimeMix, code: aa = -kk[0m
        aa: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = -kk
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:601 in hxa079_TimeMix, code: bb = kk * a[0m
        bb: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = kk * a;  [2mkk = a = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:603 in hxa079_TimeMix, code: w = -w.exp()#.to(dtype=torch.float32).exp()[0m
        exp: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = w_1.exp();  [2mw_1 = None[0m
        w_2: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = -exp;  [2mexp = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:604 in hxa079_TimeMix, code: r_,w_,k_,v_,aa_,bb_ = [i.view(B,T,H,N) for i in [r,w,k,v,aa,bb]][0m
        r_: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = q_embed.view([34m1[0m, [34m512[0m, [34m64[0m, [34m128[0m)
        w_: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = w_2.view([34m1[0m, [34m512[0m, [34m64[0m, [34m128[0m);  [2mw_2 = None[0m
        k_: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = k_5.view([34m1[0m, [34m512[0m, [34m64[0m, [34m128[0m)
        v_: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = v_3.view([34m1[0m, [34m512[0m, [34m64[0m, [34m128[0m)
        aa_: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = aa.view([34m1[0m, [34m512[0m, [34m64[0m, [34m128[0m);  [2maa = None[0m
        bb_: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = bb.view([34m1[0m, [34m512[0m, [34m64[0m, [34m128[0m);  [2mbb = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:19 in <genexpr>, code: *(i if not isinstance(i, torch.Tensor) else i.contiguous() for i in args),[0m
        contiguous_2: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = r_.contiguous();  [2mr_ = None[0m
        contiguous_3: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = k_.contiguous();  [2mk_ = None[0m
        contiguous_4: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = v_.contiguous();  [2mv_ = None[0m
        contiguous_5: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = aa_.contiguous();  [2maa_ = None[0m
        contiguous_6: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = bb_.contiguous();  [2mbb_ = None[0m
        contiguous_7: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = w_.contiguous();  [2mw_ = None[0m
        contiguous_8: "[31mbf16[0m[34m[1, 64, 128, 128][0m[2m[34m[1048576, 16384, 128, 1][0m[2m[32mcuda:0[0m" = l_state_.contiguous();  [2ml_state_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:148 in forward, code: final_state = q.new_empty(B, H, K, V, dtype=torch.float32)[0m
        final_state: "[31mf32[0m[34m[1, 64, 128, 128][0m[2m[34m[1048576, 16384, 128, 1][0m[2m[32mcuda:0[0m" = contiguous_2.new_empty([34m1[0m, [34m64[0m, [34m128[0m, [34m128[0m, dtype = [34mtorch.float32[0m)
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:152 in forward, code: ha = torch.empty_like(v, dtype=torch.float32)[0m
        ha: "[31mf32[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = torch.empty_like(contiguous_4, dtype = [34mtorch.float32[0m)
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:155 in forward, code: o = torch.empty_like(v)[0m
        o: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = torch.empty_like(contiguous_4)
        
         [2m# File: /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:452 in run, code: return self.fn.run(*args, **kwargs)[0m
        triton_kernel_wrapper_mutation = torch.ops.higher_order.triton_kernel_wrapper_mutation(kernel_idx = [34m0[0m, constant_args_idx = [34m1[0m, grid = [([34m4[0m, [34m64[0m, [34m1[0m), ([34m4[0m, [34m64[0m, [34m1[0m), ([34m4[0m, [34m64[0m, [34m1[0m)], tma_descriptor_metadata = [34m{}[0m, kwargs = [34m{'q': contiguous_2, 'k': contiguous_3, 'v': contiguous_4, 'a': contiguous_5, 'b': contiguous_6, 'gk': contiguous_7, 'o': o, 'ha': ha, 'h0': contiguous_8, 'ht': final_state}[0m);  [2mcontiguous_2 = contiguous_3 = contiguous_4 = contiguous_5 = contiguous_6 = contiguous_7 = ha = contiguous_8 = triton_kernel_wrapper_mutation = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:612 in hxa079_TimeMix, code: xx = xx.view(B,T,-1) * (float(N) ** -0.5)[0m
        view_17: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = o.view([34m1[0m, [34m512[0m, [34m-1[0m);  [2mo = None[0m
        xx: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = view_17 * [34m0.08838834764831845[0m;  [2mview_17 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix, code: xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)[0m
        to_10: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = xx.to(dtype = [34mtorch.bfloat16[0m);  [2mxx = None[0m
        view_18: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = q_embed.view([34m1[0m, [34m512[0m, [34m64[0m, [34m128[0m);  [2mq_embed = None[0m
        view_19: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = k_5.view([34m1[0m, [34m512[0m, [34m64[0m, [34m128[0m);  [2mk_5 = None[0m
        mul_15: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = view_18 * view_19;  [2mview_18 = view_19 = None[0m
        view_20: "[31mbf16[0m[34m[64, 128][0m[2m[34m[128, 1][0m[2m[32mcuda:0[0m" = l_r_k_.view([34m64[0m, [34m128[0m);  [2ml_r_k_ = None[0m
        mul_16: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = mul_15 * view_20;  [2mmul_15 = view_20 = None[0m
        sum_1: "[31mbf16[0m[34m[1, 512, 64, 1][0m[2m[34m[32768, 64, 1, 1][0m[2m[32mcuda:0[0m" = mul_16.sum(dim = [34m-1[0m, keepdim = [34mTrue[0m);  [2mmul_16 = None[0m
        view_21: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = v_3.view([34m1[0m, [34m512[0m, [34m64[0m, [34m128[0m);  [2mv_3 = None[0m
        mul_17: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = sum_1 * view_21;  [2msum_1 = view_21 = None[0m
        view_22: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = mul_17.view([34m1[0m, [34m512[0m, [34m8192[0m);  [2mmul_17 = None[0m
        xx_1: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = to_10 + view_22;  [2mto_10 = view_22 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:616 in hxa079_TimeMix, code: output = fpx_matmul((xx * (torch.sigmoid(xg) @ g2)), O_, O_state,ebits,mbits)[0m
        sigmoid_3: "[31mbf16[0m[34m[1, 512, 480][0m[2m[34m[245760, 480, 1][0m[2m[32mcuda:0[0m" = torch.sigmoid(xg);  [2mxg = None[0m
        matmul_5: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = sigmoid_3 @ l_g2_;  [2msigmoid_3 = l_g2_ = None[0m
        mul_18: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = xx_1 * matmul_5;  [2mxx_1 = matmul_5 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul, code: x = x.to(dtype=torch.float16).view(-1,x.shape[2])[0m
        to_11: "[31mf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = mul_18.to(dtype = [34mtorch.float16[0m);  [2mmul_18 = None[0m
        x_2: "[31mf16[0m[34m[512, 8192][0m[2m[34m[8192, 1][0m[2m[32mcuda:0[0m" = to_11.view([34m-1[0m, [34m8192[0m);  [2mto_11 = None[0m
        
         [2m# File: /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__, code: return self._opoverload(*args, **kwargs)[0m
        forward_functional_default_1: "[31mf16[0m[34m[512, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m" = torch.ops.gemlite.forward_functional.default(x_2, [34mNone[0m, [l_o_w_q, l_o_parameters_scales_, l_o_parameters_zeros_], [[34m0[0m, [34m4[0m, [34m64[0m, [34m15[0m, [34m8[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m0[0m, [34m4[0m, [34m1[0m], [34m4[0m);  [2mx_2 = l_o_w_q = l_o_parameters_scales_ = l_o_parameters_zeros_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul, code: out = weight.forward_manual(x).to(dtype=dtype)[0m
        out_1: "[31mbf16[0m[34m[512, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m" = forward_functional_default_1.to(dtype = [34mtorch.bfloat16[0m);  [2mforward_functional_default_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul, code: return out.view(S0,S1,-1)[0m
        output: "[31mbf16[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = out_1.view([34m1[0m, [34m512[0m, [34m-1[0m);  [2mout_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:618 in hxa079_TimeMix, code: x_in = x_in + output[0m
        x_in: "[31mbf16[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = l_x_in_ + output;  [2ml_x_in_ = output = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states_10: "[31mf32[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = x_in.to([34mtorch.float32[0m)
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_4: "[31mf32[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states_10.pow([34m2[0m)
        variance_3: "[31mf32[0m[34m[1, 512, 1][0m[2m[34m[512, 1, 1][0m[2m[32mcuda:0[0m" = pow_4.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_4 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add_14: "[31mf32[0m[34m[1, 512, 1][0m[2m[34m[512, 1, 1][0m[2m[32mcuda:0[0m" = variance_3 + [34m1e-06[0m;  [2mvariance_3 = None[0m
        rsqrt_3: "[31mf32[0m[34m[1, 512, 1][0m[2m[34m[512, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add_14);  [2madd_14 = None[0m
        hidden_states_11: "[31mf32[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states_10 * rsqrt_3;  [2mhidden_states_10 = rsqrt_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_20: "[31mf32[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = l_ln2_ * hidden_states_11;  [2ml_ln2_ = hidden_states_11 = None[0m
        output_1: "[31mbf16[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = mul_20.to([34mtorch.bfloat16[0m);  [2mmul_20 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:621 in hxa079_TimeMix, code: return  output, x[:,-1], state, v_first, k_first, x_in[0m
        getitem_14: "[31mbf16[0m[34m[1, 5120][0m[2m[34m[2621440, 1][0m[2m[32mcuda:0[0m" = x[(slice([34mNone[0m, [34mNone[0m, [34mNone[0m), [34m-1[0m)];  [2mx = None[0m
        return (output_1, getitem_14, final_state, x_in)
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing GQA_Attention_Flash_ /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:875
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:875 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7)
        @torch.compile(mode="max-autotune-no-cudagraphs")
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:904 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            B, T, C = x_in.shape
TRACE LOAD_FAST x_in []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
wrap_to_fake L['x_in'] (1, 512, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='x_in', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_x_in_ L['x_in'] FakeTensor(..., device='cuda:0', size=(1, 512, 5120), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE UNPACK_SEQUENCE 3 [SizeVariable(length=3)]
TRACE STORE_FAST B [ConstantVariable(int: 5120), ConstantVariable(int: 512), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 5120), ConstantVariable(int: 512)]
TRACE STORE_FAST C [ConstantVariable(int: 5120)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:905 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            device = x_in.device
TRACE LOAD_FAST x_in []
TRACE LOAD_ATTR device [TensorVariable()]
TRACE STORE_FAST device [ConstantVariable(device: device(type='cuda', index=0))]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:906 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            Lmax = past_key_value.shape[3]
TRACE LOAD_FAST past_key_value []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
wrap_to_fake L['past_key_value'] (8, 1, 2, 8192, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='past_key_value', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}), tensor_source=LocalSource(local_name='past_key_value', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_past_key_value_ L['past_key_value'] FakeTensor(..., device='cuda:0', size=(8, 1, 2, 8192, 1024),
           dtype=torch.bfloat16) at debug_level 0 before=False
wrap_to_fake L['past_key_value']._base (8, 1, 2, 8192, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='past_key_value', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
TRACE LOAD_CONST 3 [SizeVariable(length=5)]
TRACE BINARY_SUBSCR None [SizeVariable(length=5), ConstantVariable(int: 3)]
TRACE STORE_FAST Lmax [ConstantVariable(int: 8192)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            starts = cache_position[:, 0].clone()
TRACE LOAD_FAST cache_position []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE LOAD_CONST None [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [LazyVariableTracker(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST 0 [LazyVariableTracker(), SliceVariable()]
TRACE BUILD_TUPLE 2 [LazyVariableTracker(), SliceVariable(), ConstantVariable(int: 0)]
TRACE BINARY_SUBSCR None [LazyVariableTracker(), TupleVariable(length=2)]
wrap_to_fake L['cache_position'] (1, 1) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='cache_position', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_cache_position_ L['cache_position'] FakeTensor(..., device='cuda:0', size=(1, 1), dtype=torch.int64) at debug_level 0 before=False
TRACE FX call getitem from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        starts = cache_position[:, 0].clone()
                 ~~~~~~~~~~~~~~^^^^^^
TRACE LOAD_ATTR clone [TensorVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), clone)]
TRACE FX call clone from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        starts = cache_position[:, 0].clone()
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST starts [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:910 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            starts.clamp_(min=0, max=Lmax)
TRACE LOAD_FAST starts []
TRACE LOAD_ATTR clamp_ [TensorVariable()]
TRACE LOAD_CONST 0 [NullVariable, GetAttrVariable(TensorVariable(), clamp_)]
TRACE LOAD_FAST Lmax [NullVariable, GetAttrVariable(TensorVariable(), clamp_), ConstantVariable(int: 0)]
TRACE KW_NAMES ('min', 'max') [NullVariable, GetAttrVariable(TensorVariable(), clamp_), ConstantVariable(int: 0), ConstantVariable(int: 8192)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), clamp_), ConstantVariable(int: 0), ConstantVariable(int: 8192)]
TRACE FX call clamp_ from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:910 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        starts.clamp_(min=0, max=Lmax)
        ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:913 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            x = T5RMSNorm(x_in, ln1, rmsnorm_epsilon)  # 実装は外部
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST x_in [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:913 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        x = T5RMSNorm(x_in, ln1, rmsnorm_epsilon)  # 実装は外部
            ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE FX call add from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln1'] (5120,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln1', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln1_ L['ln1'] FakeTensor(..., device='cuda:0', size=(5120,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:915 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            HN = H * N
TRACE LOAD_FAST H []
TRACE LOAD_FAST N [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), LazyVariableTracker()]
TRACE STORE_FAST HN [ConstantVariable(int: 8192)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:918 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            qkv = fpx_matmul(x, QKV_, QKV_state, ebits, mbits)  # [B,T, QHN + KVd + KVd]
TRACE LOAD_GLOBAL fpx_matmul []
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST QKV_ [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST QKV_state [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_FAST ebits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST mbits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call fpx_matmul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:918 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        qkv = fpx_matmul(x, QKV_, QKV_state, ebits, mbits)  # [B,T, QHN + KVd + KVd]
              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object fpx_matmul at 0x3063a810, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:420 in fpx_matmul (fpx_matmul) (inline depth: 1)
    def fpx_matmul(x,weight,weight_state,ebits:int=3,mbits:int=2):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:421 in fpx_matmul (fpx_matmul) (inline depth: 1)
        if ebits == -44: #hqq
TRACE LOAD_FAST ebits []
TRACE LOAD_CONST -44 [LazyVariableTracker()]
TRACE COMPARE_OP == [LazyVariableTracker(), ConstantVariable(int: -44)]
TRACE POP_JUMP_IF_FALSE 322 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S0=x.shape[0]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 0 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 0)]
TRACE STORE_FAST S0 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S1=x.shape[1]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 1)]
TRACE STORE_FAST S1 [ConstantVariable(int: 512)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:424 in fpx_matmul (fpx_matmul) (inline depth: 1)
            dtype = x.dtype
TRACE LOAD_FAST x []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
            x = x.to(dtype=torch.float16).view(-1,x.shape[2])
TRACE LOAD_FAST x []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float16 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_2 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST x [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1)]
TRACE LOAD_ATTR shape [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3), ConstantVariable(int: 2)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), ConstantVariable(int: 5120)]
TRACE FX call view from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
            out = weight.forward_manual(x).to(dtype=dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_ATTR forward_manual [LazyVariableTracker()]
TRACE LOAD_FAST x [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE CALL 1 [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton)), TensorVariable()]
TRACE inlined call forward_manual from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:543 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        def forward_manual(self, x: Tensor, matmul_type: str="GEMM") -> Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE LOAD_GLOBAL forward_functional []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:545 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                x,
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:546 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.bias,
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR bias [NullVariable, LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_tensor_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_ATTR get_tensor_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_tensor_args at 0x70c98a9e9080>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_tensor_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_tensor_args(),
            ~~~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:524 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
        def get_tensor_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:525 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
            return [self.W_q, self.scales, self.zeros]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR W_q [UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_FAST self [LazyVariableTracker()]
TRACE LOAD_ATTR scales [LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['QKV_']._parameters['scales'] (80, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='QKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='scales'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_QKV_parameters_scales_ L['QKV_']._parameters['scales'] Parameter(FakeTensor(..., device='cuda:0', size=(80, 10240), dtype=torch.float16)) at debug_level 0 before=False
TRACE LOAD_FAST self [LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR zeros [LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['QKV_']._parameters['zeros'] (80, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='QKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='zeros'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_QKV_parameters_zeros_ L['QKV_']._parameters['zeros'] Parameter(FakeTensor(..., device='cuda:0', size=(80, 10240), dtype=torch.float16)) at debug_level 0 before=False
TRACE BUILD_LIST 3 [LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [ListVariable(length=3)]
DONE INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_meta_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3)]
TRACE LOAD_ATTR get_meta_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_meta_args at 0x70c98a9e9120>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_meta_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_meta_args(),
            ~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:527 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
        def get_meta_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE LOAD_GLOBAL int []
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR scaled_activations [NullVariable, LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:529 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_nbits,
TRACE LOAD_FAST self [ConstantVariable(int: 0)]
TRACE LOAD_ATTR W_nbits [ConstantVariable(int: 0), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:530 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.group_size,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker()]
TRACE LOAD_ATTR group_size [ConstantVariable(int: 0), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:531 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.unpack_mask,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR unpack_mask [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:532 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.elements_per_sample,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR elements_per_sample [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:533 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.input_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR input_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:534 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.output_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR output_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:535 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.acc_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR acc_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:536 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.meta_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR meta_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:537 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.channel_scale_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR channel_scale_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:538 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_group_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR W_group_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:539 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    int(self.data_contiguous),
TRACE LOAD_GLOBAL int [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int)]
TRACE LOAD_ATTR data_contiguous [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE BUILD_LIST 12 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [ListVariable(length=12)]
DONE INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:549 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
TRACE LOAD_GLOBAL GEMLITE_MATMUL_TYPES_MAPPING [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12)]
TRACE LOAD_FAST matmul_type [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker(), ConstantVariable(str: 'GEMM')]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        return forward_functional(
               ~~~~~~~~~~~~~~~~~~^
            x,
            ^^
            self.bias,
            ^^^^^^^^^^
            self.get_tensor_args(),
            ^^^^^^^^^^^^^^^^^^^^^^^
            self.get_meta_args(),
            ^^^^^^^^^^^^^^^^^^^^^
            GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:675 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        def __call__(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
            return self._opoverload(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR _opoverload [NullVariable, UserDefinedObjectVariable(CustomOpDef)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=5)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
wrap_to_fake L['QKV_'].W_q (640, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=AttrSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='QKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='W_q'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_QKV_W_q L['QKV_'].W_q FakeTensor(..., device='cuda:0', size=(640, 10240), dtype=torch.int32) at debug_level 0 before=False
TRACE FX call forward_functional_default from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        return self._opoverload(*args, **kwargs)
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_3 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE STORE_FAST out [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
            return out.view(S0,S1,-1)
TRACE LOAD_FAST out []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST S0 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST S1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: -1)]
TRACE FX call view_1 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
        return out.view(S0,S1,-1)
               ~~~~~~~~^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object fpx_matmul at 0x3063a810, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>
TRACE STORE_FAST qkv [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:919 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q, k, v = qkv.split(qkv_split_list, dim=-1)
TRACE LOAD_FAST qkv []
TRACE LOAD_ATTR split [TensorVariable()]
TRACE LOAD_FAST qkv_split_list [NullVariable, GetAttrVariable(TensorVariable(), split)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker()]
TRACE KW_NAMES ('dim',) [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE FX call split from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:919 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        q, k, v = qkv.split(qkv_split_list, dim=-1)
                  ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
TRACE UNPACK_SEQUENCE 3 [TupleVariable(length=3)]
TRACE STORE_FAST q [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST k [TensorVariable(), TensorVariable()]
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:922 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q.add_(Q_bias)
TRACE LOAD_FAST q []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST Q_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
wrap_to_fake L['Q_bias'] () StatefulSymbolicContext(dynamic_sizes=[], dynamic_strides=[], constraint_sizes=[], constraint_strides=[], specialize_on=[], view_base_context=None, tensor_source=LocalSource(local_name='Q_bias', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_Q_bias_ L['Q_bias'] FakeTensor(..., device='cuda:0', size=(), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call add_ from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:922 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        q.add_(Q_bias)
        ~~~~~~^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:923 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k.add_(K_bias)
TRACE LOAD_FAST k []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST K_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
TRACE FX call add__1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:923 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        k.add_(K_bias)
        ~~~~~~^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:924 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            v.add_(V_bias)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST V_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
TRACE FX call add__2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:924 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        v.add_(V_bias)
        ~~~~~~^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:927 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q = q.view(B, T, H, N)  # [B,T,H,N]
TRACE LOAD_FAST q []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:927 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        q = q.view(B, T, H, N)  # [B,T,H,N]
            ~~~~~~^^^^^^^^^^^^
TRACE STORE_FAST q [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:928 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            kv_dim_flat = k.shape[-1]     # kv_heads * N
TRACE LOAD_FAST k []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST -1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: -1)]
TRACE STORE_FAST kv_dim_flat [ConstantVariable(int: 1024)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:929 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            kv_heads = kv_dim_flat // N
TRACE LOAD_FAST kv_dim_flat []
TRACE LOAD_FAST N [ConstantVariable(int: 1024)]
TRACE BINARY_OP 2 [ConstantVariable(int: 1024), ConstantVariable(int: 128)]
TRACE STORE_FAST kv_heads [ConstantVariable(int: 8)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:930 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k = k.view(B, T, kv_heads, N) # [B,T,kv_h,N]
TRACE LOAD_FAST k []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_heads [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:930 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        k = k.view(B, T, kv_heads, N) # [B,T,kv_h,N]
            ~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:931 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            v = v.view(B, T, kv_heads, N)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_heads [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:931 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        v = v.view(B, T, kv_heads, N)
            ~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:934 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            if ln_r is not None:
TRACE LOAD_FAST ln_r []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 0 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
wrap_to_fake L['ln_r'] (128,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln_r', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln_r_ L['ln_r'] FakeTensor(..., device='cuda:0', size=(128,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE POP_JUMP_IF_TRUE 606 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:935 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
                q = T5RMSNorm(q, ln_r, rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln_r [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:935 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q = T5RMSNorm(q, ln_r, rmsnorm_epsilon)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST q [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:936 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
                k = T5RMSNorm(k, ln_k, rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln_k [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:936 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k = T5RMSNorm(k, ln_k, rmsnorm_epsilon)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln_k'] (128,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln_k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln_k_ L['ln_k'] FakeTensor(..., device='cuda:0', size=(128,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:940 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k_write = k.view(B, T, -1)
TRACE LOAD_FAST k []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: -1)]
TRACE FX call view_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:940 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        k_write = k.view(B, T, -1)
                  ~~~~~~^^^^^^^^^^
TRACE STORE_FAST k_write [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:941 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            v_write = v.view(B, T, -1)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: -1)]
TRACE FX call view_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:941 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        v_write = v.view(B, T, -1)
                  ~~~~~~^^^^^^^^^^
TRACE STORE_FAST v_write [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:944 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            new_lengths = starts + T
TRACE LOAD_FAST starts []
TRACE LOAD_FAST T [TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), ConstantVariable(int: 512)]
TRACE FX call add_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:944 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        new_lengths = starts + T
                      ~~~~~~~^~~
TRACE STORE_FAST new_lengths [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            excess_tokens = torch.clamp(new_lengths - Lmax, min=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR clamp [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST new_lengths [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST Lmax [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 10 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 8192)]
TRACE FX call sub from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        excess_tokens = torch.clamp(new_lengths - Lmax, min=0)
                                    ~~~~~~~~~~~~^~~~~~
TRACE LOAD_CONST 0 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE KW_NAMES ('min',) [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 0)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 0)]
TRACE FX call clamp from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        excess_tokens = torch.clamp(new_lengths - Lmax, min=0)
                        ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST excess_tokens [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:946 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            batches_to_evict = excess_tokens > 0
TRACE LOAD_FAST excess_tokens []
TRACE LOAD_CONST 0 [TensorVariable()]
TRACE COMPARE_OP > [TensorVariable(), ConstantVariable(int: 0)]
TRACE FX call gt from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:946 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        batches_to_evict = excess_tokens > 0
                           ^^^^^^^^^^^^^^^^^
TRACE STORE_FAST batches_to_evict [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            if bool(batches_to_evict.any()):
TRACE LOAD_GLOBAL bool []
TRACE LOAD_FAST batches_to_evict [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR any [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), any)]
TRACE FX call any_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        if bool(batches_to_evict.any()):
                ~~~~~~~~~~~~~~~~~~~~^^
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
Graph break in user code at /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949
Graph Break Reason: Failed to trace builtin operator
  Explanation: Dynamo does not know how to trace builtin operator `bool` with argument types ['Tensor'] (has_kwargs False)
  Hint: Avoid calling builtin `bool` with argument types ['Tensor']. Consider using an equivalent alternative function/method to `bool`.
  Hint: If you are attempting to call a logging function (e.g. `print`), you can try adding it to `torch._dynamo.config.reorderable_logging_functions`.
  Hint: Please report an issue to PyTorch.

  Developer debug context: builtin bool [<class 'torch._dynamo.variables.tensor.TensorVariable'>] False

 For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0059.html
User code traceback:
  File "/home/client/Projects/RWKV-Infer/rwkv_server_fla_fastapi.py", line 1182, in <module>
    asyncio.run(main())
  File "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
  File "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/asyncio/base_events.py", line 678, in run_until_complete
    self.run_forever()
  File "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/asyncio/base_events.py", line 645, in run_forever
    self._run_once()
  File "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/asyncio/base_events.py", line 1999, in _run_once
    handle._run()
  File "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/home/client/Projects/RWKV-Infer/rwkvengine/rwkvinfer_fla.py", line 703, in RunLLM
    x, _, wkv_states, kv_caches,pos_caches = self.model.forward(idx, shift_states, wkv_states,kv_caches,pos_caches)
  File "/home/client/Projects/RWKV-Infer/rwkvengine/rwkvcore.py", line 1009, in forward
    return HRWKV_7.hxa079r_forward_offload(self,idx,last_wkv_states,kv_cache,pos_cache,full_output)
  File "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 1690, in hxa079r_forward_offload
    xx, x, kv_cache = HRWKV_7.GQA_Attention_Flash_(
  File "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 949, in GQA_Attention_Flash_
    if bool(batches_to_evict.any()):

Step 1: torchdynamo start tracing GQA_Attention_Flash_ /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:875
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:875 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7)
        @torch.compile(mode="max-autotune-no-cudagraphs")
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:904 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            B, T, C = x_in.shape
TRACE LOAD_FAST x_in []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
wrap_to_fake L['x_in'] (1, 512, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='x_in', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_x_in_ L['x_in'] FakeTensor(..., device='cuda:0', size=(1, 512, 5120), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE UNPACK_SEQUENCE 3 [SizeVariable(length=3)]
TRACE STORE_FAST B [ConstantVariable(int: 5120), ConstantVariable(int: 512), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 5120), ConstantVariable(int: 512)]
TRACE STORE_FAST C [ConstantVariable(int: 5120)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:905 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            device = x_in.device
TRACE LOAD_FAST x_in []
TRACE LOAD_ATTR device [TensorVariable()]
TRACE STORE_FAST device [ConstantVariable(device: device(type='cuda', index=0))]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:906 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            Lmax = past_key_value.shape[3]
TRACE LOAD_FAST past_key_value []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
wrap_to_fake L['past_key_value'] (8, 1, 2, 8192, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='past_key_value', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}), tensor_source=LocalSource(local_name='past_key_value', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_past_key_value_ L['past_key_value'] FakeTensor(..., device='cuda:0', size=(8, 1, 2, 8192, 1024),
           dtype=torch.bfloat16) at debug_level 0 before=False
wrap_to_fake L['past_key_value']._base (8, 1, 2, 8192, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='past_key_value', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
TRACE LOAD_CONST 3 [SizeVariable(length=5)]
TRACE BINARY_SUBSCR None [SizeVariable(length=5), ConstantVariable(int: 3)]
TRACE STORE_FAST Lmax [ConstantVariable(int: 8192)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            starts = cache_position[:, 0].clone()
TRACE LOAD_FAST cache_position []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE LOAD_CONST None [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [LazyVariableTracker(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST 0 [LazyVariableTracker(), SliceVariable()]
TRACE BUILD_TUPLE 2 [LazyVariableTracker(), SliceVariable(), ConstantVariable(int: 0)]
TRACE BINARY_SUBSCR None [LazyVariableTracker(), TupleVariable(length=2)]
wrap_to_fake L['cache_position'] (1, 1) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='cache_position', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_cache_position_ L['cache_position'] FakeTensor(..., device='cuda:0', size=(1, 1), dtype=torch.int64) at debug_level 0 before=False
TRACE FX call getitem from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        starts = cache_position[:, 0].clone()
                 ~~~~~~~~~~~~~~^^^^^^
TRACE LOAD_ATTR clone [TensorVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), clone)]
TRACE FX call clone from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        starts = cache_position[:, 0].clone()
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST starts [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:910 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            starts.clamp_(min=0, max=Lmax)
TRACE LOAD_FAST starts []
TRACE LOAD_ATTR clamp_ [TensorVariable()]
TRACE LOAD_CONST 0 [NullVariable, GetAttrVariable(TensorVariable(), clamp_)]
TRACE LOAD_FAST Lmax [NullVariable, GetAttrVariable(TensorVariable(), clamp_), ConstantVariable(int: 0)]
TRACE KW_NAMES ('min', 'max') [NullVariable, GetAttrVariable(TensorVariable(), clamp_), ConstantVariable(int: 0), ConstantVariable(int: 8192)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), clamp_), ConstantVariable(int: 0), ConstantVariable(int: 8192)]
TRACE FX call clamp_ from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:910 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        starts.clamp_(min=0, max=Lmax)
        ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:913 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            x = T5RMSNorm(x_in, ln1, rmsnorm_epsilon)  # 実装は外部
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST x_in [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:913 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        x = T5RMSNorm(x_in, ln1, rmsnorm_epsilon)  # 実装は外部
            ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE FX call add from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln1'] (5120,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln1', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln1_ L['ln1'] FakeTensor(..., device='cuda:0', size=(5120,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:915 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            HN = H * N
TRACE LOAD_FAST H []
TRACE LOAD_FAST N [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), LazyVariableTracker()]
TRACE STORE_FAST HN [ConstantVariable(int: 8192)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:918 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            qkv = fpx_matmul(x, QKV_, QKV_state, ebits, mbits)  # [B,T, QHN + KVd + KVd]
TRACE LOAD_GLOBAL fpx_matmul []
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST QKV_ [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST QKV_state [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_FAST ebits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST mbits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call fpx_matmul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:918 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        qkv = fpx_matmul(x, QKV_, QKV_state, ebits, mbits)  # [B,T, QHN + KVd + KVd]
              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object fpx_matmul at 0x3063a810, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:420 in fpx_matmul (fpx_matmul) (inline depth: 1)
    def fpx_matmul(x,weight,weight_state,ebits:int=3,mbits:int=2):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:421 in fpx_matmul (fpx_matmul) (inline depth: 1)
        if ebits == -44: #hqq
TRACE LOAD_FAST ebits []
TRACE LOAD_CONST -44 [LazyVariableTracker()]
TRACE COMPARE_OP == [LazyVariableTracker(), ConstantVariable(int: -44)]
TRACE POP_JUMP_IF_FALSE 322 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S0=x.shape[0]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 0 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 0)]
TRACE STORE_FAST S0 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S1=x.shape[1]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 1)]
TRACE STORE_FAST S1 [ConstantVariable(int: 512)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:424 in fpx_matmul (fpx_matmul) (inline depth: 1)
            dtype = x.dtype
TRACE LOAD_FAST x []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
            x = x.to(dtype=torch.float16).view(-1,x.shape[2])
TRACE LOAD_FAST x []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float16 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_2 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST x [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1)]
TRACE LOAD_ATTR shape [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3), ConstantVariable(int: 2)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), ConstantVariable(int: 5120)]
TRACE FX call view from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
            out = weight.forward_manual(x).to(dtype=dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_ATTR forward_manual [LazyVariableTracker()]
TRACE LOAD_FAST x [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE CALL 1 [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton)), TensorVariable()]
TRACE inlined call forward_manual from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:543 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        def forward_manual(self, x: Tensor, matmul_type: str="GEMM") -> Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE LOAD_GLOBAL forward_functional []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:545 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                x,
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:546 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.bias,
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR bias [NullVariable, LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_tensor_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_ATTR get_tensor_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_tensor_args at 0x70c98a9e9080>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_tensor_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_tensor_args(),
            ~~~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:524 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
        def get_tensor_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:525 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
            return [self.W_q, self.scales, self.zeros]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR W_q [UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_FAST self [LazyVariableTracker()]
TRACE LOAD_ATTR scales [LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['QKV_']._parameters['scales'] (80, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='QKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='scales'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_QKV_parameters_scales_ L['QKV_']._parameters['scales'] Parameter(FakeTensor(..., device='cuda:0', size=(80, 10240), dtype=torch.float16)) at debug_level 0 before=False
TRACE LOAD_FAST self [LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR zeros [LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['QKV_']._parameters['zeros'] (80, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='QKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='zeros'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_QKV_parameters_zeros_ L['QKV_']._parameters['zeros'] Parameter(FakeTensor(..., device='cuda:0', size=(80, 10240), dtype=torch.float16)) at debug_level 0 before=False
TRACE BUILD_LIST 3 [LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [ListVariable(length=3)]
DONE INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_meta_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3)]
TRACE LOAD_ATTR get_meta_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_meta_args at 0x70c98a9e9120>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_meta_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_meta_args(),
            ~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:527 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
        def get_meta_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE LOAD_GLOBAL int []
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR scaled_activations [NullVariable, LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:529 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_nbits,
TRACE LOAD_FAST self [ConstantVariable(int: 0)]
TRACE LOAD_ATTR W_nbits [ConstantVariable(int: 0), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:530 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.group_size,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker()]
TRACE LOAD_ATTR group_size [ConstantVariable(int: 0), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:531 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.unpack_mask,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR unpack_mask [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:532 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.elements_per_sample,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR elements_per_sample [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:533 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.input_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR input_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:534 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.output_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR output_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:535 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.acc_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR acc_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:536 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.meta_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR meta_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:537 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.channel_scale_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR channel_scale_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:538 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_group_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR W_group_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:539 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    int(self.data_contiguous),
TRACE LOAD_GLOBAL int [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int)]
TRACE LOAD_ATTR data_contiguous [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE BUILD_LIST 12 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [ListVariable(length=12)]
DONE INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:549 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
TRACE LOAD_GLOBAL GEMLITE_MATMUL_TYPES_MAPPING [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12)]
TRACE LOAD_FAST matmul_type [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker(), ConstantVariable(str: 'GEMM')]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        return forward_functional(
               ~~~~~~~~~~~~~~~~~~^
            x,
            ^^
            self.bias,
            ^^^^^^^^^^
            self.get_tensor_args(),
            ^^^^^^^^^^^^^^^^^^^^^^^
            self.get_meta_args(),
            ^^^^^^^^^^^^^^^^^^^^^
            GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:675 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        def __call__(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
            return self._opoverload(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR _opoverload [NullVariable, UserDefinedObjectVariable(CustomOpDef)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=5)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
wrap_to_fake L['QKV_'].W_q (640, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=AttrSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='QKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='W_q'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_QKV_W_q L['QKV_'].W_q FakeTensor(..., device='cuda:0', size=(640, 10240), dtype=torch.int32) at debug_level 0 before=False
TRACE FX call forward_functional_default from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        return self._opoverload(*args, **kwargs)
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_3 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE STORE_FAST out [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
            return out.view(S0,S1,-1)
TRACE LOAD_FAST out []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST S0 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST S1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: -1)]
TRACE FX call view_1 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
        return out.view(S0,S1,-1)
               ~~~~~~~~^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object fpx_matmul at 0x3063a810, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>
TRACE STORE_FAST qkv [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:919 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q, k, v = qkv.split(qkv_split_list, dim=-1)
TRACE LOAD_FAST qkv []
TRACE LOAD_ATTR split [TensorVariable()]
TRACE LOAD_FAST qkv_split_list [NullVariable, GetAttrVariable(TensorVariable(), split)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker()]
TRACE KW_NAMES ('dim',) [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE FX call split from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:919 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        q, k, v = qkv.split(qkv_split_list, dim=-1)
                  ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
TRACE UNPACK_SEQUENCE 3 [TupleVariable(length=3)]
TRACE STORE_FAST q [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST k [TensorVariable(), TensorVariable()]
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:922 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q.add_(Q_bias)
TRACE LOAD_FAST q []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST Q_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
wrap_to_fake L['Q_bias'] () StatefulSymbolicContext(dynamic_sizes=[], dynamic_strides=[], constraint_sizes=[], constraint_strides=[], specialize_on=[], view_base_context=None, tensor_source=LocalSource(local_name='Q_bias', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_Q_bias_ L['Q_bias'] FakeTensor(..., device='cuda:0', size=(), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call add_ from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:922 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        q.add_(Q_bias)
        ~~~~~~^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:923 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k.add_(K_bias)
TRACE LOAD_FAST k []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST K_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
TRACE FX call add__1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:923 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        k.add_(K_bias)
        ~~~~~~^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:924 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            v.add_(V_bias)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST V_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
TRACE FX call add__2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:924 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        v.add_(V_bias)
        ~~~~~~^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:927 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q = q.view(B, T, H, N)  # [B,T,H,N]
TRACE LOAD_FAST q []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:927 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        q = q.view(B, T, H, N)  # [B,T,H,N]
            ~~~~~~^^^^^^^^^^^^
TRACE STORE_FAST q [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:928 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            kv_dim_flat = k.shape[-1]     # kv_heads * N
TRACE LOAD_FAST k []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST -1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: -1)]
TRACE STORE_FAST kv_dim_flat [ConstantVariable(int: 1024)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:929 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            kv_heads = kv_dim_flat // N
TRACE LOAD_FAST kv_dim_flat []
TRACE LOAD_FAST N [ConstantVariable(int: 1024)]
TRACE BINARY_OP 2 [ConstantVariable(int: 1024), ConstantVariable(int: 128)]
TRACE STORE_FAST kv_heads [ConstantVariable(int: 8)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:930 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k = k.view(B, T, kv_heads, N) # [B,T,kv_h,N]
TRACE LOAD_FAST k []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_heads [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:930 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        k = k.view(B, T, kv_heads, N) # [B,T,kv_h,N]
            ~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:931 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            v = v.view(B, T, kv_heads, N)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_heads [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:931 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        v = v.view(B, T, kv_heads, N)
            ~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:934 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            if ln_r is not None:
TRACE LOAD_FAST ln_r []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 0 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
wrap_to_fake L['ln_r'] (128,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln_r', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln_r_ L['ln_r'] FakeTensor(..., device='cuda:0', size=(128,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE POP_JUMP_IF_TRUE 606 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:935 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
                q = T5RMSNorm(q, ln_r, rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln_r [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:935 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q = T5RMSNorm(q, ln_r, rmsnorm_epsilon)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST q [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:936 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
                k = T5RMSNorm(k, ln_k, rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln_k [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:936 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k = T5RMSNorm(k, ln_k, rmsnorm_epsilon)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln_k'] (128,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln_k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln_k_ L['ln_k'] FakeTensor(..., device='cuda:0', size=(128,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:940 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k_write = k.view(B, T, -1)
TRACE LOAD_FAST k []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: -1)]
TRACE FX call view_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:940 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        k_write = k.view(B, T, -1)
                  ~~~~~~^^^^^^^^^^
TRACE STORE_FAST k_write [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:941 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            v_write = v.view(B, T, -1)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: -1)]
TRACE FX call view_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:941 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        v_write = v.view(B, T, -1)
                  ~~~~~~^^^^^^^^^^
TRACE STORE_FAST v_write [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:944 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            new_lengths = starts + T
TRACE LOAD_FAST starts []
TRACE LOAD_FAST T [TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), ConstantVariable(int: 512)]
TRACE FX call add_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:944 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        new_lengths = starts + T
                      ~~~~~~~^~~
TRACE STORE_FAST new_lengths [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            excess_tokens = torch.clamp(new_lengths - Lmax, min=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR clamp [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST new_lengths [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST Lmax [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 10 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 8192)]
TRACE FX call sub from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        excess_tokens = torch.clamp(new_lengths - Lmax, min=0)
                                    ~~~~~~~~~~~~^~~~~~
TRACE LOAD_CONST 0 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE KW_NAMES ('min',) [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 0)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 0)]
TRACE FX call clamp from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        excess_tokens = torch.clamp(new_lengths - Lmax, min=0)
                        ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST excess_tokens [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:946 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            batches_to_evict = excess_tokens > 0
TRACE LOAD_FAST excess_tokens []
TRACE LOAD_CONST 0 [TensorVariable()]
TRACE COMPARE_OP > [TensorVariable(), ConstantVariable(int: 0)]
TRACE FX call gt from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:946 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        batches_to_evict = excess_tokens > 0
                           ^^^^^^^^^^^^^^^^^
TRACE STORE_FAST batches_to_evict [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            if bool(batches_to_evict.any()):
TRACE LOAD_GLOBAL bool []
TRACE LOAD_FAST batches_to_evict [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR any [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), any)]
TRACE FX call any_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        if bool(batches_to_evict.any()):
                ~~~~~~~~~~~~~~~~~~~~^^
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
COMPILING GRAPH due to GraphCompileReason(reason="Failed to trace builtin operator\n  Explanation: Dynamo does not know how to trace builtin operator `bool` with argument types ['Tensor'] (has_kwargs False)\n  Hint: Avoid calling builtin `bool` with argument types ['Tensor']. Consider using an equivalent alternative function/method to `bool`.\n  Hint: If you are attempting to call a logging function (e.g. `print`), you can try adding it to `torch._dynamo.config.reorderable_logging_functions`.\n  Hint: Please report an issue to PyTorch.\n\n  Developer debug context: builtin bool [<class 'torch._dynamo.variables.tensor.TensorVariable'>] False\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0059.html", user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py, line 949 in GQA_Attention_Flash_>], graph_break=True)
REMOVE UNUSED GRAPHARG L['past_key_value']
TRACED GRAPH
 ===== __compiled_fn_7_d46659bd_aa1c_495e_aeb0_c870a61ff7c2 =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, L_x_in_: "[31mbf16[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m", L_cache_position_: "[31mi64[0m[34m[1, 1][0m[2m[34m[1, 1][0m[2m[32mcuda:0[0m", L_ln1_: "[31mbf16[0m[34m[5120][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_QKV_parameters_scales_: "[31mf16[0m[34m[80, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m", L_QKV_parameters_zeros_: "[31mf16[0m[34m[80, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m", L_QKV_W_q: "[31mi32[0m[34m[640, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m", L_Q_bias_: "[31mbf16[0m[34m[][0m[2m[34m[][0m[2m[32mcuda:0[0m", L_ln_r_: "[31mbf16[0m[34m[128][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_ln_k_: "[31mbf16[0m[34m[128][0m[2m[34m[1][0m[2m[32mcuda:0[0m"):
        l_x_in_ = L_x_in_
        l_cache_position_ = L_cache_position_
        l_ln1_ = L_ln1_
        l_qkv_parameters_scales_ = L_QKV_parameters_scales_
        l_qkv_parameters_zeros_ = L_QKV_parameters_zeros_
        l_qkv_w_q = L_QKV_W_q
        l_q_bias_ = L_Q_bias_
        l_ln_r_ = L_ln_r_
        l_ln_k_ = L_ln_k_
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_, code: starts = cache_position[:, 0].clone()[0m
        getitem: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = l_cache_position_[(slice([34mNone[0m, [34mNone[0m, [34mNone[0m), [34m0[0m)];  [2ml_cache_position_ = None[0m
        starts: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = getitem.clone();  [2mgetitem = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:910 in GQA_Attention_Flash_, code: starts.clamp_(min=0, max=Lmax)[0m
        clamp_: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = starts.clamp_(min = [34m0[0m, max = [34m8192[0m);  [2mclamp_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states: "[31mf32[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = l_x_in_.to([34mtorch.float32[0m);  [2ml_x_in_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_1: "[31mf32[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states.pow([34m2[0m)
        variance: "[31mf32[0m[34m[1, 512, 1][0m[2m[34m[512, 1, 1][0m[2m[32mcuda:0[0m" = pow_1.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add: "[31mf32[0m[34m[1, 512, 1][0m[2m[34m[512, 1, 1][0m[2m[32mcuda:0[0m" = variance + [34m1e-06[0m;  [2mvariance = None[0m
        rsqrt: "[31mf32[0m[34m[1, 512, 1][0m[2m[34m[512, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add);  [2madd = None[0m
        hidden_states_1: "[31mf32[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states * rsqrt;  [2mhidden_states = rsqrt = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_1: "[31mf32[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = l_ln1_ * hidden_states_1;  [2ml_ln1_ = hidden_states_1 = None[0m
        x: "[31mbf16[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = mul_1.to([34mtorch.bfloat16[0m);  [2mmul_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul, code: x = x.to(dtype=torch.float16).view(-1,x.shape[2])[0m
        to_2: "[31mf16[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = x.to(dtype = [34mtorch.float16[0m);  [2mx = None[0m
        x_1: "[31mf16[0m[34m[512, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m" = to_2.view([34m-1[0m, [34m5120[0m);  [2mto_2 = None[0m
        
         [2m# File: /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__, code: return self._opoverload(*args, **kwargs)[0m
        forward_functional_default: "[31mf16[0m[34m[512, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m" = torch.ops.gemlite.forward_functional.default(x_1, [34mNone[0m, [l_qkv_w_q, l_qkv_parameters_scales_, l_qkv_parameters_zeros_], [[34m0[0m, [34m4[0m, [34m64[0m, [34m15[0m, [34m8[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m0[0m, [34m4[0m, [34m1[0m], [34m4[0m);  [2mx_1 = l_qkv_w_q = l_qkv_parameters_scales_ = l_qkv_parameters_zeros_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul, code: out = weight.forward_manual(x).to(dtype=dtype)[0m
        out: "[31mbf16[0m[34m[512, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m" = forward_functional_default.to(dtype = [34mtorch.bfloat16[0m);  [2mforward_functional_default = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul, code: return out.view(S0,S1,-1)[0m
        qkv: "[31mbf16[0m[34m[1, 512, 10240][0m[2m[34m[5242880, 10240, 1][0m[2m[32mcuda:0[0m" = out.view([34m1[0m, [34m512[0m, [34m-1[0m);  [2mout = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:919 in GQA_Attention_Flash_, code: q, k, v = qkv.split(qkv_split_list, dim=-1)[0m
        split = qkv.split([[34m8192[0m, [34m1024[0m, [34m1024[0m], dim = [34m-1[0m);  [2mqkv = None[0m
        q: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[5242880, 10240, 1][0m[2m[32mcuda:0[0m" = split[[34m0[0m]
        k: "[31mbf16[0m[34m[1, 512, 1024][0m[2m[34m[5242880, 10240, 1][0m[2m[32mcuda:0[0m" = split[[34m1[0m]
        v: "[31mbf16[0m[34m[1, 512, 1024][0m[2m[34m[5242880, 10240, 1][0m[2m[32mcuda:0[0m" = split[[34m2[0m];  [2msplit = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:922 in GQA_Attention_Flash_, code: q.add_(Q_bias)[0m
        add_: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[5242880, 10240, 1][0m[2m[32mcuda:0[0m" = q.add_(l_q_bias_);  [2madd_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:923 in GQA_Attention_Flash_, code: k.add_(K_bias)[0m
        add__1: "[31mbf16[0m[34m[1, 512, 1024][0m[2m[34m[5242880, 10240, 1][0m[2m[32mcuda:0[0m" = k.add_(l_q_bias_);  [2madd__1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:924 in GQA_Attention_Flash_, code: v.add_(V_bias)[0m
        add__2: "[31mbf16[0m[34m[1, 512, 1024][0m[2m[34m[5242880, 10240, 1][0m[2m[32mcuda:0[0m" = v.add_(l_q_bias_);  [2ml_q_bias_ = add__2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:927 in GQA_Attention_Flash_, code: q = q.view(B, T, H, N)  # [B,T,H,N][0m
        q_1: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[5242880, 10240, 128, 1][0m[2m[32mcuda:0[0m" = q.view([34m1[0m, [34m512[0m, [34m64[0m, [34m128[0m);  [2mq = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:930 in GQA_Attention_Flash_, code: k = k.view(B, T, kv_heads, N) # [B,T,kv_h,N][0m
        k_1: "[31mbf16[0m[34m[1, 512, 8, 128][0m[2m[34m[5242880, 10240, 128, 1][0m[2m[32mcuda:0[0m" = k.view([34m1[0m, [34m512[0m, [34m8[0m, [34m128[0m);  [2mk = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:931 in GQA_Attention_Flash_, code: v = v.view(B, T, kv_heads, N)[0m
        v_1: "[31mbf16[0m[34m[1, 512, 8, 128][0m[2m[34m[5242880, 10240, 128, 1][0m[2m[32mcuda:0[0m" = v.view([34m1[0m, [34m512[0m, [34m8[0m, [34m128[0m);  [2mv = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states_2: "[31mf32[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = q_1.to([34mtorch.float32[0m);  [2mq_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_2: "[31mf32[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_2.pow([34m2[0m)
        variance_1: "[31mf32[0m[34m[1, 512, 64, 1][0m[2m[34m[32768, 64, 1, 1][0m[2m[32mcuda:0[0m" = pow_2.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add_1: "[31mf32[0m[34m[1, 512, 64, 1][0m[2m[34m[32768, 64, 1, 1][0m[2m[32mcuda:0[0m" = variance_1 + [34m1e-06[0m;  [2mvariance_1 = None[0m
        rsqrt_1: "[31mf32[0m[34m[1, 512, 64, 1][0m[2m[34m[32768, 64, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add_1);  [2madd_1 = None[0m
        hidden_states_3: "[31mf32[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_2 * rsqrt_1;  [2mhidden_states_2 = rsqrt_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_3: "[31mf32[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = l_ln_r_ * hidden_states_3;  [2ml_ln_r_ = hidden_states_3 = None[0m
        q_2: "[31mbf16[0m[34m[1, 512, 64, 128][0m[2m[34m[4194304, 8192, 128, 1][0m[2m[32mcuda:0[0m" = mul_3.to([34mtorch.bfloat16[0m);  [2mmul_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states_4: "[31mf32[0m[34m[1, 512, 8, 128][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = k_1.to([34mtorch.float32[0m);  [2mk_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_3: "[31mf32[0m[34m[1, 512, 8, 128][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_4.pow([34m2[0m)
        variance_2: "[31mf32[0m[34m[1, 512, 8, 1][0m[2m[34m[4096, 8, 1, 1][0m[2m[32mcuda:0[0m" = pow_3.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add_2: "[31mf32[0m[34m[1, 512, 8, 1][0m[2m[34m[4096, 8, 1, 1][0m[2m[32mcuda:0[0m" = variance_2 + [34m1e-06[0m;  [2mvariance_2 = None[0m
        rsqrt_2: "[31mf32[0m[34m[1, 512, 8, 1][0m[2m[34m[4096, 8, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add_2);  [2madd_2 = None[0m
        hidden_states_5: "[31mf32[0m[34m[1, 512, 8, 128][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_4 * rsqrt_2;  [2mhidden_states_4 = rsqrt_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_5: "[31mf32[0m[34m[1, 512, 8, 128][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = l_ln_k_ * hidden_states_5;  [2ml_ln_k_ = hidden_states_5 = None[0m
        k_2: "[31mbf16[0m[34m[1, 512, 8, 128][0m[2m[34m[524288, 1024, 128, 1][0m[2m[32mcuda:0[0m" = mul_5.to([34mtorch.bfloat16[0m);  [2mmul_5 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:940 in GQA_Attention_Flash_, code: k_write = k.view(B, T, -1)[0m
        k_write: "[31mbf16[0m[34m[1, 512, 1024][0m[2m[34m[524288, 1024, 1][0m[2m[32mcuda:0[0m" = k_2.view([34m1[0m, [34m512[0m, [34m-1[0m)
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:941 in GQA_Attention_Flash_, code: v_write = v.view(B, T, -1)[0m
        v_write: "[31mbf16[0m[34m[1, 512, 1024][0m[2m[34m[5242880, 10240, 1][0m[2m[32mcuda:0[0m" = v_1.view([34m1[0m, [34m512[0m, [34m-1[0m)
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:944 in GQA_Attention_Flash_, code: new_lengths = starts + T[0m
        new_lengths: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = starts + [34m512[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_, code: excess_tokens = torch.clamp(new_lengths - Lmax, min=0)[0m
        sub: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = new_lengths - [34m8192[0m;  [2mnew_lengths = None[0m
        excess_tokens: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = torch.clamp(sub, min = [34m0[0m);  [2msub = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:946 in GQA_Attention_Flash_, code: batches_to_evict = excess_tokens > 0[0m
        batches_to_evict: "[31mb8[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = excess_tokens > [34m0[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949 in GQA_Attention_Flash_, code: if bool(batches_to_evict.any()):[0m
        any_1: "[31mb8[0m[34m[][0m[2m[34m[][0m[2m[32mcuda:0[0m" = batches_to_evict.any()
        return (any_1, starts, q_2, k_2, v_1, k_write, v_write, excess_tokens, batches_to_evict)
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing torch_dynamo_resume_in_GQA_Attention_Flash__at_949 /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949 in torch_dynamo_resume_in_GQA_Attention_Flash__at_949 (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            if bool(batches_to_evict.any()):
TRACE RESUME 0 []
TRACE LOAD_CONST True []
TRACE STORE_FAST __is_tracing_resume_prologue [ConstantVariable(bool: True)]
TRACE LOAD_FAST ___stack0 []
TRACE LOAD_CONST False [LazyVariableTracker()]
TRACE STORE_FAST __is_tracing_resume_prologue [LazyVariableTracker(), ConstantVariable(bool: False)]
TRACE JUMP_FORWARD 816 [LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 876 [LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:955 in torch_dynamo_resume_in_GQA_Attention_Flash__at_949 (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            for b in range(B):
TRACE LOAD_GLOBAL range []
TRACE LOAD_FAST B [NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 1192 [RangeIteratorVariable()]
TRACE STORE_FAST b [RangeIteratorVariable(), ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:956 in torch_dynamo_resume_in_GQA_Attention_Flash__at_949 (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
                s = int(starts[b].item())
TRACE LOAD_GLOBAL int [RangeIteratorVariable()]
TRACE LOAD_FAST starts [RangeIteratorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST b [RangeIteratorVariable(), NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [RangeIteratorVariable(), NullVariable, LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: 0)]
wrap_to_fake L['starts'] (1,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='starts', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_starts_ L['starts'] FakeTensor(..., device='cuda:0', size=(1,), dtype=torch.int64) at debug_level 0 before=False
TRACE FX call getitem from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:956 in torch_dynamo_resume_in_GQA_Attention_Flash__at_949 (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            s = int(starts[b].item())
                    ~~~~~~^^^
TRACE LOAD_ATTR item [RangeIteratorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE CALL 0 [RangeIteratorVariable(), NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), item)]
TRACE FX call item from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:956 in torch_dynamo_resume_in_GQA_Attention_Flash__at_949 (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            s = int(starts[b].item())
                    ~~~~~~~~~~~~~~^^
TRACE CALL 1 [RangeIteratorVariable(), NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE FX call sym_int from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:956 in torch_dynamo_resume_in_GQA_Attention_Flash__at_949 (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            s = int(starts[b].item())
                ~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST s [RangeIteratorVariable(), SymNodeVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:957 in torch_dynamo_resume_in_GQA_Attention_Flash__at_949 (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
                write_T = min(T, Lmax - s)
TRACE LOAD_GLOBAL min [RangeIteratorVariable()]
TRACE LOAD_FAST T [RangeIteratorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST Lmax [RangeIteratorVariable(), NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST s [RangeIteratorVariable(), NullVariable, LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE BINARY_OP 10 [RangeIteratorVariable(), NullVariable, LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), SymNodeVariable()]
TRACE FX call sub from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:957 in torch_dynamo_resume_in_GQA_Attention_Flash__at_949 (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            write_T = min(T, Lmax - s)
                             ~~~~~^~~
TRACE CALL 2 [RangeIteratorVariable(), NullVariable, LazyVariableTracker(), LazyVariableTracker(), SymNodeVariable()]
TRACE FX call sym_min from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:957 in torch_dynamo_resume_in_GQA_Attention_Flash__at_949 (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            write_T = min(T, Lmax - s)
                      ~~~^^^^^^^^^^^^^
TRACE STORE_FAST write_T [RangeIteratorVariable(), SymNodeVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:958 in torch_dynamo_resume_in_GQA_Attention_Flash__at_949 (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
                if write_T > 0:
TRACE LOAD_FAST write_T [RangeIteratorVariable()]
TRACE LOAD_CONST 0 [RangeIteratorVariable(), SymNodeVariable()]
TRACE COMPARE_OP > [RangeIteratorVariable(), SymNodeVariable(), ConstantVariable(int: 0)]
TRACE FX call gt from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:958 in torch_dynamo_resume_in_GQA_Attention_Flash__at_949 (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            if write_T > 0:
               ^^^^^^^^^^^
TRACE POP_JUMP_IF_TRUE 1002 [RangeIteratorVariable(), SymNodeVariable()]
Graph break in user code at /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:958
Graph Break Reason: Data-dependent branching
  Explanation: Detected data-dependent branching (e.g. `if my_tensor.sum() > 0:`). Dynamo does not support tracing dynamic control flow.
  Hint: This graph break is fundamental - it is unlikely that Dynamo will ever be able to trace through your code. Consider finding a workaround.
  Hint: Use `torch.cond` to express dynamic control flow.

  Developer debug context: attempted to jump with SymNodeVariable()

User code traceback:
  File "/home/client/Projects/RWKV-Infer/rwkv_server_fla_fastapi.py", line 1182, in <module>
    asyncio.run(main())
  File "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
  File "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/asyncio/base_events.py", line 678, in run_until_complete
    self.run_forever()
  File "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/asyncio/base_events.py", line 645, in run_forever
    self._run_once()
  File "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/asyncio/base_events.py", line 1999, in _run_once
    handle._run()
  File "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/home/client/Projects/RWKV-Infer/rwkvengine/rwkvinfer_fla.py", line 703, in RunLLM
    x, _, wkv_states, kv_caches,pos_caches = self.model.forward(idx, shift_states, wkv_states,kv_caches,pos_caches)
  File "/home/client/Projects/RWKV-Infer/rwkvengine/rwkvcore.py", line 1009, in forward
    return HRWKV_7.hxa079r_forward_offload(self,idx,last_wkv_states,kv_cache,pos_cache,full_output)
  File "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 1690, in hxa079r_forward_offload
    xx, x, kv_cache = HRWKV_7.GQA_Attention_Flash_(
  File "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 958, in GQA_Attention_Flash_
    if write_T > 0:

Skipping frame because there is a graph break in a for/while loop
<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py, line 958 in torch_dynamo_resume_in_GQA_Attention_Flash__at_949>
Step 1: torchdynamo start tracing forward /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:831
TRACE MAKE_CELL max_seqlens_q []
TRACE MAKE_CELL batch []
TRACE MAKE_CELL nheads_q []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:831 in forward (_attention)
        @staticmethod
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:848 in forward (_attention.forward)
            use_fp8 = False
TRACE LOAD_CONST False []
TRACE STORE_FAST use_fp8 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:849 in forward (_attention.forward)
            fp8_out_scale=None
TRACE LOAD_CONST None []
TRACE STORE_FAST fp8_out_scale [ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:850 in forward (_attention.forward)
            fp8_scales=None
TRACE LOAD_CONST None []
TRACE STORE_FAST fp8_scales [ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:851 in forward (_attention.forward)
            q_scale = k_scale = v_scale = p_scale = 1.0
TRACE LOAD_CONST 1.0 []
TRACE COPY 1 [ConstantVariable(float: 1.0)]
TRACE STORE_FAST q_scale [ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE COPY 1 [ConstantVariable(float: 1.0)]
TRACE STORE_FAST k_scale [ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE COPY 1 [ConstantVariable(float: 1.0)]
TRACE STORE_FAST v_scale [ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE STORE_FAST p_scale [ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:853 in forward (_attention.forward)
            if o is None:
TRACE LOAD_FAST o []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
wrap_to_fake L['o'] (512, 64, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='o', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_o_ L['o'] FakeTensor(..., device='cuda:0', size=(512, 64, 128), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE POP_JUMP_IF_TRUE 110 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:865 in forward (_attention.forward)
            if True:  # varlen
TRACE NOP None []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:866 in forward (_attention.forward)
                total_q, nheads_q, head_size = q.shape
TRACE LOAD_FAST q []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
wrap_to_fake L['q'] (512, 64, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None], constraint_strides=[None, None, None, None], specialize_on=[[], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='q', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}), tensor_source=LocalSource(local_name='q', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_q_ L['q'] FakeTensor(..., device='cuda:0', size=(512, 64, 128), dtype=torch.bfloat16) at debug_level 0 before=False
wrap_to_fake L['q']._base (1, 512, 64, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None], constraint_strides=[None, None, None, None], specialize_on=[[], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='q', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
TRACE UNPACK_SEQUENCE 3 [SizeVariable(length=3)]
TRACE STORE_FAST total_q [ConstantVariable(int: 128), ConstantVariable(int: 64), ConstantVariable(int: 512)]
TRACE STORE_DEREF nheads_q [ConstantVariable(int: 128), ConstantVariable(int: 64)]
TRACE STORE_FAST head_size [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:867 in forward (_attention.forward)
                total_k, nheads_k, _ = k.shape
TRACE LOAD_FAST k []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
wrap_to_fake L['k'] (512, 8, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_k_ L['k'] FakeTensor(..., device='cuda:0', size=(512, 8, 128), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE UNPACK_SEQUENCE 3 [SizeVariable(length=3)]
TRACE STORE_FAST total_k [ConstantVariable(int: 128), ConstantVariable(int: 8), ConstantVariable(int: 512)]
TRACE STORE_FAST nheads_k [ConstantVariable(int: 128), ConstantVariable(int: 8)]
TRACE STORE_FAST _ [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:868 in forward (_attention.forward)
                batch = len(cu_seqlens_q) - 1
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST cu_seqlens_q [NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
wrap_to_fake L['cu_seqlens_q'] (2,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='cu_seqlens_q', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_cu_seqlens_q_ L['cu_seqlens_q'] FakeTensor(..., device='cuda:0', size=(2,), dtype=torch.int32) at debug_level 0 before=False
TRACE LOAD_CONST 1 [ConstantVariable(int: 2)]
TRACE BINARY_OP 10 [ConstantVariable(int: 2), ConstantVariable(int: 1)]
TRACE STORE_DEREF batch [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:869 in forward (_attention.forward)
                q_strides = (0, q.stride(1), q.stride(0), q.stride(2))
TRACE LOAD_CONST 0 []
TRACE LOAD_FAST q [ConstantVariable(int: 0)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), TensorVariable()]
TRACE LOAD_CONST 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 1)]
TRACE LOAD_FAST q [ConstantVariable(int: 0), ConstantVariable(int: 128)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 0)]
TRACE LOAD_FAST q [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), TensorVariable()]
TRACE LOAD_CONST 2 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 2)]
TRACE BUILD_TUPLE 4 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), ConstantVariable(int: 1)]
TRACE STORE_FAST q_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:870 in forward (_attention.forward)
                k_strides = (0, k.stride(1), k.stride(0), k.stride(2))
TRACE LOAD_CONST 0 []
TRACE LOAD_FAST k [ConstantVariable(int: 0)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), TensorVariable()]
TRACE LOAD_CONST 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 1)]
TRACE LOAD_FAST k [ConstantVariable(int: 0), ConstantVariable(int: 128)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 0)]
TRACE LOAD_FAST k [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), TensorVariable()]
TRACE LOAD_CONST 2 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 2)]
TRACE BUILD_TUPLE 4 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), ConstantVariable(int: 1)]
TRACE STORE_FAST k_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:871 in forward (_attention.forward)
                v_strides = (0, v.stride(1), v.stride(0), v.stride(2))
TRACE LOAD_CONST 0 []
TRACE LOAD_FAST v [ConstantVariable(int: 0)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), LazyVariableTracker()]
wrap_to_fake L['v'] (512, 8, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='v', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_v_ L['v'] FakeTensor(..., device='cuda:0', size=(512, 8, 128), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE LOAD_CONST 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 1)]
TRACE LOAD_FAST v [ConstantVariable(int: 0), ConstantVariable(int: 128)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 0)]
TRACE LOAD_FAST v [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), TensorVariable()]
TRACE LOAD_CONST 2 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 2)]
TRACE BUILD_TUPLE 4 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), ConstantVariable(int: 1)]
TRACE STORE_FAST v_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:872 in forward (_attention.forward)
                o_strides = (0, o.stride(1), o.stride(0), o.stride(2))
TRACE LOAD_CONST 0 []
TRACE LOAD_FAST o [ConstantVariable(int: 0)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), TensorVariable()]
TRACE LOAD_CONST 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 1)]
TRACE LOAD_FAST o [ConstantVariable(int: 0), ConstantVariable(int: 128)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 0)]
TRACE LOAD_FAST o [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), TensorVariable()]
TRACE LOAD_CONST 2 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 2)]
TRACE BUILD_TUPLE 4 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), ConstantVariable(int: 1)]
TRACE STORE_FAST o_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:882 in forward (_attention.forward)
            unpadded_head_dims = {32, 64, 128, 256}
TRACE BUILD_SET 0 []
TRACE LOAD_CONST frozenset({256, 32, 64, 128}) [SetVariable()]
TRACE SET_UPDATE 1 [SetVariable(), FrozensetVariable()]
TRACE inlined call set_update from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:882 in forward (_attention.forward)
        unpadded_head_dims = {32, 64, 128, 256}
                             ^^^^^^^^^^^^^^^^^^
INLINING <code object set_update at 0x70c9a06d2630, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 210>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:210 in set_update (set_update) (inline depth: 1)
    def set_update(set1, *others):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:211 in set_update (set_update) (inline depth: 1)
        if len(others) == 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST others [NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=1)]
TRACE LOAD_CONST 0 [ConstantVariable(int: 1)]
TRACE COMPARE_OP == [ConstantVariable(int: 1), ConstantVariable(int: 0)]
TRACE POP_JUMP_IF_FALSE 34 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:214 in set_update (set_update) (inline depth: 1)
        for set2 in others:
TRACE LOAD_FAST others []
TRACE GET_ITER None [TupleVariable(length=1)]
TRACE FOR_ITER 104 [ListIteratorVariable(length=1, index=0)]
TRACE STORE_FAST set2 [ListIteratorVariable(length=1, index=1), FrozensetVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE LOAD_FAST set2 [ListIteratorVariable(length=1, index=1)]
TRACE GET_ITER None [ListIteratorVariable(length=1, index=1), FrozensetVariable()]
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=0)]
TRACE STORE_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(int: 256)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:216 in set_update (set_update) (inline depth: 1)
                if x not in set1:
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1)]
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(int: 256)]
TRACE CONTAINS_OP 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(int: 256), SetVariable()]
TRACE POP_JUMP_IF_TRUE 64 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:217 in set_update (set_update) (inline depth: 1)
                    set1.add(x)
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1)]
TRACE LOAD_ATTR add [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), SetVariable()]
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), NullVariable, GetAttrVariable(SetVariable(), add)]
TRACE CALL 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), NullVariable, GetAttrVariable(SetVariable(), add), ConstantVariable(int: 256)]
TRACE POP_TOP None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 48 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1)]
TRACE STORE_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(int: 32)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:216 in set_update (set_update) (inline depth: 1)
                if x not in set1:
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2)]
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(int: 32)]
TRACE CONTAINS_OP 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(int: 32), SetVariable()]
TRACE POP_JUMP_IF_TRUE 64 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:217 in set_update (set_update) (inline depth: 1)
                    set1.add(x)
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2)]
TRACE LOAD_ATTR add [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), SetVariable()]
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), NullVariable, GetAttrVariable(SetVariable(), add)]
TRACE CALL 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), NullVariable, GetAttrVariable(SetVariable(), add), ConstantVariable(int: 32)]
TRACE POP_TOP None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 48 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2)]
TRACE STORE_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(int: 64)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:216 in set_update (set_update) (inline depth: 1)
                if x not in set1:
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3)]
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(int: 64)]
TRACE CONTAINS_OP 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(int: 64), SetVariable()]
TRACE POP_JUMP_IF_TRUE 64 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:217 in set_update (set_update) (inline depth: 1)
                    set1.add(x)
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3)]
TRACE LOAD_ATTR add [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), SetVariable()]
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), NullVariable, GetAttrVariable(SetVariable(), add)]
TRACE CALL 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), NullVariable, GetAttrVariable(SetVariable(), add), ConstantVariable(int: 64)]
TRACE POP_TOP None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 48 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3)]
TRACE STORE_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(int: 128)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:216 in set_update (set_update) (inline depth: 1)
                if x not in set1:
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4)]
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(int: 128)]
TRACE CONTAINS_OP 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(int: 128), SetVariable()]
TRACE POP_JUMP_IF_TRUE 64 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:217 in set_update (set_update) (inline depth: 1)
                    set1.add(x)
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4)]
TRACE LOAD_ATTR add [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), SetVariable()]
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), NullVariable, GetAttrVariable(SetVariable(), add)]
TRACE CALL 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), NullVariable, GetAttrVariable(SetVariable(), add), ConstantVariable(int: 128)]
TRACE POP_TOP None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 48 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4)]
TRACE END_FOR None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 38 [ListIteratorVariable(length=1, index=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:214 in set_update (set_update) (inline depth: 1)
        for set2 in others:
TRACE FOR_ITER 104 [ListIteratorVariable(length=1, index=1)]
TRACE END_FOR None [ListIteratorVariable(length=1, index=1), ConstantVariable(NoneType: None)]
TRACE RETURN_CONST None []
DONE INLINING <code object set_update at 0x70c9a06d2630, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 210>
TRACE STORE_FAST unpadded_head_dims [SetVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:883 in forward (_attention.forward)
            if head_size not in unpadded_head_dims:
TRACE LOAD_FAST head_size []
TRACE LOAD_FAST unpadded_head_dims [ConstantVariable(int: 128)]
TRACE CONTAINS_OP 1 [ConstantVariable(int: 128), SetVariable()]
TRACE POP_JUMP_IF_FALSE 676 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:891 in forward (_attention.forward)
                padded_d_model = head_size
TRACE LOAD_FAST head_size []
TRACE STORE_FAST padded_d_model [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in forward (_attention.forward)
            grid = lambda META: (
TRACE LOAD_CLOSURE batch []
TRACE LOAD_CLOSURE max_seqlens_q [CellVariable()]
TRACE LOAD_CLOSURE nheads_q [CellVariable(), CellVariable()]
TRACE BUILD_TUPLE 3 [CellVariable(), CellVariable(), CellVariable()]
TRACE LOAD_CONST <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893> [TupleVariable(length=3)]
TRACE MAKE_FUNCTION 8 [TupleVariable(length=3), ConstantVariable(code: <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>)]
TRACE STORE_FAST grid [NestedUserFunctionVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:899 in forward (_attention.forward)
            encoded_softmax = None
TRACE LOAD_CONST None []
TRACE STORE_FAST encoded_softmax [ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:902 in forward (_attention.forward)
            philox_seed = 0x1BF52
TRACE LOAD_CONST 114514 []
TRACE STORE_FAST philox_seed [ConstantVariable(int: 114514)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:903 in forward (_attention.forward)
            philox_offset = 0x1D4B42
TRACE LOAD_CONST 1919810 []
TRACE STORE_FAST philox_offset [ConstantVariable(int: 1919810)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:905 in forward (_attention.forward)
            if bias is not None:
TRACE LOAD_FAST bias []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 0 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 848 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:913 in forward (_attention.forward)
                bias_strides = (0, 0, 0, 0)
TRACE LOAD_CONST (0, 0, 0, 0) []
TRACE STORE_FAST bias_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:915 in forward (_attention.forward)
            p_descale = 1.0 / p_scale
TRACE LOAD_CONST 1.0 []
TRACE LOAD_FAST p_scale [ConstantVariable(float: 1.0)]
TRACE BINARY_OP 11 [ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE STORE_FAST p_descale [ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:917 in forward (_attention.forward)
            ) if fp8_out_scale is not None else 1.0
TRACE LOAD_FAST fp8_out_scale []
TRACE LOAD_CONST None [ConstantVariable(NoneType: None)]
TRACE IS_OP 0 [ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 908 [ConstantVariable(bool: True)]
TRACE LOAD_CONST 1.0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:916 in forward (_attention.forward)
            o_descale = 1.0 / fp8_out_scale.item(
TRACE STORE_FAST o_descale [ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:919 in forward (_attention.forward)
            arg_max_seqlens_q = 0 if on_gfx1x() else max_seqlens_q
TRACE LOAD_GLOBAL on_gfx1x []
TRACE CALL 0 [NullVariable, LazyVariableTracker()]
TRACE inlined call on_gfx1x from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:919 in forward (_attention.forward)
        arg_max_seqlens_q = 0 if on_gfx1x() else max_seqlens_q
                                 ~~~~~~~~^^
INLINING <code object on_gfx1x at 0x70c98a3392e0, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 35>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:35 in on_gfx1x (on_gfx1x) (inline depth: 1)
    def on_gfx1x():
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:36 in on_gfx1x (on_gfx1x) (inline depth: 1)
        return True
TRACE RETURN_CONST True []
DONE INLINING <code object on_gfx1x at 0x70c98a3392e0, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 35>
TRACE POP_JUMP_IF_FALSE 936 [ConstantVariable(bool: True)]
TRACE LOAD_CONST 0 []
TRACE JUMP_FORWARD 938 [ConstantVariable(int: 0)]
TRACE STORE_FAST arg_max_seqlens_q [ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:920 in forward (_attention.forward)
            arg_max_seqlens_k = 0 if on_gfx1x() else max_seqlens_k
TRACE LOAD_GLOBAL on_gfx1x []
TRACE CALL 0 [NullVariable, LazyVariableTracker()]
TRACE inlined call on_gfx1x from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:920 in forward (_attention.forward)
        arg_max_seqlens_k = 0 if on_gfx1x() else max_seqlens_k
                                 ~~~~~~~~^^
INLINING <code object on_gfx1x at 0x70c98a3392e0, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 35>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:35 in on_gfx1x (on_gfx1x) (inline depth: 1)
    def on_gfx1x():
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:36 in on_gfx1x (on_gfx1x) (inline depth: 1)
        return True
TRACE RETURN_CONST True []
DONE INLINING <code object on_gfx1x at 0x70c98a3392e0, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 35>
TRACE POP_JUMP_IF_FALSE 964 [ConstantVariable(bool: True)]
TRACE LOAD_CONST 0 []
TRACE JUMP_FORWARD 966 [ConstantVariable(int: 0)]
TRACE STORE_FAST arg_max_seqlens_k [ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_GLOBAL attn_fwd []
TRACE LOAD_FAST grid [NullVariable, LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), NestedUserFunctionVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:923 in forward (_attention.forward)
                q,
TRACE LOAD_FAST q [NullVariable, TritonKernelVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:924 in forward (_attention.forward)
                k,
TRACE LOAD_FAST k [NullVariable, TritonKernelVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:925 in forward (_attention.forward)
                v,
TRACE LOAD_FAST v [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:926 in forward (_attention.forward)
                bias,
TRACE LOAD_FAST bias [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:927 in forward (_attention.forward)
                sm_scale,
TRACE LOAD_FAST sm_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:928 in forward (_attention.forward)
                q_scale,
TRACE LOAD_FAST q_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:929 in forward (_attention.forward)
                k_scale,
TRACE LOAD_FAST k_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:930 in forward (_attention.forward)
                v_scale,
TRACE LOAD_FAST v_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:931 in forward (_attention.forward)
                p_scale,
TRACE LOAD_FAST p_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:932 in forward (_attention.forward)
                p_descale,
TRACE LOAD_FAST p_descale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:933 in forward (_attention.forward)
                o_descale,
TRACE LOAD_FAST o_descale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:934 in forward (_attention.forward)
                None,
TRACE LOAD_CONST None [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:935 in forward (_attention.forward)
                o,
TRACE LOAD_FAST o [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE BUILD_LIST 13 [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(NoneType: None), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:936 in forward (_attention.forward)
                *q_strides,
TRACE LOAD_FAST q_strides [NullVariable, TritonKernelVariable(), ListVariable(length=13)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=13), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:937 in forward (_attention.forward)
                *k_strides,
TRACE LOAD_FAST k_strides [NullVariable, TritonKernelVariable(), ListVariable(length=17)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=17), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:938 in forward (_attention.forward)
                *v_strides,
TRACE LOAD_FAST v_strides [NullVariable, TritonKernelVariable(), ListVariable(length=21)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=21), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:939 in forward (_attention.forward)
                *o_strides,
TRACE LOAD_FAST o_strides [NullVariable, TritonKernelVariable(), ListVariable(length=25)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=25), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:940 in forward (_attention.forward)
                *bias_strides,
TRACE LOAD_FAST bias_strides [NullVariable, TritonKernelVariable(), ListVariable(length=29)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=29), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:941 in forward (_attention.forward)
                cu_seqlens_q,
TRACE LOAD_FAST cu_seqlens_q [NullVariable, TritonKernelVariable(), ListVariable(length=33)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_APPEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=33), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:942 in forward (_attention.forward)
                cu_seqlens_k,
TRACE LOAD_FAST cu_seqlens_k [NullVariable, TritonKernelVariable(), ListVariable(length=34)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_APPEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=34), LazyVariableTracker()]
TRACE CALL_INTRINSIC_1 6 [NullVariable, TritonKernelVariable(), ListVariable(length=35)]
TRACE BUILD_MAP 0 [NullVariable, TritonKernelVariable(), TupleVariable(length=35)]
TRACE LOAD_CONST dropout_p [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:943 in forward (_attention.forward)
                dropout_p=0.0,
TRACE LOAD_CONST 0.0 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'dropout_p')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'dropout_p'), ConstantVariable(float: 0.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST philox_seed [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:944 in forward (_attention.forward)
                philox_seed=philox_seed,
TRACE LOAD_FAST philox_seed [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'philox_seed')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'philox_seed'), ConstantVariable(int: 114514)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST philox_offset_base [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:945 in forward (_attention.forward)
                philox_offset_base=philox_offset,
TRACE LOAD_FAST philox_offset [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'philox_offset_base')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'philox_offset_base'), ConstantVariable(int: 1919810)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST encoded_softmax [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:946 in forward (_attention.forward)
                encoded_softmax=encoded_softmax,
TRACE LOAD_FAST encoded_softmax [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'encoded_softmax')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'encoded_softmax'), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST HQ [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:947 in forward (_attention.forward)
                HQ=nheads_q,
TRACE LOAD_DEREF nheads_q [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'HQ')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'HQ'), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST HK [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:948 in forward (_attention.forward)
                HK=nheads_k,
TRACE LOAD_FAST nheads_k [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'HK')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'HK'), ConstantVariable(int: 8)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST ACTUAL_BLOCK_DMODEL [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:949 in forward (_attention.forward)
                ACTUAL_BLOCK_DMODEL=head_size,
TRACE LOAD_FAST head_size [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'ACTUAL_BLOCK_DMODEL')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'ACTUAL_BLOCK_DMODEL'), ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST MAX_SEQLENS_Q [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:950 in forward (_attention.forward)
                MAX_SEQLENS_Q=arg_max_seqlens_q,
TRACE LOAD_FAST arg_max_seqlens_q [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'MAX_SEQLENS_Q')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'MAX_SEQLENS_Q'), ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST MAX_SEQLENS_K [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:951 in forward (_attention.forward)
                MAX_SEQLENS_K=arg_max_seqlens_k,
TRACE LOAD_FAST arg_max_seqlens_k [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'MAX_SEQLENS_K')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'MAX_SEQLENS_K'), ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST IS_CAUSAL [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:952 in forward (_attention.forward)
                IS_CAUSAL=causal,
TRACE LOAD_FAST causal [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'IS_CAUSAL')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'IS_CAUSAL'), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST VARLEN [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:953 in forward (_attention.forward)
                VARLEN=True,
TRACE LOAD_CONST True [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'VARLEN')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'VARLEN'), ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST BLOCK_DMODEL [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:954 in forward (_attention.forward)
                BLOCK_DMODEL=padded_d_model,
TRACE LOAD_FAST padded_d_model [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BLOCK_DMODEL')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BLOCK_DMODEL'), ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST BIAS_TYPE [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:955 in forward (_attention.forward)
                BIAS_TYPE=0 if bias is None else 1,
TRACE LOAD_FAST bias [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE')]
TRACE LOAD_CONST None [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(NoneType: None)]
TRACE IS_OP 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 1130 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(bool: False)]
TRACE LOAD_CONST 0 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE')]
TRACE JUMP_FORWARD 1132 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(int: 0)]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST ENABLE_DROPOUT [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:956 in forward (_attention.forward)
                ENABLE_DROPOUT=False,
TRACE LOAD_CONST False [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'ENABLE_DROPOUT')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'ENABLE_DROPOUT'), ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST RETURN_ENCODED_SOFTMAX [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:957 in forward (_attention.forward)
                RETURN_ENCODED_SOFTMAX=False,
TRACE LOAD_CONST False [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'RETURN_ENCODED_SOFTMAX')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'RETURN_ENCODED_SOFTMAX'), ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST USE_FP8 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:958 in forward (_attention.forward)
                USE_FP8=use_fp8,
TRACE LOAD_FAST use_fp8 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8'), ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST USE_FP8_OUT [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:959 in forward (_attention.forward)
                USE_FP8_OUT=fp8_out_scale is not None,
TRACE LOAD_FAST fp8_out_scale [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8_OUT')]
TRACE LOAD_CONST None [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8_OUT'), ConstantVariable(NoneType: None)]
TRACE IS_OP 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8_OUT'), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8_OUT'), ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE CALL_FUNCTION_EX 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE inlined call <lambda> from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
                triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF max_seqlens_q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST META [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE LOAD_CONST BLOCK_M [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstDictVariable(), ConstantVariable(str: 'BLOCK_M')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
            triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
            ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 512)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 512)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 512)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 3)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [ConstantVariable(int: 512)]
TRACE BINARY_OP 0 [ConstantVariable(int: 512), ConstantVariable(int: 32)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 544)]
TRACE BINARY_OP 10 [ConstantVariable(int: 544), ConstantVariable(int: 1)]
TRACE LOAD_FAST y [ConstantVariable(int: 543)]
TRACE BINARY_OP 2 [ConstantVariable(int: 543), ConstantVariable(int: 32)]
TRACE RETURN_VALUE None [ConstantVariable(int: 16)]
DONE INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [ConstantVariable(int: 16)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 16)]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:895 in <lambda> (_attention.forward) (inline depth: 1)
                nheads_q,
TRACE LOAD_DEREF nheads_q [ConstantVariable(int: 16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:896 in <lambda> (_attention.forward) (inline depth: 1)
                batch,
TRACE LOAD_DEREF batch [ConstantVariable(int: 16), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE BUILD_TUPLE 3 [ConstantVariable(int: 16), ConstantVariable(int: 64), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [TupleVariable(length=3)]
DONE INLINING <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>
TRACE inlined call <lambda> from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
                triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF max_seqlens_q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST META [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE LOAD_CONST BLOCK_M [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstDictVariable(), ConstantVariable(str: 'BLOCK_M')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
            triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
            ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 512)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 512)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 512)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 3)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [ConstantVariable(int: 512)]
TRACE BINARY_OP 0 [ConstantVariable(int: 512), ConstantVariable(int: 32)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 544)]
TRACE BINARY_OP 10 [ConstantVariable(int: 544), ConstantVariable(int: 1)]
TRACE LOAD_FAST y [ConstantVariable(int: 543)]
TRACE BINARY_OP 2 [ConstantVariable(int: 543), ConstantVariable(int: 32)]
TRACE RETURN_VALUE None [ConstantVariable(int: 16)]
DONE INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [ConstantVariable(int: 16)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 16)]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:895 in <lambda> (_attention.forward) (inline depth: 1)
                nheads_q,
TRACE LOAD_DEREF nheads_q [ConstantVariable(int: 16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:896 in <lambda> (_attention.forward) (inline depth: 1)
                batch,
TRACE LOAD_DEREF batch [ConstantVariable(int: 16), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE BUILD_TUPLE 3 [ConstantVariable(int: 16), ConstantVariable(int: 64), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [TupleVariable(length=3)]
DONE INLINING <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>
TRACE inlined call <lambda> from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
                triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF max_seqlens_q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST META [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE LOAD_CONST BLOCK_M [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstDictVariable(), ConstantVariable(str: 'BLOCK_M')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
            triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
            ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 512)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 512)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 512)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 3)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [ConstantVariable(int: 512)]
TRACE BINARY_OP 0 [ConstantVariable(int: 512), ConstantVariable(int: 32)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 544)]
TRACE BINARY_OP 10 [ConstantVariable(int: 544), ConstantVariable(int: 1)]
TRACE LOAD_FAST y [ConstantVariable(int: 543)]
TRACE BINARY_OP 2 [ConstantVariable(int: 543), ConstantVariable(int: 32)]
TRACE RETURN_VALUE None [ConstantVariable(int: 16)]
DONE INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [ConstantVariable(int: 16)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 16)]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:895 in <lambda> (_attention.forward) (inline depth: 1)
                nheads_q,
TRACE LOAD_DEREF nheads_q [ConstantVariable(int: 16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:896 in <lambda> (_attention.forward) (inline depth: 1)
                batch,
TRACE LOAD_DEREF batch [ConstantVariable(int: 16), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE BUILD_TUPLE 3 [ConstantVariable(int: 16), ConstantVariable(int: 64), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [TupleVariable(length=3)]
DONE INLINING <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>
TRACE inlined call <lambda> from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
                triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF max_seqlens_q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST META [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE LOAD_CONST BLOCK_M [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstDictVariable(), ConstantVariable(str: 'BLOCK_M')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
            triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
            ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 512)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 512)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 512)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 3)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [ConstantVariable(int: 512)]
TRACE BINARY_OP 0 [ConstantVariable(int: 512), ConstantVariable(int: 32)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 544)]
TRACE BINARY_OP 10 [ConstantVariable(int: 544), ConstantVariable(int: 1)]
TRACE LOAD_FAST y [ConstantVariable(int: 543)]
TRACE BINARY_OP 2 [ConstantVariable(int: 543), ConstantVariable(int: 32)]
TRACE RETURN_VALUE None [ConstantVariable(int: 16)]
DONE INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [ConstantVariable(int: 16)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 16)]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:895 in <lambda> (_attention.forward) (inline depth: 1)
                nheads_q,
TRACE LOAD_DEREF nheads_q [ConstantVariable(int: 16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:896 in <lambda> (_attention.forward) (inline depth: 1)
                batch,
TRACE LOAD_DEREF batch [ConstantVariable(int: 16), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE BUILD_TUPLE 3 [ConstantVariable(int: 16), ConstantVariable(int: 64), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [TupleVariable(length=3)]
DONE INLINING <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>
wrap_to_fake L['cu_seqlens_k'] (2,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='cu_seqlens_k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_cu_seqlens_k_ L['cu_seqlens_k'] FakeTensor(..., device='cuda:0', size=(2,), dtype=torch.int32) at debug_level 0 before=False
TRACE FX call triton_kernel_wrapper_mutation from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
TRACE POP_TOP None [ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:962 in forward (_attention.forward)
            return o, encoded_softmax
TRACE LOAD_FAST o []
TRACE LOAD_FAST encoded_softmax [TensorVariable()]
TRACE BUILD_TUPLE 2 [TensorVariable(), ConstantVariable(NoneType: None)]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
Step 1: torchdynamo done tracing forward (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py, line 962 in forward>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_11_d8503d41_0559_46b5_8538_269e2355770f =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, L_o_: "[31mbf16[0m[34m[512, 64, 128][0m[2m[34m[8192, 128, 1][0m[2m[32mcuda:0[0m", L_q_: "[31mbf16[0m[34m[512, 64, 128][0m[2m[34m[8192, 128, 1][0m[2m[32mcuda:0[0m", L_k_: "[31mbf16[0m[34m[512, 8, 128][0m[2m[34m[1024, 128, 1][0m[2m[32mcuda:0[0m", L_cu_seqlens_q_: "[31mi32[0m[34m[2][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_v_: "[31mbf16[0m[34m[512, 8, 128][0m[2m[34m[1024, 128, 1][0m[2m[32mcuda:0[0m", L_cu_seqlens_k_: "[31mi32[0m[34m[2][0m[2m[34m[1][0m[2m[32mcuda:0[0m"):
        l_o_ = L_o_
        l_q_ = L_q_
        l_k_ = L_k_
        l_cu_seqlens_q_ = L_cu_seqlens_q_
        l_v_ = L_v_
        l_cu_seqlens_k_ = L_cu_seqlens_k_
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward, code: attn_fwd[grid]([0m
        triton_kernel_wrapper_mutation = torch.ops.higher_order.triton_kernel_wrapper_mutation(kernel_idx = [34m1[0m, constant_args_idx = [34m2[0m, grid = [([34m16[0m, [34m64[0m, [34m1[0m), ([34m16[0m, [34m64[0m, [34m1[0m), ([34m16[0m, [34m64[0m, [34m1[0m), ([34m16[0m, [34m64[0m, [34m1[0m)], tma_descriptor_metadata = [34m{}[0m, kwargs = [34m{'Q': l_q_, 'K': l_k_, 'V': l_v_, 'Out': l_o_, 'cu_seqlens_q': l_cu_seqlens_q_, 'cu_seqlens_k': l_cu_seqlens_k_}[0m);  [2ml_q_ = l_k_ = l_v_ = l_o_ = l_cu_seqlens_q_ = l_cu_seqlens_k_ = triton_kernel_wrapper_mutation = None[0m
        return ()
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing fpx_matmul /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:420
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:420 in fpx_matmul (fpx_matmul)
    def fpx_matmul(x,weight,weight_state,ebits:int=3,mbits:int=2):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:421 in fpx_matmul (fpx_matmul)
        if ebits == -44: #hqq
TRACE LOAD_FAST ebits []
TRACE LOAD_CONST -44 [LazyVariableTracker()]
TRACE COMPARE_OP == [LazyVariableTracker(), ConstantVariable(int: -44)]
TRACE POP_JUMP_IF_FALSE 322 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul)
            S0=x.shape[0]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
wrap_to_fake L['x'] (1, 512, 8192) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='x', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}), tensor_source=LocalSource(local_name='x', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_x_ L['x'] FakeTensor(..., device='cuda:0', size=(1, 512, 8192), dtype=torch.bfloat16) at debug_level 0 before=False
wrap_to_fake L['x']._base (512, 64, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='x', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
TRACE LOAD_CONST 0 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 0)]
TRACE STORE_FAST S0 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul)
            S1=x.shape[1]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 1)]
TRACE STORE_FAST S1 [ConstantVariable(int: 512)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:424 in fpx_matmul (fpx_matmul)
            dtype = x.dtype
TRACE LOAD_FAST x []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul)
            x = x.to(dtype=torch.float16).view(-1,x.shape[2])
TRACE LOAD_FAST x []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float16 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST x [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1)]
TRACE LOAD_ATTR shape [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3), ConstantVariable(int: 2)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), ConstantVariable(int: 8192)]
TRACE FX call view from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul)
            out = weight.forward_manual(x).to(dtype=dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_ATTR forward_manual [LazyVariableTracker()]
TRACE LOAD_FAST x [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE CALL 1 [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton)), TensorVariable()]
TRACE inlined call forward_manual from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:543 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
        def forward_manual(self, x: Tensor, matmul_type: str="GEMM") -> Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
            return forward_functional(
TRACE LOAD_GLOBAL forward_functional []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:545 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
                x,
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:546 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
                self.bias,
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR bias [NullVariable, LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
                self.get_tensor_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_ATTR get_tensor_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_tensor_args at 0x70c98a9e9080>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_tensor_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
            self.get_tensor_args(),
            ~~~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:524 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 2)
        def get_tensor_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:525 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 2)
            return [self.W_q, self.scales, self.zeros]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR W_q [UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_FAST self [LazyVariableTracker()]
TRACE LOAD_ATTR scales [LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['weight']._parameters['scales'] (128, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='weight', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='scales'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_weight_parameters_scales_ L['weight']._parameters['scales'] Parameter(FakeTensor(..., device='cuda:0', size=(128, 5120), dtype=torch.float16)) at debug_level 0 before=False
TRACE LOAD_FAST self [LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR zeros [LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['weight']._parameters['zeros'] (128, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='weight', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='zeros'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_weight_parameters_zeros_ L['weight']._parameters['zeros'] Parameter(FakeTensor(..., device='cuda:0', size=(128, 5120), dtype=torch.float16)) at debug_level 0 before=False
TRACE BUILD_LIST 3 [LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [ListVariable(length=3)]
DONE INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
                self.get_meta_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3)]
TRACE LOAD_ATTR get_meta_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_meta_args at 0x70c98a9e9120>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_meta_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
            self.get_meta_args(),
            ~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:527 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
        def get_meta_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
            return [int(self.scaled_activations),
TRACE LOAD_GLOBAL int []
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR scaled_activations [NullVariable, LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:529 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.W_nbits,
TRACE LOAD_FAST self [ConstantVariable(int: 0)]
TRACE LOAD_ATTR W_nbits [ConstantVariable(int: 0), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:530 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.group_size,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker()]
TRACE LOAD_ATTR group_size [ConstantVariable(int: 0), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:531 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.unpack_mask,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR unpack_mask [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:532 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.elements_per_sample,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR elements_per_sample [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:533 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.input_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR input_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:534 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.output_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR output_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:535 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.acc_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR acc_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:536 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.meta_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR meta_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:537 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.channel_scale_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR channel_scale_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:538 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.W_group_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR W_group_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:539 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    int(self.data_contiguous),
TRACE LOAD_GLOBAL int [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int)]
TRACE LOAD_ATTR data_contiguous [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
            return [int(self.scaled_activations),
TRACE BUILD_LIST 12 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [ListVariable(length=12)]
DONE INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:549 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
                GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
TRACE LOAD_GLOBAL GEMLITE_MATMUL_TYPES_MAPPING [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12)]
TRACE LOAD_FAST matmul_type [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker(), ConstantVariable(str: 'GEMM')]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
            return forward_functional(
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
        return forward_functional(
               ~~~~~~~~~~~~~~~~~~^
            x,
            ^^
            self.bias,
            ^^^^^^^^^^
            self.get_tensor_args(),
            ^^^^^^^^^^^^^^^^^^^^^^^
            self.get_meta_args(),
            ^^^^^^^^^^^^^^^^^^^^^
            GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:675 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 2)
        def __call__(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 2)
            return self._opoverload(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR _opoverload [NullVariable, UserDefinedObjectVariable(CustomOpDef)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=5)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
wrap_to_fake L['weight'].W_q (1024, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=AttrSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='weight', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='W_q'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_weight_W_q L['weight'].W_q FakeTensor(..., device='cuda:0', size=(1024, 5120), dtype=torch.int32) at debug_level 0 before=False
TRACE FX call forward_functional_default from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 2)
        return self._opoverload(*args, **kwargs)
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_1 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE STORE_FAST out [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul)
            return out.view(S0,S1,-1)
TRACE LOAD_FAST out []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST S0 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST S1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 512), ConstantVariable(int: -1)]
TRACE FX call view_1 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul)
        return out.view(S0,S1,-1)
               ~~~~~~~~^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
Step 1: torchdynamo done tracing fpx_matmul (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py, line 440 in fpx_matmul>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_13_9034d8b1_2b15_463e_be3d_ee9d01889466 =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, L_x_: "[31mbf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m", L_weight_parameters_scales_: "[31mf16[0m[34m[128, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m", L_weight_parameters_zeros_: "[31mf16[0m[34m[128, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m", L_weight_W_q: "[31mi32[0m[34m[1024, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m"):
        l_x_ = L_x_
        l_weight_parameters_scales_ = L_weight_parameters_scales_
        l_weight_parameters_zeros_ = L_weight_parameters_zeros_
        l_weight_w_q = L_weight_W_q
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul, code: x = x.to(dtype=torch.float16).view(-1,x.shape[2])[0m
        to: "[31mf16[0m[34m[1, 512, 8192][0m[2m[34m[4194304, 8192, 1][0m[2m[32mcuda:0[0m" = l_x_.to(dtype = [34mtorch.float16[0m);  [2ml_x_ = None[0m
        x: "[31mf16[0m[34m[512, 8192][0m[2m[34m[8192, 1][0m[2m[32mcuda:0[0m" = to.view([34m-1[0m, [34m8192[0m);  [2mto = None[0m
        
         [2m# File: /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__, code: return self._opoverload(*args, **kwargs)[0m
        forward_functional_default: "[31mf16[0m[34m[512, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m" = torch.ops.gemlite.forward_functional.default(x, [34mNone[0m, [l_weight_w_q, l_weight_parameters_scales_, l_weight_parameters_zeros_], [[34m0[0m, [34m4[0m, [34m64[0m, [34m15[0m, [34m8[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m0[0m, [34m4[0m, [34m1[0m], [34m4[0m);  [2mx = l_weight_w_q = l_weight_parameters_scales_ = l_weight_parameters_zeros_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul, code: out = weight.forward_manual(x).to(dtype=dtype)[0m
        out: "[31mbf16[0m[34m[512, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m" = forward_functional_default.to(dtype = [34mtorch.bfloat16[0m);  [2mforward_functional_default = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul, code: return out.view(S0,S1,-1)[0m
        view_1: "[31mbf16[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = out.view([34m1[0m, [34m512[0m, [34m-1[0m);  [2mout = None[0m
        return (view_1,)
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing T5RMSNorm /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [LazyVariableTracker()]
wrap_to_fake L['hidden_states'] (1, 512, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='hidden_states', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_hidden_states_ L['hidden_states'] FakeTensor(..., device='cuda:0', size=(1, 512, 5120), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE FX call add from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['weight'] (5120,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='weight', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_weight_ L['weight'] FakeTensor(..., device='cuda:0', size=(5120,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
Step 1: torchdynamo done tracing T5RMSNorm (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py, line 378 in T5RMSNorm>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_15_c8d9efe1_0beb_4da9_a80b_9966e5c4cf11 =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, L_hidden_states_: "[31mbf16[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m", L_weight_: "[31mbf16[0m[34m[5120][0m[2m[34m[1][0m[2m[32mcuda:0[0m"):
        l_hidden_states_ = L_hidden_states_
        l_weight_ = L_weight_
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states: "[31mf32[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = l_hidden_states_.to([34mtorch.float32[0m);  [2ml_hidden_states_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_1: "[31mf32[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states.pow([34m2[0m)
        variance: "[31mf32[0m[34m[1, 512, 1][0m[2m[34m[512, 1, 1][0m[2m[32mcuda:0[0m" = pow_1.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add: "[31mf32[0m[34m[1, 512, 1][0m[2m[34m[512, 1, 1][0m[2m[32mcuda:0[0m" = variance + [34m1e-06[0m;  [2mvariance = None[0m
        rsqrt: "[31mf32[0m[34m[1, 512, 1][0m[2m[34m[512, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add);  [2madd = None[0m
        hidden_states_1: "[31mf32[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states * rsqrt;  [2mhidden_states = rsqrt = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_1: "[31mf32[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = l_weight_ * hidden_states_1;  [2ml_weight_ = hidden_states_1 = None[0m
        to_1: "[31mbf16[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m" = mul_1.to([34mtorch.bfloat16[0m);  [2mmul_1 = None[0m
        return (to_1,)
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing reference_dequant_gemm /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:213
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:213 in reference_dequant_gemm ()
    @torch.compile
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:219 in reference_dequant_gemm (reference_dequant_gemm)
        W_fp16 = W_int8.to(torch.float16) * scale.view(-1, 1)
TRACE LOAD_FAST W_int8 []
TRACE LOAD_ATTR to [LazyVariableTracker()]
wrap_to_fake L['W_int8'] (5120, 151936) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='W_int8', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_W_int8_ L['W_int8'] FakeTensor(..., device='cuda:0', size=(5120, 151936), dtype=torch.int8) at debug_level 0 before=False
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float16 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to from /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:219 in reference_dequant_gemm (reference_dequant_gemm)
    W_fp16 = W_int8.to(torch.float16) * scale.view(-1, 1)
             ~~~~~~~~~^^^^^^^^^^^^^^^
TRACE LOAD_FAST scale [TensorVariable()]
TRACE LOAD_ATTR view [TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['scale'] (5120,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='scale', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_scale_ L['scale'] FakeTensor(..., device='cuda:0', size=(5120,), dtype=torch.float16) at debug_level 0 before=False
TRACE LOAD_CONST -1 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_CONST 1 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1)]
TRACE CALL 2 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), ConstantVariable(int: 1)]
TRACE FX call view from /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:219 in reference_dequant_gemm (reference_dequant_gemm)
    W_fp16 = W_int8.to(torch.float16) * scale.view(-1, 1)
                                        ~~~~~~~~~~^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul from /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:219 in reference_dequant_gemm (reference_dequant_gemm)
    W_fp16 = W_int8.to(torch.float16) * scale.view(-1, 1)
             ~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST W_fp16 [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:220 in reference_dequant_gemm (reference_dequant_gemm)
        return torch.matmul(A, W_fp16)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR matmul [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST A [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST W_fp16 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['A'] (1, 512, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='A', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_A_ L['A'] FakeTensor(..., device='cuda:0', size=(1, 512, 5120), dtype=torch.float16) at debug_level 0 before=False
TRACE FX call matmul from /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:220 in reference_dequant_gemm (reference_dequant_gemm)
    return torch.matmul(A, W_fp16)
           ~~~~~~~~~~~~^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
Step 1: torchdynamo done tracing reference_dequant_gemm (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py, line 220 in reference_dequant_gemm>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_17_e4b35745_e8fe_4b1c_bb68_7c251955f860 =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, L_W_int8_: "[31mi8[0m[34m[5120, 151936][0m[2m[34m[1, 5120][0m[2m[32mcuda:0[0m", L_scale_: "[31mf16[0m[34m[5120][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_A_: "[31mf16[0m[34m[1, 512, 5120][0m[2m[34m[2621440, 5120, 1][0m[2m[32mcuda:0[0m"):
        l_w_int8_ = L_W_int8_
        l_scale_ = L_scale_
        l_a_ = L_A_
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:219 in reference_dequant_gemm, code: W_fp16 = W_int8.to(torch.float16) * scale.view(-1, 1)[0m
        to: "[31mf16[0m[34m[5120, 151936][0m[2m[34m[1, 5120][0m[2m[32mcuda:0[0m" = l_w_int8_.to([34mtorch.float16[0m);  [2ml_w_int8_ = None[0m
        view: "[31mf16[0m[34m[5120, 1][0m[2m[34m[1, 1][0m[2m[32mcuda:0[0m" = l_scale_.view([34m-1[0m, [34m1[0m);  [2ml_scale_ = None[0m
        W_fp16: "[31mf16[0m[34m[5120, 151936][0m[2m[34m[1, 5120][0m[2m[32mcuda:0[0m" = to * view;  [2mto = view = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:220 in reference_dequant_gemm, code: return torch.matmul(A, W_fp16)[0m
        matmul: "[31mf16[0m[34m[1, 512, 151936][0m[2m[34m[77791232, 151936, 1][0m[2m[32mcuda:0[0m" = torch.matmul(l_a_, W_fp16);  [2ml_a_ = W_fp16 = None[0m
        return (matmul,)
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing forward /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:831
TRACE MAKE_CELL max_seqlens_q []
TRACE MAKE_CELL batch []
TRACE MAKE_CELL nheads_q []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:831 in forward (_attention)
        @staticmethod
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:848 in forward (_attention.forward)
            use_fp8 = False
TRACE LOAD_CONST False []
TRACE STORE_FAST use_fp8 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:849 in forward (_attention.forward)
            fp8_out_scale=None
TRACE LOAD_CONST None []
TRACE STORE_FAST fp8_out_scale [ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:850 in forward (_attention.forward)
            fp8_scales=None
TRACE LOAD_CONST None []
TRACE STORE_FAST fp8_scales [ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:851 in forward (_attention.forward)
            q_scale = k_scale = v_scale = p_scale = 1.0
TRACE LOAD_CONST 1.0 []
TRACE COPY 1 [ConstantVariable(float: 1.0)]
TRACE STORE_FAST q_scale [ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE COPY 1 [ConstantVariable(float: 1.0)]
TRACE STORE_FAST k_scale [ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE COPY 1 [ConstantVariable(float: 1.0)]
TRACE STORE_FAST v_scale [ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE STORE_FAST p_scale [ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:853 in forward (_attention.forward)
            if o is None:
TRACE LOAD_FAST o []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
wrap_to_fake L['o'] (512, 64, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='o', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_o_ L['o'] FakeTensor(..., device='cuda:0', size=(512, 64, 128), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE POP_JUMP_IF_TRUE 110 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:865 in forward (_attention.forward)
            if True:  # varlen
TRACE NOP None []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:866 in forward (_attention.forward)
                total_q, nheads_q, head_size = q.shape
TRACE LOAD_FAST q []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
wrap_to_fake L['q'] (512, 64, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None], constraint_strides=[None, None, None, None], specialize_on=[[], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='q', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}), tensor_source=LocalSource(local_name='q', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_q_ L['q'] FakeTensor(..., device='cuda:0', size=(512, 64, 128), dtype=torch.bfloat16) at debug_level 0 before=False
wrap_to_fake L['q']._base (1, 512, 64, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None], constraint_strides=[None, None, None, None], specialize_on=[[], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='q', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
TRACE UNPACK_SEQUENCE 3 [SizeVariable(length=3)]
TRACE STORE_FAST total_q [ConstantVariable(int: 128), ConstantVariable(int: 64), ConstantVariable(int: 512)]
TRACE STORE_DEREF nheads_q [ConstantVariable(int: 128), ConstantVariable(int: 64)]
TRACE STORE_FAST head_size [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:867 in forward (_attention.forward)
                total_k, nheads_k, _ = k.shape
TRACE LOAD_FAST k []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
automatic dynamic size L['k'] size(0) 1024 != 512
wrap_to_fake L['k'] (1024, 8, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_k_ L['k'] FakeTensor(..., device='cuda:0', size=(s37, 8, 128), dtype=torch.bfloat16) at debug_level 0 before=False
create_graph_input s37 L['k'].size()[0] s37 at debug_level 0 before=True
_lift_symbols_in_symint s37 from L['k'].size()[0] at debug_level 0
TRACE FX call size from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:867 in forward (_attention.forward)
            total_k, nheads_k, _ = k.shape
                                   ^^^^^^^
TRACE UNPACK_SEQUENCE 3 [SizeVariable(length=3)]
TRACE STORE_FAST total_k [ConstantVariable(int: 128), ConstantVariable(int: 8), SymNodeVariable()]
TRACE STORE_FAST nheads_k [ConstantVariable(int: 128), ConstantVariable(int: 8)]
TRACE STORE_FAST _ [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:868 in forward (_attention.forward)
                batch = len(cu_seqlens_q) - 1
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST cu_seqlens_q [NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
wrap_to_fake L['cu_seqlens_q'] (2,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='cu_seqlens_q', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_cu_seqlens_q_ L['cu_seqlens_q'] FakeTensor(..., device='cuda:0', size=(2,), dtype=torch.int32) at debug_level 0 before=False
TRACE LOAD_CONST 1 [ConstantVariable(int: 2)]
TRACE BINARY_OP 10 [ConstantVariable(int: 2), ConstantVariable(int: 1)]
TRACE STORE_DEREF batch [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:869 in forward (_attention.forward)
                q_strides = (0, q.stride(1), q.stride(0), q.stride(2))
TRACE LOAD_CONST 0 []
TRACE LOAD_FAST q [ConstantVariable(int: 0)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), TensorVariable()]
TRACE LOAD_CONST 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 1)]
TRACE LOAD_FAST q [ConstantVariable(int: 0), ConstantVariable(int: 128)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 0)]
TRACE LOAD_FAST q [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), TensorVariable()]
TRACE LOAD_CONST 2 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 2)]
TRACE BUILD_TUPLE 4 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), ConstantVariable(int: 1)]
TRACE STORE_FAST q_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:870 in forward (_attention.forward)
                k_strides = (0, k.stride(1), k.stride(0), k.stride(2))
TRACE LOAD_CONST 0 []
TRACE LOAD_FAST k [ConstantVariable(int: 0)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), TensorVariable()]
TRACE LOAD_CONST 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 1)]
TRACE LOAD_FAST k [ConstantVariable(int: 0), ConstantVariable(int: 128)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 0)]
TRACE LOAD_FAST k [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), TensorVariable()]
TRACE LOAD_CONST 2 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 2)]
TRACE BUILD_TUPLE 4 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), ConstantVariable(int: 1)]
TRACE STORE_FAST k_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:871 in forward (_attention.forward)
                v_strides = (0, v.stride(1), v.stride(0), v.stride(2))
TRACE LOAD_CONST 0 []
TRACE LOAD_FAST v [ConstantVariable(int: 0)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), LazyVariableTracker()]
automatic dynamic size L['v'] size(0) 1024 != 512
wrap_to_fake L['v'] (1024, 8, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='v', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_v_ L['v'] FakeTensor(..., device='cuda:0', size=(s33, 8, 128), dtype=torch.bfloat16) at debug_level 0 before=False
create_graph_input s33 L['v'].size()[0] s33 at debug_level 0 before=True
_lift_symbols_in_symint s33 from L['v'].size()[0] at debug_level 0
TRACE LOAD_CONST 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 1)]
TRACE LOAD_FAST v [ConstantVariable(int: 0), ConstantVariable(int: 128)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 0)]
TRACE LOAD_FAST v [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), TensorVariable()]
TRACE LOAD_CONST 2 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 2)]
TRACE BUILD_TUPLE 4 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), ConstantVariable(int: 1)]
TRACE STORE_FAST v_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:872 in forward (_attention.forward)
                o_strides = (0, o.stride(1), o.stride(0), o.stride(2))
TRACE LOAD_CONST 0 []
TRACE LOAD_FAST o [ConstantVariable(int: 0)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), TensorVariable()]
TRACE LOAD_CONST 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 1)]
TRACE LOAD_FAST o [ConstantVariable(int: 0), ConstantVariable(int: 128)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 0)]
TRACE LOAD_FAST o [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), TensorVariable()]
TRACE LOAD_CONST 2 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 2)]
TRACE BUILD_TUPLE 4 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), ConstantVariable(int: 1)]
TRACE STORE_FAST o_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:882 in forward (_attention.forward)
            unpadded_head_dims = {32, 64, 128, 256}
TRACE BUILD_SET 0 []
TRACE LOAD_CONST frozenset({256, 32, 64, 128}) [SetVariable()]
TRACE SET_UPDATE 1 [SetVariable(), FrozensetVariable()]
TRACE inlined call set_update from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:882 in forward (_attention.forward)
        unpadded_head_dims = {32, 64, 128, 256}
                             ^^^^^^^^^^^^^^^^^^
INLINING <code object set_update at 0x70c9a06d2630, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 210>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:210 in set_update (set_update) (inline depth: 1)
    def set_update(set1, *others):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:211 in set_update (set_update) (inline depth: 1)
        if len(others) == 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST others [NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=1)]
TRACE LOAD_CONST 0 [ConstantVariable(int: 1)]
TRACE COMPARE_OP == [ConstantVariable(int: 1), ConstantVariable(int: 0)]
TRACE POP_JUMP_IF_FALSE 34 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:214 in set_update (set_update) (inline depth: 1)
        for set2 in others:
TRACE LOAD_FAST others []
TRACE GET_ITER None [TupleVariable(length=1)]
TRACE FOR_ITER 104 [ListIteratorVariable(length=1, index=0)]
TRACE STORE_FAST set2 [ListIteratorVariable(length=1, index=1), FrozensetVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE LOAD_FAST set2 [ListIteratorVariable(length=1, index=1)]
TRACE GET_ITER None [ListIteratorVariable(length=1, index=1), FrozensetVariable()]
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=0)]
TRACE STORE_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(int: 256)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:216 in set_update (set_update) (inline depth: 1)
                if x not in set1:
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1)]
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(int: 256)]
TRACE CONTAINS_OP 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(int: 256), SetVariable()]
TRACE POP_JUMP_IF_TRUE 64 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:217 in set_update (set_update) (inline depth: 1)
                    set1.add(x)
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1)]
TRACE LOAD_ATTR add [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), SetVariable()]
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), NullVariable, GetAttrVariable(SetVariable(), add)]
TRACE CALL 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), NullVariable, GetAttrVariable(SetVariable(), add), ConstantVariable(int: 256)]
TRACE POP_TOP None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 48 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1)]
TRACE STORE_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(int: 32)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:216 in set_update (set_update) (inline depth: 1)
                if x not in set1:
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2)]
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(int: 32)]
TRACE CONTAINS_OP 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(int: 32), SetVariable()]
TRACE POP_JUMP_IF_TRUE 64 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:217 in set_update (set_update) (inline depth: 1)
                    set1.add(x)
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2)]
TRACE LOAD_ATTR add [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), SetVariable()]
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), NullVariable, GetAttrVariable(SetVariable(), add)]
TRACE CALL 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), NullVariable, GetAttrVariable(SetVariable(), add), ConstantVariable(int: 32)]
TRACE POP_TOP None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 48 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2)]
TRACE STORE_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(int: 64)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:216 in set_update (set_update) (inline depth: 1)
                if x not in set1:
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3)]
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(int: 64)]
TRACE CONTAINS_OP 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(int: 64), SetVariable()]
TRACE POP_JUMP_IF_TRUE 64 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:217 in set_update (set_update) (inline depth: 1)
                    set1.add(x)
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3)]
TRACE LOAD_ATTR add [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), SetVariable()]
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), NullVariable, GetAttrVariable(SetVariable(), add)]
TRACE CALL 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), NullVariable, GetAttrVariable(SetVariable(), add), ConstantVariable(int: 64)]
TRACE POP_TOP None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 48 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3)]
TRACE STORE_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(int: 128)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:216 in set_update (set_update) (inline depth: 1)
                if x not in set1:
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4)]
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(int: 128)]
TRACE CONTAINS_OP 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(int: 128), SetVariable()]
TRACE POP_JUMP_IF_TRUE 64 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:217 in set_update (set_update) (inline depth: 1)
                    set1.add(x)
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4)]
TRACE LOAD_ATTR add [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), SetVariable()]
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), NullVariable, GetAttrVariable(SetVariable(), add)]
TRACE CALL 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), NullVariable, GetAttrVariable(SetVariable(), add), ConstantVariable(int: 128)]
TRACE POP_TOP None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 48 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4)]
TRACE END_FOR None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 38 [ListIteratorVariable(length=1, index=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:214 in set_update (set_update) (inline depth: 1)
        for set2 in others:
TRACE FOR_ITER 104 [ListIteratorVariable(length=1, index=1)]
TRACE END_FOR None [ListIteratorVariable(length=1, index=1), ConstantVariable(NoneType: None)]
TRACE RETURN_CONST None []
DONE INLINING <code object set_update at 0x70c9a06d2630, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 210>
TRACE STORE_FAST unpadded_head_dims [SetVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:883 in forward (_attention.forward)
            if head_size not in unpadded_head_dims:
TRACE LOAD_FAST head_size []
TRACE LOAD_FAST unpadded_head_dims [ConstantVariable(int: 128)]
TRACE CONTAINS_OP 1 [ConstantVariable(int: 128), SetVariable()]
TRACE POP_JUMP_IF_FALSE 676 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:891 in forward (_attention.forward)
                padded_d_model = head_size
TRACE LOAD_FAST head_size []
TRACE STORE_FAST padded_d_model [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in forward (_attention.forward)
            grid = lambda META: (
TRACE LOAD_CLOSURE batch []
TRACE LOAD_CLOSURE max_seqlens_q [CellVariable()]
TRACE LOAD_CLOSURE nheads_q [CellVariable(), CellVariable()]
TRACE BUILD_TUPLE 3 [CellVariable(), CellVariable(), CellVariable()]
TRACE LOAD_CONST <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893> [TupleVariable(length=3)]
TRACE MAKE_FUNCTION 8 [TupleVariable(length=3), ConstantVariable(code: <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>)]
TRACE STORE_FAST grid [NestedUserFunctionVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:899 in forward (_attention.forward)
            encoded_softmax = None
TRACE LOAD_CONST None []
TRACE STORE_FAST encoded_softmax [ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:902 in forward (_attention.forward)
            philox_seed = 0x1BF52
TRACE LOAD_CONST 114514 []
TRACE STORE_FAST philox_seed [ConstantVariable(int: 114514)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:903 in forward (_attention.forward)
            philox_offset = 0x1D4B42
TRACE LOAD_CONST 1919810 []
TRACE STORE_FAST philox_offset [ConstantVariable(int: 1919810)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:905 in forward (_attention.forward)
            if bias is not None:
TRACE LOAD_FAST bias []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 0 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 848 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:913 in forward (_attention.forward)
                bias_strides = (0, 0, 0, 0)
TRACE LOAD_CONST (0, 0, 0, 0) []
TRACE STORE_FAST bias_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:915 in forward (_attention.forward)
            p_descale = 1.0 / p_scale
TRACE LOAD_CONST 1.0 []
TRACE LOAD_FAST p_scale [ConstantVariable(float: 1.0)]
TRACE BINARY_OP 11 [ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE STORE_FAST p_descale [ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:917 in forward (_attention.forward)
            ) if fp8_out_scale is not None else 1.0
TRACE LOAD_FAST fp8_out_scale []
TRACE LOAD_CONST None [ConstantVariable(NoneType: None)]
TRACE IS_OP 0 [ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 908 [ConstantVariable(bool: True)]
TRACE LOAD_CONST 1.0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:916 in forward (_attention.forward)
            o_descale = 1.0 / fp8_out_scale.item(
TRACE STORE_FAST o_descale [ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:919 in forward (_attention.forward)
            arg_max_seqlens_q = 0 if on_gfx1x() else max_seqlens_q
TRACE LOAD_GLOBAL on_gfx1x []
TRACE CALL 0 [NullVariable, LazyVariableTracker()]
TRACE inlined call on_gfx1x from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:919 in forward (_attention.forward)
        arg_max_seqlens_q = 0 if on_gfx1x() else max_seqlens_q
                                 ~~~~~~~~^^
INLINING <code object on_gfx1x at 0x70c98a3392e0, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 35>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:35 in on_gfx1x (on_gfx1x) (inline depth: 1)
    def on_gfx1x():
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:36 in on_gfx1x (on_gfx1x) (inline depth: 1)
        return True
TRACE RETURN_CONST True []
DONE INLINING <code object on_gfx1x at 0x70c98a3392e0, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 35>
TRACE POP_JUMP_IF_FALSE 936 [ConstantVariable(bool: True)]
TRACE LOAD_CONST 0 []
TRACE JUMP_FORWARD 938 [ConstantVariable(int: 0)]
TRACE STORE_FAST arg_max_seqlens_q [ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:920 in forward (_attention.forward)
            arg_max_seqlens_k = 0 if on_gfx1x() else max_seqlens_k
TRACE LOAD_GLOBAL on_gfx1x []
TRACE CALL 0 [NullVariable, LazyVariableTracker()]
TRACE inlined call on_gfx1x from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:920 in forward (_attention.forward)
        arg_max_seqlens_k = 0 if on_gfx1x() else max_seqlens_k
                                 ~~~~~~~~^^
INLINING <code object on_gfx1x at 0x70c98a3392e0, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 35>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:35 in on_gfx1x (on_gfx1x) (inline depth: 1)
    def on_gfx1x():
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:36 in on_gfx1x (on_gfx1x) (inline depth: 1)
        return True
TRACE RETURN_CONST True []
DONE INLINING <code object on_gfx1x at 0x70c98a3392e0, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 35>
TRACE POP_JUMP_IF_FALSE 964 [ConstantVariable(bool: True)]
TRACE LOAD_CONST 0 []
TRACE JUMP_FORWARD 966 [ConstantVariable(int: 0)]
TRACE STORE_FAST arg_max_seqlens_k [ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_GLOBAL attn_fwd []
TRACE LOAD_FAST grid [NullVariable, LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), NestedUserFunctionVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:923 in forward (_attention.forward)
                q,
TRACE LOAD_FAST q [NullVariable, TritonKernelVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:924 in forward (_attention.forward)
                k,
TRACE LOAD_FAST k [NullVariable, TritonKernelVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:925 in forward (_attention.forward)
                v,
TRACE LOAD_FAST v [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:926 in forward (_attention.forward)
                bias,
TRACE LOAD_FAST bias [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:927 in forward (_attention.forward)
                sm_scale,
TRACE LOAD_FAST sm_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:928 in forward (_attention.forward)
                q_scale,
TRACE LOAD_FAST q_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:929 in forward (_attention.forward)
                k_scale,
TRACE LOAD_FAST k_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:930 in forward (_attention.forward)
                v_scale,
TRACE LOAD_FAST v_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:931 in forward (_attention.forward)
                p_scale,
TRACE LOAD_FAST p_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:932 in forward (_attention.forward)
                p_descale,
TRACE LOAD_FAST p_descale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:933 in forward (_attention.forward)
                o_descale,
TRACE LOAD_FAST o_descale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:934 in forward (_attention.forward)
                None,
TRACE LOAD_CONST None [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:935 in forward (_attention.forward)
                o,
TRACE LOAD_FAST o [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE BUILD_LIST 13 [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(NoneType: None), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:936 in forward (_attention.forward)
                *q_strides,
TRACE LOAD_FAST q_strides [NullVariable, TritonKernelVariable(), ListVariable(length=13)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=13), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:937 in forward (_attention.forward)
                *k_strides,
TRACE LOAD_FAST k_strides [NullVariable, TritonKernelVariable(), ListVariable(length=17)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=17), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:938 in forward (_attention.forward)
                *v_strides,
TRACE LOAD_FAST v_strides [NullVariable, TritonKernelVariable(), ListVariable(length=21)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=21), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:939 in forward (_attention.forward)
                *o_strides,
TRACE LOAD_FAST o_strides [NullVariable, TritonKernelVariable(), ListVariable(length=25)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=25), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:940 in forward (_attention.forward)
                *bias_strides,
TRACE LOAD_FAST bias_strides [NullVariable, TritonKernelVariable(), ListVariable(length=29)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=29), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:941 in forward (_attention.forward)
                cu_seqlens_q,
TRACE LOAD_FAST cu_seqlens_q [NullVariable, TritonKernelVariable(), ListVariable(length=33)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_APPEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=33), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:942 in forward (_attention.forward)
                cu_seqlens_k,
TRACE LOAD_FAST cu_seqlens_k [NullVariable, TritonKernelVariable(), ListVariable(length=34)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_APPEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=34), LazyVariableTracker()]
TRACE CALL_INTRINSIC_1 6 [NullVariable, TritonKernelVariable(), ListVariable(length=35)]
TRACE BUILD_MAP 0 [NullVariable, TritonKernelVariable(), TupleVariable(length=35)]
TRACE LOAD_CONST dropout_p [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:943 in forward (_attention.forward)
                dropout_p=0.0,
TRACE LOAD_CONST 0.0 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'dropout_p')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'dropout_p'), ConstantVariable(float: 0.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST philox_seed [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:944 in forward (_attention.forward)
                philox_seed=philox_seed,
TRACE LOAD_FAST philox_seed [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'philox_seed')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'philox_seed'), ConstantVariable(int: 114514)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST philox_offset_base [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:945 in forward (_attention.forward)
                philox_offset_base=philox_offset,
TRACE LOAD_FAST philox_offset [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'philox_offset_base')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'philox_offset_base'), ConstantVariable(int: 1919810)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST encoded_softmax [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:946 in forward (_attention.forward)
                encoded_softmax=encoded_softmax,
TRACE LOAD_FAST encoded_softmax [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'encoded_softmax')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'encoded_softmax'), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST HQ [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:947 in forward (_attention.forward)
                HQ=nheads_q,
TRACE LOAD_DEREF nheads_q [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'HQ')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'HQ'), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST HK [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:948 in forward (_attention.forward)
                HK=nheads_k,
TRACE LOAD_FAST nheads_k [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'HK')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'HK'), ConstantVariable(int: 8)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST ACTUAL_BLOCK_DMODEL [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:949 in forward (_attention.forward)
                ACTUAL_BLOCK_DMODEL=head_size,
TRACE LOAD_FAST head_size [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'ACTUAL_BLOCK_DMODEL')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'ACTUAL_BLOCK_DMODEL'), ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST MAX_SEQLENS_Q [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:950 in forward (_attention.forward)
                MAX_SEQLENS_Q=arg_max_seqlens_q,
TRACE LOAD_FAST arg_max_seqlens_q [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'MAX_SEQLENS_Q')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'MAX_SEQLENS_Q'), ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST MAX_SEQLENS_K [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:951 in forward (_attention.forward)
                MAX_SEQLENS_K=arg_max_seqlens_k,
TRACE LOAD_FAST arg_max_seqlens_k [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'MAX_SEQLENS_K')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'MAX_SEQLENS_K'), ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST IS_CAUSAL [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:952 in forward (_attention.forward)
                IS_CAUSAL=causal,
TRACE LOAD_FAST causal [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'IS_CAUSAL')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'IS_CAUSAL'), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST VARLEN [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:953 in forward (_attention.forward)
                VARLEN=True,
TRACE LOAD_CONST True [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'VARLEN')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'VARLEN'), ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST BLOCK_DMODEL [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:954 in forward (_attention.forward)
                BLOCK_DMODEL=padded_d_model,
TRACE LOAD_FAST padded_d_model [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BLOCK_DMODEL')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BLOCK_DMODEL'), ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST BIAS_TYPE [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:955 in forward (_attention.forward)
                BIAS_TYPE=0 if bias is None else 1,
TRACE LOAD_FAST bias [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE')]
TRACE LOAD_CONST None [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(NoneType: None)]
TRACE IS_OP 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 1130 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(bool: False)]
TRACE LOAD_CONST 0 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE')]
TRACE JUMP_FORWARD 1132 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(int: 0)]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST ENABLE_DROPOUT [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:956 in forward (_attention.forward)
                ENABLE_DROPOUT=False,
TRACE LOAD_CONST False [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'ENABLE_DROPOUT')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'ENABLE_DROPOUT'), ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST RETURN_ENCODED_SOFTMAX [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:957 in forward (_attention.forward)
                RETURN_ENCODED_SOFTMAX=False,
TRACE LOAD_CONST False [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'RETURN_ENCODED_SOFTMAX')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'RETURN_ENCODED_SOFTMAX'), ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST USE_FP8 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:958 in forward (_attention.forward)
                USE_FP8=use_fp8,
TRACE LOAD_FAST use_fp8 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8'), ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST USE_FP8_OUT [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:959 in forward (_attention.forward)
                USE_FP8_OUT=fp8_out_scale is not None,
TRACE LOAD_FAST fp8_out_scale [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8_OUT')]
TRACE LOAD_CONST None [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8_OUT'), ConstantVariable(NoneType: None)]
TRACE IS_OP 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8_OUT'), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8_OUT'), ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE CALL_FUNCTION_EX 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE inlined call <lambda> from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
                triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF max_seqlens_q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST META [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE LOAD_CONST BLOCK_M [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstDictVariable(), ConstantVariable(str: 'BLOCK_M')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
            triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
            ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 512)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 512)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 512)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 3)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [ConstantVariable(int: 512)]
TRACE BINARY_OP 0 [ConstantVariable(int: 512), ConstantVariable(int: 32)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 544)]
TRACE BINARY_OP 10 [ConstantVariable(int: 544), ConstantVariable(int: 1)]
TRACE LOAD_FAST y [ConstantVariable(int: 543)]
TRACE BINARY_OP 2 [ConstantVariable(int: 543), ConstantVariable(int: 32)]
TRACE RETURN_VALUE None [ConstantVariable(int: 16)]
DONE INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [ConstantVariable(int: 16)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 16)]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:895 in <lambda> (_attention.forward) (inline depth: 1)
                nheads_q,
TRACE LOAD_DEREF nheads_q [ConstantVariable(int: 16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:896 in <lambda> (_attention.forward) (inline depth: 1)
                batch,
TRACE LOAD_DEREF batch [ConstantVariable(int: 16), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE BUILD_TUPLE 3 [ConstantVariable(int: 16), ConstantVariable(int: 64), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [TupleVariable(length=3)]
DONE INLINING <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>
TRACE inlined call <lambda> from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
                triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF max_seqlens_q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST META [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE LOAD_CONST BLOCK_M [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstDictVariable(), ConstantVariable(str: 'BLOCK_M')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
            triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
            ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 512)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 512)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 512)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 3)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [ConstantVariable(int: 512)]
TRACE BINARY_OP 0 [ConstantVariable(int: 512), ConstantVariable(int: 32)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 544)]
TRACE BINARY_OP 10 [ConstantVariable(int: 544), ConstantVariable(int: 1)]
TRACE LOAD_FAST y [ConstantVariable(int: 543)]
TRACE BINARY_OP 2 [ConstantVariable(int: 543), ConstantVariable(int: 32)]
TRACE RETURN_VALUE None [ConstantVariable(int: 16)]
DONE INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [ConstantVariable(int: 16)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 16)]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:895 in <lambda> (_attention.forward) (inline depth: 1)
                nheads_q,
TRACE LOAD_DEREF nheads_q [ConstantVariable(int: 16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:896 in <lambda> (_attention.forward) (inline depth: 1)
                batch,
TRACE LOAD_DEREF batch [ConstantVariable(int: 16), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE BUILD_TUPLE 3 [ConstantVariable(int: 16), ConstantVariable(int: 64), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [TupleVariable(length=3)]
DONE INLINING <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>
TRACE inlined call <lambda> from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
                triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF max_seqlens_q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST META [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE LOAD_CONST BLOCK_M [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstDictVariable(), ConstantVariable(str: 'BLOCK_M')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
            triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
            ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 512)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 512)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 512)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 3)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [ConstantVariable(int: 512)]
TRACE BINARY_OP 0 [ConstantVariable(int: 512), ConstantVariable(int: 32)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 544)]
TRACE BINARY_OP 10 [ConstantVariable(int: 544), ConstantVariable(int: 1)]
TRACE LOAD_FAST y [ConstantVariable(int: 543)]
TRACE BINARY_OP 2 [ConstantVariable(int: 543), ConstantVariable(int: 32)]
TRACE RETURN_VALUE None [ConstantVariable(int: 16)]
DONE INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [ConstantVariable(int: 16)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 16)]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:895 in <lambda> (_attention.forward) (inline depth: 1)
                nheads_q,
TRACE LOAD_DEREF nheads_q [ConstantVariable(int: 16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:896 in <lambda> (_attention.forward) (inline depth: 1)
                batch,
TRACE LOAD_DEREF batch [ConstantVariable(int: 16), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE BUILD_TUPLE 3 [ConstantVariable(int: 16), ConstantVariable(int: 64), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [TupleVariable(length=3)]
DONE INLINING <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>
TRACE inlined call <lambda> from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
                triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF max_seqlens_q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST META [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE LOAD_CONST BLOCK_M [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstDictVariable(), ConstantVariable(str: 'BLOCK_M')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
            triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
            ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 512)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 512), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 512)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 512)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 3)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [ConstantVariable(int: 512)]
TRACE BINARY_OP 0 [ConstantVariable(int: 512), ConstantVariable(int: 32)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 544)]
TRACE BINARY_OP 10 [ConstantVariable(int: 544), ConstantVariable(int: 1)]
TRACE LOAD_FAST y [ConstantVariable(int: 543)]
TRACE BINARY_OP 2 [ConstantVariable(int: 543), ConstantVariable(int: 32)]
TRACE RETURN_VALUE None [ConstantVariable(int: 16)]
DONE INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [ConstantVariable(int: 16)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 16)]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:895 in <lambda> (_attention.forward) (inline depth: 1)
                nheads_q,
TRACE LOAD_DEREF nheads_q [ConstantVariable(int: 16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:896 in <lambda> (_attention.forward) (inline depth: 1)
                batch,
TRACE LOAD_DEREF batch [ConstantVariable(int: 16), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE BUILD_TUPLE 3 [ConstantVariable(int: 16), ConstantVariable(int: 64), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [TupleVariable(length=3)]
DONE INLINING <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>
wrap_to_fake L['cu_seqlens_k'] (2,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='cu_seqlens_k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_cu_seqlens_k_ L['cu_seqlens_k'] FakeTensor(..., device='cuda:0', size=(2,), dtype=torch.int32) at debug_level 0 before=False
TRACE FX call triton_kernel_wrapper_mutation from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
TRACE POP_TOP None [ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:962 in forward (_attention.forward)
            return o, encoded_softmax
TRACE LOAD_FAST o []
TRACE LOAD_FAST encoded_softmax [TensorVariable()]
TRACE BUILD_TUPLE 2 [TensorVariable(), ConstantVariable(NoneType: None)]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
Step 1: torchdynamo done tracing forward (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py, line 962 in forward>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_19_b5d1c80d_4f36_431b_a6e5_41f7b3ab5ffb =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, L_o_: "[31mbf16[0m[34m[512, 64, 128][0m[2m[34m[8192, 128, 1][0m[2m[32mcuda:0[0m", L_q_: "[31mbf16[0m[34m[512, 64, 128][0m[2m[34m[8192, 128, 1][0m[2m[32mcuda:0[0m", s37: "Sym(s37)", L_k_: "[31mbf16[0m[34m[s37, 8, 128][0m[2m[34m[1024, 128, 1][0m[2m[32mcuda:0[0m", L_cu_seqlens_q_: "[31mi32[0m[34m[2][0m[2m[34m[1][0m[2m[32mcuda:0[0m", s33: "Sym(s33)", L_v_: "[31mbf16[0m[34m[s33, 8, 128][0m[2m[34m[1024, 128, 1][0m[2m[32mcuda:0[0m", L_cu_seqlens_k_: "[31mi32[0m[34m[2][0m[2m[34m[1][0m[2m[32mcuda:0[0m"):
        l_o_ = L_o_
        l_q_ = L_q_
        l_k_ = L_k_
        l_cu_seqlens_q_ = L_cu_seqlens_q_
        l_v_ = L_v_
        l_cu_seqlens_k_ = L_cu_seqlens_k_
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward, code: attn_fwd[grid]([0m
        triton_kernel_wrapper_mutation = torch.ops.higher_order.triton_kernel_wrapper_mutation(kernel_idx = [34m1[0m, constant_args_idx = [34m3[0m, grid = [([34m16[0m, [34m64[0m, [34m1[0m), ([34m16[0m, [34m64[0m, [34m1[0m), ([34m16[0m, [34m64[0m, [34m1[0m), ([34m16[0m, [34m64[0m, [34m1[0m)], tma_descriptor_metadata = [34m{}[0m, kwargs = [34m{'Q': l_q_, 'K': l_k_, 'V': l_v_, 'Out': l_o_, 'cu_seqlens_q': l_cu_seqlens_q_, 'cu_seqlens_k': l_cu_seqlens_k_}[0m);  [2ml_q_ = l_k_ = l_v_ = l_o_ = l_cu_seqlens_q_ = l_cu_seqlens_k_ = triton_kernel_wrapper_mutation = None[0m
        return ()
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing hxa079_TimeMix /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:524
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:524 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7)
        @torch.compile
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:550 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            x = T5RMSNorm(x_in,ln1,variance_epsilon=rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST x_in [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE KW_NAMES ('variance_epsilon',) [NullVariable, LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:550 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        x = T5RMSNorm(x_in,ln1,variance_epsilon=rmsnorm_epsilon)
            ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
automatic dynamic size L['x_in'] size(1) 128 != 512
wrap_to_fake L['x_in'] (1, 128, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='x_in', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_x_in_ L['x_in'] FakeTensor(..., device='cuda:0', size=(1, s52, 5120), dtype=torch.bfloat16) at debug_level 0 before=False
create_graph_input s52 L['x_in'].size()[1] s52 at debug_level 0 before=True
_lift_symbols_in_symint s52 from L['x_in'].size()[1] at debug_level 0
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE FX call add from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln1'] (5120,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln1', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln1_ L['ln1'] FakeTensor(..., device='cuda:0', size=(5120,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:551 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            xw,xa,xv,xg,xk = (x @ wavgk1).split(wavgk_split_list, dim=-1)
TRACE LOAD_FAST x []
TRACE LOAD_FAST wavgk1 [TensorVariable()]
TRACE BINARY_OP 4 [TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['wavgk1'] (5120, 1376) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='wavgk1', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_wavgk1_ L['wavgk1'] FakeTensor(..., device='cuda:0', size=(5120, 1376), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call matmul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:551 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xw,xa,xv,xg,xk = (x @ wavgk1).split(wavgk_split_list, dim=-1)
                          ~~^~~~~~~~
TRACE LOAD_ATTR split [TensorVariable()]
TRACE LOAD_FAST wavgk_split_list [NullVariable, GetAttrVariable(TensorVariable(), split)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker()]
TRACE KW_NAMES ('dim',) [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE FX call split from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:551 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xw,xa,xv,xg,xk = (x @ wavgk1).split(wavgk_split_list, dim=-1)
                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE UNPACK_SEQUENCE 5 [TupleVariable(length=5)]
TRACE STORE_FAST xw [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST xa [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST xv [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST xg [TensorVariable(), TensorVariable()]
TRACE STORE_FAST xk [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:553 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            B, T, HN = x.shape
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE FX call size from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:553 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        B, T, HN = x.shape
                   ^^^^^^^
TRACE UNPACK_SEQUENCE 3 [SizeVariable(length=3)]
TRACE STORE_FAST B [ConstantVariable(int: 5120), SymNodeVariable(), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 5120), SymNodeVariable()]
TRACE STORE_FAST HN [ConstantVariable(int: 5120)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:555 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            rkv = fpx_matmul(x, RKV_,RKV_state, ebits, mbits)
TRACE LOAD_GLOBAL fpx_matmul []
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST RKV_ [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST RKV_state [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_FAST ebits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST mbits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call fpx_matmul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:555 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        rkv = fpx_matmul(x, RKV_,RKV_state, ebits, mbits)
              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object fpx_matmul at 0x3063a810, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:420 in fpx_matmul (fpx_matmul) (inline depth: 1)
    def fpx_matmul(x,weight,weight_state,ebits:int=3,mbits:int=2):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:421 in fpx_matmul (fpx_matmul) (inline depth: 1)
        if ebits == -44: #hqq
TRACE LOAD_FAST ebits []
TRACE LOAD_CONST -44 [LazyVariableTracker()]
TRACE COMPARE_OP == [LazyVariableTracker(), ConstantVariable(int: -44)]
TRACE POP_JUMP_IF_FALSE 322 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S0=x.shape[0]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE FX call size_1 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul) (inline depth: 1)
        S0=x.shape[0]
           ^^^^^^^
TRACE LOAD_CONST 0 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 0)]
TRACE STORE_FAST S0 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S1=x.shape[1]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE FX call size_2 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul) (inline depth: 1)
        S1=x.shape[1]
           ^^^^^^^
TRACE LOAD_CONST 1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 1)]
TRACE STORE_FAST S1 [SymNodeVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:424 in fpx_matmul (fpx_matmul) (inline depth: 1)
            dtype = x.dtype
TRACE LOAD_FAST x []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
            x = x.to(dtype=torch.float16).view(-1,x.shape[2])
TRACE LOAD_FAST x []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float16 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_2 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST x [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1)]
TRACE LOAD_ATTR shape [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), TensorVariable()]
TRACE FX call size_3 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
                                              ^^^^^^^
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3), ConstantVariable(int: 2)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), ConstantVariable(int: 5120)]
TRACE FX call view from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
            out = weight.forward_manual(x).to(dtype=dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_ATTR forward_manual [LazyVariableTracker()]
TRACE LOAD_FAST x [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE CALL 1 [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton)), TensorVariable()]
TRACE inlined call forward_manual from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:543 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        def forward_manual(self, x: Tensor, matmul_type: str="GEMM") -> Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE LOAD_GLOBAL forward_functional []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:545 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                x,
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:546 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.bias,
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR bias [NullVariable, LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_tensor_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_ATTR get_tensor_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_tensor_args at 0x70c98a9e9080>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_tensor_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_tensor_args(),
            ~~~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:524 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
        def get_tensor_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:525 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
            return [self.W_q, self.scales, self.zeros]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR W_q [UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_FAST self [LazyVariableTracker()]
TRACE LOAD_ATTR scales [LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['RKV_']._parameters['scales'] (80, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='RKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='scales'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_RKV_parameters_scales_ L['RKV_']._parameters['scales'] Parameter(FakeTensor(..., device='cuda:0', size=(80, 10240), dtype=torch.float16)) at debug_level 0 before=False
TRACE LOAD_FAST self [LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR zeros [LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['RKV_']._parameters['zeros'] (80, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='RKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='zeros'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_RKV_parameters_zeros_ L['RKV_']._parameters['zeros'] Parameter(FakeTensor(..., device='cuda:0', size=(80, 10240), dtype=torch.float16)) at debug_level 0 before=False
TRACE BUILD_LIST 3 [LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [ListVariable(length=3)]
DONE INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_meta_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3)]
TRACE LOAD_ATTR get_meta_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_meta_args at 0x70c98a9e9120>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_meta_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_meta_args(),
            ~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:527 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
        def get_meta_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE LOAD_GLOBAL int []
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR scaled_activations [NullVariable, LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:529 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_nbits,
TRACE LOAD_FAST self [ConstantVariable(int: 0)]
TRACE LOAD_ATTR W_nbits [ConstantVariable(int: 0), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:530 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.group_size,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker()]
TRACE LOAD_ATTR group_size [ConstantVariable(int: 0), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:531 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.unpack_mask,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR unpack_mask [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:532 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.elements_per_sample,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR elements_per_sample [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:533 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.input_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR input_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:534 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.output_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR output_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:535 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.acc_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR acc_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:536 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.meta_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR meta_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:537 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.channel_scale_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR channel_scale_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:538 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_group_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR W_group_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:539 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    int(self.data_contiguous),
TRACE LOAD_GLOBAL int [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int)]
TRACE LOAD_ATTR data_contiguous [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE BUILD_LIST 12 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [ListVariable(length=12)]
DONE INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:549 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
TRACE LOAD_GLOBAL GEMLITE_MATMUL_TYPES_MAPPING [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12)]
TRACE LOAD_FAST matmul_type [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker(), ConstantVariable(str: 'GEMM')]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        return forward_functional(
               ~~~~~~~~~~~~~~~~~~^
            x,
            ^^
            self.bias,
            ^^^^^^^^^^
            self.get_tensor_args(),
            ^^^^^^^^^^^^^^^^^^^^^^^
            self.get_meta_args(),
            ^^^^^^^^^^^^^^^^^^^^^
            GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:675 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        def __call__(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
            return self._opoverload(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR _opoverload [NullVariable, UserDefinedObjectVariable(CustomOpDef)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=5)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
wrap_to_fake L['RKV_'].W_q (640, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=AttrSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='RKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='W_q'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_RKV_W_q L['RKV_'].W_q FakeTensor(..., device='cuda:0', size=(640, 10240), dtype=torch.int32) at debug_level 0 before=False
TRACE FX call forward_functional_default from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        return self._opoverload(*args, **kwargs)
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_3 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE STORE_FAST out [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
            return out.view(S0,S1,-1)
TRACE LOAD_FAST out []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST S0 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST S1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: -1)]
TRACE FX call view_1 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
        return out.view(S0,S1,-1)
               ~~~~~~~~^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object fpx_matmul at 0x3063a810, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>
TRACE STORE_FAST rkv [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:556 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            r,k,v = rkv.split(rkv_split_list,dim=-1)
TRACE LOAD_FAST rkv []
TRACE LOAD_ATTR split [TensorVariable()]
TRACE LOAD_FAST rkv_split_list [NullVariable, GetAttrVariable(TensorVariable(), split)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker()]
TRACE KW_NAMES ('dim',) [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE FX call split_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:556 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        r,k,v = rkv.split(rkv_split_list,dim=-1)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
TRACE UNPACK_SEQUENCE 3 [TupleVariable(length=3)]
TRACE STORE_FAST r [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST k [TensorVariable(), TensorVariable()]
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:558 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            kv_dim = k.shape[2] # B,T,kv_dim
TRACE LOAD_FAST k []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE FX call size_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:558 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        kv_dim = k.shape[2] # B,T,kv_dim
                 ^^^^^^^
TRACE LOAD_CONST 2 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 2)]
TRACE STORE_FAST kv_dim [ConstantVariable(int: 1024)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:559 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            kv_repeat = H*N // kv_dim
TRACE LOAD_FAST H []
TRACE LOAD_FAST N [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST kv_dim [ConstantVariable(int: 8192)]
TRACE BINARY_OP 2 [ConstantVariable(int: 8192), ConstantVariable(int: 1024)]
TRACE STORE_FAST kv_repeat [ConstantVariable(int: 8)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:560 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            kv_per_head = kv_dim // N
TRACE LOAD_FAST kv_dim []
TRACE LOAD_FAST N [ConstantVariable(int: 1024)]
TRACE BINARY_OP 2 [ConstantVariable(int: 1024), ConstantVariable(int: 128)]
TRACE STORE_FAST kv_per_head [ConstantVariable(int: 8)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:562 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            r = r.add_(R_bias)
TRACE LOAD_FAST r []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST R_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
wrap_to_fake L['R_bias'] () StatefulSymbolicContext(dynamic_sizes=[], dynamic_strides=[], constraint_sizes=[], constraint_strides=[], specialize_on=[], view_base_context=None, tensor_source=LocalSource(local_name='R_bias', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_R_bias_ L['R_bias'] FakeTensor(..., device='cuda:0', size=(), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call add_ from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:562 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        r = r.add_(R_bias)
            ~~~~~~^^^^^^^^
TRACE STORE_FAST r [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:563 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = k.add_(K_bias).view(B, T, kv_per_head, N)
TRACE LOAD_FAST k []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST K_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
TRACE FX call add__1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:563 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = k.add_(K_bias).view(B, T, kv_per_head, N)
            ~~~~~~^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_per_head [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:563 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = k.add_(K_bias).view(B, T, kv_per_head, N)
            ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:564 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            v = v.add_(V_bias).view(B, T, kv_per_head, N)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST V_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
TRACE FX call add__2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:564 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        v = v.add_(V_bias).view(B, T, kv_per_head, N)
            ~~~~~~^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_per_head [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:564 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        v = v.add_(V_bias).view(B, T, kv_per_head, N)
            ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:568 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            if ln_r is None:
TRACE LOAD_FAST ln_r []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
wrap_to_fake L['ln_r'] (128,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln_r', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln_r_ L['ln_r'] FakeTensor(..., device='cuda:0', size=(128,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE POP_JUMP_IF_TRUE 478 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:572 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
                r = T5RMSNorm(r.view(B,T,H,N), ln_r, variance_epsilon=rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST r [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR view [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:572 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            r = T5RMSNorm(r.view(B,T,H,N), ln_r, variance_epsilon=rmsnorm_epsilon)
                          ~~~~~~^^^^^^^^^
TRACE LOAD_FAST ln_r [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE KW_NAMES ('variance_epsilon',) [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:572 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            r = T5RMSNorm(r.view(B,T,H,N), ln_r, variance_epsilon=rmsnorm_epsilon)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST r [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:573 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
                k = T5RMSNorm(k, ln_k, variance_epsilon=rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln_k [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE KW_NAMES ('variance_epsilon',) [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ConstantVariable(float: 1e-06)]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:573 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = T5RMSNorm(k, ln_k, variance_epsilon=rmsnorm_epsilon)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln_k'] (128,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln_k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln_k_ L['ln_k'] FakeTensor(..., device='cuda:0', size=(128,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:576 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            cos, sin = calc_cos.to(k.dtype), calc_sin.to(k.dtype)
TRACE LOAD_FAST calc_cos []
TRACE LOAD_ATTR to [LazyVariableTracker()]
automatic dynamic size L['calc_cos'] size(1) 128 != 512
wrap_to_fake L['calc_cos'] (1, 128, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='calc_cos', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_calc_cos_ L['calc_cos'] FakeTensor(..., device='cuda:0', size=(1, s22, 128)) at debug_level 0 before=False
create_graph_input s22 L['calc_cos'].size()[1] s22 at debug_level 0 before=True
_lift_symbols_in_symint s22 from L['calc_cos'].size()[1] at debug_level 0
TRACE LOAD_FAST k [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR dtype [NullVariable, GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_8 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:576 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        cos, sin = calc_cos.to(k.dtype), calc_sin.to(k.dtype)
                   ~~~~~~~~~~~^^^^^^^^^
TRACE LOAD_FAST calc_sin [TensorVariable()]
TRACE LOAD_ATTR to [TensorVariable(), LazyVariableTracker()]
automatic dynamic size L['calc_sin'] size(1) 128 != 512
wrap_to_fake L['calc_sin'] (1, 128, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='calc_sin', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_calc_sin_ L['calc_sin'] FakeTensor(..., device='cuda:0', size=(1, s83, 128)) at debug_level 0 before=False
create_graph_input s83 L['calc_sin'].size()[1] s83 at debug_level 0 before=True
_lift_symbols_in_symint s83 from L['calc_sin'].size()[1] at debug_level 0
TRACE LOAD_FAST k [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR dtype [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE CALL 1 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_9 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:576 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        cos, sin = calc_cos.to(k.dtype), calc_sin.to(k.dtype)
                                         ~~~~~~~~~~~^^^^^^^^^
TRACE STORE_FAST sin [TensorVariable(), TensorVariable()]
TRACE STORE_FAST cos [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:577 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            r, k = apply_rotary_pos_emb(r, k, cos, sin,unsqueeze_dim=2)
TRACE LOAD_GLOBAL apply_rotary_pos_emb []
TRACE LOAD_FAST r [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST cos [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST sin [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE KW_NAMES ('unsqueeze_dim',) [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(int: 2)]
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(int: 2)]
TRACE inlined call apply_rotary_pos_emb from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:577 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        r, k = apply_rotary_pos_emb(r, k, cos, sin,unsqueeze_dim=2)
               ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object apply_rotary_pos_emb at 0x70c98a344710, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 473>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:473 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    def apply_rotary_pos_emb(q, k, cos, sin, position_ids=None, unsqueeze_dim=1):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:493 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
        cos = cos.unsqueeze(unsqueeze_dim)
TRACE LOAD_FAST cos []
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_FAST unsqueeze_dim [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int: 2)]
TRACE FX call unsqueeze from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:493 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    cos = cos.unsqueeze(unsqueeze_dim)
          ~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST cos [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:494 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
        sin = sin.unsqueeze(unsqueeze_dim)
TRACE LOAD_FAST sin []
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_FAST unsqueeze_dim [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int: 2)]
TRACE FX call unsqueeze_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:494 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    sin = sin.unsqueeze(unsqueeze_dim)
          ~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST sin [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
        q_embed = (q * cos) + (rotate_half(q) * sin)
TRACE LOAD_FAST q []
TRACE LOAD_FAST cos [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    q_embed = (q * cos) + (rotate_half(q) * sin)
               ~~^~~~~
TRACE LOAD_GLOBAL rotate_half [TensorVariable()]
TRACE LOAD_FAST q [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE inlined call rotate_half from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    q_embed = (q * cos) + (rotate_half(q) * sin)
                           ~~~~~~~~~~~^^^
INLINING <code object rotate_half at 0x70c98a344450, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 467>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:467 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    def rotate_half(x):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
        x1 = x[..., : x.shape[-1] // 2]
TRACE LOAD_FAST x []
TRACE LOAD_CONST Ellipsis [TensorVariable()]
TRACE LOAD_CONST None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis)]
TRACE LOAD_FAST x [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None)]
TRACE LOAD_ATTR shape [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), TensorVariable()]
TRACE FX call size_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    x1 = x[..., : x.shape[-1] // 2]
                  ^^^^^^^
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), SizeVariable(length=4)]
TRACE BINARY_SUBSCR None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), SizeVariable(length=4), ConstantVariable(int: -1)]
TRACE LOAD_CONST 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), ConstantVariable(int: 128)]
TRACE BINARY_OP 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), ConstantVariable(int: 128), ConstantVariable(int: 2)]
TRACE BUILD_SLICE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), ConstantVariable(int: 64)]
TRACE BUILD_TUPLE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SliceVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), TupleVariable(length=2)]
TRACE FX call getitem_27 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    x1 = x[..., : x.shape[-1] // 2]
         ~^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST x1 [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
        x2 = x[..., x.shape[-1] // 2 :]
TRACE LOAD_FAST x []
TRACE LOAD_CONST Ellipsis [TensorVariable()]
TRACE LOAD_FAST x [TensorVariable(), ConstantVariable(ellipsis: Ellipsis)]
TRACE LOAD_ATTR shape [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), TensorVariable()]
TRACE FX call size_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    x2 = x[..., x.shape[-1] // 2 :]
                ^^^^^^^
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SizeVariable(length=4)]
TRACE BINARY_SUBSCR None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SizeVariable(length=4), ConstantVariable(int: -1)]
TRACE LOAD_CONST 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 128)]
TRACE BINARY_OP 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 128), ConstantVariable(int: 2)]
TRACE LOAD_CONST None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 64)]
TRACE BUILD_SLICE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 64), ConstantVariable(NoneType: None)]
TRACE BUILD_TUPLE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SliceVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), TupleVariable(length=2)]
TRACE FX call getitem_32 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    x2 = x[..., x.shape[-1] // 2 :]
         ~^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST x2 [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
        return torch.cat((-x2, x1), dim=-1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST x2 [NullVariable, LazyVariableTracker()]
TRACE UNARY_NEGATIVE None [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call neg from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    return torch.cat((-x2, x1), dim=-1)
                      ^^^
TRACE LOAD_FAST x1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, LazyVariableTracker(), TupleVariable(length=2)]
TRACE KW_NAMES ('dim',) [NullVariable, LazyVariableTracker(), TupleVariable(length=2), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TupleVariable(length=2), ConstantVariable(int: -1)]
TRACE FX call cat from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    return torch.cat((-x2, x1), dim=-1)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object rotate_half at 0x70c98a344450, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 467>
TRACE LOAD_FAST sin [TensorVariable(), TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call mul_7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    q_embed = (q * cos) + (rotate_half(q) * sin)
                           ~~~~~~~~~~~~~~~^~~~~
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable()]
TRACE FX call add_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    q_embed = (q * cos) + (rotate_half(q) * sin)
              ~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST q_embed [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
        k_embed = (k * cos) + (rotate_half(k) * sin)
TRACE LOAD_FAST k []
TRACE LOAD_FAST cos [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_8 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    k_embed = (k * cos) + (rotate_half(k) * sin)
               ~~^~~~~
TRACE LOAD_GLOBAL rotate_half [TensorVariable()]
TRACE LOAD_FAST k [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE inlined call rotate_half from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    k_embed = (k * cos) + (rotate_half(k) * sin)
                           ~~~~~~~~~~~^^^
INLINING <code object rotate_half at 0x70c98a344450, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 467>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:467 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    def rotate_half(x):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
        x1 = x[..., : x.shape[-1] // 2]
TRACE LOAD_FAST x []
TRACE LOAD_CONST Ellipsis [TensorVariable()]
TRACE LOAD_CONST None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis)]
TRACE LOAD_FAST x [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None)]
TRACE LOAD_ATTR shape [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), TensorVariable()]
TRACE FX call size_7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    x1 = x[..., : x.shape[-1] // 2]
                  ^^^^^^^
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), SizeVariable(length=4)]
TRACE BINARY_SUBSCR None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), SizeVariable(length=4), ConstantVariable(int: -1)]
TRACE LOAD_CONST 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), ConstantVariable(int: 128)]
TRACE BINARY_OP 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), ConstantVariable(int: 128), ConstantVariable(int: 2)]
TRACE BUILD_SLICE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), ConstantVariable(int: 64)]
TRACE BUILD_TUPLE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SliceVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), TupleVariable(length=2)]
TRACE FX call getitem_37 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    x1 = x[..., : x.shape[-1] // 2]
         ~^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST x1 [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
        x2 = x[..., x.shape[-1] // 2 :]
TRACE LOAD_FAST x []
TRACE LOAD_CONST Ellipsis [TensorVariable()]
TRACE LOAD_FAST x [TensorVariable(), ConstantVariable(ellipsis: Ellipsis)]
TRACE LOAD_ATTR shape [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), TensorVariable()]
TRACE FX call size_8 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    x2 = x[..., x.shape[-1] // 2 :]
                ^^^^^^^
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SizeVariable(length=4)]
TRACE BINARY_SUBSCR None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SizeVariable(length=4), ConstantVariable(int: -1)]
TRACE LOAD_CONST 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 128)]
TRACE BINARY_OP 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 128), ConstantVariable(int: 2)]
TRACE LOAD_CONST None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 64)]
TRACE BUILD_SLICE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 64), ConstantVariable(NoneType: None)]
TRACE BUILD_TUPLE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SliceVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), TupleVariable(length=2)]
TRACE FX call getitem_42 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    x2 = x[..., x.shape[-1] // 2 :]
         ~^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST x2 [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
        return torch.cat((-x2, x1), dim=-1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST x2 [NullVariable, LazyVariableTracker()]
TRACE UNARY_NEGATIVE None [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call neg_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    return torch.cat((-x2, x1), dim=-1)
                      ^^^
TRACE LOAD_FAST x1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, LazyVariableTracker(), TupleVariable(length=2)]
TRACE KW_NAMES ('dim',) [NullVariable, LazyVariableTracker(), TupleVariable(length=2), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TupleVariable(length=2), ConstantVariable(int: -1)]
TRACE FX call cat_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    return torch.cat((-x2, x1), dim=-1)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object rotate_half at 0x70c98a344450, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 467>
TRACE LOAD_FAST sin [TensorVariable(), TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call mul_9 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    k_embed = (k * cos) + (rotate_half(k) * sin)
                           ~~~~~~~~~~~~~~~^~~~~
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable()]
TRACE FX call add_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    k_embed = (k * cos) + (rotate_half(k) * sin)
              ~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST k_embed [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:497 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
        return q_embed, k_embed
TRACE LOAD_FAST q_embed []
TRACE LOAD_FAST k_embed [TensorVariable()]
TRACE BUILD_TUPLE 2 [TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object apply_rotary_pos_emb at 0x70c98a344710, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 473>
TRACE UNPACK_SEQUENCE 2 [TupleVariable(length=2)]
TRACE STORE_FAST r [TensorVariable(), TensorVariable()]
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:579 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            if layer_id == 0:
TRACE LOAD_FAST layer_id []
TRACE LOAD_CONST 0 [LazyVariableTracker()]
TRACE COMPARE_OP == [LazyVariableTracker(), ConstantVariable(int: 0)]
create_graph_input L_layer_id_ L['layer_id'] s56 at debug_level 0 before=False
TRACE FX call eq from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:579 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        if layer_id == 0:
           ^^^^^^^^^^^^^
TRACE POP_JUMP_IF_FALSE 736 [SymNodeVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:580 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
                v_first = v
TRACE LOAD_FAST v []
TRACE STORE_FAST v_first [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:581 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
                k_first = k
TRACE LOAD_FAST k []
TRACE STORE_FAST k_first [TensorVariable()]
TRACE JUMP_FORWARD 952 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:589 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = repeat_kv(k, kv_repeat).view(B, T, -1)
TRACE LOAD_GLOBAL repeat_kv []
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST kv_repeat [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 8)]
TRACE inlined call repeat_kv from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:589 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = repeat_kv(k, kv_repeat).view(B, T, -1)
            ~~~~~~~~~^^^^^^^^^^^^^^
INLINING <code object repeat_kv at 0x70c98a2f25b0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 347>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:347 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    def repeat_kv(hidden_states: torch.Tensor, n_rep: int) -> torch.Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:353 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        B, T, H_kv, D = hidden_states.shape
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE FX call size_9 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:353 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    B, T, H_kv, D = hidden_states.shape
                    ^^^^^^^^^^^^^^^^^^^
TRACE UNPACK_SEQUENCE 4 [SizeVariable(length=4)]
TRACE STORE_FAST B [ConstantVariable(int: 128), ConstantVariable(int: 8), SymNodeVariable(), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 128), ConstantVariable(int: 8), SymNodeVariable()]
TRACE STORE_FAST H_kv [ConstantVariable(int: 128), ConstantVariable(int: 8)]
TRACE STORE_FAST D [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:354 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        if n_rep == 1:
TRACE LOAD_FAST n_rep []
TRACE LOAD_CONST 1 [ConstantVariable(int: 8)]
TRACE COMPARE_OP == [ConstantVariable(int: 8), ConstantVariable(int: 1)]
TRACE POP_JUMP_IF_FALSE 50 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:357 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        hidden_states = hidden_states[:, :, :, None, :]  # (B, T, H_kv, 1, D)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_CONST None [TensorVariable()]
TRACE LOAD_CONST None [TensorVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable()]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable()]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable()]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE BUILD_TUPLE 5 [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), SliceVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), TupleVariable(length=5)]
TRACE FX call getitem_47 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:357 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    hidden_states = hidden_states[:, :, :, None, :]  # (B, T, H_kv, 1, D)
                    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:358 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        hidden_states = hidden_states.expand(B, T, H_kv, n_rep, D)  # (B, T, H_kv, n_rep, D)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR expand [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), expand)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1)]
TRACE LOAD_FAST H_kv [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST n_rep [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8)]
TRACE LOAD_FAST D [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8), ConstantVariable(int: 8)]
TRACE CALL 5 [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call expand from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:358 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    hidden_states = hidden_states.expand(B, T, H_kv, n_rep, D)  # (B, T, H_kv, n_rep, D)
                    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR reshape [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), reshape)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1)]
TRACE LOAD_FAST H_kv [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST n_rep [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8)]
TRACE BINARY_OP 5 [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8), ConstantVariable(int: 8)]
TRACE LOAD_FAST D [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call reshape from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR contiguous [TensorVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE FX call contiguous from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object repeat_kv at 0x70c98a2f25b0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 347>
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: -1)]
TRACE FX call view_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:589 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = repeat_kv(k, kv_repeat).view(B, T, -1)
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:590 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            v = repeat_kv(v, kv_repeat).view(B, T, -1)
TRACE LOAD_GLOBAL repeat_kv []
TRACE LOAD_FAST v [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST kv_repeat [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 8)]
TRACE inlined call repeat_kv from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:590 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        v = repeat_kv(v, kv_repeat).view(B, T, -1)
            ~~~~~~~~~^^^^^^^^^^^^^^
INLINING <code object repeat_kv at 0x70c98a2f25b0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 347>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:347 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    def repeat_kv(hidden_states: torch.Tensor, n_rep: int) -> torch.Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:353 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        B, T, H_kv, D = hidden_states.shape
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE FX call size_10 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:353 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    B, T, H_kv, D = hidden_states.shape
                    ^^^^^^^^^^^^^^^^^^^
TRACE UNPACK_SEQUENCE 4 [SizeVariable(length=4)]
TRACE STORE_FAST B [ConstantVariable(int: 128), ConstantVariable(int: 8), SymNodeVariable(), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 128), ConstantVariable(int: 8), SymNodeVariable()]
TRACE STORE_FAST H_kv [ConstantVariable(int: 128), ConstantVariable(int: 8)]
TRACE STORE_FAST D [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:354 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        if n_rep == 1:
TRACE LOAD_FAST n_rep []
TRACE LOAD_CONST 1 [ConstantVariable(int: 8)]
TRACE COMPARE_OP == [ConstantVariable(int: 8), ConstantVariable(int: 1)]
TRACE POP_JUMP_IF_FALSE 50 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:357 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        hidden_states = hidden_states[:, :, :, None, :]  # (B, T, H_kv, 1, D)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_CONST None [TensorVariable()]
TRACE LOAD_CONST None [TensorVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable()]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable()]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable()]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE BUILD_TUPLE 5 [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), SliceVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), TupleVariable(length=5)]
TRACE FX call getitem_52 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:357 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    hidden_states = hidden_states[:, :, :, None, :]  # (B, T, H_kv, 1, D)
                    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:358 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        hidden_states = hidden_states.expand(B, T, H_kv, n_rep, D)  # (B, T, H_kv, n_rep, D)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR expand [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), expand)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1)]
TRACE LOAD_FAST H_kv [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST n_rep [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8)]
TRACE LOAD_FAST D [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8), ConstantVariable(int: 8)]
TRACE CALL 5 [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call expand_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:358 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    hidden_states = hidden_states.expand(B, T, H_kv, n_rep, D)  # (B, T, H_kv, n_rep, D)
                    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR reshape [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), reshape)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1)]
TRACE LOAD_FAST H_kv [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST n_rep [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8)]
TRACE BINARY_OP 5 [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8), ConstantVariable(int: 8)]
TRACE LOAD_FAST D [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call reshape_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR contiguous [TensorVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE FX call contiguous_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object repeat_kv at 0x70c98a2f25b0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 347>
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: -1)]
TRACE FX call view_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:590 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        v = repeat_kv(v, kv_repeat).view(B, T, -1)
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:593 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            a = torch.sigmoid(xa @ a2 + a0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR sigmoid [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST xa [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST a2 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 4 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['a2'] (160, 8192) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='a2', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_a2_ L['a2'] FakeTensor(..., device='cuda:0', size=(160, 8192), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call matmul_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:593 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        a = torch.sigmoid(xa @ a2 + a0)
                          ~~~^~~~
TRACE LOAD_FAST a0 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['a0'] (1, 1, 8192) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='a0', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_a0_ L['a0'] FakeTensor(..., device='cuda:0', size=(1, 1, 8192), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call add_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:593 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        a = torch.sigmoid(xa @ a2 + a0)
                          ~~~~~~~~^~~~
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call sigmoid from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:593 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        a = torch.sigmoid(xa @ a2 + a0)
            ~~~~~~~~~~~~~^^^^^^^^^^^^^^
TRACE STORE_FAST a [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:595 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            kk = F.normalize(k.view(B, T, H, N), p=2.0, dim=-1).view(B, T, H*N)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR normalize [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR view [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:595 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        kk = F.normalize(k.view(B, T, H, N), p=2.0, dim=-1).view(B, T, H*N)
                         ~~~~~~^^^^^^^^^^^^
TRACE LOAD_CONST 2.0 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 2.0)]
TRACE KW_NAMES ('p', 'dim') [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 2.0), ConstantVariable(int: -1)]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 2.0), ConstantVariable(int: -1)]
TRACE FX call normalize from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:595 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        kk = F.normalize(k.view(B, T, H, N), p=2.0, dim=-1).view(B, T, H*N)
             ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64)]
TRACE BINARY_OP 5 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8192)]
TRACE FX call view_8 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:595 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        kk = F.normalize(k.view(B, T, H, N), p=2.0, dim=-1).view(B, T, H*N)
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
TRACE STORE_FAST kk [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:596 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            w = torch.tanh(xw) @ w2 + w0
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR tanh [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST xw [NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call tanh from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:596 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = torch.tanh(xw) @ w2 + w0
            ~~~~~~~~~~^^^^
TRACE LOAD_FAST w2 [TensorVariable()]
TRACE BINARY_OP 4 [TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['w2'] (480, 8192) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='w2', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_w2_ L['w2'] FakeTensor(..., device='cuda:0', size=(480, 8192), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call matmul_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:596 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = torch.tanh(xw) @ w2 + w0
            ~~~~~~~~~~~~~~~^~~~
TRACE LOAD_FAST w0 [TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['w0'] (1, 1, 8192) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='w0', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_w0_ L['w0'] FakeTensor(..., device='cuda:0', size=(1, 1, 8192), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call add_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:596 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = torch.tanh(xw) @ w2 + w0
            ~~~~~~~~~~~~~~~~~~~~^~~~
TRACE STORE_FAST w [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:597 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            w = -F.softplus(-w) - 0.5
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR softplus [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST w [NullVariable, LazyVariableTracker()]
TRACE UNARY_NEGATIVE None [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call neg_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:597 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = -F.softplus(-w) - 0.5
                        ^^
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call softplus from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:597 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = -F.softplus(-w) - 0.5
             ~~~~~~~~~~^^^^
TRACE UNARY_NEGATIVE None [TensorVariable()]
TRACE FX call neg_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:597 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = -F.softplus(-w) - 0.5
            ^^^^^^^^^^^^^^^
TRACE LOAD_CONST 0.5 [TensorVariable()]
TRACE BINARY_OP 10 [TensorVariable(), ConstantVariable(float: 0.5)]
TRACE FX call sub from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:597 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = -F.softplus(-w) - 0.5
            ~~~~~~~~~~~~~~~~^~~~~
TRACE STORE_FAST w [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:598 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = k * (1.0 - w + a)
TRACE LOAD_FAST k []
TRACE LOAD_CONST 1.0 [TensorVariable()]
TRACE LOAD_FAST w [TensorVariable(), ConstantVariable(float: 1.0)]
TRACE BINARY_OP 10 [TensorVariable(), ConstantVariable(float: 1.0), TensorVariable()]
TRACE FX call sub_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:598 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = k * (1.0 - w + a)
                 ~~~~^~~
TRACE LOAD_FAST a [TensorVariable(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call add_7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:598 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = k * (1.0 - w + a)
                 ~~~~~~~~^~~
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_10 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:598 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = k * (1.0 - w + a)
            ~~^~~~~~~~~~~~~~~
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:600 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            aa = -kk
TRACE LOAD_FAST kk []
TRACE UNARY_NEGATIVE None [TensorVariable()]
TRACE FX call neg_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:600 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        aa = -kk
             ^^^
TRACE STORE_FAST aa [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:601 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            bb = kk * a
TRACE LOAD_FAST kk []
TRACE LOAD_FAST a [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_11 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:601 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        bb = kk * a
             ~~~^~~
TRACE STORE_FAST bb [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:603 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            w = -w.exp()#.to(dtype=torch.float32).exp()
TRACE LOAD_FAST w []
TRACE LOAD_ATTR exp [TensorVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), exp)]
TRACE FX call exp from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:603 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = -w.exp()#.to(dtype=torch.float32).exp()
             ~~~~~^^
TRACE UNARY_NEGATIVE None [TensorVariable()]
TRACE FX call neg_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:603 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = -w.exp()#.to(dtype=torch.float32).exp()
            ^^^^^^^^
TRACE STORE_FAST w [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:604 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            r_,w_,k_,v_,aa_,bb_ = [i.view(B,T,H,N) for i in [r,w,k,v,aa,bb]]
TRACE LOAD_FAST r []
TRACE LOAD_FAST w [TensorVariable()]
TRACE LOAD_FAST k [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST v [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST aa [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST bb [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 6 [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE GET_ITER None [TupleVariable(length=6)]
TRACE LOAD_FAST_AND_CLEAR i [ListIteratorVariable(length=6, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=6, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=6, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=6, index=0), ListVariable(length=0)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=0)]
TRACE STORE_FAST i [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), TensorVariable()]
TRACE LOAD_FAST i [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1)]
TRACE LOAD_ATTR view [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_9 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:604 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        r_,w_,k_,v_,aa_,bb_ = [i.view(B,T,H,N) for i in [r,w,k,v,aa,bb]]
                               ~~~~~~^^^^^^^^^
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), TensorVariable()]
TRACE JUMP_BACKWARD 1448 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=1)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=1)]
TRACE STORE_FAST i [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), TensorVariable()]
TRACE LOAD_FAST i [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2)]
TRACE LOAD_ATTR view [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), TensorVariable()]
TRACE JUMP_BACKWARD 1448 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=2)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=2)]
TRACE STORE_FAST i [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), TensorVariable()]
TRACE LOAD_FAST i [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3)]
TRACE LOAD_ATTR view [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), TensorVariable()]
TRACE JUMP_BACKWARD 1448 [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=3)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=3)]
TRACE STORE_FAST i [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), TensorVariable()]
TRACE LOAD_FAST i [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4)]
TRACE LOAD_ATTR view [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), TensorVariable()]
TRACE JUMP_BACKWARD 1448 [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=4)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=4)]
TRACE STORE_FAST i [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), TensorVariable()]
TRACE LOAD_FAST i [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5)]
TRACE LOAD_ATTR view [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), TensorVariable()]
TRACE JUMP_BACKWARD 1448 [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=5)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=5)]
TRACE STORE_FAST i [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), TensorVariable()]
TRACE LOAD_FAST i [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6)]
TRACE LOAD_ATTR view [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), TensorVariable()]
TRACE JUMP_BACKWARD 1448 [NullVariable, ListVariable(length=6), ListIteratorVariable(length=6, index=6)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=6), ListIteratorVariable(length=6, index=6)]
TRACE END_FOR None [NullVariable, ListVariable(length=6), ListIteratorVariable(length=6, index=6), ConstantVariable(NoneType: None)]
TRACE SWAP 2 [NullVariable, ListVariable(length=6)]
TRACE STORE_FAST i [ListVariable(length=6), NullVariable]
TRACE UNPACK_SEQUENCE 6 [ListVariable(length=6)]
TRACE STORE_FAST r_ [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST w_ [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST k_ [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST v_ [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST aa_ [TensorVariable(), TensorVariable()]
TRACE STORE_FAST bb_ [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:605 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            B,T,_,_ = r_.shape
TRACE LOAD_FAST r_ []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE FX call size_11 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:605 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        B,T,_,_ = r_.shape
                  ^^^^^^^^
TRACE UNPACK_SEQUENCE 4 [SizeVariable(length=4)]
TRACE STORE_FAST B [ConstantVariable(int: 128), ConstantVariable(int: 64), SymNodeVariable(), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 128), ConstantVariable(int: 64), SymNodeVariable()]
TRACE STORE_FAST _ [ConstantVariable(int: 128), ConstantVariable(int: 64)]
TRACE STORE_FAST _ [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:609 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            xx, state = fused_recurrent_rwkv7(r_, w_, k_, v_, aa_, bb_, scale=1.0, initial_state=state, output_final_state=True, head_first=False)
TRACE LOAD_GLOBAL fused_recurrent_rwkv7 []
TRACE LOAD_FAST r_ [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST w_ [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST k_ [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST v_ [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST aa_ [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST bb_ [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 1.0 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST state [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0)]
TRACE LOAD_CONST True [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker()]
TRACE LOAD_CONST False [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True)]
TRACE KW_NAMES ('scale', 'initial_state', 'output_final_state', 'head_first') [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(bool: False)]
TRACE CALL 10 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(bool: False)]
TRACE inlined call fused_recurrent_rwkv7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:609 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx, state = fused_recurrent_rwkv7(r_, w_, k_, v_, aa_, bb_, scale=1.0, initial_state=state, output_final_state=True, head_first=False)
                    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object fused_recurrent_rwkv7 at 0x70c98d0c9890, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py", line 11>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:11 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
    def fused_recurrent_rwkv7(
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:50 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
        return fused_recurrent_dplr_delta_rule(
TRACE LOAD_GLOBAL fused_recurrent_dplr_delta_rule []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:51 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            q=r,
TRACE LOAD_FAST r [NullVariable, LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:52 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            k=k,
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:53 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            v=v,
TRACE LOAD_FAST v [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:54 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            a=a,
TRACE LOAD_FAST a [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:55 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            b=b,
TRACE LOAD_FAST b [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:56 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            gk=log_w,
TRACE LOAD_FAST log_w [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:57 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            scale=scale,
TRACE LOAD_FAST scale [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:58 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            initial_state=initial_state,
TRACE LOAD_FAST initial_state [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:59 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            output_final_state=output_final_state,
TRACE LOAD_FAST output_final_state [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:60 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            cu_seqlens=cu_seqlens,
TRACE LOAD_FAST cu_seqlens [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:61 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            head_first=head_first
TRACE LOAD_FAST head_first [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:50 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
        return fused_recurrent_dplr_delta_rule(
TRACE KW_NAMES ('q', 'k', 'v', 'a', 'b', 'gk', 'scale', 'initial_state', 'output_final_state', 'cu_seqlens', 'head_first') [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(NoneType: None), ConstantVariable(bool: False)]
TRACE CALL 11 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(NoneType: None), ConstantVariable(bool: False)]
TRACE inlined call fused_recurrent_dplr_delta_rule from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:50 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
    return fused_recurrent_dplr_delta_rule(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        q=r,
        ^^^^
        k=k,
        ^^^^
        v=v,
        ^^^^
        a=a,
        ^^^^
        b=b,
        ^^^^
        gk=log_w,
        ^^^^^^^^^
        scale=scale,
        ^^^^^^^^^^^^
        initial_state=initial_state,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        output_final_state=output_final_state,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        cu_seqlens=cu_seqlens,
        ^^^^^^^^^^^^^^^^^^^^^^
        head_first=head_first
        ^^^^^^^^^^^^^^^^^^^^^
    )
    ^
INLINING <code object fused_recurrent_dplr_delta_rule at 0x305fb4e0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 188>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:188 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
    def fused_recurrent_dplr_delta_rule(
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:231 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
        if cu_seqlens is not None:
TRACE LOAD_FAST cu_seqlens []
TRACE LOAD_CONST None [ConstantVariable(NoneType: None)]
TRACE IS_OP 0 [ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 282 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:240 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
        if scale is None:
TRACE LOAD_FAST scale []
TRACE LOAD_CONST None [ConstantVariable(float: 1.0)]
TRACE IS_OP 1 [ConstantVariable(float: 1.0), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 328 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:243 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            assert scale > 0, "scale must be positive"
TRACE LOAD_FAST scale []
TRACE LOAD_CONST 0 [ConstantVariable(float: 1.0)]
TRACE COMPARE_OP > [ConstantVariable(float: 1.0), ConstantVariable(int: 0)]
TRACE POP_JUMP_IF_TRUE 352 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:244 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
        o, final_state = FusedRecurrentDPLRDeltaRuleFunction.apply(
TRACE LOAD_GLOBAL FusedRecurrentDPLRDeltaRuleFunction []
TRACE LOAD_ATTR apply [LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:245 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            q,
TRACE LOAD_FAST q [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:246 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            k,
TRACE LOAD_FAST k [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:247 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            v,
TRACE LOAD_FAST v [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:248 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            a,
TRACE LOAD_FAST a [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:249 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            b,
TRACE LOAD_FAST b [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:250 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            gk,
TRACE LOAD_FAST gk [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:251 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            scale,
TRACE LOAD_FAST scale [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:252 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            initial_state,
TRACE LOAD_FAST initial_state [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:253 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            output_final_state,
TRACE LOAD_FAST output_final_state [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:254 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            cu_seqlens,
TRACE LOAD_FAST cu_seqlens [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:255 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            head_first
TRACE LOAD_FAST head_first [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:244 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
        o, final_state = FusedRecurrentDPLRDeltaRuleFunction.apply(
TRACE CALL 11 [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(NoneType: None), ConstantVariable(bool: False)]
wrap_to_fake L['state'] (1, 64, 128, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None], constraint_strides=[None, None, None, None], specialize_on=[[], [], [], []], view_base_context=StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='state', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}), tensor_source=LocalSource(local_name='state', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_state_ L['state'] FakeTensor(..., device='cuda:0', size=(1, 64, 128, 128), dtype=torch.bfloat16) at debug_level 0 before=False
wrap_to_fake L['state']._base (56, 1, 64, 128, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='state', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
TRACE inlined call wrapper from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:244 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
    o, final_state = FusedRecurrentDPLRDeltaRuleFunction.apply(
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        q,
        ^^
        k,
        ^^
        v,
        ^^
        a,
        ^^
        b,
        ^^
        gk,
        ^^^
        scale,
        ^^^^^^
        initial_state,
        ^^^^^^^^^^^^^^
        output_final_state,
        ^^^^^^^^^^^^^^^^^^^
        cu_seqlens,
        ^^^^^^^^^^^
        head_first
        ^^^^^^^^^^
    )
    ^
INLINING <code object wrapper at 0x70c98d04f0a0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 16>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 1 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:16 in wrapper (contiguous) (inline depth: 3)
        @functools.wraps(fn)
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:18 in wrapper (contiguous.wrapper) (inline depth: 3)
            return fn(ctx,
TRACE PUSH_NULL None []
TRACE LOAD_DEREF fn [NullVariable]
TRACE LOAD_FAST ctx [NullVariable, LazyVariableTracker()]
TRACE BUILD_LIST 1 [NullVariable, LazyVariableTracker(), AutogradFunctionContextVariable(Function)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:19 in wrapper (contiguous.wrapper) (inline depth: 3)
                      *(i if not isinstance(i, torch.Tensor) else i.contiguous() for i in args),
TRACE LOAD_CONST <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19> [NullVariable, LazyVariableTracker(), ListVariable(length=1)]
TRACE MAKE_FUNCTION 0 [NullVariable, LazyVariableTracker(), ListVariable(length=1), ConstantVariable(code: <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker(), ListVariable(length=1), NestedUserFunctionVariable()]
TRACE GET_ITER None [NullVariable, LazyVariableTracker(), ListVariable(length=1), NestedUserFunctionVariable(), TupleVariable(length=11)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), ListVariable(length=1), NestedUserFunctionVariable(), ListIteratorVariable(length=11, index=0)]
TRACE inlined call <genexpr> from /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:19 in wrapper (contiguous.wrapper) (inline depth: 3)
                  *(i if not isinstance(i, torch.Tensor) else i.contiguous() for i in args),
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:18 in wrapper (contiguous.wrapper) (inline depth: 3)
            return fn(ctx,
TRACE LIST_EXTEND 1 [NullVariable, LazyVariableTracker(), ListVariable(length=1), LocalGeneratorObjectVariable(<genexpr>)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:19 in <genexpr> (contiguous.wrapper) (inline depth: 4)
                      *(i if not isinstance(i, torch.Tensor) else i.contiguous() for i in args),
TRACE RETURN_GENERATOR None [BuiltinVariable(None)]
TRACE POP_TOP None [BuiltinVariable(None)]
TRACE RESUME 0 []
TRACE LOAD_FAST .0 []
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=0)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=1), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=1)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=1), NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=1), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=1), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=1), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=1), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=1)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=1), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=1), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE FX call contiguous_2 from /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:19 in <genexpr> (contiguous.wrapper) (inline depth: 4)
                  *(i if not isinstance(i, torch.Tensor) else i.contiguous() for i in args),
                                                              ~~~~~~~~~~~~^^
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=1), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=1), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=1), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=1)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=1)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=2), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=2)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=2), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=2), NullVariable, BuiltinVariable(isinstance), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=2), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=2), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=2), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=2)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=2), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=2), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=2), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=2), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=2), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=2)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=2)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=3), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=3)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=3), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=3), NullVariable, BuiltinVariable(isinstance), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=3), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=3), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=3), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=3)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=3), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=3), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=3), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=3), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=3), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=3)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=3)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=4), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=4)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=4), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=4), NullVariable, BuiltinVariable(isinstance), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=4), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=4), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=4), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=4)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=4), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=4), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=4), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=4), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=4), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=4)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=4)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=5), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=5)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=5), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=5), NullVariable, BuiltinVariable(isinstance), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=5), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=5), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=5), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=5)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=5), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=5), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=5), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=5), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=5), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=5)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=5)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=6), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=6)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=6), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=6), NullVariable, BuiltinVariable(isinstance), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=6), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=6), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=6), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=6)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=6), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=6), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=6), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=6), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=6), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=6)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=6)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=7), ConstantVariable(float: 1.0)]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=7)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=7), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=7), NullVariable, BuiltinVariable(isinstance), ConstantVariable(float: 1.0)]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=7), NullVariable, BuiltinVariable(isinstance), ConstantVariable(float: 1.0), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=7), NullVariable, BuiltinVariable(isinstance), ConstantVariable(float: 1.0), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=7), ConstantVariable(bool: False)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=7)]
TRACE JUMP_FORWARD 100 [ListIteratorVariable(length=11, index=7), ConstantVariable(float: 1.0)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=7), ConstantVariable(float: 1.0)]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=7), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=7), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=7)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=7)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=8), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=8)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=8), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=8), NullVariable, BuiltinVariable(isinstance), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=8), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=8), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=8), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=8)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=8), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=8), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=8), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=8), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=8), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=8)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=8)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=9), ConstantVariable(bool: True)]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=9)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=9), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=9), NullVariable, BuiltinVariable(isinstance), ConstantVariable(bool: True)]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=9), NullVariable, BuiltinVariable(isinstance), ConstantVariable(bool: True), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=9), NullVariable, BuiltinVariable(isinstance), ConstantVariable(bool: True), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=9), ConstantVariable(bool: False)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=9)]
TRACE JUMP_FORWARD 100 [ListIteratorVariable(length=11, index=9), ConstantVariable(bool: True)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=9), ConstantVariable(bool: True)]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=9), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=9), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=9)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=9)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=10), ConstantVariable(NoneType: None)]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=10)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=10), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=10), NullVariable, BuiltinVariable(isinstance), ConstantVariable(NoneType: None)]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=10), NullVariable, BuiltinVariable(isinstance), ConstantVariable(NoneType: None), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=10), NullVariable, BuiltinVariable(isinstance), ConstantVariable(NoneType: None), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=10), ConstantVariable(bool: False)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=10)]
TRACE JUMP_FORWARD 100 [ListIteratorVariable(length=11, index=10), ConstantVariable(NoneType: None)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=10), ConstantVariable(NoneType: None)]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=10), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=10), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=10)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=10)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=11), ConstantVariable(bool: False)]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=11)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=11), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=11), NullVariable, BuiltinVariable(isinstance), ConstantVariable(bool: False)]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=11), NullVariable, BuiltinVariable(isinstance), ConstantVariable(bool: False), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=11), NullVariable, BuiltinVariable(isinstance), ConstantVariable(bool: False), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=11), ConstantVariable(bool: False)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=11)]
TRACE JUMP_FORWARD 100 [ListIteratorVariable(length=11, index=11), ConstantVariable(bool: False)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=11), ConstantVariable(bool: False)]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=11), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=11), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=11)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=11)]
TRACE END_FOR None [ListIteratorVariable(length=11, index=11), ConstantVariable(NoneType: None)]
TRACE RETURN_CONST None []
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE CALL_INTRINSIC_1 6 [NullVariable, LazyVariableTracker(), ListVariable(length=12)]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=12)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:20 in wrapper (contiguous.wrapper) (inline depth: 3)
                      **{k: (v if not isinstance(v, torch.Tensor) else v.contiguous()) for k, v in kwargs.items()})
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable()]
TRACE LOAD_ATTR items [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ConstDictVariable()]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 180 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE SWAP 3 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST v [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ConstDictVariable(), NullVariable, NullVariable]
TRACE STORE_FAST k [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ConstDictVariable(), NullVariable]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:18 in wrapper (contiguous.wrapper) (inline depth: 3)
            return fn(ctx,
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable()]
TRACE inlined call forward from /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:18 in wrapper (contiguous.wrapper) (inline depth: 3)
        return fn(ctx,
               ~~^^^^^
                  *(i if not isinstance(i, torch.Tensor) else i.contiguous() for i in args),
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                  **{k: (v if not isinstance(v, torch.Tensor) else v.contiguous()) for k, v in kwargs.items()})
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object forward at 0x3060e8b0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 124>, inlined according trace_rules.lookup inlined by default
TRACE MAKE_CELL H []
TRACE MAKE_CELL N []
TRACE MAKE_CELL V []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:124 in forward (FusedRecurrentDPLRDeltaRuleFunction) (inline depth: 4)
        @staticmethod
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:140 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            if head_first:
TRACE LOAD_FAST head_first []
TRACE POP_JUMP_IF_FALSE 86 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:143 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
                B, T, H, K, V = *k.shape, v.shape[-1]
TRACE BUILD_LIST 0 []
TRACE LOAD_FAST k [ListVariable(length=0)]
TRACE LOAD_ATTR shape [ListVariable(length=0), TensorVariable()]
TRACE FX call size_12 from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:143 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            B, T, H, K, V = *k.shape, v.shape[-1]
                             ^^^^^^^
TRACE LIST_EXTEND 1 [ListVariable(length=0), SizeVariable(length=4)]
TRACE LOAD_FAST v [ListVariable(length=4)]
TRACE LOAD_ATTR shape [ListVariable(length=4), TensorVariable()]
TRACE FX call size_13 from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:143 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            B, T, H, K, V = *k.shape, v.shape[-1]
                                      ^^^^^^^
TRACE LOAD_CONST -1 [ListVariable(length=4), SizeVariable(length=4)]
TRACE BINARY_SUBSCR None [ListVariable(length=4), SizeVariable(length=4), ConstantVariable(int: -1)]
TRACE LIST_APPEND 1 [ListVariable(length=4), ConstantVariable(int: 128)]
TRACE CALL_INTRINSIC_1 6 [ListVariable(length=5)]
TRACE UNPACK_SEQUENCE 5 [TupleVariable(length=5)]
TRACE STORE_FAST B [ConstantVariable(int: 128), ConstantVariable(int: 128), ConstantVariable(int: 64), SymNodeVariable(), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 128), ConstantVariable(int: 128), ConstantVariable(int: 64), SymNodeVariable()]
TRACE STORE_DEREF H [ConstantVariable(int: 128), ConstantVariable(int: 128), ConstantVariable(int: 64)]
TRACE STORE_FAST K [ConstantVariable(int: 128), ConstantVariable(int: 128)]
TRACE STORE_DEREF V [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:144 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            N = B if offsets is None else len(offsets) - 1
TRACE LOAD_FAST offsets []
TRACE LOAD_CONST None [ConstantVariable(NoneType: None)]
TRACE IS_OP 1 [ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 170 [ConstantVariable(bool: False)]
TRACE LOAD_FAST B []
TRACE JUMP_FORWARD 196 [ConstantVariable(int: 1)]
TRACE STORE_DEREF N [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:146 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            BK = triton.next_power_of_2(K)
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR next_power_of_2 [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST K [NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:146 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
        BK = triton.next_power_of_2(K)
             ~~~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=1)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=1, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=1, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=1, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=1, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=1), ConstantVariable(int: 128)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 6)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 6)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 6)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 6)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 6)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 128)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=1), ConstantVariable(int: 128)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=1, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=1, index=1)]
TRACE END_FOR None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=1, index=1), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=1)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=1)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=1), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=1), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=1), ConstDictVariable()]
TRACE inlined call next_power_of_2 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object next_power_of_2 at 0x70c9a955f730, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 71>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:71 in next_power_of_2 () (inline depth: 6)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:74 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n -= 1
TRACE LOAD_FAST n []
TRACE LOAD_CONST 1 [ConstantVariable(int: 128)]
TRACE BINARY_OP 23 [ConstantVariable(int: 128), ConstantVariable(int: 1)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:75 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n |= n >> 1
TRACE LOAD_FAST n []
TRACE LOAD_FAST n [ConstantVariable(int: 127)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 127), ConstantVariable(int: 127)]
TRACE BINARY_OP 9 [ConstantVariable(int: 127), ConstantVariable(int: 127), ConstantVariable(int: 1)]
TRACE BINARY_OP 20 [ConstantVariable(int: 127), ConstantVariable(int: 63)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:76 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n |= n >> 2
TRACE LOAD_FAST n []
TRACE LOAD_FAST n [ConstantVariable(int: 127)]
TRACE LOAD_CONST 2 [ConstantVariable(int: 127), ConstantVariable(int: 127)]
TRACE BINARY_OP 9 [ConstantVariable(int: 127), ConstantVariable(int: 127), ConstantVariable(int: 2)]
TRACE BINARY_OP 20 [ConstantVariable(int: 127), ConstantVariable(int: 31)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:77 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n |= n >> 4
TRACE LOAD_FAST n []
TRACE LOAD_FAST n [ConstantVariable(int: 127)]
TRACE LOAD_CONST 4 [ConstantVariable(int: 127), ConstantVariable(int: 127)]
TRACE BINARY_OP 9 [ConstantVariable(int: 127), ConstantVariable(int: 127), ConstantVariable(int: 4)]
TRACE BINARY_OP 20 [ConstantVariable(int: 127), ConstantVariable(int: 7)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:78 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n |= n >> 8
TRACE LOAD_FAST n []
TRACE LOAD_FAST n [ConstantVariable(int: 127)]
TRACE LOAD_CONST 8 [ConstantVariable(int: 127), ConstantVariable(int: 127)]
TRACE BINARY_OP 9 [ConstantVariable(int: 127), ConstantVariable(int: 127), ConstantVariable(int: 8)]
TRACE BINARY_OP 20 [ConstantVariable(int: 127), ConstantVariable(int: 0)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:79 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n |= n >> 16
TRACE LOAD_FAST n []
TRACE LOAD_FAST n [ConstantVariable(int: 127)]
TRACE LOAD_CONST 16 [ConstantVariable(int: 127), ConstantVariable(int: 127)]
TRACE BINARY_OP 9 [ConstantVariable(int: 127), ConstantVariable(int: 127), ConstantVariable(int: 16)]
TRACE BINARY_OP 20 [ConstantVariable(int: 127), ConstantVariable(int: 0)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:80 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n |= n >> 32
TRACE LOAD_FAST n []
TRACE LOAD_FAST n [ConstantVariable(int: 127)]
TRACE LOAD_CONST 32 [ConstantVariable(int: 127), ConstantVariable(int: 127)]
TRACE BINARY_OP 9 [ConstantVariable(int: 127), ConstantVariable(int: 127), ConstantVariable(int: 32)]
TRACE BINARY_OP 20 [ConstantVariable(int: 127), ConstantVariable(int: 0)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:81 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n += 1
TRACE LOAD_FAST n []
TRACE LOAD_CONST 1 [ConstantVariable(int: 127)]
TRACE BINARY_OP 13 [ConstantVariable(int: 127), ConstantVariable(int: 1)]
TRACE STORE_FAST n [ConstantVariable(int: 128)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:82 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        return n
TRACE LOAD_FAST n []
TRACE RETURN_VALUE None [ConstantVariable(int: 128)]
DONE INLINING <code object next_power_of_2 at 0x70c9a955f730, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 71>
TRACE STORE_FAST res [ConstantVariable(int: 128)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 128)]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE STORE_FAST BK [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:147 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            if output_final_state:
TRACE LOAD_FAST output_final_state []
TRACE POP_JUMP_IF_FALSE 318 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:148 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
                final_state = q.new_empty(B, H, K, V, dtype=torch.float32)
TRACE LOAD_FAST q []
TRACE LOAD_ATTR new_empty [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), new_empty)]
TRACE LOAD_DEREF H [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1)]
TRACE LOAD_FAST K [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE LOAD_DEREF V [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128), ConstantVariable(int: 128)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE CALL 5 [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE FX call new_empty from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:148 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            final_state = q.new_empty(B, H, K, V, dtype=torch.float32)
                          ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST final_state [TensorVariable()]
TRACE JUMP_FORWARD 322 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:152 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            ha = torch.empty_like(v, dtype=torch.float32)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR empty_like [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST v [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL torch [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR float32 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE FX call empty_like from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:152 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
        ha = torch.empty_like(v, dtype=torch.float32)
             ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST ha [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
TRACE LOAD_CLOSURE H []
TRACE LOAD_CLOSURE N [CellVariable()]
TRACE LOAD_CLOSURE V [CellVariable(), CellVariable()]
TRACE BUILD_TUPLE 3 [CellVariable(), CellVariable(), CellVariable()]
TRACE LOAD_CONST <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154> [TupleVariable(length=3)]
TRACE MAKE_FUNCTION 8 [TupleVariable(length=3), ConstantVariable(code: <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>)]
TRACE STORE_FAST grid [NestedUserFunctionVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:155 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            o = torch.empty_like(v)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR empty_like [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST v [NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call empty_like_1 from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:155 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
        o = torch.empty_like(v)
            ~~~~~~~~~~~~~~~~^^^
TRACE STORE_FAST o [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_GLOBAL fused_recurrent_fwd_kernel []
TRACE LOAD_FAST grid [NullVariable, LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), NestedUserFunctionVariable()]
TRACE inlined call __getitem__ from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
        fused_recurrent_fwd_kernel[grid](
        ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
INLINING <code object __getitem__ at 0x70c9a94dd6f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 413>, inlined according trace_rules.lookup inlined by default
TRACE MAKE_CELL self []
TRACE MAKE_CELL grid []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:413 in __getitem__ (KernelInterface.__getitem__) (inline depth: 5)
        def __getitem__(self, grid) -> T:
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:419 in __getitem__ (KernelInterface.__getitem__) (inline depth: 5)
            return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
TRACE LOAD_CLOSURE grid []
TRACE LOAD_CLOSURE self [CellVariable()]
TRACE BUILD_TUPLE 2 [CellVariable(), CellVariable()]
TRACE LOAD_CONST <code object <lambda> at 0x70c9a9437780, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 419> [TupleVariable(length=2)]
TRACE MAKE_FUNCTION 8 [TupleVariable(length=2), ConstantVariable(code: <code object <lambda> at 0x70c9a9437780, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 419>)]
TRACE RETURN_VALUE None [NestedUserFunctionVariable()]
DONE INLINING <code object __getitem__ at 0x70c9a94dd6f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 413>
TRACE LOAD_CONST () [NullVariable, NestedUserFunctionVariable()]
TRACE BUILD_MAP 0 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0)]
TRACE LOAD_CONST q [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:157 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                q=q,
TRACE LOAD_FAST q [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'q')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'q'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST k [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:158 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                k=k,
TRACE LOAD_FAST k [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'k')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'k'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST v [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:159 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                v=v,
TRACE LOAD_FAST v [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'v')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'v'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST a [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:160 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                a=a,
TRACE LOAD_FAST a [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'a')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'a'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST b [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:161 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                b=b,
TRACE LOAD_FAST b [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'b')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'b'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST gk [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:162 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                gk=gk,
TRACE LOAD_FAST gk [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'gk')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'gk'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST o [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:163 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                o=o,
TRACE LOAD_FAST o [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'o')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'o'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST ha [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:164 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                ha=ha,
TRACE LOAD_FAST ha [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'ha')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'ha'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST h0 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:165 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                h0=initial_state,
TRACE LOAD_FAST initial_state [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'h0')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'h0'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST ht [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:166 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                ht=final_state,
TRACE LOAD_FAST final_state [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'ht')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'ht'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST scale [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:167 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                scale=scale,
TRACE LOAD_FAST scale [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'scale')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'scale'), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST offsets [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:168 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                offsets=offsets,
TRACE LOAD_FAST offsets [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'offsets')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'offsets'), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST H [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:169 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                H=H,
TRACE LOAD_DEREF H [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'H')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'H'), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST T [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:170 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                T=T,
TRACE LOAD_FAST T [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'T')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'T'), SymNodeVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST K [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:171 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                K=K,
TRACE LOAD_FAST K [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'K')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'K'), ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST V [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:172 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                V=V,
TRACE LOAD_DEREF V [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'V')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'V'), ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST BK [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:173 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                BK=BK,
TRACE LOAD_FAST BK [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'BK')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'BK'), ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST HEAD_FIRST [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:174 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                HEAD_FIRST=head_first
TRACE LOAD_FAST head_first [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'HEAD_FIRST')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'HEAD_FIRST'), ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE CALL_FUNCTION_EX 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE inlined call <lambda> from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
        fused_recurrent_fwd_kernel[grid](
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
            q=q,
            ^^^^
            k=k,
            ^^^^
            v=v,
            ^^^^
            a=a,
            ^^^^
            b=b,
            ^^^^
            gk=gk,
            ^^^^^^
            o=o,
            ^^^^
            ha=ha,
            ^^^^^^
            h0=initial_state,
            ^^^^^^^^^^^^^^^^^
            ht=final_state,
            ^^^^^^^^^^^^^^^
            scale=scale,
            ^^^^^^^^^^^^
            offsets=offsets,
            ^^^^^^^^^^^^^^^^
            H=H,
            ^^^^
            T=T,
            ^^^^
            K=K,
            ^^^^
            V=V,
            ^^^^
            BK=BK,
            ^^^^^^
            HEAD_FIRST=head_first
            ^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object <lambda> at 0x70c9a9437780, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 419>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 2 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:419 in <lambda> (KernelInterface.__getitem__) (inline depth: 5)
            return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
TRACE RESUME 0 []
TRACE PUSH_NULL None []
TRACE LOAD_DEREF self [NullVariable]
TRACE LOAD_ATTR run [NullVariable, UserDefinedObjectVariable(Heuristics)]
TRACE LOAD_FAST args [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics))]
TRACE LOAD_DEREF grid [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0)]
TRACE LOAD_CONST False [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0), NestedUserFunctionVariable()]
TRACE LOAD_CONST ('grid', 'warmup') [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0), NestedUserFunctionVariable(), ConstantVariable(bool: False)]
TRACE BUILD_CONST_KEY_MAP 2 [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0), NestedUserFunctionVariable(), ConstantVariable(bool: False), TupleVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0), ConstDictVariable()]
TRACE inlined call run from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:419 in <lambda> (KernelInterface.__getitem__) (inline depth: 5)
        return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
                                       ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object run at 0x70c9a971df10, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py", line 449>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:449 in run (Heuristics.run) (inline depth: 6)
        def run(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:450 in run (Heuristics.run) (inline depth: 6)
            for v, heur in self.values.items():
TRACE LOAD_FAST self []
TRACE LOAD_ATTR values [UserDefinedObjectVariable(Heuristics)]
TRACE LOAD_ATTR items [LazyVariableTracker()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE FOR_ITER 156 [ListIteratorVariable(length=3, index=0)]
TRACE UNPACK_SEQUENCE 2 [ListIteratorVariable(length=3, index=1), TupleVariable(length=2)]
TRACE STORE_FAST v [ListIteratorVariable(length=3, index=1), LazyVariableTracker(), ConstantVariable(str: 'USE_INITIAL_STATE')]
TRACE STORE_FAST heur [ListIteratorVariable(length=3, index=1), LazyVariableTracker()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
                kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
TRACE PUSH_NULL None [ListIteratorVariable(length=3, index=1)]
TRACE LOAD_FAST heur [ListIteratorVariable(length=3, index=1), NullVariable]
TRACE BUILD_MAP 0 [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL dict [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE LOAD_GLOBAL zip [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST self [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, LazyVariableTracker(), NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR arg_names [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, LazyVariableTracker(), NullVariable, LazyVariableTracker(), UserDefinedObjectVariable(Heuristics)]
TRACE LOAD_FAST args [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, LazyVariableTracker(), NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, LazyVariableTracker(), NullVariable, LazyVariableTracker(), LazyVariableTracker(), TupleVariable(length=0)]
TRACE CALL 1 [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, LazyVariableTracker(), ZipVariable()]
TRACE inlined call construct_dict from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
            kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
                                ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object construct_dict at 0x70c9a070b0a0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 285>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:285 in construct_dict (construct_dict) (inline depth: 7)
    def construct_dict(cls, /, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:286 in construct_dict (construct_dict) (inline depth: 7)
        dst = cls.__new__(cls)
TRACE LOAD_FAST cls []
TRACE LOAD_ATTR __new__ [BuiltinVariable(dict)]
TRACE LOAD_FAST cls [NullVariable, GetAttrVariable(BuiltinVariable(dict), __new__)]
TRACE CALL 1 [NullVariable, GetAttrVariable(BuiltinVariable(dict), __new__), BuiltinVariable(dict)]
TRACE STORE_FAST dst [ConstDictVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:288 in construct_dict (construct_dict) (inline depth: 7)
        if args:
TRACE LOAD_FAST args []
TRACE POP_JUMP_IF_FALSE 264 [TupleVariable(length=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:289 in construct_dict (construct_dict) (inline depth: 7)
            src = args[0]
TRACE LOAD_FAST args []
TRACE LOAD_CONST 0 [TupleVariable(length=1)]
TRACE BINARY_SUBSCR None [TupleVariable(length=1), ConstantVariable(int: 0)]
TRACE STORE_FAST src [ZipVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:291 in construct_dict (construct_dict) (inline depth: 7)
            if not isinstance(src, Iterable):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST src [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL Iterable [NullVariable, LazyVariableTracker(), ZipVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ZipVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 128 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:295 in construct_dict (construct_dict) (inline depth: 7)
            if isinstance(src, (dict, MutableMapping, types.MappingProxyType)):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST src [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL dict [NullVariable, BuiltinVariable(isinstance), ZipVariable()]
TRACE LOAD_GLOBAL MutableMapping [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker()]
TRACE LOAD_GLOBAL types [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR MappingProxyType [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE BUILD_TUPLE 3 [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ZipVariable(), TupleVariable(length=3)]
TRACE POP_JUMP_IF_FALSE 234 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:301 in construct_dict (construct_dict) (inline depth: 7)
                for key, value in src:
TRACE LOAD_FAST src []
TRACE GET_ITER None [ZipVariable()]
TRACE FOR_ITER 262 [ZipVariable()]
TRACE END_FOR None [ZipVariable(), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:304 in construct_dict (construct_dict) (inline depth: 7)
        if kwargs:
TRACE LOAD_FAST kwargs []
TRACE POP_JUMP_IF_FALSE 298 [ConstDictVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:308 in construct_dict (construct_dict) (inline depth: 7)
        return dst
TRACE LOAD_FAST dst []
TRACE RETURN_VALUE None [ConstDictVariable()]
DONE INLINING <code object construct_dict at 0x70c9a070b0a0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 285>
TRACE DICT_UPDATE 1 [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), ConstDictVariable()]
TRACE LOAD_FAST kwargs [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE DICT_UPDATE 1 [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), ConstDictVariable()]
TRACE CALL 1 [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE inlined call <lambda> from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
            kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
                        ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object <lambda> at 0x70c98ce24d30, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 14>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:14 in <lambda> () (inline depth: 7)
        'USE_INITIAL_STATE': lambda args: args['h0'] is not None,
TRACE RESUME 0 []
TRACE LOAD_FAST args []
TRACE LOAD_CONST h0 [ConstDictVariable()]
TRACE BINARY_SUBSCR None [ConstDictVariable(), ConstantVariable(str: 'h0')]
TRACE LOAD_CONST None [TensorVariable()]
TRACE IS_OP 1 [TensorVariable(), ConstantVariable(NoneType: None)]
TRACE RETURN_VALUE None [ConstantVariable(bool: True)]
DONE INLINING <code object <lambda> at 0x70c98ce24d30, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 14>
TRACE LOAD_FAST kwargs [ListIteratorVariable(length=3, index=1), ConstantVariable(bool: True)]
TRACE LOAD_FAST v [ListIteratorVariable(length=3, index=1), ConstantVariable(bool: True), ConstDictVariable()]
TRACE STORE_SUBSCR None [ListIteratorVariable(length=3, index=1), ConstantVariable(bool: True), ConstDictVariable(), ConstantVariable(str: 'USE_INITIAL_STATE')]
TRACE JUMP_BACKWARD 54 [ListIteratorVariable(length=3, index=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:450 in run (Heuristics.run) (inline depth: 6)
            for v, heur in self.values.items():
TRACE FOR_ITER 156 [ListIteratorVariable(length=3, index=1)]
TRACE UNPACK_SEQUENCE 2 [ListIteratorVariable(length=3, index=2), TupleVariable(length=2)]
TRACE STORE_FAST v [ListIteratorVariable(length=3, index=2), LazyVariableTracker(), ConstantVariable(str: 'STORE_FINAL_STATE')]
TRACE STORE_FAST heur [ListIteratorVariable(length=3, index=2), LazyVariableTracker()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
                kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
TRACE PUSH_NULL None [ListIteratorVariable(length=3, index=2)]
TRACE LOAD_FAST heur [ListIteratorVariable(length=3, index=2), NullVariable]
TRACE BUILD_MAP 0 [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL dict [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE LOAD_GLOBAL zip [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict)]
TRACE LOAD_FAST self [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip)]
TRACE LOAD_ATTR arg_names [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip), UserDefinedObjectVariable(Heuristics)]
TRACE LOAD_FAST args [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip), LazyVariableTracker(), TupleVariable(length=0)]
TRACE CALL 1 [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), ZipVariable()]
TRACE inlined call construct_dict from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
            kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
                                ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object construct_dict at 0x70c9a070b0a0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 285>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:285 in construct_dict (construct_dict) (inline depth: 7)
    def construct_dict(cls, /, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:286 in construct_dict (construct_dict) (inline depth: 7)
        dst = cls.__new__(cls)
TRACE LOAD_FAST cls []
TRACE LOAD_ATTR __new__ [BuiltinVariable(dict)]
TRACE LOAD_FAST cls [NullVariable, GetAttrVariable(BuiltinVariable(dict), __new__)]
TRACE CALL 1 [NullVariable, GetAttrVariable(BuiltinVariable(dict), __new__), BuiltinVariable(dict)]
TRACE STORE_FAST dst [ConstDictVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:288 in construct_dict (construct_dict) (inline depth: 7)
        if args:
TRACE LOAD_FAST args []
TRACE POP_JUMP_IF_FALSE 264 [TupleVariable(length=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:289 in construct_dict (construct_dict) (inline depth: 7)
            src = args[0]
TRACE LOAD_FAST args []
TRACE LOAD_CONST 0 [TupleVariable(length=1)]
TRACE BINARY_SUBSCR None [TupleVariable(length=1), ConstantVariable(int: 0)]
TRACE STORE_FAST src [ZipVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:291 in construct_dict (construct_dict) (inline depth: 7)
            if not isinstance(src, Iterable):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST src [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL Iterable [NullVariable, LazyVariableTracker(), ZipVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ZipVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 128 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:295 in construct_dict (construct_dict) (inline depth: 7)
            if isinstance(src, (dict, MutableMapping, types.MappingProxyType)):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST src [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL dict [NullVariable, BuiltinVariable(isinstance), ZipVariable()]
TRACE LOAD_GLOBAL MutableMapping [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker()]
TRACE LOAD_GLOBAL types [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR MappingProxyType [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE BUILD_TUPLE 3 [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ZipVariable(), TupleVariable(length=3)]
TRACE POP_JUMP_IF_FALSE 234 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:301 in construct_dict (construct_dict) (inline depth: 7)
                for key, value in src:
TRACE LOAD_FAST src []
TRACE GET_ITER None [ZipVariable()]
TRACE FOR_ITER 262 [ZipVariable()]
TRACE END_FOR None [ZipVariable(), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:304 in construct_dict (construct_dict) (inline depth: 7)
        if kwargs:
TRACE LOAD_FAST kwargs []
TRACE POP_JUMP_IF_FALSE 298 [ConstDictVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:308 in construct_dict (construct_dict) (inline depth: 7)
        return dst
TRACE LOAD_FAST dst []
TRACE RETURN_VALUE None [ConstDictVariable()]
DONE INLINING <code object construct_dict at 0x70c9a070b0a0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 285>
TRACE DICT_UPDATE 1 [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), ConstDictVariable()]
TRACE LOAD_FAST kwargs [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE DICT_UPDATE 1 [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), ConstDictVariable()]
TRACE CALL 1 [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE inlined call <lambda> from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
            kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
                        ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object <lambda> at 0x70c98ce257c0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 15>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:15 in <lambda> () (inline depth: 7)
        'STORE_FINAL_STATE': lambda args: args['ht'] is not None,
TRACE RESUME 0 []
TRACE LOAD_FAST args []
TRACE LOAD_CONST ht [ConstDictVariable()]
TRACE BINARY_SUBSCR None [ConstDictVariable(), ConstantVariable(str: 'ht')]
TRACE LOAD_CONST None [TensorVariable()]
TRACE IS_OP 1 [TensorVariable(), ConstantVariable(NoneType: None)]
TRACE RETURN_VALUE None [ConstantVariable(bool: True)]
DONE INLINING <code object <lambda> at 0x70c98ce257c0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 15>
TRACE LOAD_FAST kwargs [ListIteratorVariable(length=3, index=2), ConstantVariable(bool: True)]
TRACE LOAD_FAST v [ListIteratorVariable(length=3, index=2), ConstantVariable(bool: True), ConstDictVariable()]
TRACE STORE_SUBSCR None [ListIteratorVariable(length=3, index=2), ConstantVariable(bool: True), ConstDictVariable(), ConstantVariable(str: 'STORE_FINAL_STATE')]
TRACE JUMP_BACKWARD 54 [ListIteratorVariable(length=3, index=2)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:450 in run (Heuristics.run) (inline depth: 6)
            for v, heur in self.values.items():
TRACE FOR_ITER 156 [ListIteratorVariable(length=3, index=2)]
TRACE UNPACK_SEQUENCE 2 [ListIteratorVariable(length=3, index=3), TupleVariable(length=2)]
TRACE STORE_FAST v [ListIteratorVariable(length=3, index=3), LazyVariableTracker(), ConstantVariable(str: 'USE_OFFSETS')]
TRACE STORE_FAST heur [ListIteratorVariable(length=3, index=3), LazyVariableTracker()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
                kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
TRACE PUSH_NULL None [ListIteratorVariable(length=3, index=3)]
TRACE LOAD_FAST heur [ListIteratorVariable(length=3, index=3), NullVariable]
TRACE BUILD_MAP 0 [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL dict [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE LOAD_GLOBAL zip [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict)]
TRACE LOAD_FAST self [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip)]
TRACE LOAD_ATTR arg_names [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip), UserDefinedObjectVariable(Heuristics)]
TRACE LOAD_FAST args [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip), LazyVariableTracker(), TupleVariable(length=0)]
TRACE CALL 1 [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), ZipVariable()]
TRACE inlined call construct_dict from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
            kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
                                ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object construct_dict at 0x70c9a070b0a0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 285>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:285 in construct_dict (construct_dict) (inline depth: 7)
    def construct_dict(cls, /, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:286 in construct_dict (construct_dict) (inline depth: 7)
        dst = cls.__new__(cls)
TRACE LOAD_FAST cls []
TRACE LOAD_ATTR __new__ [BuiltinVariable(dict)]
TRACE LOAD_FAST cls [NullVariable, GetAttrVariable(BuiltinVariable(dict), __new__)]
TRACE CALL 1 [NullVariable, GetAttrVariable(BuiltinVariable(dict), __new__), BuiltinVariable(dict)]
TRACE STORE_FAST dst [ConstDictVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:288 in construct_dict (construct_dict) (inline depth: 7)
        if args:
TRACE LOAD_FAST args []
TRACE POP_JUMP_IF_FALSE 264 [TupleVariable(length=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:289 in construct_dict (construct_dict) (inline depth: 7)
            src = args[0]
TRACE LOAD_FAST args []
TRACE LOAD_CONST 0 [TupleVariable(length=1)]
TRACE BINARY_SUBSCR None [TupleVariable(length=1), ConstantVariable(int: 0)]
TRACE STORE_FAST src [ZipVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:291 in construct_dict (construct_dict) (inline depth: 7)
            if not isinstance(src, Iterable):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST src [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL Iterable [NullVariable, LazyVariableTracker(), ZipVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ZipVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 128 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:295 in construct_dict (construct_dict) (inline depth: 7)
            if isinstance(src, (dict, MutableMapping, types.MappingProxyType)):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST src [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL dict [NullVariable, BuiltinVariable(isinstance), ZipVariable()]
TRACE LOAD_GLOBAL MutableMapping [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker()]
TRACE LOAD_GLOBAL types [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR MappingProxyType [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE BUILD_TUPLE 3 [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ZipVariable(), TupleVariable(length=3)]
TRACE POP_JUMP_IF_FALSE 234 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:301 in construct_dict (construct_dict) (inline depth: 7)
                for key, value in src:
TRACE LOAD_FAST src []
TRACE GET_ITER None [ZipVariable()]
TRACE FOR_ITER 262 [ZipVariable()]
TRACE END_FOR None [ZipVariable(), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:304 in construct_dict (construct_dict) (inline depth: 7)
        if kwargs:
TRACE LOAD_FAST kwargs []
TRACE POP_JUMP_IF_FALSE 298 [ConstDictVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:308 in construct_dict (construct_dict) (inline depth: 7)
        return dst
TRACE LOAD_FAST dst []
TRACE RETURN_VALUE None [ConstDictVariable()]
DONE INLINING <code object construct_dict at 0x70c9a070b0a0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 285>
TRACE DICT_UPDATE 1 [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), ConstDictVariable()]
TRACE LOAD_FAST kwargs [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE DICT_UPDATE 1 [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), ConstDictVariable()]
TRACE CALL 1 [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE inlined call <lambda> from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
            kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
                        ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object <lambda> at 0x70c98ce25a30, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 16>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:16 in <lambda> () (inline depth: 7)
        'USE_OFFSETS': lambda args: args['offsets'] is not None
TRACE RESUME 0 []
TRACE LOAD_FAST args []
TRACE LOAD_CONST offsets [ConstDictVariable()]
TRACE BINARY_SUBSCR None [ConstDictVariable(), ConstantVariable(str: 'offsets')]
TRACE LOAD_CONST None [ConstantVariable(NoneType: None)]
TRACE IS_OP 1 [ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE RETURN_VALUE None [ConstantVariable(bool: False)]
DONE INLINING <code object <lambda> at 0x70c98ce25a30, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 16>
TRACE LOAD_FAST kwargs [ListIteratorVariable(length=3, index=3), ConstantVariable(bool: False)]
TRACE LOAD_FAST v [ListIteratorVariable(length=3, index=3), ConstantVariable(bool: False), ConstDictVariable()]
TRACE STORE_SUBSCR None [ListIteratorVariable(length=3, index=3), ConstantVariable(bool: False), ConstDictVariable(), ConstantVariable(str: 'USE_OFFSETS')]
TRACE JUMP_BACKWARD 54 [ListIteratorVariable(length=3, index=3)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:450 in run (Heuristics.run) (inline depth: 6)
            for v, heur in self.values.items():
TRACE FOR_ITER 156 [ListIteratorVariable(length=3, index=3)]
TRACE END_FOR None [ListIteratorVariable(length=3, index=3), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:452 in run (Heuristics.run) (inline depth: 6)
            return self.fn.run(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(Heuristics)]
TRACE LOAD_ATTR run [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST args [NullVariable, GetAttrVariable(TritonKernelVariable(), run)]
TRACE BUILD_MAP 0 [NullVariable, GetAttrVariable(TritonKernelVariable(), run), TupleVariable(length=0)]
TRACE LOAD_FAST kwargs [NullVariable, GetAttrVariable(TritonKernelVariable(), run), TupleVariable(length=0), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, GetAttrVariable(TritonKernelVariable(), run), TupleVariable(length=0), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, GetAttrVariable(TritonKernelVariable(), run), TupleVariable(length=0), ConstDictVariable()]
TRACE inlined call grid from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:452 in run (Heuristics.run) (inline depth: 6)
        return self.fn.run(*args, **kwargs)
               ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in grid (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 7)
            def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
TRACE RESUME 0 []
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF V [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST meta [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE LOAD_CONST BV [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstDictVariable(), ConstantVariable(str: 'BV')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in grid (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 7)
        def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
                                ~~~~~~~~~~~^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 128)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 128)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 128)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 9)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 9)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [ConstantVariable(int: 128)]
TRACE BINARY_OP 0 [ConstantVariable(int: 128), ConstantVariable(int: 32)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 160)]
TRACE BINARY_OP 10 [ConstantVariable(int: 160), ConstantVariable(int: 1)]
TRACE LOAD_FAST y [ConstantVariable(int: 159)]
TRACE BINARY_OP 2 [ConstantVariable(int: 159), ConstantVariable(int: 32)]
TRACE RETURN_VALUE None [ConstantVariable(int: 4)]
DONE INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [ConstantVariable(int: 4)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 4)]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE LOAD_DEREF N [ConstantVariable(int: 4)]
TRACE LOAD_DEREF H [ConstantVariable(int: 4), ConstantVariable(int: 1)]
TRACE BINARY_OP 5 [ConstantVariable(int: 4), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE BUILD_TUPLE 2 [ConstantVariable(int: 4), ConstantVariable(int: 64)]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>
TRACE inlined call grid from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:452 in run (Heuristics.run) (inline depth: 6)
        return self.fn.run(*args, **kwargs)
               ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in grid (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 7)
            def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
TRACE RESUME 0 []
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF V [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST meta [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE LOAD_CONST BV [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstDictVariable(), ConstantVariable(str: 'BV')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in grid (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 7)
        def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
                                ~~~~~~~~~~~^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 128)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 128)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 128)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 9)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 9)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [ConstantVariable(int: 128)]
TRACE BINARY_OP 0 [ConstantVariable(int: 128), ConstantVariable(int: 32)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 160)]
TRACE BINARY_OP 10 [ConstantVariable(int: 160), ConstantVariable(int: 1)]
TRACE LOAD_FAST y [ConstantVariable(int: 159)]
TRACE BINARY_OP 2 [ConstantVariable(int: 159), ConstantVariable(int: 32)]
TRACE RETURN_VALUE None [ConstantVariable(int: 4)]
DONE INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [ConstantVariable(int: 4)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 4)]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE LOAD_DEREF N [ConstantVariable(int: 4)]
TRACE LOAD_DEREF H [ConstantVariable(int: 4), ConstantVariable(int: 1)]
TRACE BINARY_OP 5 [ConstantVariable(int: 4), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE BUILD_TUPLE 2 [ConstantVariable(int: 4), ConstantVariable(int: 64)]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>
TRACE inlined call grid from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:452 in run (Heuristics.run) (inline depth: 6)
        return self.fn.run(*args, **kwargs)
               ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in grid (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 7)
            def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
TRACE RESUME 0 []
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF V [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST meta [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE LOAD_CONST BV [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstDictVariable(), ConstantVariable(str: 'BV')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in grid (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 7)
        def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
                                ~~~~~~~~~~~^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 128)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 128)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 128)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 9)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 9)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [ConstantVariable(int: 128)]
TRACE BINARY_OP 0 [ConstantVariable(int: 128), ConstantVariable(int: 32)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 160)]
TRACE BINARY_OP 10 [ConstantVariable(int: 160), ConstantVariable(int: 1)]
TRACE LOAD_FAST y [ConstantVariable(int: 159)]
TRACE BINARY_OP 2 [ConstantVariable(int: 159), ConstantVariable(int: 32)]
TRACE RETURN_VALUE None [ConstantVariable(int: 4)]
DONE INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [ConstantVariable(int: 4)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 4)]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE LOAD_DEREF N [ConstantVariable(int: 4)]
TRACE LOAD_DEREF H [ConstantVariable(int: 4), ConstantVariable(int: 1)]
TRACE BINARY_OP 5 [ConstantVariable(int: 4), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE BUILD_TUPLE 2 [ConstantVariable(int: 4), ConstantVariable(int: 64)]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>
TRACE FX call triton_kernel_wrapper_mutation from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:452 in run (Heuristics.run) (inline depth: 6)
        return self.fn.run(*args, **kwargs)
               ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [ConstantVariable(NoneType: None)]
DONE INLINING <code object run at 0x70c9a971df10, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py", line 449>
TRACE RETURN_VALUE None [ConstantVariable(NoneType: None)]
DONE INLINING <code object <lambda> at 0x70c9a9437780, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 419>
TRACE POP_TOP None [ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:176 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            return o, final_state
TRACE LOAD_FAST o []
TRACE LOAD_FAST final_state [TensorVariable()]
TRACE BUILD_TUPLE 2 [TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object forward at 0x3060e8b0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 124>
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object wrapper at 0x70c98d04f0a0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 16>
TRACE UNPACK_SEQUENCE 2 [TupleVariable(length=2)]
TRACE STORE_FAST o [TensorVariable(), TensorVariable()]
TRACE STORE_FAST final_state [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:258 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
        return o, final_state
TRACE LOAD_FAST o []
TRACE LOAD_FAST final_state [TensorVariable()]
TRACE BUILD_TUPLE 2 [TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object fused_recurrent_dplr_delta_rule at 0x305fb4e0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 188>
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object fused_recurrent_rwkv7 at 0x70c98d0c9890, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py", line 11>
TRACE UNPACK_SEQUENCE 2 [TupleVariable(length=2)]
TRACE STORE_FAST xx [TensorVariable(), TensorVariable()]
TRACE STORE_FAST state [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:612 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            xx = xx.view(B,T,-1) * (float(N) ** -0.5)
TRACE LOAD_FAST xx []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: -1)]
TRACE FX call view_15 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:612 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.view(B,T,-1) * (float(N) ** -0.5)
             ~~~~~~~^^^^^^^^
TRACE LOAD_GLOBAL float [TensorVariable()]
TRACE LOAD_FAST N [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE LOAD_CONST -0.5 [TensorVariable(), ConstantVariable(float: 128.0)]
TRACE BINARY_OP 8 [TensorVariable(), ConstantVariable(float: 128.0), ConstantVariable(float: -0.5)]
TRACE BINARY_OP 5 [TensorVariable(), ConstantVariable(float: 0.08838834764831845)]
TRACE FX call mul_12 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:612 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.view(B,T,-1) * (float(N) ** -0.5)
             ~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST xx [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
TRACE LOAD_FAST xx []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST r [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR dtype [NullVariable, GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_10 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
             ~~~~~^^^^^^^^^^^^^^^
TRACE LOAD_FAST r [TensorVariable()]
TRACE LOAD_ATTR view [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST B [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64)]
TRACE CALL 4 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_16 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                      ~~~~~~^^^^^^^^^
TRACE LOAD_FAST k [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR view [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST B [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64)]
TRACE CALL 4 [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_17 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                                      ~~~~~~^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call mul_13 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                      ~~~~~~~~~~~~~~~^^~~~~~~~~~~~~~~
TRACE LOAD_FAST r_k [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR view [TensorVariable(), TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['r_k'] (8192,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='r_k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_r_k_ L['r_k'] FakeTensor(..., device='cuda:0', size=(8192,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE LOAD_FAST H [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST N [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 64)]
TRACE CALL 2 [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_18 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                                                      ~~~~~~~~^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call mul_14 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^~~~~~~~~~~~~
TRACE LOAD_ATTR sum [TensorVariable(), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), sum)]
TRACE LOAD_CONST True [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), sum), ConstantVariable(int: -1)]
TRACE KW_NAMES ('dim', 'keepdim') [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), sum), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), sum), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call sum_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_FAST v [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR view [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST B [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64)]
TRACE CALL 4 [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_19 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                                                                                                 ~~~~~~^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call mul_15 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~
TRACE LOAD_ATTR view [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST B [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64)]
TRACE BINARY_OP 5 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE CALL 3 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8192)]
TRACE FX call view_20 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable()]
TRACE FX call add_8 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
             ~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST xx [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:616 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            output = fpx_matmul((xx * (torch.sigmoid(xg) @ g2)), O_, O_state,ebits,mbits)
TRACE LOAD_GLOBAL fpx_matmul []
TRACE LOAD_FAST xx [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL torch [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR sigmoid [NullVariable, LazyVariableTracker(), TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST xg [NullVariable, LazyVariableTracker(), TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call sigmoid_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:616 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        output = fpx_matmul((xx * (torch.sigmoid(xg) @ g2)), O_, O_state,ebits,mbits)
                                   ~~~~~~~~~~~~~^^^^
TRACE LOAD_FAST g2 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE BINARY_OP 4 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['g2'] (480, 8192) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='g2', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_g2_ L['g2'] FakeTensor(..., device='cuda:0', size=(480, 8192), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call matmul_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:616 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        output = fpx_matmul((xx * (torch.sigmoid(xg) @ g2)), O_, O_state,ebits,mbits)
                                   ~~~~~~~~~~~~~~~~~~^~~~
TRACE BINARY_OP 5 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE FX call mul_16 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:616 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        output = fpx_matmul((xx * (torch.sigmoid(xg) @ g2)), O_, O_state,ebits,mbits)
                             ~~~^~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_FAST O_ [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST O_state [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_FAST ebits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST mbits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: -44)]
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: -44), LazyVariableTracker()]
TRACE inlined call fpx_matmul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:616 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        output = fpx_matmul((xx * (torch.sigmoid(xg) @ g2)), O_, O_state,ebits,mbits)
                 ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object fpx_matmul at 0x3063a810, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:420 in fpx_matmul (fpx_matmul) (inline depth: 1)
    def fpx_matmul(x,weight,weight_state,ebits:int=3,mbits:int=2):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:421 in fpx_matmul (fpx_matmul) (inline depth: 1)
        if ebits == -44: #hqq
TRACE LOAD_FAST ebits []
TRACE LOAD_CONST -44 [ConstantVariable(int: -44)]
TRACE COMPARE_OP == [ConstantVariable(int: -44), ConstantVariable(int: -44)]
TRACE POP_JUMP_IF_FALSE 322 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S0=x.shape[0]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE FX call size_14 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul) (inline depth: 1)
        S0=x.shape[0]
           ^^^^^^^
TRACE LOAD_CONST 0 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 0)]
TRACE STORE_FAST S0 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S1=x.shape[1]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE FX call size_15 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul) (inline depth: 1)
        S1=x.shape[1]
           ^^^^^^^
TRACE LOAD_CONST 1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 1)]
TRACE STORE_FAST S1 [SymNodeVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:424 in fpx_matmul (fpx_matmul) (inline depth: 1)
            dtype = x.dtype
TRACE LOAD_FAST x []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
            x = x.to(dtype=torch.float16).view(-1,x.shape[2])
TRACE LOAD_FAST x []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float16 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_11 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST x [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1)]
TRACE LOAD_ATTR shape [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), TensorVariable()]
TRACE FX call size_16 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
                                              ^^^^^^^
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3), ConstantVariable(int: 2)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), ConstantVariable(int: 8192)]
TRACE FX call view_21 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
            out = weight.forward_manual(x).to(dtype=dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_ATTR forward_manual [LazyVariableTracker()]
TRACE LOAD_FAST x [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE CALL 1 [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton)), TensorVariable()]
TRACE inlined call forward_manual from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:543 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        def forward_manual(self, x: Tensor, matmul_type: str="GEMM") -> Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE LOAD_GLOBAL forward_functional []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:545 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                x,
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:546 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.bias,
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR bias [NullVariable, LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_tensor_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_ATTR get_tensor_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_tensor_args at 0x70c98a9e9080>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_tensor_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_tensor_args(),
            ~~~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:524 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
        def get_tensor_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:525 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
            return [self.W_q, self.scales, self.zeros]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR W_q [UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_FAST self [LazyVariableTracker()]
TRACE LOAD_ATTR scales [LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['O_']._parameters['scales'] (128, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='O_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='scales'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_O_parameters_scales_ L['O_']._parameters['scales'] Parameter(FakeTensor(..., device='cuda:0', size=(128, 5120), dtype=torch.float16)) at debug_level 0 before=False
TRACE LOAD_FAST self [LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR zeros [LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['O_']._parameters['zeros'] (128, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='O_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='zeros'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_O_parameters_zeros_ L['O_']._parameters['zeros'] Parameter(FakeTensor(..., device='cuda:0', size=(128, 5120), dtype=torch.float16)) at debug_level 0 before=False
TRACE BUILD_LIST 3 [LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [ListVariable(length=3)]
DONE INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_meta_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3)]
TRACE LOAD_ATTR get_meta_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_meta_args at 0x70c98a9e9120>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_meta_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_meta_args(),
            ~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:527 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
        def get_meta_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE LOAD_GLOBAL int []
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR scaled_activations [NullVariable, LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:529 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_nbits,
TRACE LOAD_FAST self [ConstantVariable(int: 0)]
TRACE LOAD_ATTR W_nbits [ConstantVariable(int: 0), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:530 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.group_size,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker()]
TRACE LOAD_ATTR group_size [ConstantVariable(int: 0), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:531 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.unpack_mask,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR unpack_mask [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:532 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.elements_per_sample,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR elements_per_sample [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:533 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.input_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR input_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:534 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.output_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR output_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:535 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.acc_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR acc_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:536 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.meta_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR meta_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:537 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.channel_scale_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR channel_scale_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:538 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_group_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR W_group_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:539 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    int(self.data_contiguous),
TRACE LOAD_GLOBAL int [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int)]
TRACE LOAD_ATTR data_contiguous [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE BUILD_LIST 12 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [ListVariable(length=12)]
DONE INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:549 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
TRACE LOAD_GLOBAL GEMLITE_MATMUL_TYPES_MAPPING [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12)]
TRACE LOAD_FAST matmul_type [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker(), ConstantVariable(str: 'GEMM')]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), ConstantVariable(int: 4)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        return forward_functional(
               ~~~~~~~~~~~~~~~~~~^
            x,
            ^^
            self.bias,
            ^^^^^^^^^^
            self.get_tensor_args(),
            ^^^^^^^^^^^^^^^^^^^^^^^
            self.get_meta_args(),
            ^^^^^^^^^^^^^^^^^^^^^
            GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:675 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        def __call__(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
            return self._opoverload(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR _opoverload [NullVariable, UserDefinedObjectVariable(CustomOpDef)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=5)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
wrap_to_fake L['O_'].W_q (1024, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=AttrSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='O_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='W_q'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_O_W_q L['O_'].W_q FakeTensor(..., device='cuda:0', size=(1024, 5120), dtype=torch.int32) at debug_level 0 before=False
TRACE FX call forward_functional_default_1 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        return self._opoverload(*args, **kwargs)
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_12 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE STORE_FAST out [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
            return out.view(S0,S1,-1)
TRACE LOAD_FAST out []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST S0 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST S1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: -1)]
TRACE FX call view_22 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
        return out.view(S0,S1,-1)
               ~~~~~~~~^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object fpx_matmul at 0x3063a810, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>
TRACE STORE_FAST output [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:618 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            x_in = x_in + output
TRACE LOAD_FAST x_in []
TRACE LOAD_FAST output [TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable()]
TRACE FX call add_9 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:618 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        x_in = x_in + output
               ~~~~~^~~~~~~~
TRACE STORE_FAST x_in [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:619 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            output = T5RMSNorm(x_in,ln2,variance_epsilon=rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST x_in [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln2 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE KW_NAMES ('variance_epsilon',) [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ConstantVariable(float: 1e-06)]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:619 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        output = T5RMSNorm(x_in,ln2,variance_epsilon=rmsnorm_epsilon)
                 ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_13 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_10 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_17 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln2'] (5120,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln2', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln2_ L['ln2'] FakeTensor(..., device='cuda:0', size=(5120,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_18 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_14 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST output [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:621 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            return  output, x[:,-1], state, v_first, k_first, x_in
TRACE LOAD_FAST output []
TRACE LOAD_FAST x [TensorVariable()]
TRACE LOAD_CONST None [TensorVariable(), TensorVariable()]
TRACE LOAD_CONST None [TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST -1 [TensorVariable(), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [TensorVariable(), TensorVariable(), SliceVariable(), ConstantVariable(int: -1)]
TRACE BINARY_SUBSCR None [TensorVariable(), TensorVariable(), TupleVariable(length=2)]
TRACE FX call getitem_74 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:621 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        return  output, x[:,-1], state, v_first, k_first, x_in
                        ~^^^^^^
TRACE LOAD_FAST state [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST v_first [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST k_first [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST x_in [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 6 [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [TupleVariable(length=6)]
Step 1: torchdynamo done tracing hxa079_TimeMix (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py, line 621 in hxa079_TimeMix>], graph_break=False)
REMOVE UNUSED GRAPHARG L['layer_id']
REMOVE UNUSED GRAPHARG L['calc_sin'].size()[1]
TRACED GRAPH
 ===== __compiled_fn_21_bbf03636_8cd1_4cea_8e56_ba8bfea2d0e4 =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, s52: "Sym(s22)", L_x_in_: "[31mbf16[0m[34m[1, s22, 5120][0m[2m[34m[5120*s22, 5120, 1][0m[2m[32mcuda:0[0m", L_ln1_: "[31mbf16[0m[34m[5120][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_wavgk1_: "[31mbf16[0m[34m[5120, 1376][0m[2m[34m[1376, 1][0m[2m[32mcuda:0[0m", L_RKV_parameters_scales_: "[31mf16[0m[34m[80, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m", L_RKV_parameters_zeros_: "[31mf16[0m[34m[80, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m", L_RKV_W_q: "[31mi32[0m[34m[640, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m", L_R_bias_: "[31mbf16[0m[34m[][0m[2m[34m[][0m[2m[32mcuda:0[0m", L_ln_r_: "[31mbf16[0m[34m[128][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_ln_k_: "[31mbf16[0m[34m[128][0m[2m[34m[1][0m[2m[32mcuda:0[0m", s22: "Sym(s22)", L_calc_cos_: "[31mf32[0m[34m[1, s22, 128][0m[2m[34m[128*s22, 128, 1][0m[2m[32mcuda:0[0m", L_calc_sin_: "[31mf32[0m[34m[1, s22, 128][0m[2m[34m[128*s22, 128, 1][0m[2m[32mcuda:0[0m", L_a2_: "[31mbf16[0m[34m[160, 8192][0m[2m[34m[8192, 1][0m[2m[32mcuda:0[0m", L_a0_: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m", L_w2_: "[31mbf16[0m[34m[480, 8192][0m[2m[34m[8192, 1][0m[2m[32mcuda:0[0m", L_w0_: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m", L_state_: "[31mbf16[0m[34m[1, 64, 128, 128][0m[2m[34m[1048576, 16384, 128, 1][0m[2m[32mcuda:0[0m", L_r_k_: "[31mbf16[0m[34m[8192][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_g2_: "[31mbf16[0m[34m[480, 8192][0m[2m[34m[8192, 1][0m[2m[32mcuda:0[0m", L_O_parameters_scales_: "[31mf16[0m[34m[128, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m", L_O_parameters_zeros_: "[31mf16[0m[34m[128, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m", L_O_W_q: "[31mi32[0m[34m[1024, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m", L_ln2_: "[31mbf16[0m[34m[5120][0m[2m[34m[1][0m[2m[32mcuda:0[0m"):
        l_x_in_ = L_x_in_
        l_ln1_ = L_ln1_
        l_wavgk1_ = L_wavgk1_
        l_rkv_parameters_scales_ = L_RKV_parameters_scales_
        l_rkv_parameters_zeros_ = L_RKV_parameters_zeros_
        l_rkv_w_q = L_RKV_W_q
        l_r_bias_ = L_R_bias_
        l_ln_r_ = L_ln_r_
        l_ln_k_ = L_ln_k_
        l_calc_cos_ = L_calc_cos_
        l_calc_sin_ = L_calc_sin_
        l_a2_ = L_a2_
        l_a0_ = L_a0_
        l_w2_ = L_w2_
        l_w0_ = L_w0_
        l_state_ = L_state_
        l_r_k_ = L_r_k_
        l_g2_ = L_g2_
        l_o_parameters_scales_ = L_O_parameters_scales_
        l_o_parameters_zeros_ = L_O_parameters_zeros_
        l_o_w_q = L_O_W_q
        l_ln2_ = L_ln2_
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states: "[31mf32[0m[34m[1, s22, 5120][0m[2m[34m[5120*s22, 5120, 1][0m[2m[32mcuda:0[0m" = l_x_in_.to([34mtorch.float32[0m)
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_1: "[31mf32[0m[34m[1, s22, 5120][0m[2m[34m[5120*s22, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states.pow([34m2[0m)
        variance: "[31mf32[0m[34m[1, s22, 1][0m[2m[34m[s22, 1, 1][0m[2m[32mcuda:0[0m" = pow_1.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add: "[31mf32[0m[34m[1, s22, 1][0m[2m[34m[s22, 1, 1][0m[2m[32mcuda:0[0m" = variance + [34m1e-06[0m;  [2mvariance = None[0m
        rsqrt: "[31mf32[0m[34m[1, s22, 1][0m[2m[34m[s22, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add);  [2madd = None[0m
        hidden_states_1: "[31mf32[0m[34m[1, s22, 5120][0m[2m[34m[5120*s22, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states * rsqrt;  [2mhidden_states = rsqrt = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_1: "[31mf32[0m[34m[1, s22, 5120][0m[2m[34m[5120*s22, 5120, 1][0m[2m[32mcuda:0[0m" = l_ln1_ * hidden_states_1;  [2ml_ln1_ = hidden_states_1 = None[0m
        x: "[31mbf16[0m[34m[1, s22, 5120][0m[2m[34m[5120*s22, 5120, 1][0m[2m[32mcuda:0[0m" = mul_1.to([34mtorch.bfloat16[0m);  [2mmul_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:551 in hxa079_TimeMix, code: xw,xa,xv,xg,xk = (x @ wavgk1).split(wavgk_split_list, dim=-1)[0m
        matmul: "[31mbf16[0m[34m[1, s22, 1376][0m[2m[34m[1376*s22, 1376, 1][0m[2m[32mcuda:0[0m" = x @ l_wavgk1_;  [2ml_wavgk1_ = None[0m
        split = matmul.split([[34m480[0m, [34m160[0m, [34m128[0m, [34m480[0m, [34m128[0m], dim = [34m-1[0m);  [2mmatmul = None[0m
        xw: "[31mbf16[0m[34m[1, s22, 480][0m[2m[34m[1376*s22, 1376, 1][0m[2m[32mcuda:0[0m" = split[[34m0[0m]
        xa: "[31mbf16[0m[34m[1, s22, 160][0m[2m[34m[1376*s22, 1376, 1][0m[2m[32mcuda:0[0m" = split[[34m1[0m]
        xg: "[31mbf16[0m[34m[1, s22, 480][0m[2m[34m[1376*s22, 1376, 1][0m[2m[32mcuda:0[0m" = split[[34m3[0m];  [2msplit = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul, code: x = x.to(dtype=torch.float16).view(-1,x.shape[2])[0m
        to_2: "[31mf16[0m[34m[1, s22, 5120][0m[2m[34m[5120*s22, 5120, 1][0m[2m[32mcuda:0[0m" = x.to(dtype = [34mtorch.float16[0m)
        x_1: "[31mf16[0m[34m[s22, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m" = to_2.view([34m-1[0m, [34m5120[0m);  [2mto_2 = None[0m
        
         [2m# File: /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__, code: return self._opoverload(*args, **kwargs)[0m
        forward_functional_default: "[31mf16[0m[34m[s22, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m" = torch.ops.gemlite.forward_functional.default(x_1, [34mNone[0m, [l_rkv_w_q, l_rkv_parameters_scales_, l_rkv_parameters_zeros_], [[34m0[0m, [34m4[0m, [34m64[0m, [34m15[0m, [34m8[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m0[0m, [34m4[0m, [34m1[0m], [34m4[0m);  [2mx_1 = l_rkv_w_q = l_rkv_parameters_scales_ = l_rkv_parameters_zeros_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul, code: out = weight.forward_manual(x).to(dtype=dtype)[0m
        out: "[31mbf16[0m[34m[s22, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m" = forward_functional_default.to(dtype = [34mtorch.bfloat16[0m);  [2mforward_functional_default = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul, code: return out.view(S0,S1,-1)[0m
        rkv: "[31mbf16[0m[34m[1, s22, 10240][0m[2m[34m[10240*s22, 10240, 1][0m[2m[32mcuda:0[0m" = out.view([34m1[0m, s22, [34m-1[0m);  [2mout = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:556 in hxa079_TimeMix, code: r,k,v = rkv.split(rkv_split_list,dim=-1)[0m
        split_1 = rkv.split([[34m8192[0m, [34m1024[0m, [34m1024[0m], dim = [34m-1[0m);  [2mrkv = None[0m
        r: "[31mbf16[0m[34m[1, s22, 8192][0m[2m[34m[10240*s22, 10240, 1][0m[2m[32mcuda:0[0m" = split_1[[34m0[0m]
        k: "[31mbf16[0m[34m[1, s22, 1024][0m[2m[34m[10240*s22, 10240, 1][0m[2m[32mcuda:0[0m" = split_1[[34m1[0m]
        v: "[31mbf16[0m[34m[1, s22, 1024][0m[2m[34m[10240*s22, 10240, 1][0m[2m[32mcuda:0[0m" = split_1[[34m2[0m];  [2msplit_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:562 in hxa079_TimeMix, code: r = r.add_(R_bias)[0m
        r_1: "[31mbf16[0m[34m[1, s22, 8192][0m[2m[34m[10240*s22, 10240, 1][0m[2m[32mcuda:0[0m" = r.add_(l_r_bias_);  [2mr = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:563 in hxa079_TimeMix, code: k = k.add_(K_bias).view(B, T, kv_per_head, N)[0m
        add__1: "[31mbf16[0m[34m[1, s22, 1024][0m[2m[34m[10240*s22, 10240, 1][0m[2m[32mcuda:0[0m" = k.add_(l_r_bias_);  [2mk = None[0m
        k_1: "[31mbf16[0m[34m[1, s22, 8, 128][0m[2m[34m[10240*s22, 10240, 128, 1][0m[2m[32mcuda:0[0m" = add__1.view([34m1[0m, s22, [34m8[0m, [34m128[0m);  [2madd__1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:564 in hxa079_TimeMix, code: v = v.add_(V_bias).view(B, T, kv_per_head, N)[0m
        add__2: "[31mbf16[0m[34m[1, s22, 1024][0m[2m[34m[10240*s22, 10240, 1][0m[2m[32mcuda:0[0m" = v.add_(l_r_bias_);  [2mv = l_r_bias_ = None[0m
        v_1: "[31mbf16[0m[34m[1, s22, 8, 128][0m[2m[34m[10240*s22, 10240, 128, 1][0m[2m[32mcuda:0[0m" = add__2.view([34m1[0m, s22, [34m8[0m, [34m128[0m);  [2madd__2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:572 in hxa079_TimeMix, code: r = T5RMSNorm(r.view(B,T,H,N), ln_r, variance_epsilon=rmsnorm_epsilon)[0m
        view_4: "[31mbf16[0m[34m[1, s22, 64, 128][0m[2m[34m[10240*s22, 10240, 128, 1][0m[2m[32mcuda:0[0m" = r_1.view([34m1[0m, s22, [34m64[0m, [34m128[0m);  [2mr_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states_2: "[31mf32[0m[34m[1, s22, 64, 128][0m[2m[34m[8192*s22, 8192, 128, 1][0m[2m[32mcuda:0[0m" = view_4.to([34mtorch.float32[0m);  [2mview_4 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_2: "[31mf32[0m[34m[1, s22, 64, 128][0m[2m[34m[8192*s22, 8192, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_2.pow([34m2[0m)
        variance_1: "[31mf32[0m[34m[1, s22, 64, 1][0m[2m[34m[64*s22, 64, 1, 1][0m[2m[32mcuda:0[0m" = pow_2.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add_1: "[31mf32[0m[34m[1, s22, 64, 1][0m[2m[34m[64*s22, 64, 1, 1][0m[2m[32mcuda:0[0m" = variance_1 + [34m1e-06[0m;  [2mvariance_1 = None[0m
        rsqrt_1: "[31mf32[0m[34m[1, s22, 64, 1][0m[2m[34m[64*s22, 64, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add_1);  [2madd_1 = None[0m
        hidden_states_3: "[31mf32[0m[34m[1, s22, 64, 128][0m[2m[34m[8192*s22, 8192, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_2 * rsqrt_1;  [2mhidden_states_2 = rsqrt_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_3: "[31mf32[0m[34m[1, s22, 64, 128][0m[2m[34m[8192*s22, 8192, 128, 1][0m[2m[32mcuda:0[0m" = l_ln_r_ * hidden_states_3;  [2ml_ln_r_ = hidden_states_3 = None[0m
        r_2: "[31mbf16[0m[34m[1, s22, 64, 128][0m[2m[34m[8192*s22, 8192, 128, 1][0m[2m[32mcuda:0[0m" = mul_3.to([34mtorch.bfloat16[0m);  [2mmul_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states_4: "[31mf32[0m[34m[1, s22, 8, 128][0m[2m[34m[1024*s22, 1024, 128, 1][0m[2m[32mcuda:0[0m" = k_1.to([34mtorch.float32[0m);  [2mk_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_3: "[31mf32[0m[34m[1, s22, 8, 128][0m[2m[34m[1024*s22, 1024, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_4.pow([34m2[0m)
        variance_2: "[31mf32[0m[34m[1, s22, 8, 1][0m[2m[34m[8*s22, 8, 1, 1][0m[2m[32mcuda:0[0m" = pow_3.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add_2: "[31mf32[0m[34m[1, s22, 8, 1][0m[2m[34m[8*s22, 8, 1, 1][0m[2m[32mcuda:0[0m" = variance_2 + [34m1e-06[0m;  [2mvariance_2 = None[0m
        rsqrt_2: "[31mf32[0m[34m[1, s22, 8, 1][0m[2m[34m[8*s22, 8, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add_2);  [2madd_2 = None[0m
        hidden_states_5: "[31mf32[0m[34m[1, s22, 8, 128][0m[2m[34m[1024*s22, 1024, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_4 * rsqrt_2;  [2mhidden_states_4 = rsqrt_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_5: "[31mf32[0m[34m[1, s22, 8, 128][0m[2m[34m[1024*s22, 1024, 128, 1][0m[2m[32mcuda:0[0m" = l_ln_k_ * hidden_states_5;  [2ml_ln_k_ = hidden_states_5 = None[0m
        k_2: "[31mbf16[0m[34m[1, s22, 8, 128][0m[2m[34m[1024*s22, 1024, 128, 1][0m[2m[32mcuda:0[0m" = mul_5.to([34mtorch.bfloat16[0m);  [2mmul_5 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:576 in hxa079_TimeMix, code: cos, sin = calc_cos.to(k.dtype), calc_sin.to(k.dtype)[0m
        cos: "[31mbf16[0m[34m[1, s22, 128][0m[2m[34m[128*s22, 128, 1][0m[2m[32mcuda:0[0m" = l_calc_cos_.to([34mtorch.bfloat16[0m);  [2ml_calc_cos_ = None[0m
        sin: "[31mbf16[0m[34m[1, s22, 128][0m[2m[34m[128*s22, 128, 1][0m[2m[32mcuda:0[0m" = l_calc_sin_.to([34mtorch.bfloat16[0m);  [2ml_calc_sin_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:493 in apply_rotary_pos_emb, code: cos = cos.unsqueeze(unsqueeze_dim)[0m
        cos_1: "[31mbf16[0m[34m[1, s22, 1, 128][0m[2m[34m[128*s22, 128, 128, 1][0m[2m[32mcuda:0[0m" = cos.unsqueeze([34m2[0m);  [2mcos = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:494 in apply_rotary_pos_emb, code: sin = sin.unsqueeze(unsqueeze_dim)[0m
        sin_1: "[31mbf16[0m[34m[1, s22, 1, 128][0m[2m[34m[128*s22, 128, 128, 1][0m[2m[32mcuda:0[0m" = sin.unsqueeze([34m2[0m);  [2msin = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb, code: q_embed = (q * cos) + (rotate_half(q) * sin)[0m
        mul_6: "[31mbf16[0m[34m[1, s22, 64, 128][0m[2m[34m[8192*s22, 8192, 128, 1][0m[2m[32mcuda:0[0m" = r_2 * cos_1
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half, code: x1 = x[..., : x.shape[-1] // 2][0m
        x1: "[31mbf16[0m[34m[1, s22, 64, 64][0m[2m[34m[8192*s22, 8192, 128, 1][0m[2m[32mcuda:0[0m" = r_2[([34mEllipsis[0m, slice([34mNone[0m, [34m64[0m, [34mNone[0m))]
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half, code: x2 = x[..., x.shape[-1] // 2 :][0m
        x2: "[31mbf16[0m[34m[1, s22, 64, 64][0m[2m[34m[8192*s22, 8192, 128, 1][0m[2m[32mcuda:0[0m" = r_2[([34mEllipsis[0m, slice([34m64[0m, [34mNone[0m, [34mNone[0m))];  [2mr_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half, code: return torch.cat((-x2, x1), dim=-1)[0m
        neg: "[31mbf16[0m[34m[1, s22, 64, 64][0m[2m[34m[4096*s22, 4096, 64, 1][0m[2m[32mcuda:0[0m" = -x2;  [2mx2 = None[0m
        cat: "[31mbf16[0m[34m[1, s22, 64, 128][0m[2m[34m[8192*s22, 8192, 128, 1][0m[2m[32mcuda:0[0m" = torch.cat((neg, x1), dim = [34m-1[0m);  [2mneg = x1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb, code: q_embed = (q * cos) + (rotate_half(q) * sin)[0m
        mul_7: "[31mbf16[0m[34m[1, s22, 64, 128][0m[2m[34m[8192*s22, 8192, 128, 1][0m[2m[32mcuda:0[0m" = cat * sin_1;  [2mcat = None[0m
        q_embed: "[31mbf16[0m[34m[1, s22, 64, 128][0m[2m[34m[8192*s22, 8192, 128, 1][0m[2m[32mcuda:0[0m" = mul_6 + mul_7;  [2mmul_6 = mul_7 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb, code: k_embed = (k * cos) + (rotate_half(k) * sin)[0m
        mul_8: "[31mbf16[0m[34m[1, s22, 8, 128][0m[2m[34m[1024*s22, 1024, 128, 1][0m[2m[32mcuda:0[0m" = k_2 * cos_1;  [2mcos_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half, code: x1 = x[..., : x.shape[-1] // 2][0m
        x1_1: "[31mbf16[0m[34m[1, s22, 8, 64][0m[2m[34m[1024*s22, 1024, 128, 1][0m[2m[32mcuda:0[0m" = k_2[([34mEllipsis[0m, slice([34mNone[0m, [34m64[0m, [34mNone[0m))]
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half, code: x2 = x[..., x.shape[-1] // 2 :][0m
        x2_1: "[31mbf16[0m[34m[1, s22, 8, 64][0m[2m[34m[1024*s22, 1024, 128, 1][0m[2m[32mcuda:0[0m" = k_2[([34mEllipsis[0m, slice([34m64[0m, [34mNone[0m, [34mNone[0m))];  [2mk_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half, code: return torch.cat((-x2, x1), dim=-1)[0m
        neg_1: "[31mbf16[0m[34m[1, s22, 8, 64][0m[2m[34m[512*s22, 512, 64, 1][0m[2m[32mcuda:0[0m" = -x2_1;  [2mx2_1 = None[0m
        cat_1: "[31mbf16[0m[34m[1, s22, 8, 128][0m[2m[34m[1024*s22, 1024, 128, 1][0m[2m[32mcuda:0[0m" = torch.cat((neg_1, x1_1), dim = [34m-1[0m);  [2mneg_1 = x1_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb, code: k_embed = (k * cos) + (rotate_half(k) * sin)[0m
        mul_9: "[31mbf16[0m[34m[1, s22, 8, 128][0m[2m[34m[1024*s22, 1024, 128, 1][0m[2m[32mcuda:0[0m" = cat_1 * sin_1;  [2mcat_1 = sin_1 = None[0m
        k_embed: "[31mbf16[0m[34m[1, s22, 8, 128][0m[2m[34m[1024*s22, 1024, 128, 1][0m[2m[32mcuda:0[0m" = mul_8 + mul_9;  [2mmul_8 = mul_9 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:357 in repeat_kv, code: hidden_states = hidden_states[:, :, :, None, :]  # (B, T, H_kv, 1, D)[0m
        hidden_states_6: "[31mbf16[0m[34m[1, s22, 8, 1, 128][0m[2m[34m[1024*s22, 1024, 128, 128, 1][0m[2m[32mcuda:0[0m" = k_embed[(slice([34mNone[0m, [34mNone[0m, [34mNone[0m), slice([34mNone[0m, [34mNone[0m, [34mNone[0m), slice([34mNone[0m, [34mNone[0m, [34mNone[0m), [34mNone[0m, slice([34mNone[0m, [34mNone[0m, [34mNone[0m))]
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:358 in repeat_kv, code: hidden_states = hidden_states.expand(B, T, H_kv, n_rep, D)  # (B, T, H_kv, n_rep, D)[0m
        hidden_states_7: "[31mbf16[0m[34m[1, s22, 8, 8, 128][0m[2m[34m[1024*s22, 1024, 128, 0, 1][0m[2m[32mcuda:0[0m" = hidden_states_6.expand([34m1[0m, s22, [34m8[0m, [34m8[0m, [34m128[0m);  [2mhidden_states_6 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv, code: return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()[0m
        reshape: "[31mbf16[0m[34m[1, s22, 64, 128][0m[2m[34m[8192*s22, 8192, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_7.reshape([34m1[0m, s22, [34m64[0m, [34m128[0m);  [2mhidden_states_7 = None[0m
        contiguous: "[31mbf16[0m[34m[1, s22, 64, 128][0m[2m[34m[8192*s22, 8192, 128, 1][0m[2m[32mcuda:0[0m" = reshape.contiguous();  [2mreshape = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:589 in hxa079_TimeMix, code: k = repeat_kv(k, kv_repeat).view(B, T, -1)[0m
        k_3: "[31mbf16[0m[34m[1, s22, 8192][0m[2m[34m[8192*s22, 8192, 1][0m[2m[32mcuda:0[0m" = contiguous.view([34m1[0m, s22, [34m-1[0m);  [2mcontiguous = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:357 in repeat_kv, code: hidden_states = hidden_states[:, :, :, None, :]  # (B, T, H_kv, 1, D)[0m
        hidden_states_8: "[31mbf16[0m[34m[1, s22, 8, 1, 128][0m[2m[34m[10240*s22, 10240, 128, 128, 1][0m[2m[32mcuda:0[0m" = v_1[(slice([34mNone[0m, [34mNone[0m, [34mNone[0m), slice([34mNone[0m, [34mNone[0m, [34mNone[0m), slice([34mNone[0m, [34mNone[0m, [34mNone[0m), [34mNone[0m, slice([34mNone[0m, [34mNone[0m, [34mNone[0m))]
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:358 in repeat_kv, code: hidden_states = hidden_states.expand(B, T, H_kv, n_rep, D)  # (B, T, H_kv, n_rep, D)[0m
        hidden_states_9: "[31mbf16[0m[34m[1, s22, 8, 8, 128][0m[2m[34m[10240*s22, 10240, 128, 0, 1][0m[2m[32mcuda:0[0m" = hidden_states_8.expand([34m1[0m, s22, [34m8[0m, [34m8[0m, [34m128[0m);  [2mhidden_states_8 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv, code: return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()[0m
        reshape_1: "[31mbf16[0m[34m[1, s22, 64, 128][0m[2m[34m[8192*s22, 8192, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_9.reshape([34m1[0m, s22, [34m64[0m, [34m128[0m);  [2mhidden_states_9 = None[0m
        contiguous_1: "[31mbf16[0m[34m[1, s22, 64, 128][0m[2m[34m[8192*s22, 8192, 128, 1][0m[2m[32mcuda:0[0m" = reshape_1.contiguous();  [2mreshape_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:590 in hxa079_TimeMix, code: v = repeat_kv(v, kv_repeat).view(B, T, -1)[0m
        v_2: "[31mbf16[0m[34m[1, s22, 8192][0m[2m[34m[8192*s22, 8192, 1][0m[2m[32mcuda:0[0m" = contiguous_1.view([34m1[0m, s22, [34m-1[0m);  [2mcontiguous_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:593 in hxa079_TimeMix, code: a = torch.sigmoid(xa @ a2 + a0)[0m
        matmul_1: "[31mbf16[0m[34m[1, s22, 8192][0m[2m[34m[8192*s22, 8192, 1][0m[2m[32mcuda:0[0m" = xa @ l_a2_;  [2mxa = l_a2_ = None[0m
        add_5: "[31mbf16[0m[34m[1, s22, 8192][0m[2m[34m[8192*s22, 8192, 1][0m[2m[32mcuda:0[0m" = matmul_1 + l_a0_;  [2mmatmul_1 = l_a0_ = None[0m
        a: "[31mbf16[0m[34m[1, s22, 8192][0m[2m[34m[8192*s22, 8192, 1][0m[2m[32mcuda:0[0m" = torch.sigmoid(add_5);  [2madd_5 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:595 in hxa079_TimeMix, code: kk = F.normalize(k.view(B, T, H, N), p=2.0, dim=-1).view(B, T, H*N)[0m
        view_7: "[31mbf16[0m[34m[1, s22, 64, 128][0m[2m[34m[8192*s22, 8192, 128, 1][0m[2m[32mcuda:0[0m" = k_3.view([34m1[0m, s22, [34m64[0m, [34m128[0m)
        normalize: "[31mbf16[0m[34m[1, s22, 64, 128][0m[2m[34m[8192*s22, 8192, 128, 1][0m[2m[32mcuda:0[0m" = torch.nn.functional.normalize(view_7, p = [34m2.0[0m, dim = [34m-1[0m);  [2mview_7 = None[0m
        kk: "[31mbf16[0m[34m[1, s22, 8192][0m[2m[34m[8192*s22, 8192, 1][0m[2m[32mcuda:0[0m" = normalize.view([34m1[0m, s22, [34m8192[0m);  [2mnormalize = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:596 in hxa079_TimeMix, code: w = torch.tanh(xw) @ w2 + w0[0m
        tanh: "[31mbf16[0m[34m[1, s22, 480][0m[2m[34m[480*s22, 480, 1][0m[2m[32mcuda:0[0m" = torch.tanh(xw);  [2mxw = None[0m
        matmul_2: "[31mbf16[0m[34m[1, s22, 8192][0m[2m[34m[8192*s22, 8192, 1][0m[2m[32mcuda:0[0m" = tanh @ l_w2_;  [2mtanh = l_w2_ = None[0m
        w: "[31mbf16[0m[34m[1, s22, 8192][0m[2m[34m[8192*s22, 8192, 1][0m[2m[32mcuda:0[0m" = matmul_2 + l_w0_;  [2mmatmul_2 = l_w0_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:597 in hxa079_TimeMix, code: w = -F.softplus(-w) - 0.5[0m
        neg_2: "[31mbf16[0m[34m[1, s22, 8192][0m[2m[34m[8192*s22, 8192, 1][0m[2m[32mcuda:0[0m" = -w;  [2mw = None[0m
        softplus: "[31mbf16[0m[34m[1, s22, 8192][0m[2m[34m[8192*s22, 8192, 1][0m[2m[32mcuda:0[0m" = torch._C._nn.softplus(neg_2);  [2mneg_2 = None[0m
        neg_3: "[31mbf16[0m[34m[1, s22, 8192][0m[2m[34m[8192*s22, 8192, 1][0m[2m[32mcuda:0[0m" = -softplus;  [2msoftplus = None[0m
        w_1: "[31mbf16[0m[34m[1, s22, 8192][0m[2m[34m[8192*s22, 8192, 1][0m[2m[32mcuda:0[0m" = neg_3 - [34m0.5[0m;  [2mneg_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:598 in hxa079_TimeMix, code: k = k * (1.0 - w + a)[0m
        sub_1: "[31mbf16[0m[34m[1, s22, 8192][0m[2m[34m[8192*s22, 8192, 1][0m[2m[32mcuda:0[0m" = [34m1.0[0m - w_1
        add_7: "[31mbf16[0m[34m[1, s22, 8192][0m[2m[34m[8192*s22, 8192, 1][0m[2m[32mcuda:0[0m" = sub_1 + a;  [2msub_1 = None[0m
        k_4: "[31mbf16[0m[34m[1, s22, 8192][0m[2m[34m[8192*s22, 8192, 1][0m[2m[32mcuda:0[0m" = k_3 * add_7;  [2mk_3 = add_7 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:600 in hxa079_TimeMix, code: aa = -kk[0m
        aa: "[31mbf16[0m[34m[1, s22, 8192][0m[2m[34m[8192*s22, 8192, 1][0m[2m[32mcuda:0[0m" = -kk
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:601 in hxa079_TimeMix, code: bb = kk * a[0m
        bb: "[31mbf16[0m[34m[1, s22, 8192][0m[2m[34m[8192*s22, 8192, 1][0m[2m[32mcuda:0[0m" = kk * a;  [2mkk = a = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:603 in hxa079_TimeMix, code: w = -w.exp()#.to(dtype=torch.float32).exp()[0m
        exp: "[31mbf16[0m[34m[1, s22, 8192][0m[2m[34m[8192*s22, 8192, 1][0m[2m[32mcuda:0[0m" = w_1.exp();  [2mw_1 = None[0m
        w_2: "[31mbf16[0m[34m[1, s22, 8192][0m[2m[34m[8192*s22, 8192, 1][0m[2m[32mcuda:0[0m" = -exp;  [2mexp = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:604 in hxa079_TimeMix, code: r_,w_,k_,v_,aa_,bb_ = [i.view(B,T,H,N) for i in [r,w,k,v,aa,bb]][0m
        r_: "[31mbf16[0m[34m[1, s22, 64, 128][0m[2m[34m[8192*s22, 8192, 128, 1][0m[2m[32mcuda:0[0m" = q_embed.view([34m1[0m, s22, [34m64[0m, [34m128[0m)
        w_: "[31mbf16[0m[34m[1, s22, 64, 128][0m[2m[34m[8192*s22, 8192, 128, 1][0m[2m[32mcuda:0[0m" = w_2.view([34m1[0m, s22, [34m64[0m, [34m128[0m);  [2mw_2 = None[0m
        k_: "[31mbf16[0m[34m[1, s22, 64, 128][0m[2m[34m[8192*s22, 8192, 128, 1][0m[2m[32mcuda:0[0m" = k_4.view([34m1[0m, s22, [34m64[0m, [34m128[0m)
        v_: "[31mbf16[0m[34m[1, s22, 64, 128][0m[2m[34m[8192*s22, 8192, 128, 1][0m[2m[32mcuda:0[0m" = v_2.view([34m1[0m, s22, [34m64[0m, [34m128[0m)
        aa_: "[31mbf16[0m[34m[1, s22, 64, 128][0m[2m[34m[8192*s22, 8192, 128, 1][0m[2m[32mcuda:0[0m" = aa.view([34m1[0m, s22, [34m64[0m, [34m128[0m);  [2maa = None[0m
        bb_: "[31mbf16[0m[34m[1, s22, 64, 128][0m[2m[34m[8192*s22, 8192, 128, 1][0m[2m[32mcuda:0[0m" = bb.view([34m1[0m, s22, [34m64[0m, [34m128[0m);  [2mbb = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:19 in <genexpr>, code: *(i if not isinstance(i, torch.Tensor) else i.contiguous() for i in args),[0m
        contiguous_2: "[31mbf16[0m[34m[1, s22, 64, 128][0m[2m[34m[8192*s22, 8192, 128, 1][0m[2m[32mcuda:0[0m" = r_.contiguous();  [2mr_ = None[0m
        contiguous_3: "[31mbf16[0m[34m[1, s22, 64, 128][0m[2m[34m[8192*s22, 8192, 128, 1][0m[2m[32mcuda:0[0m" = k_.contiguous();  [2mk_ = None[0m
        contiguous_4: "[31mbf16[0m[34m[1, s22, 64, 128][0m[2m[34m[8192*s22, 8192, 128, 1][0m[2m[32mcuda:0[0m" = v_.contiguous();  [2mv_ = None[0m
        contiguous_5: "[31mbf16[0m[34m[1, s22, 64, 128][0m[2m[34m[8192*s22, 8192, 128, 1][0m[2m[32mcuda:0[0m" = aa_.contiguous();  [2maa_ = None[0m
        contiguous_6: "[31mbf16[0m[34m[1, s22, 64, 128][0m[2m[34m[8192*s22, 8192, 128, 1][0m[2m[32mcuda:0[0m" = bb_.contiguous();  [2mbb_ = None[0m
        contiguous_7: "[31mbf16[0m[34m[1, s22, 64, 128][0m[2m[34m[8192*s22, 8192, 128, 1][0m[2m[32mcuda:0[0m" = w_.contiguous();  [2mw_ = None[0m
        contiguous_8: "[31mbf16[0m[34m[1, 64, 128, 128][0m[2m[34m[1048576, 16384, 128, 1][0m[2m[32mcuda:0[0m" = l_state_.contiguous();  [2ml_state_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:148 in forward, code: final_state = q.new_empty(B, H, K, V, dtype=torch.float32)[0m
        final_state: "[31mf32[0m[34m[1, 64, 128, 128][0m[2m[34m[1048576, 16384, 128, 1][0m[2m[32mcuda:0[0m" = contiguous_2.new_empty([34m1[0m, [34m64[0m, [34m128[0m, [34m128[0m, dtype = [34mtorch.float32[0m)
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:152 in forward, code: ha = torch.empty_like(v, dtype=torch.float32)[0m
        ha: "[31mf32[0m[34m[1, s22, 64, 128][0m[2m[34m[8192*s22, 8192, 128, 1][0m[2m[32mcuda:0[0m" = torch.empty_like(contiguous_4, dtype = [34mtorch.float32[0m)
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:155 in forward, code: o = torch.empty_like(v)[0m
        o: "[31mbf16[0m[34m[1, s22, 64, 128][0m[2m[34m[8192*s22, 8192, 128, 1][0m[2m[32mcuda:0[0m" = torch.empty_like(contiguous_4)
        
         [2m# File: /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:452 in run, code: return self.fn.run(*args, **kwargs)[0m
        triton_kernel_wrapper_mutation = torch.ops.higher_order.triton_kernel_wrapper_mutation(kernel_idx = [34m0[0m, constant_args_idx = [34m4[0m, grid = [([34m4[0m, [34m64[0m, [34m1[0m), ([34m4[0m, [34m64[0m, [34m1[0m), ([34m4[0m, [34m64[0m, [34m1[0m)], tma_descriptor_metadata = [34m{}[0m, kwargs = [34m{'q': contiguous_2, 'k': contiguous_3, 'v': contiguous_4, 'a': contiguous_5, 'b': contiguous_6, 'gk': contiguous_7, 'o': o, 'ha': ha, 'h0': contiguous_8, 'ht': final_state, 'T': s22}[0m);  [2mcontiguous_2 = contiguous_3 = contiguous_4 = contiguous_5 = contiguous_6 = contiguous_7 = ha = contiguous_8 = triton_kernel_wrapper_mutation = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:612 in hxa079_TimeMix, code: xx = xx.view(B,T,-1) * (float(N) ** -0.5)[0m
        view_15: "[31mbf16[0m[34m[1, s22, 8192][0m[2m[34m[8192*s22, 8192, 1][0m[2m[32mcuda:0[0m" = o.view([34m1[0m, s22, [34m-1[0m);  [2mo = None[0m
        xx: "[31mbf16[0m[34m[1, s22, 8192][0m[2m[34m[8192*s22, 8192, 1][0m[2m[32mcuda:0[0m" = view_15 * [34m0.08838834764831845[0m;  [2mview_15 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix, code: xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)[0m
        to_10: "[31mbf16[0m[34m[1, s22, 8192][0m[2m[34m[8192*s22, 8192, 1][0m[2m[32mcuda:0[0m" = xx.to(dtype = [34mtorch.bfloat16[0m);  [2mxx = None[0m
        view_16: "[31mbf16[0m[34m[1, s22, 64, 128][0m[2m[34m[8192*s22, 8192, 128, 1][0m[2m[32mcuda:0[0m" = q_embed.view([34m1[0m, s22, [34m64[0m, [34m128[0m);  [2mq_embed = None[0m
        view_17: "[31mbf16[0m[34m[1, s22, 64, 128][0m[2m[34m[8192*s22, 8192, 128, 1][0m[2m[32mcuda:0[0m" = k_4.view([34m1[0m, s22, [34m64[0m, [34m128[0m);  [2mk_4 = None[0m
        mul_13: "[31mbf16[0m[34m[1, s22, 64, 128][0m[2m[34m[8192*s22, 8192, 128, 1][0m[2m[32mcuda:0[0m" = view_16 * view_17;  [2mview_16 = view_17 = None[0m
        view_18: "[31mbf16[0m[34m[64, 128][0m[2m[34m[128, 1][0m[2m[32mcuda:0[0m" = l_r_k_.view([34m64[0m, [34m128[0m);  [2ml_r_k_ = None[0m
        mul_14: "[31mbf16[0m[34m[1, s22, 64, 128][0m[2m[34m[8192*s22, 8192, 128, 1][0m[2m[32mcuda:0[0m" = mul_13 * view_18;  [2mmul_13 = view_18 = None[0m
        sum_1: "[31mbf16[0m[34m[1, s22, 64, 1][0m[2m[34m[64*s22, 64, 1, 1][0m[2m[32mcuda:0[0m" = mul_14.sum(dim = [34m-1[0m, keepdim = [34mTrue[0m);  [2mmul_14 = None[0m
        view_19: "[31mbf16[0m[34m[1, s22, 64, 128][0m[2m[34m[8192*s22, 8192, 128, 1][0m[2m[32mcuda:0[0m" = v_2.view([34m1[0m, s22, [34m64[0m, [34m128[0m);  [2mv_2 = None[0m
        mul_15: "[31mbf16[0m[34m[1, s22, 64, 128][0m[2m[34m[8192*s22, 8192, 128, 1][0m[2m[32mcuda:0[0m" = sum_1 * view_19;  [2msum_1 = view_19 = None[0m
        view_20: "[31mbf16[0m[34m[1, s22, 8192][0m[2m[34m[8192*s22, 8192, 1][0m[2m[32mcuda:0[0m" = mul_15.view([34m1[0m, s22, [34m8192[0m);  [2mmul_15 = None[0m
        xx_1: "[31mbf16[0m[34m[1, s22, 8192][0m[2m[34m[8192*s22, 8192, 1][0m[2m[32mcuda:0[0m" = to_10 + view_20;  [2mto_10 = view_20 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:616 in hxa079_TimeMix, code: output = fpx_matmul((xx * (torch.sigmoid(xg) @ g2)), O_, O_state,ebits,mbits)[0m
        sigmoid_1: "[31mbf16[0m[34m[1, s22, 480][0m[2m[34m[480*s22, 480, 1][0m[2m[32mcuda:0[0m" = torch.sigmoid(xg);  [2mxg = None[0m
        matmul_3: "[31mbf16[0m[34m[1, s22, 8192][0m[2m[34m[8192*s22, 8192, 1][0m[2m[32mcuda:0[0m" = sigmoid_1 @ l_g2_;  [2msigmoid_1 = l_g2_ = None[0m
        mul_16: "[31mbf16[0m[34m[1, s22, 8192][0m[2m[34m[8192*s22, 8192, 1][0m[2m[32mcuda:0[0m" = xx_1 * matmul_3;  [2mxx_1 = matmul_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul, code: x = x.to(dtype=torch.float16).view(-1,x.shape[2])[0m
        to_11: "[31mf16[0m[34m[1, s22, 8192][0m[2m[34m[8192*s22, 8192, 1][0m[2m[32mcuda:0[0m" = mul_16.to(dtype = [34mtorch.float16[0m);  [2mmul_16 = None[0m
        x_2: "[31mf16[0m[34m[s22, 8192][0m[2m[34m[8192, 1][0m[2m[32mcuda:0[0m" = to_11.view([34m-1[0m, [34m8192[0m);  [2mto_11 = None[0m
        
         [2m# File: /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__, code: return self._opoverload(*args, **kwargs)[0m
        forward_functional_default_1: "[31mf16[0m[34m[s22, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m" = torch.ops.gemlite.forward_functional.default(x_2, [34mNone[0m, [l_o_w_q, l_o_parameters_scales_, l_o_parameters_zeros_], [[34m0[0m, [34m4[0m, [34m64[0m, [34m15[0m, [34m8[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m0[0m, [34m4[0m, [34m1[0m], [34m4[0m);  [2mx_2 = l_o_w_q = l_o_parameters_scales_ = l_o_parameters_zeros_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul, code: out = weight.forward_manual(x).to(dtype=dtype)[0m
        out_1: "[31mbf16[0m[34m[s22, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m" = forward_functional_default_1.to(dtype = [34mtorch.bfloat16[0m);  [2mforward_functional_default_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul, code: return out.view(S0,S1,-1)[0m
        output: "[31mbf16[0m[34m[1, s22, 5120][0m[2m[34m[5120*s22, 5120, 1][0m[2m[32mcuda:0[0m" = out_1.view([34m1[0m, s22, [34m-1[0m);  [2mout_1 = s22 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:618 in hxa079_TimeMix, code: x_in = x_in + output[0m
        x_in: "[31mbf16[0m[34m[1, s22, 5120][0m[2m[34m[5120*s22, 5120, 1][0m[2m[32mcuda:0[0m" = l_x_in_ + output;  [2ml_x_in_ = output = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states_10: "[31mf32[0m[34m[1, s22, 5120][0m[2m[34m[5120*s22, 5120, 1][0m[2m[32mcuda:0[0m" = x_in.to([34mtorch.float32[0m)
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_4: "[31mf32[0m[34m[1, s22, 5120][0m[2m[34m[5120*s22, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states_10.pow([34m2[0m)
        variance_3: "[31mf32[0m[34m[1, s22, 1][0m[2m[34m[s22, 1, 1][0m[2m[32mcuda:0[0m" = pow_4.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_4 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add_10: "[31mf32[0m[34m[1, s22, 1][0m[2m[34m[s22, 1, 1][0m[2m[32mcuda:0[0m" = variance_3 + [34m1e-06[0m;  [2mvariance_3 = None[0m
        rsqrt_3: "[31mf32[0m[34m[1, s22, 1][0m[2m[34m[s22, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add_10);  [2madd_10 = None[0m
        hidden_states_11: "[31mf32[0m[34m[1, s22, 5120][0m[2m[34m[5120*s22, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states_10 * rsqrt_3;  [2mhidden_states_10 = rsqrt_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_18: "[31mf32[0m[34m[1, s22, 5120][0m[2m[34m[5120*s22, 5120, 1][0m[2m[32mcuda:0[0m" = l_ln2_ * hidden_states_11;  [2ml_ln2_ = hidden_states_11 = None[0m
        output_1: "[31mbf16[0m[34m[1, s22, 5120][0m[2m[34m[5120*s22, 5120, 1][0m[2m[32mcuda:0[0m" = mul_18.to([34mtorch.bfloat16[0m);  [2mmul_18 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:621 in hxa079_TimeMix, code: return  output, x[:,-1], state, v_first, k_first, x_in[0m
        getitem_74: "[31mbf16[0m[34m[1, 5120][0m[2m[34m[5120*s22, 1][0m[2m[32mcuda:0[0m" = x[(slice([34mNone[0m, [34mNone[0m, [34mNone[0m), [34m-1[0m)];  [2mx = None[0m
        return (output_1, getitem_74, final_state, v_1, k_embed, x_in)
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing hxa079_TimeMix /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:524
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:524 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7)
        @torch.compile
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:550 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            x = T5RMSNorm(x_in,ln1,variance_epsilon=rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST x_in [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE KW_NAMES ('variance_epsilon',) [NullVariable, LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:550 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        x = T5RMSNorm(x_in,ln1,variance_epsilon=rmsnorm_epsilon)
            ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
wrap_to_fake L['x_in'] (1, 128, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='x_in', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_x_in_ L['x_in'] FakeTensor(..., device='cuda:0', size=(1, s52, 5120), dtype=torch.bfloat16) at debug_level 0 before=False
create_graph_input s52 L['x_in'].size()[1] s52 at debug_level 0 before=True
_lift_symbols_in_symint s52 from L['x_in'].size()[1] at debug_level 0
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE FX call add from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln1'] (5120,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln1', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln1_ L['ln1'] FakeTensor(..., device='cuda:0', size=(5120,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:551 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            xw,xa,xv,xg,xk = (x @ wavgk1).split(wavgk_split_list, dim=-1)
TRACE LOAD_FAST x []
TRACE LOAD_FAST wavgk1 [TensorVariable()]
TRACE BINARY_OP 4 [TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['wavgk1'] (5120, 1376) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='wavgk1', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_wavgk1_ L['wavgk1'] FakeTensor(..., device='cuda:0', size=(5120, 1376), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call matmul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:551 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xw,xa,xv,xg,xk = (x @ wavgk1).split(wavgk_split_list, dim=-1)
                          ~~^~~~~~~~
TRACE LOAD_ATTR split [TensorVariable()]
TRACE LOAD_FAST wavgk_split_list [NullVariable, GetAttrVariable(TensorVariable(), split)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker()]
TRACE KW_NAMES ('dim',) [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE FX call split from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:551 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xw,xa,xv,xg,xk = (x @ wavgk1).split(wavgk_split_list, dim=-1)
                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE UNPACK_SEQUENCE 5 [TupleVariable(length=5)]
TRACE STORE_FAST xw [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST xa [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST xv [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST xg [TensorVariable(), TensorVariable()]
TRACE STORE_FAST xk [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:553 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            B, T, HN = x.shape
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE FX call size from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:553 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        B, T, HN = x.shape
                   ^^^^^^^
TRACE UNPACK_SEQUENCE 3 [SizeVariable(length=3)]
TRACE STORE_FAST B [ConstantVariable(int: 5120), SymNodeVariable(), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 5120), SymNodeVariable()]
TRACE STORE_FAST HN [ConstantVariable(int: 5120)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:555 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            rkv = fpx_matmul(x, RKV_,RKV_state, ebits, mbits)
TRACE LOAD_GLOBAL fpx_matmul []
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST RKV_ [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST RKV_state [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_FAST ebits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST mbits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call fpx_matmul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:555 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        rkv = fpx_matmul(x, RKV_,RKV_state, ebits, mbits)
              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object fpx_matmul at 0x3063a810, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:420 in fpx_matmul (fpx_matmul) (inline depth: 1)
    def fpx_matmul(x,weight,weight_state,ebits:int=3,mbits:int=2):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:421 in fpx_matmul (fpx_matmul) (inline depth: 1)
        if ebits == -44: #hqq
TRACE LOAD_FAST ebits []
TRACE LOAD_CONST -44 [LazyVariableTracker()]
TRACE COMPARE_OP == [LazyVariableTracker(), ConstantVariable(int: -44)]
TRACE POP_JUMP_IF_FALSE 322 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S0=x.shape[0]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE FX call size_1 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul) (inline depth: 1)
        S0=x.shape[0]
           ^^^^^^^
TRACE LOAD_CONST 0 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 0)]
TRACE STORE_FAST S0 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S1=x.shape[1]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE FX call size_2 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul) (inline depth: 1)
        S1=x.shape[1]
           ^^^^^^^
TRACE LOAD_CONST 1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 1)]
TRACE STORE_FAST S1 [SymNodeVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:424 in fpx_matmul (fpx_matmul) (inline depth: 1)
            dtype = x.dtype
TRACE LOAD_FAST x []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
            x = x.to(dtype=torch.float16).view(-1,x.shape[2])
TRACE LOAD_FAST x []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float16 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_2 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST x [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1)]
TRACE LOAD_ATTR shape [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), TensorVariable()]
TRACE FX call size_3 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
                                              ^^^^^^^
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3), ConstantVariable(int: 2)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), ConstantVariable(int: 5120)]
TRACE FX call view from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
            out = weight.forward_manual(x).to(dtype=dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_ATTR forward_manual [LazyVariableTracker()]
TRACE LOAD_FAST x [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE CALL 1 [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton)), TensorVariable()]
TRACE inlined call forward_manual from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:543 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        def forward_manual(self, x: Tensor, matmul_type: str="GEMM") -> Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE LOAD_GLOBAL forward_functional []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:545 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                x,
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:546 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.bias,
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR bias [NullVariable, LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_tensor_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_ATTR get_tensor_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_tensor_args at 0x70c98a9e9080>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_tensor_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_tensor_args(),
            ~~~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:524 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
        def get_tensor_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:525 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
            return [self.W_q, self.scales, self.zeros]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR W_q [UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_FAST self [LazyVariableTracker()]
TRACE LOAD_ATTR scales [LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['RKV_']._parameters['scales'] (80, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='RKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='scales'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_RKV_parameters_scales_ L['RKV_']._parameters['scales'] Parameter(FakeTensor(..., device='cuda:0', size=(80, 10240), dtype=torch.float16)) at debug_level 0 before=False
TRACE LOAD_FAST self [LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR zeros [LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['RKV_']._parameters['zeros'] (80, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='RKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='zeros'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_RKV_parameters_zeros_ L['RKV_']._parameters['zeros'] Parameter(FakeTensor(..., device='cuda:0', size=(80, 10240), dtype=torch.float16)) at debug_level 0 before=False
TRACE BUILD_LIST 3 [LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [ListVariable(length=3)]
DONE INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_meta_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3)]
TRACE LOAD_ATTR get_meta_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_meta_args at 0x70c98a9e9120>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_meta_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_meta_args(),
            ~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:527 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
        def get_meta_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE LOAD_GLOBAL int []
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR scaled_activations [NullVariable, LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:529 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_nbits,
TRACE LOAD_FAST self [ConstantVariable(int: 0)]
TRACE LOAD_ATTR W_nbits [ConstantVariable(int: 0), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:530 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.group_size,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker()]
TRACE LOAD_ATTR group_size [ConstantVariable(int: 0), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:531 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.unpack_mask,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR unpack_mask [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:532 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.elements_per_sample,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR elements_per_sample [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:533 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.input_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR input_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:534 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.output_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR output_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:535 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.acc_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR acc_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:536 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.meta_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR meta_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:537 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.channel_scale_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR channel_scale_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:538 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_group_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR W_group_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:539 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    int(self.data_contiguous),
TRACE LOAD_GLOBAL int [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int)]
TRACE LOAD_ATTR data_contiguous [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE BUILD_LIST 12 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [ListVariable(length=12)]
DONE INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:549 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
TRACE LOAD_GLOBAL GEMLITE_MATMUL_TYPES_MAPPING [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12)]
TRACE LOAD_FAST matmul_type [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker(), ConstantVariable(str: 'GEMM')]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        return forward_functional(
               ~~~~~~~~~~~~~~~~~~^
            x,
            ^^
            self.bias,
            ^^^^^^^^^^
            self.get_tensor_args(),
            ^^^^^^^^^^^^^^^^^^^^^^^
            self.get_meta_args(),
            ^^^^^^^^^^^^^^^^^^^^^
            GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:675 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        def __call__(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
            return self._opoverload(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR _opoverload [NullVariable, UserDefinedObjectVariable(CustomOpDef)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=5)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
wrap_to_fake L['RKV_'].W_q (640, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=AttrSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='RKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='W_q'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_RKV_W_q L['RKV_'].W_q FakeTensor(..., device='cuda:0', size=(640, 10240), dtype=torch.int32) at debug_level 0 before=False
TRACE FX call forward_functional_default from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        return self._opoverload(*args, **kwargs)
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_3 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE STORE_FAST out [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
            return out.view(S0,S1,-1)
TRACE LOAD_FAST out []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST S0 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST S1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: -1)]
TRACE FX call view_1 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
        return out.view(S0,S1,-1)
               ~~~~~~~~^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object fpx_matmul at 0x3063a810, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>
TRACE STORE_FAST rkv [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:556 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            r,k,v = rkv.split(rkv_split_list,dim=-1)
TRACE LOAD_FAST rkv []
TRACE LOAD_ATTR split [TensorVariable()]
TRACE LOAD_FAST rkv_split_list [NullVariable, GetAttrVariable(TensorVariable(), split)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker()]
TRACE KW_NAMES ('dim',) [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE FX call split_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:556 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        r,k,v = rkv.split(rkv_split_list,dim=-1)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
TRACE UNPACK_SEQUENCE 3 [TupleVariable(length=3)]
TRACE STORE_FAST r [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST k [TensorVariable(), TensorVariable()]
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:558 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            kv_dim = k.shape[2] # B,T,kv_dim
TRACE LOAD_FAST k []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE FX call size_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:558 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        kv_dim = k.shape[2] # B,T,kv_dim
                 ^^^^^^^
TRACE LOAD_CONST 2 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 2)]
TRACE STORE_FAST kv_dim [ConstantVariable(int: 1024)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:559 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            kv_repeat = H*N // kv_dim
TRACE LOAD_FAST H []
TRACE LOAD_FAST N [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST kv_dim [ConstantVariable(int: 8192)]
TRACE BINARY_OP 2 [ConstantVariable(int: 8192), ConstantVariable(int: 1024)]
TRACE STORE_FAST kv_repeat [ConstantVariable(int: 8)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:560 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            kv_per_head = kv_dim // N
TRACE LOAD_FAST kv_dim []
TRACE LOAD_FAST N [ConstantVariable(int: 1024)]
TRACE BINARY_OP 2 [ConstantVariable(int: 1024), ConstantVariable(int: 128)]
TRACE STORE_FAST kv_per_head [ConstantVariable(int: 8)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:562 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            r = r.add_(R_bias)
TRACE LOAD_FAST r []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST R_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
wrap_to_fake L['R_bias'] () StatefulSymbolicContext(dynamic_sizes=[], dynamic_strides=[], constraint_sizes=[], constraint_strides=[], specialize_on=[], view_base_context=None, tensor_source=LocalSource(local_name='R_bias', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_R_bias_ L['R_bias'] FakeTensor(..., device='cuda:0', size=(), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call add_ from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:562 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        r = r.add_(R_bias)
            ~~~~~~^^^^^^^^
TRACE STORE_FAST r [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:563 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = k.add_(K_bias).view(B, T, kv_per_head, N)
TRACE LOAD_FAST k []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST K_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
TRACE FX call add__1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:563 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = k.add_(K_bias).view(B, T, kv_per_head, N)
            ~~~~~~^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_per_head [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:563 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = k.add_(K_bias).view(B, T, kv_per_head, N)
            ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:564 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            v = v.add_(V_bias).view(B, T, kv_per_head, N)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST V_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
TRACE FX call add__2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:564 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        v = v.add_(V_bias).view(B, T, kv_per_head, N)
            ~~~~~~^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_per_head [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:564 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        v = v.add_(V_bias).view(B, T, kv_per_head, N)
            ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:568 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            if ln_r is None:
TRACE LOAD_FAST ln_r []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
wrap_to_fake L['ln_r'] (128,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln_r', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln_r_ L['ln_r'] FakeTensor(..., device='cuda:0', size=(128,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE POP_JUMP_IF_TRUE 478 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:572 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
                r = T5RMSNorm(r.view(B,T,H,N), ln_r, variance_epsilon=rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST r [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR view [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:572 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            r = T5RMSNorm(r.view(B,T,H,N), ln_r, variance_epsilon=rmsnorm_epsilon)
                          ~~~~~~^^^^^^^^^
TRACE LOAD_FAST ln_r [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE KW_NAMES ('variance_epsilon',) [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:572 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            r = T5RMSNorm(r.view(B,T,H,N), ln_r, variance_epsilon=rmsnorm_epsilon)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST r [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:573 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
                k = T5RMSNorm(k, ln_k, variance_epsilon=rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln_k [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE KW_NAMES ('variance_epsilon',) [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ConstantVariable(float: 1e-06)]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:573 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = T5RMSNorm(k, ln_k, variance_epsilon=rmsnorm_epsilon)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln_k'] (128,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln_k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln_k_ L['ln_k'] FakeTensor(..., device='cuda:0', size=(128,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:576 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            cos, sin = calc_cos.to(k.dtype), calc_sin.to(k.dtype)
TRACE LOAD_FAST calc_cos []
TRACE LOAD_ATTR to [LazyVariableTracker()]
wrap_to_fake L['calc_cos'] (1, 128, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='calc_cos', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_calc_cos_ L['calc_cos'] FakeTensor(..., device='cuda:0', size=(1, s22, 128)) at debug_level 0 before=False
create_graph_input s22 L['calc_cos'].size()[1] s22 at debug_level 0 before=True
_lift_symbols_in_symint s22 from L['calc_cos'].size()[1] at debug_level 0
TRACE LOAD_FAST k [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR dtype [NullVariable, GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_8 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:576 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        cos, sin = calc_cos.to(k.dtype), calc_sin.to(k.dtype)
                   ~~~~~~~~~~~^^^^^^^^^
TRACE LOAD_FAST calc_sin [TensorVariable()]
TRACE LOAD_ATTR to [TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['calc_sin'] (1, 128, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='calc_sin', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_calc_sin_ L['calc_sin'] FakeTensor(..., device='cuda:0', size=(1, s83, 128)) at debug_level 0 before=False
create_graph_input s83 L['calc_sin'].size()[1] s83 at debug_level 0 before=True
_lift_symbols_in_symint s83 from L['calc_sin'].size()[1] at debug_level 0
TRACE LOAD_FAST k [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR dtype [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE CALL 1 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_9 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:576 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        cos, sin = calc_cos.to(k.dtype), calc_sin.to(k.dtype)
                                         ~~~~~~~~~~~^^^^^^^^^
TRACE STORE_FAST sin [TensorVariable(), TensorVariable()]
TRACE STORE_FAST cos [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:577 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            r, k = apply_rotary_pos_emb(r, k, cos, sin,unsqueeze_dim=2)
TRACE LOAD_GLOBAL apply_rotary_pos_emb []
TRACE LOAD_FAST r [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST cos [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST sin [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE KW_NAMES ('unsqueeze_dim',) [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(int: 2)]
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(int: 2)]
TRACE inlined call apply_rotary_pos_emb from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:577 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        r, k = apply_rotary_pos_emb(r, k, cos, sin,unsqueeze_dim=2)
               ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object apply_rotary_pos_emb at 0x70c98a344710, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 473>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:473 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    def apply_rotary_pos_emb(q, k, cos, sin, position_ids=None, unsqueeze_dim=1):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:493 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
        cos = cos.unsqueeze(unsqueeze_dim)
TRACE LOAD_FAST cos []
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_FAST unsqueeze_dim [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int: 2)]
TRACE FX call unsqueeze from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:493 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    cos = cos.unsqueeze(unsqueeze_dim)
          ~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST cos [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:494 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
        sin = sin.unsqueeze(unsqueeze_dim)
TRACE LOAD_FAST sin []
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_FAST unsqueeze_dim [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int: 2)]
TRACE FX call unsqueeze_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:494 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    sin = sin.unsqueeze(unsqueeze_dim)
          ~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST sin [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
        q_embed = (q * cos) + (rotate_half(q) * sin)
TRACE LOAD_FAST q []
TRACE LOAD_FAST cos [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    q_embed = (q * cos) + (rotate_half(q) * sin)
               ~~^~~~~
TRACE LOAD_GLOBAL rotate_half [TensorVariable()]
TRACE LOAD_FAST q [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE inlined call rotate_half from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    q_embed = (q * cos) + (rotate_half(q) * sin)
                           ~~~~~~~~~~~^^^
INLINING <code object rotate_half at 0x70c98a344450, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 467>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:467 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    def rotate_half(x):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
        x1 = x[..., : x.shape[-1] // 2]
TRACE LOAD_FAST x []
TRACE LOAD_CONST Ellipsis [TensorVariable()]
TRACE LOAD_CONST None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis)]
TRACE LOAD_FAST x [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None)]
TRACE LOAD_ATTR shape [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), TensorVariable()]
TRACE FX call size_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    x1 = x[..., : x.shape[-1] // 2]
                  ^^^^^^^
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), SizeVariable(length=4)]
TRACE BINARY_SUBSCR None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), SizeVariable(length=4), ConstantVariable(int: -1)]
TRACE LOAD_CONST 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), ConstantVariable(int: 128)]
TRACE BINARY_OP 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), ConstantVariable(int: 128), ConstantVariable(int: 2)]
TRACE BUILD_SLICE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), ConstantVariable(int: 64)]
TRACE BUILD_TUPLE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SliceVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), TupleVariable(length=2)]
TRACE FX call getitem_27 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    x1 = x[..., : x.shape[-1] // 2]
         ~^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST x1 [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
        x2 = x[..., x.shape[-1] // 2 :]
TRACE LOAD_FAST x []
TRACE LOAD_CONST Ellipsis [TensorVariable()]
TRACE LOAD_FAST x [TensorVariable(), ConstantVariable(ellipsis: Ellipsis)]
TRACE LOAD_ATTR shape [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), TensorVariable()]
TRACE FX call size_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    x2 = x[..., x.shape[-1] // 2 :]
                ^^^^^^^
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SizeVariable(length=4)]
TRACE BINARY_SUBSCR None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SizeVariable(length=4), ConstantVariable(int: -1)]
TRACE LOAD_CONST 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 128)]
TRACE BINARY_OP 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 128), ConstantVariable(int: 2)]
TRACE LOAD_CONST None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 64)]
TRACE BUILD_SLICE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 64), ConstantVariable(NoneType: None)]
TRACE BUILD_TUPLE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SliceVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), TupleVariable(length=2)]
TRACE FX call getitem_32 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    x2 = x[..., x.shape[-1] // 2 :]
         ~^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST x2 [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
        return torch.cat((-x2, x1), dim=-1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST x2 [NullVariable, LazyVariableTracker()]
TRACE UNARY_NEGATIVE None [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call neg from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    return torch.cat((-x2, x1), dim=-1)
                      ^^^
TRACE LOAD_FAST x1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, LazyVariableTracker(), TupleVariable(length=2)]
TRACE KW_NAMES ('dim',) [NullVariable, LazyVariableTracker(), TupleVariable(length=2), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TupleVariable(length=2), ConstantVariable(int: -1)]
TRACE FX call cat from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    return torch.cat((-x2, x1), dim=-1)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object rotate_half at 0x70c98a344450, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 467>
TRACE LOAD_FAST sin [TensorVariable(), TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call mul_7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    q_embed = (q * cos) + (rotate_half(q) * sin)
                           ~~~~~~~~~~~~~~~^~~~~
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable()]
TRACE FX call add_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    q_embed = (q * cos) + (rotate_half(q) * sin)
              ~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST q_embed [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
        k_embed = (k * cos) + (rotate_half(k) * sin)
TRACE LOAD_FAST k []
TRACE LOAD_FAST cos [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_8 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    k_embed = (k * cos) + (rotate_half(k) * sin)
               ~~^~~~~
TRACE LOAD_GLOBAL rotate_half [TensorVariable()]
TRACE LOAD_FAST k [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE inlined call rotate_half from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    k_embed = (k * cos) + (rotate_half(k) * sin)
                           ~~~~~~~~~~~^^^
INLINING <code object rotate_half at 0x70c98a344450, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 467>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:467 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    def rotate_half(x):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
        x1 = x[..., : x.shape[-1] // 2]
TRACE LOAD_FAST x []
TRACE LOAD_CONST Ellipsis [TensorVariable()]
TRACE LOAD_CONST None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis)]
TRACE LOAD_FAST x [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None)]
TRACE LOAD_ATTR shape [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), TensorVariable()]
TRACE FX call size_7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    x1 = x[..., : x.shape[-1] // 2]
                  ^^^^^^^
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), SizeVariable(length=4)]
TRACE BINARY_SUBSCR None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), SizeVariable(length=4), ConstantVariable(int: -1)]
TRACE LOAD_CONST 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), ConstantVariable(int: 128)]
TRACE BINARY_OP 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), ConstantVariable(int: 128), ConstantVariable(int: 2)]
TRACE BUILD_SLICE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), ConstantVariable(int: 64)]
TRACE BUILD_TUPLE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SliceVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), TupleVariable(length=2)]
TRACE FX call getitem_37 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    x1 = x[..., : x.shape[-1] // 2]
         ~^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST x1 [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
        x2 = x[..., x.shape[-1] // 2 :]
TRACE LOAD_FAST x []
TRACE LOAD_CONST Ellipsis [TensorVariable()]
TRACE LOAD_FAST x [TensorVariable(), ConstantVariable(ellipsis: Ellipsis)]
TRACE LOAD_ATTR shape [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), TensorVariable()]
TRACE FX call size_8 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    x2 = x[..., x.shape[-1] // 2 :]
                ^^^^^^^
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SizeVariable(length=4)]
TRACE BINARY_SUBSCR None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SizeVariable(length=4), ConstantVariable(int: -1)]
TRACE LOAD_CONST 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 128)]
TRACE BINARY_OP 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 128), ConstantVariable(int: 2)]
TRACE LOAD_CONST None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 64)]
TRACE BUILD_SLICE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 64), ConstantVariable(NoneType: None)]
TRACE BUILD_TUPLE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SliceVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), TupleVariable(length=2)]
TRACE FX call getitem_42 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    x2 = x[..., x.shape[-1] // 2 :]
         ~^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST x2 [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
        return torch.cat((-x2, x1), dim=-1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST x2 [NullVariable, LazyVariableTracker()]
TRACE UNARY_NEGATIVE None [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call neg_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    return torch.cat((-x2, x1), dim=-1)
                      ^^^
TRACE LOAD_FAST x1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, LazyVariableTracker(), TupleVariable(length=2)]
TRACE KW_NAMES ('dim',) [NullVariable, LazyVariableTracker(), TupleVariable(length=2), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TupleVariable(length=2), ConstantVariable(int: -1)]
TRACE FX call cat_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    return torch.cat((-x2, x1), dim=-1)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object rotate_half at 0x70c98a344450, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 467>
TRACE LOAD_FAST sin [TensorVariable(), TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call mul_9 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    k_embed = (k * cos) + (rotate_half(k) * sin)
                           ~~~~~~~~~~~~~~~^~~~~
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable()]
TRACE FX call add_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    k_embed = (k * cos) + (rotate_half(k) * sin)
              ~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST k_embed [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:497 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
        return q_embed, k_embed
TRACE LOAD_FAST q_embed []
TRACE LOAD_FAST k_embed [TensorVariable()]
TRACE BUILD_TUPLE 2 [TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object apply_rotary_pos_emb at 0x70c98a344710, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 473>
TRACE UNPACK_SEQUENCE 2 [TupleVariable(length=2)]
TRACE STORE_FAST r [TensorVariable(), TensorVariable()]
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:579 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            if layer_id == 0:
TRACE LOAD_FAST layer_id []
TRACE LOAD_CONST 0 [LazyVariableTracker()]
TRACE COMPARE_OP == [LazyVariableTracker(), ConstantVariable(int: 0)]
create_graph_input L_layer_id_ L['layer_id'] s56 at debug_level 0 before=False
TRACE FX call eq from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:579 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        if layer_id == 0:
           ^^^^^^^^^^^^^
TRACE POP_JUMP_IF_FALSE 736 [SymNodeVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:584 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
                v = v + (v_first - v) * torch.sigmoid(xv@v2 + v0).view(B, T, kv_per_head, N)
TRACE LOAD_FAST v []
TRACE LOAD_FAST v_first [TensorVariable()]
TRACE LOAD_FAST v [TensorVariable(), LazyVariableTracker()]
TRACE BINARY_OP 10 [TensorVariable(), LazyVariableTracker(), TensorVariable()]
automatic dynamic size L['v_first'] size(1) 128 != 512
wrap_to_fake L['v_first'] (1, 128, 8, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None, None], specialize_on=[[], [], [], []], view_base_context=None, tensor_source=LocalSource(local_name='v_first', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_v_first_ L['v_first'] FakeTensor(..., device='cuda:0', size=(1, s63, 8, 128), dtype=torch.bfloat16) at debug_level 0 before=False
create_graph_input s63 L['v_first'].size()[1] s63 at debug_level 0 before=True
_lift_symbols_in_symint s63 from L['v_first'].size()[1] at debug_level 0
create_graph_input s80 L['v_first'].stride()[0] s63*s80 at debug_level 0 before=True
_lift_symbols_in_symint s63*s80 from L['v_first'].stride()[0] at debug_level 0
create_graph_input s80 L['v_first'].stride()[1] s80 at debug_level 0 before=True
_lift_symbols_in_symint s80 from L['v_first'].stride()[1] at debug_level 0
create_graph_input s81 L['v_first'].storage_offset() s81 at debug_level 0 before=True
_lift_symbols_in_symint s81 from L['v_first'].storage_offset() at debug_level 0
TRACE FX call sub from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:584 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            v = v + (v_first - v) * torch.sigmoid(xv@v2 + v0).view(B, T, kv_per_head, N)
                     ~~~~~~~~^~~
TRACE LOAD_GLOBAL torch [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR sigmoid [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST xv [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST v2 [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 4 [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['v2'] (128, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='v2', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_v2_ L['v2'] FakeTensor(..., device='cuda:0', size=(128, 1024), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call matmul_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:584 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            v = v + (v_first - v) * torch.sigmoid(xv@v2 + v0).view(B, T, kv_per_head, N)
                                                  ~~^^~
TRACE LOAD_FAST v0 [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['v0'] (1, 1, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='v0', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_v0_ L['v0'] FakeTensor(..., device='cuda:0', size=(1, 1, 1024), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call add_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:584 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            v = v + (v_first - v) * torch.sigmoid(xv@v2 + v0).view(B, T, kv_per_head, N)
                                                  ~~~~~~^~~~
TRACE CALL 1 [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call sigmoid from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:584 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            v = v + (v_first - v) * torch.sigmoid(xv@v2 + v0).view(B, T, kv_per_head, N)
                                    ~~~~~~~~~~~~~^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST B [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_per_head [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8)]
TRACE CALL 4 [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:584 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            v = v + (v_first - v) * torch.sigmoid(xv@v2 + v0).view(B, T, kv_per_head, N)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call mul_10 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:584 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            v = v + (v_first - v) * torch.sigmoid(xv@v2 + v0).view(B, T, kv_per_head, N)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable()]
TRACE FX call add_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:584 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            v = v + (v_first - v) * torch.sigmoid(xv@v2 + v0).view(B, T, kv_per_head, N)
                ~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:585 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
                k = k + (k_first - k) * torch.sigmoid(xk@k2 + k0).view(B, T, kv_per_head, N)
TRACE LOAD_FAST k []
TRACE LOAD_FAST k_first [TensorVariable()]
TRACE LOAD_FAST k [TensorVariable(), LazyVariableTracker()]
TRACE BINARY_OP 10 [TensorVariable(), LazyVariableTracker(), TensorVariable()]
automatic dynamic size L['k_first'] size(1) 128 != 512
wrap_to_fake L['k_first'] (1, 128, 8, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None, None], specialize_on=[[], [], [], []], view_base_context=None, tensor_source=LocalSource(local_name='k_first', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_k_first_ L['k_first'] FakeTensor(..., device='cuda:0', size=(1, s18, 8, 128), dtype=torch.bfloat16) at debug_level 0 before=False
create_graph_input s18 L['k_first'].size()[1] s18 at debug_level 0 before=True
_lift_symbols_in_symint s18 from L['k_first'].size()[1] at debug_level 0
TRACE FX call sub_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:585 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = k + (k_first - k) * torch.sigmoid(xk@k2 + k0).view(B, T, kv_per_head, N)
                     ~~~~~~~~^~~
TRACE LOAD_GLOBAL torch [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR sigmoid [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST xk [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST k2 [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 4 [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['k2'] (128, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='k2', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_k2_ L['k2'] FakeTensor(..., device='cuda:0', size=(128, 1024), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call matmul_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:585 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = k + (k_first - k) * torch.sigmoid(xk@k2 + k0).view(B, T, kv_per_head, N)
                                                  ~~^^~
TRACE LOAD_FAST k0 [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['k0'] (1, 1, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='k0', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_k0_ L['k0'] FakeTensor(..., device='cuda:0', size=(1, 1, 1024), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call add_7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:585 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = k + (k_first - k) * torch.sigmoid(xk@k2 + k0).view(B, T, kv_per_head, N)
                                                  ~~~~~~^~~~
TRACE CALL 1 [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call sigmoid_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:585 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = k + (k_first - k) * torch.sigmoid(xk@k2 + k0).view(B, T, kv_per_head, N)
                                    ~~~~~~~~~~~~~^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST B [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_per_head [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8)]
TRACE CALL 4 [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:585 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = k + (k_first - k) * torch.sigmoid(xk@k2 + k0).view(B, T, kv_per_head, N)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call mul_11 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:585 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = k + (k_first - k) * torch.sigmoid(xk@k2 + k0).view(B, T, kv_per_head, N)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable()]
TRACE FX call add_8 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:585 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = k + (k_first - k) * torch.sigmoid(xk@k2 + k0).view(B, T, kv_per_head, N)
                ~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:589 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = repeat_kv(k, kv_repeat).view(B, T, -1)
TRACE LOAD_GLOBAL repeat_kv []
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST kv_repeat [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 8)]
TRACE inlined call repeat_kv from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:589 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = repeat_kv(k, kv_repeat).view(B, T, -1)
            ~~~~~~~~~^^^^^^^^^^^^^^
INLINING <code object repeat_kv at 0x70c98a2f25b0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 347>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:347 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    def repeat_kv(hidden_states: torch.Tensor, n_rep: int) -> torch.Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:353 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        B, T, H_kv, D = hidden_states.shape
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE FX call size_9 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:353 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    B, T, H_kv, D = hidden_states.shape
                    ^^^^^^^^^^^^^^^^^^^
TRACE UNPACK_SEQUENCE 4 [SizeVariable(length=4)]
TRACE STORE_FAST B [ConstantVariable(int: 128), ConstantVariable(int: 8), SymNodeVariable(), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 128), ConstantVariable(int: 8), SymNodeVariable()]
TRACE STORE_FAST H_kv [ConstantVariable(int: 128), ConstantVariable(int: 8)]
TRACE STORE_FAST D [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:354 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        if n_rep == 1:
TRACE LOAD_FAST n_rep []
TRACE LOAD_CONST 1 [ConstantVariable(int: 8)]
TRACE COMPARE_OP == [ConstantVariable(int: 8), ConstantVariable(int: 1)]
TRACE POP_JUMP_IF_FALSE 50 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:357 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        hidden_states = hidden_states[:, :, :, None, :]  # (B, T, H_kv, 1, D)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_CONST None [TensorVariable()]
TRACE LOAD_CONST None [TensorVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable()]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable()]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable()]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE BUILD_TUPLE 5 [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), SliceVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), TupleVariable(length=5)]
TRACE FX call getitem_47 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:357 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    hidden_states = hidden_states[:, :, :, None, :]  # (B, T, H_kv, 1, D)
                    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:358 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        hidden_states = hidden_states.expand(B, T, H_kv, n_rep, D)  # (B, T, H_kv, n_rep, D)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR expand [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), expand)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1)]
TRACE LOAD_FAST H_kv [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST n_rep [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8)]
TRACE LOAD_FAST D [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8), ConstantVariable(int: 8)]
TRACE CALL 5 [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call expand from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:358 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    hidden_states = hidden_states.expand(B, T, H_kv, n_rep, D)  # (B, T, H_kv, n_rep, D)
                    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR reshape [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), reshape)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1)]
TRACE LOAD_FAST H_kv [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST n_rep [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8)]
TRACE BINARY_OP 5 [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8), ConstantVariable(int: 8)]
TRACE LOAD_FAST D [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call reshape from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR contiguous [TensorVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE FX call contiguous from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object repeat_kv at 0x70c98a2f25b0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 347>
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: -1)]
TRACE FX call view_7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:589 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = repeat_kv(k, kv_repeat).view(B, T, -1)
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:590 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            v = repeat_kv(v, kv_repeat).view(B, T, -1)
TRACE LOAD_GLOBAL repeat_kv []
TRACE LOAD_FAST v [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST kv_repeat [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 8)]
TRACE inlined call repeat_kv from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:590 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        v = repeat_kv(v, kv_repeat).view(B, T, -1)
            ~~~~~~~~~^^^^^^^^^^^^^^
INLINING <code object repeat_kv at 0x70c98a2f25b0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 347>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:347 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    def repeat_kv(hidden_states: torch.Tensor, n_rep: int) -> torch.Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:353 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        B, T, H_kv, D = hidden_states.shape
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE FX call size_10 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:353 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    B, T, H_kv, D = hidden_states.shape
                    ^^^^^^^^^^^^^^^^^^^
TRACE UNPACK_SEQUENCE 4 [SizeVariable(length=4)]
TRACE STORE_FAST B [ConstantVariable(int: 128), ConstantVariable(int: 8), SymNodeVariable(), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 128), ConstantVariable(int: 8), SymNodeVariable()]
TRACE STORE_FAST H_kv [ConstantVariable(int: 128), ConstantVariable(int: 8)]
TRACE STORE_FAST D [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:354 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        if n_rep == 1:
TRACE LOAD_FAST n_rep []
TRACE LOAD_CONST 1 [ConstantVariable(int: 8)]
TRACE COMPARE_OP == [ConstantVariable(int: 8), ConstantVariable(int: 1)]
TRACE POP_JUMP_IF_FALSE 50 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:357 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        hidden_states = hidden_states[:, :, :, None, :]  # (B, T, H_kv, 1, D)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_CONST None [TensorVariable()]
TRACE LOAD_CONST None [TensorVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable()]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable()]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable()]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE BUILD_TUPLE 5 [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), SliceVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), TupleVariable(length=5)]
TRACE FX call getitem_52 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:357 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    hidden_states = hidden_states[:, :, :, None, :]  # (B, T, H_kv, 1, D)
                    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:358 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        hidden_states = hidden_states.expand(B, T, H_kv, n_rep, D)  # (B, T, H_kv, n_rep, D)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR expand [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), expand)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1)]
TRACE LOAD_FAST H_kv [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST n_rep [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8)]
TRACE LOAD_FAST D [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8), ConstantVariable(int: 8)]
TRACE CALL 5 [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call expand_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:358 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    hidden_states = hidden_states.expand(B, T, H_kv, n_rep, D)  # (B, T, H_kv, n_rep, D)
                    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR reshape [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), reshape)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1)]
TRACE LOAD_FAST H_kv [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST n_rep [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8)]
TRACE BINARY_OP 5 [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8), ConstantVariable(int: 8)]
TRACE LOAD_FAST D [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call reshape_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR contiguous [TensorVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE FX call contiguous_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object repeat_kv at 0x70c98a2f25b0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 347>
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: -1)]
TRACE FX call view_8 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:590 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        v = repeat_kv(v, kv_repeat).view(B, T, -1)
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:593 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            a = torch.sigmoid(xa @ a2 + a0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR sigmoid [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST xa [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST a2 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 4 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['a2'] (160, 8192) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='a2', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_a2_ L['a2'] FakeTensor(..., device='cuda:0', size=(160, 8192), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call matmul_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:593 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        a = torch.sigmoid(xa @ a2 + a0)
                          ~~~^~~~
TRACE LOAD_FAST a0 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['a0'] (1, 1, 8192) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='a0', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_a0_ L['a0'] FakeTensor(..., device='cuda:0', size=(1, 1, 8192), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call add_9 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:593 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        a = torch.sigmoid(xa @ a2 + a0)
                          ~~~~~~~~^~~~
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call sigmoid_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:593 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        a = torch.sigmoid(xa @ a2 + a0)
            ~~~~~~~~~~~~~^^^^^^^^^^^^^^
TRACE STORE_FAST a [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:595 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            kk = F.normalize(k.view(B, T, H, N), p=2.0, dim=-1).view(B, T, H*N)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR normalize [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR view [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_9 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:595 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        kk = F.normalize(k.view(B, T, H, N), p=2.0, dim=-1).view(B, T, H*N)
                         ~~~~~~^^^^^^^^^^^^
TRACE LOAD_CONST 2.0 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 2.0)]
TRACE KW_NAMES ('p', 'dim') [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 2.0), ConstantVariable(int: -1)]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 2.0), ConstantVariable(int: -1)]
TRACE FX call normalize from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:595 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        kk = F.normalize(k.view(B, T, H, N), p=2.0, dim=-1).view(B, T, H*N)
             ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64)]
TRACE BINARY_OP 5 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8192)]
TRACE FX call view_10 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:595 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        kk = F.normalize(k.view(B, T, H, N), p=2.0, dim=-1).view(B, T, H*N)
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
TRACE STORE_FAST kk [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:596 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            w = torch.tanh(xw) @ w2 + w0
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR tanh [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST xw [NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call tanh from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:596 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = torch.tanh(xw) @ w2 + w0
            ~~~~~~~~~~^^^^
TRACE LOAD_FAST w2 [TensorVariable()]
TRACE BINARY_OP 4 [TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['w2'] (480, 8192) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='w2', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_w2_ L['w2'] FakeTensor(..., device='cuda:0', size=(480, 8192), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call matmul_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:596 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = torch.tanh(xw) @ w2 + w0
            ~~~~~~~~~~~~~~~^~~~
TRACE LOAD_FAST w0 [TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['w0'] (1, 1, 8192) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='w0', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_w0_ L['w0'] FakeTensor(..., device='cuda:0', size=(1, 1, 8192), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call add_10 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:596 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = torch.tanh(xw) @ w2 + w0
            ~~~~~~~~~~~~~~~~~~~~^~~~
TRACE STORE_FAST w [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:597 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            w = -F.softplus(-w) - 0.5
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR softplus [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST w [NullVariable, LazyVariableTracker()]
TRACE UNARY_NEGATIVE None [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call neg_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:597 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = -F.softplus(-w) - 0.5
                        ^^
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call softplus from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:597 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = -F.softplus(-w) - 0.5
             ~~~~~~~~~~^^^^
TRACE UNARY_NEGATIVE None [TensorVariable()]
TRACE FX call neg_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:597 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = -F.softplus(-w) - 0.5
            ^^^^^^^^^^^^^^^
TRACE LOAD_CONST 0.5 [TensorVariable()]
TRACE BINARY_OP 10 [TensorVariable(), ConstantVariable(float: 0.5)]
TRACE FX call sub_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:597 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = -F.softplus(-w) - 0.5
            ~~~~~~~~~~~~~~~~^~~~~
TRACE STORE_FAST w [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:598 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = k * (1.0 - w + a)
TRACE LOAD_FAST k []
TRACE LOAD_CONST 1.0 [TensorVariable()]
TRACE LOAD_FAST w [TensorVariable(), ConstantVariable(float: 1.0)]
TRACE BINARY_OP 10 [TensorVariable(), ConstantVariable(float: 1.0), TensorVariable()]
TRACE FX call sub_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:598 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = k * (1.0 - w + a)
                 ~~~~^~~
TRACE LOAD_FAST a [TensorVariable(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call add_11 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:598 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = k * (1.0 - w + a)
                 ~~~~~~~~^~~
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_12 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:598 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = k * (1.0 - w + a)
            ~~^~~~~~~~~~~~~~~
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:600 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            aa = -kk
TRACE LOAD_FAST kk []
TRACE UNARY_NEGATIVE None [TensorVariable()]
TRACE FX call neg_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:600 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        aa = -kk
             ^^^
TRACE STORE_FAST aa [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:601 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            bb = kk * a
TRACE LOAD_FAST kk []
TRACE LOAD_FAST a [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_13 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:601 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        bb = kk * a
             ~~~^~~
TRACE STORE_FAST bb [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:603 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            w = -w.exp()#.to(dtype=torch.float32).exp()
TRACE LOAD_FAST w []
TRACE LOAD_ATTR exp [TensorVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), exp)]
TRACE FX call exp from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:603 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = -w.exp()#.to(dtype=torch.float32).exp()
             ~~~~~^^
TRACE UNARY_NEGATIVE None [TensorVariable()]
TRACE FX call neg_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:603 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = -w.exp()#.to(dtype=torch.float32).exp()
            ^^^^^^^^
TRACE STORE_FAST w [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:604 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            r_,w_,k_,v_,aa_,bb_ = [i.view(B,T,H,N) for i in [r,w,k,v,aa,bb]]
TRACE LOAD_FAST r []
TRACE LOAD_FAST w [TensorVariable()]
TRACE LOAD_FAST k [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST v [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST aa [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST bb [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 6 [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE GET_ITER None [TupleVariable(length=6)]
TRACE LOAD_FAST_AND_CLEAR i [ListIteratorVariable(length=6, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=6, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=6, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=6, index=0), ListVariable(length=0)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=0)]
TRACE STORE_FAST i [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), TensorVariable()]
TRACE LOAD_FAST i [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1)]
TRACE LOAD_ATTR view [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_11 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:604 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        r_,w_,k_,v_,aa_,bb_ = [i.view(B,T,H,N) for i in [r,w,k,v,aa,bb]]
                               ~~~~~~^^^^^^^^^
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), TensorVariable()]
TRACE JUMP_BACKWARD 1448 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=1)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=1)]
TRACE STORE_FAST i [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), TensorVariable()]
TRACE LOAD_FAST i [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2)]
TRACE LOAD_ATTR view [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), TensorVariable()]
TRACE JUMP_BACKWARD 1448 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=2)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=2)]
TRACE STORE_FAST i [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), TensorVariable()]
TRACE LOAD_FAST i [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3)]
TRACE LOAD_ATTR view [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), TensorVariable()]
TRACE JUMP_BACKWARD 1448 [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=3)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=3)]
TRACE STORE_FAST i [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), TensorVariable()]
TRACE LOAD_FAST i [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4)]
TRACE LOAD_ATTR view [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), TensorVariable()]
TRACE JUMP_BACKWARD 1448 [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=4)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=4)]
TRACE STORE_FAST i [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), TensorVariable()]
TRACE LOAD_FAST i [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5)]
TRACE LOAD_ATTR view [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), TensorVariable()]
TRACE JUMP_BACKWARD 1448 [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=5)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=5)]
TRACE STORE_FAST i [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), TensorVariable()]
TRACE LOAD_FAST i [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6)]
TRACE LOAD_ATTR view [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), TensorVariable()]
TRACE JUMP_BACKWARD 1448 [NullVariable, ListVariable(length=6), ListIteratorVariable(length=6, index=6)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=6), ListIteratorVariable(length=6, index=6)]
TRACE END_FOR None [NullVariable, ListVariable(length=6), ListIteratorVariable(length=6, index=6), ConstantVariable(NoneType: None)]
TRACE SWAP 2 [NullVariable, ListVariable(length=6)]
TRACE STORE_FAST i [ListVariable(length=6), NullVariable]
TRACE UNPACK_SEQUENCE 6 [ListVariable(length=6)]
TRACE STORE_FAST r_ [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST w_ [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST k_ [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST v_ [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST aa_ [TensorVariable(), TensorVariable()]
TRACE STORE_FAST bb_ [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:605 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            B,T,_,_ = r_.shape
TRACE LOAD_FAST r_ []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE FX call size_11 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:605 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        B,T,_,_ = r_.shape
                  ^^^^^^^^
TRACE UNPACK_SEQUENCE 4 [SizeVariable(length=4)]
TRACE STORE_FAST B [ConstantVariable(int: 128), ConstantVariable(int: 64), SymNodeVariable(), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 128), ConstantVariable(int: 64), SymNodeVariable()]
TRACE STORE_FAST _ [ConstantVariable(int: 128), ConstantVariable(int: 64)]
TRACE STORE_FAST _ [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:609 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            xx, state = fused_recurrent_rwkv7(r_, w_, k_, v_, aa_, bb_, scale=1.0, initial_state=state, output_final_state=True, head_first=False)
TRACE LOAD_GLOBAL fused_recurrent_rwkv7 []
TRACE LOAD_FAST r_ [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST w_ [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST k_ [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST v_ [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST aa_ [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST bb_ [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 1.0 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST state [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0)]
TRACE LOAD_CONST True [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker()]
TRACE LOAD_CONST False [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True)]
TRACE KW_NAMES ('scale', 'initial_state', 'output_final_state', 'head_first') [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(bool: False)]
TRACE CALL 10 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(bool: False)]
TRACE inlined call fused_recurrent_rwkv7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:609 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx, state = fused_recurrent_rwkv7(r_, w_, k_, v_, aa_, bb_, scale=1.0, initial_state=state, output_final_state=True, head_first=False)
                    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object fused_recurrent_rwkv7 at 0x70c98d0c9890, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py", line 11>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:11 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
    def fused_recurrent_rwkv7(
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:50 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
        return fused_recurrent_dplr_delta_rule(
TRACE LOAD_GLOBAL fused_recurrent_dplr_delta_rule []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:51 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            q=r,
TRACE LOAD_FAST r [NullVariable, LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:52 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            k=k,
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:53 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            v=v,
TRACE LOAD_FAST v [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:54 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            a=a,
TRACE LOAD_FAST a [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:55 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            b=b,
TRACE LOAD_FAST b [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:56 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            gk=log_w,
TRACE LOAD_FAST log_w [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:57 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            scale=scale,
TRACE LOAD_FAST scale [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:58 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            initial_state=initial_state,
TRACE LOAD_FAST initial_state [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:59 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            output_final_state=output_final_state,
TRACE LOAD_FAST output_final_state [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:60 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            cu_seqlens=cu_seqlens,
TRACE LOAD_FAST cu_seqlens [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:61 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            head_first=head_first
TRACE LOAD_FAST head_first [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:50 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
        return fused_recurrent_dplr_delta_rule(
TRACE KW_NAMES ('q', 'k', 'v', 'a', 'b', 'gk', 'scale', 'initial_state', 'output_final_state', 'cu_seqlens', 'head_first') [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(NoneType: None), ConstantVariable(bool: False)]
TRACE CALL 11 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(NoneType: None), ConstantVariable(bool: False)]
TRACE inlined call fused_recurrent_dplr_delta_rule from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:50 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
    return fused_recurrent_dplr_delta_rule(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        q=r,
        ^^^^
        k=k,
        ^^^^
        v=v,
        ^^^^
        a=a,
        ^^^^
        b=b,
        ^^^^
        gk=log_w,
        ^^^^^^^^^
        scale=scale,
        ^^^^^^^^^^^^
        initial_state=initial_state,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        output_final_state=output_final_state,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        cu_seqlens=cu_seqlens,
        ^^^^^^^^^^^^^^^^^^^^^^
        head_first=head_first
        ^^^^^^^^^^^^^^^^^^^^^
    )
    ^
INLINING <code object fused_recurrent_dplr_delta_rule at 0x305fb4e0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 188>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:188 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
    def fused_recurrent_dplr_delta_rule(
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:231 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
        if cu_seqlens is not None:
TRACE LOAD_FAST cu_seqlens []
TRACE LOAD_CONST None [ConstantVariable(NoneType: None)]
TRACE IS_OP 0 [ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 282 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:240 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
        if scale is None:
TRACE LOAD_FAST scale []
TRACE LOAD_CONST None [ConstantVariable(float: 1.0)]
TRACE IS_OP 1 [ConstantVariable(float: 1.0), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 328 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:243 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            assert scale > 0, "scale must be positive"
TRACE LOAD_FAST scale []
TRACE LOAD_CONST 0 [ConstantVariable(float: 1.0)]
TRACE COMPARE_OP > [ConstantVariable(float: 1.0), ConstantVariable(int: 0)]
TRACE POP_JUMP_IF_TRUE 352 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:244 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
        o, final_state = FusedRecurrentDPLRDeltaRuleFunction.apply(
TRACE LOAD_GLOBAL FusedRecurrentDPLRDeltaRuleFunction []
TRACE LOAD_ATTR apply [LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:245 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            q,
TRACE LOAD_FAST q [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:246 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            k,
TRACE LOAD_FAST k [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:247 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            v,
TRACE LOAD_FAST v [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:248 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            a,
TRACE LOAD_FAST a [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:249 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            b,
TRACE LOAD_FAST b [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:250 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            gk,
TRACE LOAD_FAST gk [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:251 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            scale,
TRACE LOAD_FAST scale [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:252 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            initial_state,
TRACE LOAD_FAST initial_state [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:253 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            output_final_state,
TRACE LOAD_FAST output_final_state [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:254 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            cu_seqlens,
TRACE LOAD_FAST cu_seqlens [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:255 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            head_first
TRACE LOAD_FAST head_first [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:244 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
        o, final_state = FusedRecurrentDPLRDeltaRuleFunction.apply(
TRACE CALL 11 [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(NoneType: None), ConstantVariable(bool: False)]
wrap_to_fake L['state'] (1, 64, 128, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None], constraint_strides=[None, None, None, None], specialize_on=[[], [], [], []], view_base_context=StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='state', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}), tensor_source=LocalSource(local_name='state', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_state_ L['state'] FakeTensor(..., device='cuda:0', size=(1, 64, 128, 128), dtype=torch.bfloat16) at debug_level 0 before=False
wrap_to_fake L['state']._base (56, 1, 64, 128, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='state', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
TRACE inlined call wrapper from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:244 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
    o, final_state = FusedRecurrentDPLRDeltaRuleFunction.apply(
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        q,
        ^^
        k,
        ^^
        v,
        ^^
        a,
        ^^
        b,
        ^^
        gk,
        ^^^
        scale,
        ^^^^^^
        initial_state,
        ^^^^^^^^^^^^^^
        output_final_state,
        ^^^^^^^^^^^^^^^^^^^
        cu_seqlens,
        ^^^^^^^^^^^
        head_first
        ^^^^^^^^^^
    )
    ^
INLINING <code object wrapper at 0x70c98d04f0a0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 16>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 1 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:16 in wrapper (contiguous) (inline depth: 3)
        @functools.wraps(fn)
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:18 in wrapper (contiguous.wrapper) (inline depth: 3)
            return fn(ctx,
TRACE PUSH_NULL None []
TRACE LOAD_DEREF fn [NullVariable]
TRACE LOAD_FAST ctx [NullVariable, LazyVariableTracker()]
TRACE BUILD_LIST 1 [NullVariable, LazyVariableTracker(), AutogradFunctionContextVariable(Function)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:19 in wrapper (contiguous.wrapper) (inline depth: 3)
                      *(i if not isinstance(i, torch.Tensor) else i.contiguous() for i in args),
TRACE LOAD_CONST <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19> [NullVariable, LazyVariableTracker(), ListVariable(length=1)]
TRACE MAKE_FUNCTION 0 [NullVariable, LazyVariableTracker(), ListVariable(length=1), ConstantVariable(code: <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker(), ListVariable(length=1), NestedUserFunctionVariable()]
TRACE GET_ITER None [NullVariable, LazyVariableTracker(), ListVariable(length=1), NestedUserFunctionVariable(), TupleVariable(length=11)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), ListVariable(length=1), NestedUserFunctionVariable(), ListIteratorVariable(length=11, index=0)]
TRACE inlined call <genexpr> from /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:19 in wrapper (contiguous.wrapper) (inline depth: 3)
                  *(i if not isinstance(i, torch.Tensor) else i.contiguous() for i in args),
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:18 in wrapper (contiguous.wrapper) (inline depth: 3)
            return fn(ctx,
TRACE LIST_EXTEND 1 [NullVariable, LazyVariableTracker(), ListVariable(length=1), LocalGeneratorObjectVariable(<genexpr>)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:19 in <genexpr> (contiguous.wrapper) (inline depth: 4)
                      *(i if not isinstance(i, torch.Tensor) else i.contiguous() for i in args),
TRACE RETURN_GENERATOR None [BuiltinVariable(None)]
TRACE POP_TOP None [BuiltinVariable(None)]
TRACE RESUME 0 []
TRACE LOAD_FAST .0 []
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=0)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=1), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=1)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=1), NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=1), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=1), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=1), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=1), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=1)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=1), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=1), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE FX call contiguous_2 from /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:19 in <genexpr> (contiguous.wrapper) (inline depth: 4)
                  *(i if not isinstance(i, torch.Tensor) else i.contiguous() for i in args),
                                                              ~~~~~~~~~~~~^^
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=1), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=1), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=1), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=1)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=1)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=2), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=2)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=2), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=2), NullVariable, BuiltinVariable(isinstance), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=2), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=2), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=2), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=2)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=2), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=2), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=2), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=2), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=2), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=2)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=2)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=3), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=3)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=3), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=3), NullVariable, BuiltinVariable(isinstance), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=3), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=3), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=3), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=3)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=3), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=3), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=3), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=3), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=3), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=3)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=3)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=4), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=4)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=4), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=4), NullVariable, BuiltinVariable(isinstance), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=4), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=4), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=4), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=4)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=4), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=4), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=4), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=4), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=4), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=4)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=4)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=5), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=5)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=5), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=5), NullVariable, BuiltinVariable(isinstance), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=5), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=5), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=5), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=5)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=5), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=5), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=5), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=5), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=5), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=5)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=5)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=6), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=6)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=6), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=6), NullVariable, BuiltinVariable(isinstance), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=6), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=6), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=6), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=6)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=6), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=6), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=6), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=6), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=6), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=6)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=6)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=7), ConstantVariable(float: 1.0)]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=7)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=7), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=7), NullVariable, BuiltinVariable(isinstance), ConstantVariable(float: 1.0)]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=7), NullVariable, BuiltinVariable(isinstance), ConstantVariable(float: 1.0), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=7), NullVariable, BuiltinVariable(isinstance), ConstantVariable(float: 1.0), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=7), ConstantVariable(bool: False)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=7)]
TRACE JUMP_FORWARD 100 [ListIteratorVariable(length=11, index=7), ConstantVariable(float: 1.0)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=7), ConstantVariable(float: 1.0)]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=7), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=7), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=7)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=7)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=8), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=8)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=8), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=8), NullVariable, BuiltinVariable(isinstance), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=8), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=8), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=8), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=8)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=8), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=8), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=8), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=8), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=8), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=8)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=8)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=9), ConstantVariable(bool: True)]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=9)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=9), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=9), NullVariable, BuiltinVariable(isinstance), ConstantVariable(bool: True)]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=9), NullVariable, BuiltinVariable(isinstance), ConstantVariable(bool: True), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=9), NullVariable, BuiltinVariable(isinstance), ConstantVariable(bool: True), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=9), ConstantVariable(bool: False)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=9)]
TRACE JUMP_FORWARD 100 [ListIteratorVariable(length=11, index=9), ConstantVariable(bool: True)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=9), ConstantVariable(bool: True)]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=9), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=9), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=9)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=9)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=10), ConstantVariable(NoneType: None)]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=10)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=10), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=10), NullVariable, BuiltinVariable(isinstance), ConstantVariable(NoneType: None)]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=10), NullVariable, BuiltinVariable(isinstance), ConstantVariable(NoneType: None), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=10), NullVariable, BuiltinVariable(isinstance), ConstantVariable(NoneType: None), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=10), ConstantVariable(bool: False)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=10)]
TRACE JUMP_FORWARD 100 [ListIteratorVariable(length=11, index=10), ConstantVariable(NoneType: None)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=10), ConstantVariable(NoneType: None)]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=10), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=10), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=10)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=10)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=11), ConstantVariable(bool: False)]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=11)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=11), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=11), NullVariable, BuiltinVariable(isinstance), ConstantVariable(bool: False)]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=11), NullVariable, BuiltinVariable(isinstance), ConstantVariable(bool: False), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=11), NullVariable, BuiltinVariable(isinstance), ConstantVariable(bool: False), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=11), ConstantVariable(bool: False)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=11)]
TRACE JUMP_FORWARD 100 [ListIteratorVariable(length=11, index=11), ConstantVariable(bool: False)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=11), ConstantVariable(bool: False)]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=11), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=11), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=11)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=11)]
TRACE END_FOR None [ListIteratorVariable(length=11, index=11), ConstantVariable(NoneType: None)]
TRACE RETURN_CONST None []
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE CALL_INTRINSIC_1 6 [NullVariable, LazyVariableTracker(), ListVariable(length=12)]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=12)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:20 in wrapper (contiguous.wrapper) (inline depth: 3)
                      **{k: (v if not isinstance(v, torch.Tensor) else v.contiguous()) for k, v in kwargs.items()})
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable()]
TRACE LOAD_ATTR items [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ConstDictVariable()]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 180 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE SWAP 3 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST v [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ConstDictVariable(), NullVariable, NullVariable]
TRACE STORE_FAST k [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ConstDictVariable(), NullVariable]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:18 in wrapper (contiguous.wrapper) (inline depth: 3)
            return fn(ctx,
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable()]
TRACE inlined call forward from /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:18 in wrapper (contiguous.wrapper) (inline depth: 3)
        return fn(ctx,
               ~~^^^^^
                  *(i if not isinstance(i, torch.Tensor) else i.contiguous() for i in args),
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                  **{k: (v if not isinstance(v, torch.Tensor) else v.contiguous()) for k, v in kwargs.items()})
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object forward at 0x3060e8b0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 124>, inlined according trace_rules.lookup inlined by default
TRACE MAKE_CELL H []
TRACE MAKE_CELL N []
TRACE MAKE_CELL V []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:124 in forward (FusedRecurrentDPLRDeltaRuleFunction) (inline depth: 4)
        @staticmethod
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:140 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            if head_first:
TRACE LOAD_FAST head_first []
TRACE POP_JUMP_IF_FALSE 86 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:143 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
                B, T, H, K, V = *k.shape, v.shape[-1]
TRACE BUILD_LIST 0 []
TRACE LOAD_FAST k [ListVariable(length=0)]
TRACE LOAD_ATTR shape [ListVariable(length=0), TensorVariable()]
TRACE FX call size_12 from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:143 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            B, T, H, K, V = *k.shape, v.shape[-1]
                             ^^^^^^^
TRACE LIST_EXTEND 1 [ListVariable(length=0), SizeVariable(length=4)]
TRACE LOAD_FAST v [ListVariable(length=4)]
TRACE LOAD_ATTR shape [ListVariable(length=4), TensorVariable()]
TRACE FX call size_13 from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:143 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            B, T, H, K, V = *k.shape, v.shape[-1]
                                      ^^^^^^^
TRACE LOAD_CONST -1 [ListVariable(length=4), SizeVariable(length=4)]
TRACE BINARY_SUBSCR None [ListVariable(length=4), SizeVariable(length=4), ConstantVariable(int: -1)]
TRACE LIST_APPEND 1 [ListVariable(length=4), ConstantVariable(int: 128)]
TRACE CALL_INTRINSIC_1 6 [ListVariable(length=5)]
TRACE UNPACK_SEQUENCE 5 [TupleVariable(length=5)]
TRACE STORE_FAST B [ConstantVariable(int: 128), ConstantVariable(int: 128), ConstantVariable(int: 64), SymNodeVariable(), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 128), ConstantVariable(int: 128), ConstantVariable(int: 64), SymNodeVariable()]
TRACE STORE_DEREF H [ConstantVariable(int: 128), ConstantVariable(int: 128), ConstantVariable(int: 64)]
TRACE STORE_FAST K [ConstantVariable(int: 128), ConstantVariable(int: 128)]
TRACE STORE_DEREF V [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:144 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            N = B if offsets is None else len(offsets) - 1
TRACE LOAD_FAST offsets []
TRACE LOAD_CONST None [ConstantVariable(NoneType: None)]
TRACE IS_OP 1 [ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 170 [ConstantVariable(bool: False)]
TRACE LOAD_FAST B []
TRACE JUMP_FORWARD 196 [ConstantVariable(int: 1)]
TRACE STORE_DEREF N [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:146 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            BK = triton.next_power_of_2(K)
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR next_power_of_2 [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST K [NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:146 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
        BK = triton.next_power_of_2(K)
             ~~~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=1)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=1, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=1, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=1, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=1, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=1), ConstantVariable(int: 128)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 6)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 6)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 6)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 6)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 6)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 128)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=1), ConstantVariable(int: 128)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=1, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=1, index=1)]
TRACE END_FOR None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=1, index=1), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=1)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=1)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=1), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=1), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=1), ConstDictVariable()]
TRACE inlined call next_power_of_2 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object next_power_of_2 at 0x70c9a955f730, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 71>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:71 in next_power_of_2 () (inline depth: 6)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:74 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n -= 1
TRACE LOAD_FAST n []
TRACE LOAD_CONST 1 [ConstantVariable(int: 128)]
TRACE BINARY_OP 23 [ConstantVariable(int: 128), ConstantVariable(int: 1)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:75 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n |= n >> 1
TRACE LOAD_FAST n []
TRACE LOAD_FAST n [ConstantVariable(int: 127)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 127), ConstantVariable(int: 127)]
TRACE BINARY_OP 9 [ConstantVariable(int: 127), ConstantVariable(int: 127), ConstantVariable(int: 1)]
TRACE BINARY_OP 20 [ConstantVariable(int: 127), ConstantVariable(int: 63)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:76 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n |= n >> 2
TRACE LOAD_FAST n []
TRACE LOAD_FAST n [ConstantVariable(int: 127)]
TRACE LOAD_CONST 2 [ConstantVariable(int: 127), ConstantVariable(int: 127)]
TRACE BINARY_OP 9 [ConstantVariable(int: 127), ConstantVariable(int: 127), ConstantVariable(int: 2)]
TRACE BINARY_OP 20 [ConstantVariable(int: 127), ConstantVariable(int: 31)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:77 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n |= n >> 4
TRACE LOAD_FAST n []
TRACE LOAD_FAST n [ConstantVariable(int: 127)]
TRACE LOAD_CONST 4 [ConstantVariable(int: 127), ConstantVariable(int: 127)]
TRACE BINARY_OP 9 [ConstantVariable(int: 127), ConstantVariable(int: 127), ConstantVariable(int: 4)]
TRACE BINARY_OP 20 [ConstantVariable(int: 127), ConstantVariable(int: 7)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:78 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n |= n >> 8
TRACE LOAD_FAST n []
TRACE LOAD_FAST n [ConstantVariable(int: 127)]
TRACE LOAD_CONST 8 [ConstantVariable(int: 127), ConstantVariable(int: 127)]
TRACE BINARY_OP 9 [ConstantVariable(int: 127), ConstantVariable(int: 127), ConstantVariable(int: 8)]
TRACE BINARY_OP 20 [ConstantVariable(int: 127), ConstantVariable(int: 0)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:79 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n |= n >> 16
TRACE LOAD_FAST n []
TRACE LOAD_FAST n [ConstantVariable(int: 127)]
TRACE LOAD_CONST 16 [ConstantVariable(int: 127), ConstantVariable(int: 127)]
TRACE BINARY_OP 9 [ConstantVariable(int: 127), ConstantVariable(int: 127), ConstantVariable(int: 16)]
TRACE BINARY_OP 20 [ConstantVariable(int: 127), ConstantVariable(int: 0)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:80 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n |= n >> 32
TRACE LOAD_FAST n []
TRACE LOAD_FAST n [ConstantVariable(int: 127)]
TRACE LOAD_CONST 32 [ConstantVariable(int: 127), ConstantVariable(int: 127)]
TRACE BINARY_OP 9 [ConstantVariable(int: 127), ConstantVariable(int: 127), ConstantVariable(int: 32)]
TRACE BINARY_OP 20 [ConstantVariable(int: 127), ConstantVariable(int: 0)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:81 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n += 1
TRACE LOAD_FAST n []
TRACE LOAD_CONST 1 [ConstantVariable(int: 127)]
TRACE BINARY_OP 13 [ConstantVariable(int: 127), ConstantVariable(int: 1)]
TRACE STORE_FAST n [ConstantVariable(int: 128)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:82 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        return n
TRACE LOAD_FAST n []
TRACE RETURN_VALUE None [ConstantVariable(int: 128)]
DONE INLINING <code object next_power_of_2 at 0x70c9a955f730, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 71>
TRACE STORE_FAST res [ConstantVariable(int: 128)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 128)]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE STORE_FAST BK [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:147 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            if output_final_state:
TRACE LOAD_FAST output_final_state []
TRACE POP_JUMP_IF_FALSE 318 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:148 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
                final_state = q.new_empty(B, H, K, V, dtype=torch.float32)
TRACE LOAD_FAST q []
TRACE LOAD_ATTR new_empty [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), new_empty)]
TRACE LOAD_DEREF H [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1)]
TRACE LOAD_FAST K [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE LOAD_DEREF V [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128), ConstantVariable(int: 128)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE CALL 5 [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE FX call new_empty from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:148 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            final_state = q.new_empty(B, H, K, V, dtype=torch.float32)
                          ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST final_state [TensorVariable()]
TRACE JUMP_FORWARD 322 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:152 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            ha = torch.empty_like(v, dtype=torch.float32)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR empty_like [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST v [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL torch [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR float32 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE FX call empty_like from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:152 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
        ha = torch.empty_like(v, dtype=torch.float32)
             ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST ha [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
TRACE LOAD_CLOSURE H []
TRACE LOAD_CLOSURE N [CellVariable()]
TRACE LOAD_CLOSURE V [CellVariable(), CellVariable()]
TRACE BUILD_TUPLE 3 [CellVariable(), CellVariable(), CellVariable()]
TRACE LOAD_CONST <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154> [TupleVariable(length=3)]
TRACE MAKE_FUNCTION 8 [TupleVariable(length=3), ConstantVariable(code: <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>)]
TRACE STORE_FAST grid [NestedUserFunctionVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:155 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            o = torch.empty_like(v)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR empty_like [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST v [NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call empty_like_1 from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:155 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
        o = torch.empty_like(v)
            ~~~~~~~~~~~~~~~~^^^
TRACE STORE_FAST o [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_GLOBAL fused_recurrent_fwd_kernel []
TRACE LOAD_FAST grid [NullVariable, LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), NestedUserFunctionVariable()]
TRACE inlined call __getitem__ from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
        fused_recurrent_fwd_kernel[grid](
        ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
INLINING <code object __getitem__ at 0x70c9a94dd6f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 413>, inlined according trace_rules.lookup inlined by default
TRACE MAKE_CELL self []
TRACE MAKE_CELL grid []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:413 in __getitem__ (KernelInterface.__getitem__) (inline depth: 5)
        def __getitem__(self, grid) -> T:
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:419 in __getitem__ (KernelInterface.__getitem__) (inline depth: 5)
            return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
TRACE LOAD_CLOSURE grid []
TRACE LOAD_CLOSURE self [CellVariable()]
TRACE BUILD_TUPLE 2 [CellVariable(), CellVariable()]
TRACE LOAD_CONST <code object <lambda> at 0x70c9a9437780, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 419> [TupleVariable(length=2)]
TRACE MAKE_FUNCTION 8 [TupleVariable(length=2), ConstantVariable(code: <code object <lambda> at 0x70c9a9437780, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 419>)]
TRACE RETURN_VALUE None [NestedUserFunctionVariable()]
DONE INLINING <code object __getitem__ at 0x70c9a94dd6f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 413>
TRACE LOAD_CONST () [NullVariable, NestedUserFunctionVariable()]
TRACE BUILD_MAP 0 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0)]
TRACE LOAD_CONST q [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:157 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                q=q,
TRACE LOAD_FAST q [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'q')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'q'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST k [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:158 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                k=k,
TRACE LOAD_FAST k [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'k')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'k'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST v [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:159 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                v=v,
TRACE LOAD_FAST v [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'v')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'v'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST a [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:160 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                a=a,
TRACE LOAD_FAST a [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'a')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'a'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST b [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:161 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                b=b,
TRACE LOAD_FAST b [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'b')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'b'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST gk [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:162 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                gk=gk,
TRACE LOAD_FAST gk [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'gk')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'gk'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST o [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:163 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                o=o,
TRACE LOAD_FAST o [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'o')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'o'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST ha [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:164 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                ha=ha,
TRACE LOAD_FAST ha [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'ha')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'ha'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST h0 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:165 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                h0=initial_state,
TRACE LOAD_FAST initial_state [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'h0')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'h0'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST ht [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:166 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                ht=final_state,
TRACE LOAD_FAST final_state [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'ht')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'ht'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST scale [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:167 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                scale=scale,
TRACE LOAD_FAST scale [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'scale')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'scale'), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST offsets [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:168 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                offsets=offsets,
TRACE LOAD_FAST offsets [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'offsets')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'offsets'), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST H [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:169 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                H=H,
TRACE LOAD_DEREF H [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'H')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'H'), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST T [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:170 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                T=T,
TRACE LOAD_FAST T [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'T')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'T'), SymNodeVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST K [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:171 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                K=K,
TRACE LOAD_FAST K [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'K')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'K'), ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST V [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:172 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                V=V,
TRACE LOAD_DEREF V [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'V')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'V'), ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST BK [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:173 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                BK=BK,
TRACE LOAD_FAST BK [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'BK')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'BK'), ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST HEAD_FIRST [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:174 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                HEAD_FIRST=head_first
TRACE LOAD_FAST head_first [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'HEAD_FIRST')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'HEAD_FIRST'), ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE CALL_FUNCTION_EX 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE inlined call <lambda> from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
        fused_recurrent_fwd_kernel[grid](
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
            q=q,
            ^^^^
            k=k,
            ^^^^
            v=v,
            ^^^^
            a=a,
            ^^^^
            b=b,
            ^^^^
            gk=gk,
            ^^^^^^
            o=o,
            ^^^^
            ha=ha,
            ^^^^^^
            h0=initial_state,
            ^^^^^^^^^^^^^^^^^
            ht=final_state,
            ^^^^^^^^^^^^^^^
            scale=scale,
            ^^^^^^^^^^^^
            offsets=offsets,
            ^^^^^^^^^^^^^^^^
            H=H,
            ^^^^
            T=T,
            ^^^^
            K=K,
            ^^^^
            V=V,
            ^^^^
            BK=BK,
            ^^^^^^
            HEAD_FIRST=head_first
            ^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object <lambda> at 0x70c9a9437780, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 419>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 2 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:419 in <lambda> (KernelInterface.__getitem__) (inline depth: 5)
            return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
TRACE RESUME 0 []
TRACE PUSH_NULL None []
TRACE LOAD_DEREF self [NullVariable]
TRACE LOAD_ATTR run [NullVariable, UserDefinedObjectVariable(Heuristics)]
TRACE LOAD_FAST args [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics))]
TRACE LOAD_DEREF grid [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0)]
TRACE LOAD_CONST False [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0), NestedUserFunctionVariable()]
TRACE LOAD_CONST ('grid', 'warmup') [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0), NestedUserFunctionVariable(), ConstantVariable(bool: False)]
TRACE BUILD_CONST_KEY_MAP 2 [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0), NestedUserFunctionVariable(), ConstantVariable(bool: False), TupleVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0), ConstDictVariable()]
TRACE inlined call run from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:419 in <lambda> (KernelInterface.__getitem__) (inline depth: 5)
        return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
                                       ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object run at 0x70c9a971df10, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py", line 449>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:449 in run (Heuristics.run) (inline depth: 6)
        def run(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:450 in run (Heuristics.run) (inline depth: 6)
            for v, heur in self.values.items():
TRACE LOAD_FAST self []
TRACE LOAD_ATTR values [UserDefinedObjectVariable(Heuristics)]
TRACE LOAD_ATTR items [LazyVariableTracker()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE FOR_ITER 156 [ListIteratorVariable(length=3, index=0)]
TRACE UNPACK_SEQUENCE 2 [ListIteratorVariable(length=3, index=1), TupleVariable(length=2)]
TRACE STORE_FAST v [ListIteratorVariable(length=3, index=1), LazyVariableTracker(), ConstantVariable(str: 'USE_INITIAL_STATE')]
TRACE STORE_FAST heur [ListIteratorVariable(length=3, index=1), LazyVariableTracker()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
                kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
TRACE PUSH_NULL None [ListIteratorVariable(length=3, index=1)]
TRACE LOAD_FAST heur [ListIteratorVariable(length=3, index=1), NullVariable]
TRACE BUILD_MAP 0 [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL dict [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE LOAD_GLOBAL zip [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST self [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, LazyVariableTracker(), NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR arg_names [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, LazyVariableTracker(), NullVariable, LazyVariableTracker(), UserDefinedObjectVariable(Heuristics)]
TRACE LOAD_FAST args [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, LazyVariableTracker(), NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, LazyVariableTracker(), NullVariable, LazyVariableTracker(), LazyVariableTracker(), TupleVariable(length=0)]
TRACE CALL 1 [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, LazyVariableTracker(), ZipVariable()]
TRACE inlined call construct_dict from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
            kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
                                ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object construct_dict at 0x70c9a070b0a0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 285>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:285 in construct_dict (construct_dict) (inline depth: 7)
    def construct_dict(cls, /, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:286 in construct_dict (construct_dict) (inline depth: 7)
        dst = cls.__new__(cls)
TRACE LOAD_FAST cls []
TRACE LOAD_ATTR __new__ [BuiltinVariable(dict)]
TRACE LOAD_FAST cls [NullVariable, GetAttrVariable(BuiltinVariable(dict), __new__)]
TRACE CALL 1 [NullVariable, GetAttrVariable(BuiltinVariable(dict), __new__), BuiltinVariable(dict)]
TRACE STORE_FAST dst [ConstDictVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:288 in construct_dict (construct_dict) (inline depth: 7)
        if args:
TRACE LOAD_FAST args []
TRACE POP_JUMP_IF_FALSE 264 [TupleVariable(length=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:289 in construct_dict (construct_dict) (inline depth: 7)
            src = args[0]
TRACE LOAD_FAST args []
TRACE LOAD_CONST 0 [TupleVariable(length=1)]
TRACE BINARY_SUBSCR None [TupleVariable(length=1), ConstantVariable(int: 0)]
TRACE STORE_FAST src [ZipVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:291 in construct_dict (construct_dict) (inline depth: 7)
            if not isinstance(src, Iterable):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST src [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL Iterable [NullVariable, LazyVariableTracker(), ZipVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ZipVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 128 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:295 in construct_dict (construct_dict) (inline depth: 7)
            if isinstance(src, (dict, MutableMapping, types.MappingProxyType)):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST src [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL dict [NullVariable, BuiltinVariable(isinstance), ZipVariable()]
TRACE LOAD_GLOBAL MutableMapping [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker()]
TRACE LOAD_GLOBAL types [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR MappingProxyType [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE BUILD_TUPLE 3 [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ZipVariable(), TupleVariable(length=3)]
TRACE POP_JUMP_IF_FALSE 234 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:301 in construct_dict (construct_dict) (inline depth: 7)
                for key, value in src:
TRACE LOAD_FAST src []
TRACE GET_ITER None [ZipVariable()]
TRACE FOR_ITER 262 [ZipVariable()]
TRACE END_FOR None [ZipVariable(), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:304 in construct_dict (construct_dict) (inline depth: 7)
        if kwargs:
TRACE LOAD_FAST kwargs []
TRACE POP_JUMP_IF_FALSE 298 [ConstDictVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:308 in construct_dict (construct_dict) (inline depth: 7)
        return dst
TRACE LOAD_FAST dst []
TRACE RETURN_VALUE None [ConstDictVariable()]
DONE INLINING <code object construct_dict at 0x70c9a070b0a0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 285>
TRACE DICT_UPDATE 1 [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), ConstDictVariable()]
TRACE LOAD_FAST kwargs [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE DICT_UPDATE 1 [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), ConstDictVariable()]
TRACE CALL 1 [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE inlined call <lambda> from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
            kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
                        ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object <lambda> at 0x70c98ce24d30, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 14>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:14 in <lambda> () (inline depth: 7)
        'USE_INITIAL_STATE': lambda args: args['h0'] is not None,
TRACE RESUME 0 []
TRACE LOAD_FAST args []
TRACE LOAD_CONST h0 [ConstDictVariable()]
TRACE BINARY_SUBSCR None [ConstDictVariable(), ConstantVariable(str: 'h0')]
TRACE LOAD_CONST None [TensorVariable()]
TRACE IS_OP 1 [TensorVariable(), ConstantVariable(NoneType: None)]
TRACE RETURN_VALUE None [ConstantVariable(bool: True)]
DONE INLINING <code object <lambda> at 0x70c98ce24d30, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 14>
TRACE LOAD_FAST kwargs [ListIteratorVariable(length=3, index=1), ConstantVariable(bool: True)]
TRACE LOAD_FAST v [ListIteratorVariable(length=3, index=1), ConstantVariable(bool: True), ConstDictVariable()]
TRACE STORE_SUBSCR None [ListIteratorVariable(length=3, index=1), ConstantVariable(bool: True), ConstDictVariable(), ConstantVariable(str: 'USE_INITIAL_STATE')]
TRACE JUMP_BACKWARD 54 [ListIteratorVariable(length=3, index=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:450 in run (Heuristics.run) (inline depth: 6)
            for v, heur in self.values.items():
TRACE FOR_ITER 156 [ListIteratorVariable(length=3, index=1)]
TRACE UNPACK_SEQUENCE 2 [ListIteratorVariable(length=3, index=2), TupleVariable(length=2)]
TRACE STORE_FAST v [ListIteratorVariable(length=3, index=2), LazyVariableTracker(), ConstantVariable(str: 'STORE_FINAL_STATE')]
TRACE STORE_FAST heur [ListIteratorVariable(length=3, index=2), LazyVariableTracker()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
                kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
TRACE PUSH_NULL None [ListIteratorVariable(length=3, index=2)]
TRACE LOAD_FAST heur [ListIteratorVariable(length=3, index=2), NullVariable]
TRACE BUILD_MAP 0 [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL dict [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE LOAD_GLOBAL zip [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict)]
TRACE LOAD_FAST self [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip)]
TRACE LOAD_ATTR arg_names [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip), UserDefinedObjectVariable(Heuristics)]
TRACE LOAD_FAST args [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip), LazyVariableTracker(), TupleVariable(length=0)]
TRACE CALL 1 [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), ZipVariable()]
TRACE inlined call construct_dict from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
            kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
                                ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object construct_dict at 0x70c9a070b0a0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 285>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:285 in construct_dict (construct_dict) (inline depth: 7)
    def construct_dict(cls, /, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:286 in construct_dict (construct_dict) (inline depth: 7)
        dst = cls.__new__(cls)
TRACE LOAD_FAST cls []
TRACE LOAD_ATTR __new__ [BuiltinVariable(dict)]
TRACE LOAD_FAST cls [NullVariable, GetAttrVariable(BuiltinVariable(dict), __new__)]
TRACE CALL 1 [NullVariable, GetAttrVariable(BuiltinVariable(dict), __new__), BuiltinVariable(dict)]
TRACE STORE_FAST dst [ConstDictVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:288 in construct_dict (construct_dict) (inline depth: 7)
        if args:
TRACE LOAD_FAST args []
TRACE POP_JUMP_IF_FALSE 264 [TupleVariable(length=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:289 in construct_dict (construct_dict) (inline depth: 7)
            src = args[0]
TRACE LOAD_FAST args []
TRACE LOAD_CONST 0 [TupleVariable(length=1)]
TRACE BINARY_SUBSCR None [TupleVariable(length=1), ConstantVariable(int: 0)]
TRACE STORE_FAST src [ZipVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:291 in construct_dict (construct_dict) (inline depth: 7)
            if not isinstance(src, Iterable):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST src [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL Iterable [NullVariable, LazyVariableTracker(), ZipVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ZipVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 128 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:295 in construct_dict (construct_dict) (inline depth: 7)
            if isinstance(src, (dict, MutableMapping, types.MappingProxyType)):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST src [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL dict [NullVariable, BuiltinVariable(isinstance), ZipVariable()]
TRACE LOAD_GLOBAL MutableMapping [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker()]
TRACE LOAD_GLOBAL types [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR MappingProxyType [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE BUILD_TUPLE 3 [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ZipVariable(), TupleVariable(length=3)]
TRACE POP_JUMP_IF_FALSE 234 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:301 in construct_dict (construct_dict) (inline depth: 7)
                for key, value in src:
TRACE LOAD_FAST src []
TRACE GET_ITER None [ZipVariable()]
TRACE FOR_ITER 262 [ZipVariable()]
TRACE END_FOR None [ZipVariable(), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:304 in construct_dict (construct_dict) (inline depth: 7)
        if kwargs:
TRACE LOAD_FAST kwargs []
TRACE POP_JUMP_IF_FALSE 298 [ConstDictVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:308 in construct_dict (construct_dict) (inline depth: 7)
        return dst
TRACE LOAD_FAST dst []
TRACE RETURN_VALUE None [ConstDictVariable()]
DONE INLINING <code object construct_dict at 0x70c9a070b0a0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 285>
TRACE DICT_UPDATE 1 [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), ConstDictVariable()]
TRACE LOAD_FAST kwargs [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE DICT_UPDATE 1 [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), ConstDictVariable()]
TRACE CALL 1 [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE inlined call <lambda> from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
            kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
                        ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object <lambda> at 0x70c98ce257c0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 15>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:15 in <lambda> () (inline depth: 7)
        'STORE_FINAL_STATE': lambda args: args['ht'] is not None,
TRACE RESUME 0 []
TRACE LOAD_FAST args []
TRACE LOAD_CONST ht [ConstDictVariable()]
TRACE BINARY_SUBSCR None [ConstDictVariable(), ConstantVariable(str: 'ht')]
TRACE LOAD_CONST None [TensorVariable()]
TRACE IS_OP 1 [TensorVariable(), ConstantVariable(NoneType: None)]
TRACE RETURN_VALUE None [ConstantVariable(bool: True)]
DONE INLINING <code object <lambda> at 0x70c98ce257c0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 15>
TRACE LOAD_FAST kwargs [ListIteratorVariable(length=3, index=2), ConstantVariable(bool: True)]
TRACE LOAD_FAST v [ListIteratorVariable(length=3, index=2), ConstantVariable(bool: True), ConstDictVariable()]
TRACE STORE_SUBSCR None [ListIteratorVariable(length=3, index=2), ConstantVariable(bool: True), ConstDictVariable(), ConstantVariable(str: 'STORE_FINAL_STATE')]
TRACE JUMP_BACKWARD 54 [ListIteratorVariable(length=3, index=2)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:450 in run (Heuristics.run) (inline depth: 6)
            for v, heur in self.values.items():
TRACE FOR_ITER 156 [ListIteratorVariable(length=3, index=2)]
TRACE UNPACK_SEQUENCE 2 [ListIteratorVariable(length=3, index=3), TupleVariable(length=2)]
TRACE STORE_FAST v [ListIteratorVariable(length=3, index=3), LazyVariableTracker(), ConstantVariable(str: 'USE_OFFSETS')]
TRACE STORE_FAST heur [ListIteratorVariable(length=3, index=3), LazyVariableTracker()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
                kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
TRACE PUSH_NULL None [ListIteratorVariable(length=3, index=3)]
TRACE LOAD_FAST heur [ListIteratorVariable(length=3, index=3), NullVariable]
TRACE BUILD_MAP 0 [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL dict [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE LOAD_GLOBAL zip [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict)]
TRACE LOAD_FAST self [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip)]
TRACE LOAD_ATTR arg_names [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip), UserDefinedObjectVariable(Heuristics)]
TRACE LOAD_FAST args [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip), LazyVariableTracker(), TupleVariable(length=0)]
TRACE CALL 1 [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), ZipVariable()]
TRACE inlined call construct_dict from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
            kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
                                ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object construct_dict at 0x70c9a070b0a0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 285>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:285 in construct_dict (construct_dict) (inline depth: 7)
    def construct_dict(cls, /, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:286 in construct_dict (construct_dict) (inline depth: 7)
        dst = cls.__new__(cls)
TRACE LOAD_FAST cls []
TRACE LOAD_ATTR __new__ [BuiltinVariable(dict)]
TRACE LOAD_FAST cls [NullVariable, GetAttrVariable(BuiltinVariable(dict), __new__)]
TRACE CALL 1 [NullVariable, GetAttrVariable(BuiltinVariable(dict), __new__), BuiltinVariable(dict)]
TRACE STORE_FAST dst [ConstDictVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:288 in construct_dict (construct_dict) (inline depth: 7)
        if args:
TRACE LOAD_FAST args []
TRACE POP_JUMP_IF_FALSE 264 [TupleVariable(length=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:289 in construct_dict (construct_dict) (inline depth: 7)
            src = args[0]
TRACE LOAD_FAST args []
TRACE LOAD_CONST 0 [TupleVariable(length=1)]
TRACE BINARY_SUBSCR None [TupleVariable(length=1), ConstantVariable(int: 0)]
TRACE STORE_FAST src [ZipVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:291 in construct_dict (construct_dict) (inline depth: 7)
            if not isinstance(src, Iterable):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST src [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL Iterable [NullVariable, LazyVariableTracker(), ZipVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ZipVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 128 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:295 in construct_dict (construct_dict) (inline depth: 7)
            if isinstance(src, (dict, MutableMapping, types.MappingProxyType)):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST src [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL dict [NullVariable, BuiltinVariable(isinstance), ZipVariable()]
TRACE LOAD_GLOBAL MutableMapping [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker()]
TRACE LOAD_GLOBAL types [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR MappingProxyType [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE BUILD_TUPLE 3 [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ZipVariable(), TupleVariable(length=3)]
TRACE POP_JUMP_IF_FALSE 234 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:301 in construct_dict (construct_dict) (inline depth: 7)
                for key, value in src:
TRACE LOAD_FAST src []
TRACE GET_ITER None [ZipVariable()]
TRACE FOR_ITER 262 [ZipVariable()]
TRACE END_FOR None [ZipVariable(), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:304 in construct_dict (construct_dict) (inline depth: 7)
        if kwargs:
TRACE LOAD_FAST kwargs []
TRACE POP_JUMP_IF_FALSE 298 [ConstDictVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:308 in construct_dict (construct_dict) (inline depth: 7)
        return dst
TRACE LOAD_FAST dst []
TRACE RETURN_VALUE None [ConstDictVariable()]
DONE INLINING <code object construct_dict at 0x70c9a070b0a0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 285>
TRACE DICT_UPDATE 1 [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), ConstDictVariable()]
TRACE LOAD_FAST kwargs [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE DICT_UPDATE 1 [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), ConstDictVariable()]
TRACE CALL 1 [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE inlined call <lambda> from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
            kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
                        ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object <lambda> at 0x70c98ce25a30, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 16>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:16 in <lambda> () (inline depth: 7)
        'USE_OFFSETS': lambda args: args['offsets'] is not None
TRACE RESUME 0 []
TRACE LOAD_FAST args []
TRACE LOAD_CONST offsets [ConstDictVariable()]
TRACE BINARY_SUBSCR None [ConstDictVariable(), ConstantVariable(str: 'offsets')]
TRACE LOAD_CONST None [ConstantVariable(NoneType: None)]
TRACE IS_OP 1 [ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE RETURN_VALUE None [ConstantVariable(bool: False)]
DONE INLINING <code object <lambda> at 0x70c98ce25a30, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 16>
TRACE LOAD_FAST kwargs [ListIteratorVariable(length=3, index=3), ConstantVariable(bool: False)]
TRACE LOAD_FAST v [ListIteratorVariable(length=3, index=3), ConstantVariable(bool: False), ConstDictVariable()]
TRACE STORE_SUBSCR None [ListIteratorVariable(length=3, index=3), ConstantVariable(bool: False), ConstDictVariable(), ConstantVariable(str: 'USE_OFFSETS')]
TRACE JUMP_BACKWARD 54 [ListIteratorVariable(length=3, index=3)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:450 in run (Heuristics.run) (inline depth: 6)
            for v, heur in self.values.items():
TRACE FOR_ITER 156 [ListIteratorVariable(length=3, index=3)]
TRACE END_FOR None [ListIteratorVariable(length=3, index=3), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:452 in run (Heuristics.run) (inline depth: 6)
            return self.fn.run(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(Heuristics)]
TRACE LOAD_ATTR run [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST args [NullVariable, GetAttrVariable(TritonKernelVariable(), run)]
TRACE BUILD_MAP 0 [NullVariable, GetAttrVariable(TritonKernelVariable(), run), TupleVariable(length=0)]
TRACE LOAD_FAST kwargs [NullVariable, GetAttrVariable(TritonKernelVariable(), run), TupleVariable(length=0), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, GetAttrVariable(TritonKernelVariable(), run), TupleVariable(length=0), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, GetAttrVariable(TritonKernelVariable(), run), TupleVariable(length=0), ConstDictVariable()]
TRACE inlined call grid from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:452 in run (Heuristics.run) (inline depth: 6)
        return self.fn.run(*args, **kwargs)
               ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in grid (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 7)
            def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
TRACE RESUME 0 []
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF V [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST meta [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE LOAD_CONST BV [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstDictVariable(), ConstantVariable(str: 'BV')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in grid (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 7)
        def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
                                ~~~~~~~~~~~^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 128)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 128)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 128)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 9)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 9)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [ConstantVariable(int: 128)]
TRACE BINARY_OP 0 [ConstantVariable(int: 128), ConstantVariable(int: 32)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 160)]
TRACE BINARY_OP 10 [ConstantVariable(int: 160), ConstantVariable(int: 1)]
TRACE LOAD_FAST y [ConstantVariable(int: 159)]
TRACE BINARY_OP 2 [ConstantVariable(int: 159), ConstantVariable(int: 32)]
TRACE RETURN_VALUE None [ConstantVariable(int: 4)]
DONE INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [ConstantVariable(int: 4)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 4)]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE LOAD_DEREF N [ConstantVariable(int: 4)]
TRACE LOAD_DEREF H [ConstantVariable(int: 4), ConstantVariable(int: 1)]
TRACE BINARY_OP 5 [ConstantVariable(int: 4), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE BUILD_TUPLE 2 [ConstantVariable(int: 4), ConstantVariable(int: 64)]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>
TRACE inlined call grid from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:452 in run (Heuristics.run) (inline depth: 6)
        return self.fn.run(*args, **kwargs)
               ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in grid (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 7)
            def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
TRACE RESUME 0 []
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF V [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST meta [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE LOAD_CONST BV [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstDictVariable(), ConstantVariable(str: 'BV')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in grid (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 7)
        def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
                                ~~~~~~~~~~~^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 128)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 128)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 128)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 9)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 9)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [ConstantVariable(int: 128)]
TRACE BINARY_OP 0 [ConstantVariable(int: 128), ConstantVariable(int: 32)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 160)]
TRACE BINARY_OP 10 [ConstantVariable(int: 160), ConstantVariable(int: 1)]
TRACE LOAD_FAST y [ConstantVariable(int: 159)]
TRACE BINARY_OP 2 [ConstantVariable(int: 159), ConstantVariable(int: 32)]
TRACE RETURN_VALUE None [ConstantVariable(int: 4)]
DONE INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [ConstantVariable(int: 4)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 4)]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE LOAD_DEREF N [ConstantVariable(int: 4)]
TRACE LOAD_DEREF H [ConstantVariable(int: 4), ConstantVariable(int: 1)]
TRACE BINARY_OP 5 [ConstantVariable(int: 4), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE BUILD_TUPLE 2 [ConstantVariable(int: 4), ConstantVariable(int: 64)]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>
TRACE inlined call grid from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:452 in run (Heuristics.run) (inline depth: 6)
        return self.fn.run(*args, **kwargs)
               ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in grid (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 7)
            def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
TRACE RESUME 0 []
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF V [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST meta [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE LOAD_CONST BV [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstDictVariable(), ConstantVariable(str: 'BV')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in grid (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 7)
        def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
                                ~~~~~~~~~~~^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 128)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 128)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 128)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 9)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 9)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [ConstantVariable(int: 128)]
TRACE BINARY_OP 0 [ConstantVariable(int: 128), ConstantVariable(int: 32)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 160)]
TRACE BINARY_OP 10 [ConstantVariable(int: 160), ConstantVariable(int: 1)]
TRACE LOAD_FAST y [ConstantVariable(int: 159)]
TRACE BINARY_OP 2 [ConstantVariable(int: 159), ConstantVariable(int: 32)]
TRACE RETURN_VALUE None [ConstantVariable(int: 4)]
DONE INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [ConstantVariable(int: 4)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 4)]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE LOAD_DEREF N [ConstantVariable(int: 4)]
TRACE LOAD_DEREF H [ConstantVariable(int: 4), ConstantVariable(int: 1)]
TRACE BINARY_OP 5 [ConstantVariable(int: 4), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE BUILD_TUPLE 2 [ConstantVariable(int: 4), ConstantVariable(int: 64)]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>
TRACE FX call triton_kernel_wrapper_mutation from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:452 in run (Heuristics.run) (inline depth: 6)
        return self.fn.run(*args, **kwargs)
               ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [ConstantVariable(NoneType: None)]
DONE INLINING <code object run at 0x70c9a971df10, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py", line 449>
TRACE RETURN_VALUE None [ConstantVariable(NoneType: None)]
DONE INLINING <code object <lambda> at 0x70c9a9437780, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 419>
TRACE POP_TOP None [ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:176 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            return o, final_state
TRACE LOAD_FAST o []
TRACE LOAD_FAST final_state [TensorVariable()]
TRACE BUILD_TUPLE 2 [TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object forward at 0x3060e8b0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 124>
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object wrapper at 0x70c98d04f0a0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 16>
TRACE UNPACK_SEQUENCE 2 [TupleVariable(length=2)]
TRACE STORE_FAST o [TensorVariable(), TensorVariable()]
TRACE STORE_FAST final_state [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:258 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
        return o, final_state
TRACE LOAD_FAST o []
TRACE LOAD_FAST final_state [TensorVariable()]
TRACE BUILD_TUPLE 2 [TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object fused_recurrent_dplr_delta_rule at 0x305fb4e0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 188>
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object fused_recurrent_rwkv7 at 0x70c98d0c9890, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py", line 11>
TRACE UNPACK_SEQUENCE 2 [TupleVariable(length=2)]
TRACE STORE_FAST xx [TensorVariable(), TensorVariable()]
TRACE STORE_FAST state [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:612 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            xx = xx.view(B,T,-1) * (float(N) ** -0.5)
TRACE LOAD_FAST xx []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: -1)]
TRACE FX call view_17 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:612 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.view(B,T,-1) * (float(N) ** -0.5)
             ~~~~~~~^^^^^^^^
TRACE LOAD_GLOBAL float [TensorVariable()]
TRACE LOAD_FAST N [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE LOAD_CONST -0.5 [TensorVariable(), ConstantVariable(float: 128.0)]
TRACE BINARY_OP 8 [TensorVariable(), ConstantVariable(float: 128.0), ConstantVariable(float: -0.5)]
TRACE BINARY_OP 5 [TensorVariable(), ConstantVariable(float: 0.08838834764831845)]
TRACE FX call mul_14 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:612 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.view(B,T,-1) * (float(N) ** -0.5)
             ~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST xx [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
TRACE LOAD_FAST xx []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST r [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR dtype [NullVariable, GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_10 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
             ~~~~~^^^^^^^^^^^^^^^
TRACE LOAD_FAST r [TensorVariable()]
TRACE LOAD_ATTR view [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST B [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64)]
TRACE CALL 4 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_18 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                      ~~~~~~^^^^^^^^^
TRACE LOAD_FAST k [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR view [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST B [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64)]
TRACE CALL 4 [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_19 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                                      ~~~~~~^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call mul_15 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                      ~~~~~~~~~~~~~~~^^~~~~~~~~~~~~~~
TRACE LOAD_FAST r_k [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR view [TensorVariable(), TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['r_k'] (8192,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='r_k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_r_k_ L['r_k'] FakeTensor(..., device='cuda:0', size=(8192,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE LOAD_FAST H [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST N [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 64)]
TRACE CALL 2 [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_20 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                                                      ~~~~~~~~^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call mul_16 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^~~~~~~~~~~~~
TRACE LOAD_ATTR sum [TensorVariable(), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), sum)]
TRACE LOAD_CONST True [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), sum), ConstantVariable(int: -1)]
TRACE KW_NAMES ('dim', 'keepdim') [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), sum), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), sum), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call sum_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_FAST v [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR view [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST B [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64)]
TRACE CALL 4 [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_21 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                                                                                                 ~~~~~~^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call mul_17 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~
TRACE LOAD_ATTR view [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST B [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64)]
TRACE BINARY_OP 5 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE CALL 3 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8192)]
TRACE FX call view_22 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable()]
TRACE FX call add_12 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
             ~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST xx [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:616 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            output = fpx_matmul((xx * (torch.sigmoid(xg) @ g2)), O_, O_state,ebits,mbits)
TRACE LOAD_GLOBAL fpx_matmul []
TRACE LOAD_FAST xx [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL torch [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR sigmoid [NullVariable, LazyVariableTracker(), TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST xg [NullVariable, LazyVariableTracker(), TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call sigmoid_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:616 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        output = fpx_matmul((xx * (torch.sigmoid(xg) @ g2)), O_, O_state,ebits,mbits)
                                   ~~~~~~~~~~~~~^^^^
TRACE LOAD_FAST g2 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE BINARY_OP 4 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['g2'] (480, 8192) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='g2', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_g2_ L['g2'] FakeTensor(..., device='cuda:0', size=(480, 8192), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call matmul_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:616 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        output = fpx_matmul((xx * (torch.sigmoid(xg) @ g2)), O_, O_state,ebits,mbits)
                                   ~~~~~~~~~~~~~~~~~~^~~~
TRACE BINARY_OP 5 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE FX call mul_18 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:616 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        output = fpx_matmul((xx * (torch.sigmoid(xg) @ g2)), O_, O_state,ebits,mbits)
                             ~~~^~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_FAST O_ [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST O_state [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_FAST ebits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST mbits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: -44)]
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: -44), LazyVariableTracker()]
TRACE inlined call fpx_matmul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:616 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        output = fpx_matmul((xx * (torch.sigmoid(xg) @ g2)), O_, O_state,ebits,mbits)
                 ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object fpx_matmul at 0x3063a810, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:420 in fpx_matmul (fpx_matmul) (inline depth: 1)
    def fpx_matmul(x,weight,weight_state,ebits:int=3,mbits:int=2):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:421 in fpx_matmul (fpx_matmul) (inline depth: 1)
        if ebits == -44: #hqq
TRACE LOAD_FAST ebits []
TRACE LOAD_CONST -44 [ConstantVariable(int: -44)]
TRACE COMPARE_OP == [ConstantVariable(int: -44), ConstantVariable(int: -44)]
TRACE POP_JUMP_IF_FALSE 322 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S0=x.shape[0]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE FX call size_14 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul) (inline depth: 1)
        S0=x.shape[0]
           ^^^^^^^
TRACE LOAD_CONST 0 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 0)]
TRACE STORE_FAST S0 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S1=x.shape[1]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE FX call size_15 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul) (inline depth: 1)
        S1=x.shape[1]
           ^^^^^^^
TRACE LOAD_CONST 1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 1)]
TRACE STORE_FAST S1 [SymNodeVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:424 in fpx_matmul (fpx_matmul) (inline depth: 1)
            dtype = x.dtype
TRACE LOAD_FAST x []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
            x = x.to(dtype=torch.float16).view(-1,x.shape[2])
TRACE LOAD_FAST x []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float16 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_11 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST x [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1)]
TRACE LOAD_ATTR shape [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), TensorVariable()]
TRACE FX call size_16 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
                                              ^^^^^^^
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3), ConstantVariable(int: 2)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), ConstantVariable(int: 8192)]
TRACE FX call view_23 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
            out = weight.forward_manual(x).to(dtype=dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_ATTR forward_manual [LazyVariableTracker()]
TRACE LOAD_FAST x [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE CALL 1 [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton)), TensorVariable()]
TRACE inlined call forward_manual from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:543 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        def forward_manual(self, x: Tensor, matmul_type: str="GEMM") -> Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE LOAD_GLOBAL forward_functional []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:545 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                x,
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:546 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.bias,
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR bias [NullVariable, LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_tensor_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_ATTR get_tensor_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_tensor_args at 0x70c98a9e9080>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_tensor_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_tensor_args(),
            ~~~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:524 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
        def get_tensor_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:525 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
            return [self.W_q, self.scales, self.zeros]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR W_q [UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_FAST self [LazyVariableTracker()]
TRACE LOAD_ATTR scales [LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['O_']._parameters['scales'] (128, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='O_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='scales'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_O_parameters_scales_ L['O_']._parameters['scales'] Parameter(FakeTensor(..., device='cuda:0', size=(128, 5120), dtype=torch.float16)) at debug_level 0 before=False
TRACE LOAD_FAST self [LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR zeros [LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['O_']._parameters['zeros'] (128, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='O_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='zeros'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_O_parameters_zeros_ L['O_']._parameters['zeros'] Parameter(FakeTensor(..., device='cuda:0', size=(128, 5120), dtype=torch.float16)) at debug_level 0 before=False
TRACE BUILD_LIST 3 [LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [ListVariable(length=3)]
DONE INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_meta_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3)]
TRACE LOAD_ATTR get_meta_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_meta_args at 0x70c98a9e9120>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_meta_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_meta_args(),
            ~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:527 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
        def get_meta_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE LOAD_GLOBAL int []
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR scaled_activations [NullVariable, LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:529 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_nbits,
TRACE LOAD_FAST self [ConstantVariable(int: 0)]
TRACE LOAD_ATTR W_nbits [ConstantVariable(int: 0), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:530 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.group_size,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker()]
TRACE LOAD_ATTR group_size [ConstantVariable(int: 0), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:531 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.unpack_mask,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR unpack_mask [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:532 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.elements_per_sample,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR elements_per_sample [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:533 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.input_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR input_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:534 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.output_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR output_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:535 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.acc_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR acc_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:536 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.meta_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR meta_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:537 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.channel_scale_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR channel_scale_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:538 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_group_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR W_group_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:539 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    int(self.data_contiguous),
TRACE LOAD_GLOBAL int [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int)]
TRACE LOAD_ATTR data_contiguous [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE BUILD_LIST 12 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [ListVariable(length=12)]
DONE INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:549 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
TRACE LOAD_GLOBAL GEMLITE_MATMUL_TYPES_MAPPING [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12)]
TRACE LOAD_FAST matmul_type [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker(), ConstantVariable(str: 'GEMM')]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), ConstantVariable(int: 4)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        return forward_functional(
               ~~~~~~~~~~~~~~~~~~^
            x,
            ^^
            self.bias,
            ^^^^^^^^^^
            self.get_tensor_args(),
            ^^^^^^^^^^^^^^^^^^^^^^^
            self.get_meta_args(),
            ^^^^^^^^^^^^^^^^^^^^^
            GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:675 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        def __call__(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
            return self._opoverload(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR _opoverload [NullVariable, UserDefinedObjectVariable(CustomOpDef)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=5)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
wrap_to_fake L['O_'].W_q (1024, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=AttrSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='O_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='W_q'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_O_W_q L['O_'].W_q FakeTensor(..., device='cuda:0', size=(1024, 5120), dtype=torch.int32) at debug_level 0 before=False
TRACE FX call forward_functional_default_1 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        return self._opoverload(*args, **kwargs)
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_12 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE STORE_FAST out [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
            return out.view(S0,S1,-1)
TRACE LOAD_FAST out []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST S0 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST S1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: -1)]
TRACE FX call view_24 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
        return out.view(S0,S1,-1)
               ~~~~~~~~^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object fpx_matmul at 0x3063a810, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>
TRACE STORE_FAST output [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:618 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            x_in = x_in + output
TRACE LOAD_FAST x_in []
TRACE LOAD_FAST output [TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable()]
TRACE FX call add_13 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:618 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        x_in = x_in + output
               ~~~~~^~~~~~~~
TRACE STORE_FAST x_in [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:619 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            output = T5RMSNorm(x_in,ln2,variance_epsilon=rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST x_in [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln2 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE KW_NAMES ('variance_epsilon',) [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ConstantVariable(float: 1e-06)]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:619 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        output = T5RMSNorm(x_in,ln2,variance_epsilon=rmsnorm_epsilon)
                 ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_13 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_14 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_19 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln2'] (5120,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln2', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln2_ L['ln2'] FakeTensor(..., device='cuda:0', size=(5120,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_20 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_14 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST output [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:621 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            return  output, x[:,-1], state, v_first, k_first, x_in
TRACE LOAD_FAST output []
TRACE LOAD_FAST x [TensorVariable()]
TRACE LOAD_CONST None [TensorVariable(), TensorVariable()]
TRACE LOAD_CONST None [TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST -1 [TensorVariable(), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [TensorVariable(), TensorVariable(), SliceVariable(), ConstantVariable(int: -1)]
TRACE BINARY_SUBSCR None [TensorVariable(), TensorVariable(), TupleVariable(length=2)]
TRACE FX call getitem_74 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:621 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        return  output, x[:,-1], state, v_first, k_first, x_in
                        ~^^^^^^
TRACE LOAD_FAST state [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST v_first [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST k_first [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST x_in [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 6 [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [TupleVariable(length=6)]
Step 1: torchdynamo done tracing hxa079_TimeMix (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py, line 621 in hxa079_TimeMix>], graph_break=False)
REMOVE UNUSED GRAPHARG L['v_first'].stride()[0]
REMOVE UNUSED GRAPHARG L['calc_cos'].size()[1]
REMOVE UNUSED GRAPHARG L['calc_sin'].size()[1]
REMOVE UNUSED GRAPHARG L['layer_id']
REMOVE UNUSED GRAPHARG L['v_first'].size()[1]
TRACED GRAPH
 ===== __compiled_fn_23_ebd21c8e_e0a7_4348_847f_0fadd1f3988b =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, s52: "Sym(s18)", L_x_in_: "[31mbf16[0m[34m[1, s18, 5120][0m[2m[34m[5120*s18, 5120, 1][0m[2m[32mcuda:0[0m", L_ln1_: "[31mbf16[0m[34m[5120][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_wavgk1_: "[31mbf16[0m[34m[5120, 1376][0m[2m[34m[1376, 1][0m[2m[32mcuda:0[0m", L_RKV_parameters_scales_: "[31mf16[0m[34m[80, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m", L_RKV_parameters_zeros_: "[31mf16[0m[34m[80, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m", L_RKV_W_q: "[31mi32[0m[34m[640, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m", L_R_bias_: "[31mbf16[0m[34m[][0m[2m[34m[][0m[2m[32mcuda:0[0m", L_ln_r_: "[31mbf16[0m[34m[128][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_ln_k_: "[31mbf16[0m[34m[128][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_calc_cos_: "[31mf32[0m[34m[1, s18, 128][0m[2m[34m[128*s18, 128, 1][0m[2m[32mcuda:0[0m", L_calc_sin_: "[31mf32[0m[34m[1, s18, 128][0m[2m[34m[128*s18, 128, 1][0m[2m[32mcuda:0[0m", s80_0: "Sym(s80)", s81: "Sym(s81)", L_v_first_: "[31mbf16[0m[34m[1, s18, 8, 128][0m[2m[34m[s18*s80, s80, 128, 1][0m[2m[32mcuda:0[0m", L_v2_: "[31mbf16[0m[34m[128, 1024][0m[2m[34m[1024, 1][0m[2m[32mcuda:0[0m", L_v0_: "[31mbf16[0m[34m[1, 1, 1024][0m[2m[34m[1024, 1024, 1][0m[2m[32mcuda:0[0m", s18: "Sym(s18)", L_k_first_: "[31mbf16[0m[34m[1, s18, 8, 128][0m[2m[34m[1024*s18, 1024, 128, 1][0m[2m[32mcuda:0[0m", L_k2_: "[31mbf16[0m[34m[128, 1024][0m[2m[34m[1024, 1][0m[2m[32mcuda:0[0m", L_k0_: "[31mbf16[0m[34m[1, 1, 1024][0m[2m[34m[1024, 1024, 1][0m[2m[32mcuda:0[0m", L_a2_: "[31mbf16[0m[34m[160, 8192][0m[2m[34m[8192, 1][0m[2m[32mcuda:0[0m", L_a0_: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m", L_w2_: "[31mbf16[0m[34m[480, 8192][0m[2m[34m[8192, 1][0m[2m[32mcuda:0[0m", L_w0_: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m", L_state_: "[31mbf16[0m[34m[1, 64, 128, 128][0m[2m[34m[1048576, 16384, 128, 1][0m[2m[32mcuda:0[0m", L_r_k_: "[31mbf16[0m[34m[8192][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_g2_: "[31mbf16[0m[34m[480, 8192][0m[2m[34m[8192, 1][0m[2m[32mcuda:0[0m", L_O_parameters_scales_: "[31mf16[0m[34m[128, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m", L_O_parameters_zeros_: "[31mf16[0m[34m[128, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m", L_O_W_q: "[31mi32[0m[34m[1024, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m", L_ln2_: "[31mbf16[0m[34m[5120][0m[2m[34m[1][0m[2m[32mcuda:0[0m"):
        l_x_in_ = L_x_in_
        l_ln1_ = L_ln1_
        l_wavgk1_ = L_wavgk1_
        l_rkv_parameters_scales_ = L_RKV_parameters_scales_
        l_rkv_parameters_zeros_ = L_RKV_parameters_zeros_
        l_rkv_w_q = L_RKV_W_q
        l_r_bias_ = L_R_bias_
        l_ln_r_ = L_ln_r_
        l_ln_k_ = L_ln_k_
        l_calc_cos_ = L_calc_cos_
        l_calc_sin_ = L_calc_sin_
        l_v_first_ = L_v_first_
        l_v2_ = L_v2_
        l_v0_ = L_v0_
        l_k_first_ = L_k_first_
        l_k2_ = L_k2_
        l_k0_ = L_k0_
        l_a2_ = L_a2_
        l_a0_ = L_a0_
        l_w2_ = L_w2_
        l_w0_ = L_w0_
        l_state_ = L_state_
        l_r_k_ = L_r_k_
        l_g2_ = L_g2_
        l_o_parameters_scales_ = L_O_parameters_scales_
        l_o_parameters_zeros_ = L_O_parameters_zeros_
        l_o_w_q = L_O_W_q
        l_ln2_ = L_ln2_
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states: "[31mf32[0m[34m[1, s18, 5120][0m[2m[34m[5120*s18, 5120, 1][0m[2m[32mcuda:0[0m" = l_x_in_.to([34mtorch.float32[0m)
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_1: "[31mf32[0m[34m[1, s18, 5120][0m[2m[34m[5120*s18, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states.pow([34m2[0m)
        variance: "[31mf32[0m[34m[1, s18, 1][0m[2m[34m[s18, 1, 1][0m[2m[32mcuda:0[0m" = pow_1.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add: "[31mf32[0m[34m[1, s18, 1][0m[2m[34m[s18, 1, 1][0m[2m[32mcuda:0[0m" = variance + [34m1e-06[0m;  [2mvariance = None[0m
        rsqrt: "[31mf32[0m[34m[1, s18, 1][0m[2m[34m[s18, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add);  [2madd = None[0m
        hidden_states_1: "[31mf32[0m[34m[1, s18, 5120][0m[2m[34m[5120*s18, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states * rsqrt;  [2mhidden_states = rsqrt = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_1: "[31mf32[0m[34m[1, s18, 5120][0m[2m[34m[5120*s18, 5120, 1][0m[2m[32mcuda:0[0m" = l_ln1_ * hidden_states_1;  [2ml_ln1_ = hidden_states_1 = None[0m
        x: "[31mbf16[0m[34m[1, s18, 5120][0m[2m[34m[5120*s18, 5120, 1][0m[2m[32mcuda:0[0m" = mul_1.to([34mtorch.bfloat16[0m);  [2mmul_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:551 in hxa079_TimeMix, code: xw,xa,xv,xg,xk = (x @ wavgk1).split(wavgk_split_list, dim=-1)[0m
        matmul: "[31mbf16[0m[34m[1, s18, 1376][0m[2m[34m[1376*s18, 1376, 1][0m[2m[32mcuda:0[0m" = x @ l_wavgk1_;  [2ml_wavgk1_ = None[0m
        split = matmul.split([[34m480[0m, [34m160[0m, [34m128[0m, [34m480[0m, [34m128[0m], dim = [34m-1[0m);  [2mmatmul = None[0m
        xw: "[31mbf16[0m[34m[1, s18, 480][0m[2m[34m[1376*s18, 1376, 1][0m[2m[32mcuda:0[0m" = split[[34m0[0m]
        xa: "[31mbf16[0m[34m[1, s18, 160][0m[2m[34m[1376*s18, 1376, 1][0m[2m[32mcuda:0[0m" = split[[34m1[0m]
        xv: "[31mbf16[0m[34m[1, s18, 128][0m[2m[34m[1376*s18, 1376, 1][0m[2m[32mcuda:0[0m" = split[[34m2[0m]
        xg: "[31mbf16[0m[34m[1, s18, 480][0m[2m[34m[1376*s18, 1376, 1][0m[2m[32mcuda:0[0m" = split[[34m3[0m]
        xk: "[31mbf16[0m[34m[1, s18, 128][0m[2m[34m[1376*s18, 1376, 1][0m[2m[32mcuda:0[0m" = split[[34m4[0m];  [2msplit = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul, code: x = x.to(dtype=torch.float16).view(-1,x.shape[2])[0m
        to_2: "[31mf16[0m[34m[1, s18, 5120][0m[2m[34m[5120*s18, 5120, 1][0m[2m[32mcuda:0[0m" = x.to(dtype = [34mtorch.float16[0m)
        x_1: "[31mf16[0m[34m[s18, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m" = to_2.view([34m-1[0m, [34m5120[0m);  [2mto_2 = None[0m
        
         [2m# File: /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__, code: return self._opoverload(*args, **kwargs)[0m
        forward_functional_default: "[31mf16[0m[34m[s18, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m" = torch.ops.gemlite.forward_functional.default(x_1, [34mNone[0m, [l_rkv_w_q, l_rkv_parameters_scales_, l_rkv_parameters_zeros_], [[34m0[0m, [34m4[0m, [34m64[0m, [34m15[0m, [34m8[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m0[0m, [34m4[0m, [34m1[0m], [34m4[0m);  [2mx_1 = l_rkv_w_q = l_rkv_parameters_scales_ = l_rkv_parameters_zeros_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul, code: out = weight.forward_manual(x).to(dtype=dtype)[0m
        out: "[31mbf16[0m[34m[s18, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m" = forward_functional_default.to(dtype = [34mtorch.bfloat16[0m);  [2mforward_functional_default = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul, code: return out.view(S0,S1,-1)[0m
        rkv: "[31mbf16[0m[34m[1, s18, 10240][0m[2m[34m[10240*s18, 10240, 1][0m[2m[32mcuda:0[0m" = out.view([34m1[0m, s18, [34m-1[0m);  [2mout = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:556 in hxa079_TimeMix, code: r,k,v = rkv.split(rkv_split_list,dim=-1)[0m
        split_1 = rkv.split([[34m8192[0m, [34m1024[0m, [34m1024[0m], dim = [34m-1[0m);  [2mrkv = None[0m
        r: "[31mbf16[0m[34m[1, s18, 8192][0m[2m[34m[10240*s18, 10240, 1][0m[2m[32mcuda:0[0m" = split_1[[34m0[0m]
        k: "[31mbf16[0m[34m[1, s18, 1024][0m[2m[34m[10240*s18, 10240, 1][0m[2m[32mcuda:0[0m" = split_1[[34m1[0m]
        v: "[31mbf16[0m[34m[1, s18, 1024][0m[2m[34m[10240*s18, 10240, 1][0m[2m[32mcuda:0[0m" = split_1[[34m2[0m];  [2msplit_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:562 in hxa079_TimeMix, code: r = r.add_(R_bias)[0m
        r_1: "[31mbf16[0m[34m[1, s18, 8192][0m[2m[34m[10240*s18, 10240, 1][0m[2m[32mcuda:0[0m" = r.add_(l_r_bias_);  [2mr = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:563 in hxa079_TimeMix, code: k = k.add_(K_bias).view(B, T, kv_per_head, N)[0m
        add__1: "[31mbf16[0m[34m[1, s18, 1024][0m[2m[34m[10240*s18, 10240, 1][0m[2m[32mcuda:0[0m" = k.add_(l_r_bias_);  [2mk = None[0m
        k_1: "[31mbf16[0m[34m[1, s18, 8, 128][0m[2m[34m[10240*s18, 10240, 128, 1][0m[2m[32mcuda:0[0m" = add__1.view([34m1[0m, s18, [34m8[0m, [34m128[0m);  [2madd__1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:564 in hxa079_TimeMix, code: v = v.add_(V_bias).view(B, T, kv_per_head, N)[0m
        add__2: "[31mbf16[0m[34m[1, s18, 1024][0m[2m[34m[10240*s18, 10240, 1][0m[2m[32mcuda:0[0m" = v.add_(l_r_bias_);  [2mv = l_r_bias_ = None[0m
        v_1: "[31mbf16[0m[34m[1, s18, 8, 128][0m[2m[34m[10240*s18, 10240, 128, 1][0m[2m[32mcuda:0[0m" = add__2.view([34m1[0m, s18, [34m8[0m, [34m128[0m);  [2madd__2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:572 in hxa079_TimeMix, code: r = T5RMSNorm(r.view(B,T,H,N), ln_r, variance_epsilon=rmsnorm_epsilon)[0m
        view_4: "[31mbf16[0m[34m[1, s18, 64, 128][0m[2m[34m[10240*s18, 10240, 128, 1][0m[2m[32mcuda:0[0m" = r_1.view([34m1[0m, s18, [34m64[0m, [34m128[0m);  [2mr_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states_2: "[31mf32[0m[34m[1, s18, 64, 128][0m[2m[34m[8192*s18, 8192, 128, 1][0m[2m[32mcuda:0[0m" = view_4.to([34mtorch.float32[0m);  [2mview_4 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_2: "[31mf32[0m[34m[1, s18, 64, 128][0m[2m[34m[8192*s18, 8192, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_2.pow([34m2[0m)
        variance_1: "[31mf32[0m[34m[1, s18, 64, 1][0m[2m[34m[64*s18, 64, 1, 1][0m[2m[32mcuda:0[0m" = pow_2.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add_1: "[31mf32[0m[34m[1, s18, 64, 1][0m[2m[34m[64*s18, 64, 1, 1][0m[2m[32mcuda:0[0m" = variance_1 + [34m1e-06[0m;  [2mvariance_1 = None[0m
        rsqrt_1: "[31mf32[0m[34m[1, s18, 64, 1][0m[2m[34m[64*s18, 64, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add_1);  [2madd_1 = None[0m
        hidden_states_3: "[31mf32[0m[34m[1, s18, 64, 128][0m[2m[34m[8192*s18, 8192, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_2 * rsqrt_1;  [2mhidden_states_2 = rsqrt_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_3: "[31mf32[0m[34m[1, s18, 64, 128][0m[2m[34m[8192*s18, 8192, 128, 1][0m[2m[32mcuda:0[0m" = l_ln_r_ * hidden_states_3;  [2ml_ln_r_ = hidden_states_3 = None[0m
        r_2: "[31mbf16[0m[34m[1, s18, 64, 128][0m[2m[34m[8192*s18, 8192, 128, 1][0m[2m[32mcuda:0[0m" = mul_3.to([34mtorch.bfloat16[0m);  [2mmul_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states_4: "[31mf32[0m[34m[1, s18, 8, 128][0m[2m[34m[1024*s18, 1024, 128, 1][0m[2m[32mcuda:0[0m" = k_1.to([34mtorch.float32[0m);  [2mk_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_3: "[31mf32[0m[34m[1, s18, 8, 128][0m[2m[34m[1024*s18, 1024, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_4.pow([34m2[0m)
        variance_2: "[31mf32[0m[34m[1, s18, 8, 1][0m[2m[34m[8*s18, 8, 1, 1][0m[2m[32mcuda:0[0m" = pow_3.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add_2: "[31mf32[0m[34m[1, s18, 8, 1][0m[2m[34m[8*s18, 8, 1, 1][0m[2m[32mcuda:0[0m" = variance_2 + [34m1e-06[0m;  [2mvariance_2 = None[0m
        rsqrt_2: "[31mf32[0m[34m[1, s18, 8, 1][0m[2m[34m[8*s18, 8, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add_2);  [2madd_2 = None[0m
        hidden_states_5: "[31mf32[0m[34m[1, s18, 8, 128][0m[2m[34m[1024*s18, 1024, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_4 * rsqrt_2;  [2mhidden_states_4 = rsqrt_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_5: "[31mf32[0m[34m[1, s18, 8, 128][0m[2m[34m[1024*s18, 1024, 128, 1][0m[2m[32mcuda:0[0m" = l_ln_k_ * hidden_states_5;  [2ml_ln_k_ = hidden_states_5 = None[0m
        k_2: "[31mbf16[0m[34m[1, s18, 8, 128][0m[2m[34m[1024*s18, 1024, 128, 1][0m[2m[32mcuda:0[0m" = mul_5.to([34mtorch.bfloat16[0m);  [2mmul_5 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:576 in hxa079_TimeMix, code: cos, sin = calc_cos.to(k.dtype), calc_sin.to(k.dtype)[0m
        cos: "[31mbf16[0m[34m[1, s18, 128][0m[2m[34m[128*s18, 128, 1][0m[2m[32mcuda:0[0m" = l_calc_cos_.to([34mtorch.bfloat16[0m);  [2ml_calc_cos_ = None[0m
        sin: "[31mbf16[0m[34m[1, s18, 128][0m[2m[34m[128*s18, 128, 1][0m[2m[32mcuda:0[0m" = l_calc_sin_.to([34mtorch.bfloat16[0m);  [2ml_calc_sin_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:493 in apply_rotary_pos_emb, code: cos = cos.unsqueeze(unsqueeze_dim)[0m
        cos_1: "[31mbf16[0m[34m[1, s18, 1, 128][0m[2m[34m[128*s18, 128, 128, 1][0m[2m[32mcuda:0[0m" = cos.unsqueeze([34m2[0m);  [2mcos = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:494 in apply_rotary_pos_emb, code: sin = sin.unsqueeze(unsqueeze_dim)[0m
        sin_1: "[31mbf16[0m[34m[1, s18, 1, 128][0m[2m[34m[128*s18, 128, 128, 1][0m[2m[32mcuda:0[0m" = sin.unsqueeze([34m2[0m);  [2msin = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb, code: q_embed = (q * cos) + (rotate_half(q) * sin)[0m
        mul_6: "[31mbf16[0m[34m[1, s18, 64, 128][0m[2m[34m[8192*s18, 8192, 128, 1][0m[2m[32mcuda:0[0m" = r_2 * cos_1
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half, code: x1 = x[..., : x.shape[-1] // 2][0m
        x1: "[31mbf16[0m[34m[1, s18, 64, 64][0m[2m[34m[8192*s18, 8192, 128, 1][0m[2m[32mcuda:0[0m" = r_2[([34mEllipsis[0m, slice([34mNone[0m, [34m64[0m, [34mNone[0m))]
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half, code: x2 = x[..., x.shape[-1] // 2 :][0m
        x2: "[31mbf16[0m[34m[1, s18, 64, 64][0m[2m[34m[8192*s18, 8192, 128, 1][0m[2m[32mcuda:0[0m" = r_2[([34mEllipsis[0m, slice([34m64[0m, [34mNone[0m, [34mNone[0m))];  [2mr_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half, code: return torch.cat((-x2, x1), dim=-1)[0m
        neg: "[31mbf16[0m[34m[1, s18, 64, 64][0m[2m[34m[4096*s18, 4096, 64, 1][0m[2m[32mcuda:0[0m" = -x2;  [2mx2 = None[0m
        cat: "[31mbf16[0m[34m[1, s18, 64, 128][0m[2m[34m[8192*s18, 8192, 128, 1][0m[2m[32mcuda:0[0m" = torch.cat((neg, x1), dim = [34m-1[0m);  [2mneg = x1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb, code: q_embed = (q * cos) + (rotate_half(q) * sin)[0m
        mul_7: "[31mbf16[0m[34m[1, s18, 64, 128][0m[2m[34m[8192*s18, 8192, 128, 1][0m[2m[32mcuda:0[0m" = cat * sin_1;  [2mcat = None[0m
        q_embed: "[31mbf16[0m[34m[1, s18, 64, 128][0m[2m[34m[8192*s18, 8192, 128, 1][0m[2m[32mcuda:0[0m" = mul_6 + mul_7;  [2mmul_6 = mul_7 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb, code: k_embed = (k * cos) + (rotate_half(k) * sin)[0m
        mul_8: "[31mbf16[0m[34m[1, s18, 8, 128][0m[2m[34m[1024*s18, 1024, 128, 1][0m[2m[32mcuda:0[0m" = k_2 * cos_1;  [2mcos_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half, code: x1 = x[..., : x.shape[-1] // 2][0m
        x1_1: "[31mbf16[0m[34m[1, s18, 8, 64][0m[2m[34m[1024*s18, 1024, 128, 1][0m[2m[32mcuda:0[0m" = k_2[([34mEllipsis[0m, slice([34mNone[0m, [34m64[0m, [34mNone[0m))]
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half, code: x2 = x[..., x.shape[-1] // 2 :][0m
        x2_1: "[31mbf16[0m[34m[1, s18, 8, 64][0m[2m[34m[1024*s18, 1024, 128, 1][0m[2m[32mcuda:0[0m" = k_2[([34mEllipsis[0m, slice([34m64[0m, [34mNone[0m, [34mNone[0m))];  [2mk_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half, code: return torch.cat((-x2, x1), dim=-1)[0m
        neg_1: "[31mbf16[0m[34m[1, s18, 8, 64][0m[2m[34m[512*s18, 512, 64, 1][0m[2m[32mcuda:0[0m" = -x2_1;  [2mx2_1 = None[0m
        cat_1: "[31mbf16[0m[34m[1, s18, 8, 128][0m[2m[34m[1024*s18, 1024, 128, 1][0m[2m[32mcuda:0[0m" = torch.cat((neg_1, x1_1), dim = [34m-1[0m);  [2mneg_1 = x1_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb, code: k_embed = (k * cos) + (rotate_half(k) * sin)[0m
        mul_9: "[31mbf16[0m[34m[1, s18, 8, 128][0m[2m[34m[1024*s18, 1024, 128, 1][0m[2m[32mcuda:0[0m" = cat_1 * sin_1;  [2mcat_1 = sin_1 = None[0m
        k_embed: "[31mbf16[0m[34m[1, s18, 8, 128][0m[2m[34m[1024*s18, 1024, 128, 1][0m[2m[32mcuda:0[0m" = mul_8 + mul_9;  [2mmul_8 = mul_9 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:584 in hxa079_TimeMix, code: v = v + (v_first - v) * torch.sigmoid(xv@v2 + v0).view(B, T, kv_per_head, N)[0m
        sub: "[31mbf16[0m[34m[1, s18, 8, 128][0m[2m[34m[1024*s18, 1024, 128, 1][0m[2m[32mcuda:0[0m" = l_v_first_ - v_1;  [2ml_v_first_ = None[0m
        matmul_1: "[31mbf16[0m[34m[1, s18, 1024][0m[2m[34m[1024*s18, 1024, 1][0m[2m[32mcuda:0[0m" = xv @ l_v2_;  [2mxv = l_v2_ = None[0m
        add_5: "[31mbf16[0m[34m[1, s18, 1024][0m[2m[34m[1024*s18, 1024, 1][0m[2m[32mcuda:0[0m" = matmul_1 + l_v0_;  [2mmatmul_1 = l_v0_ = None[0m
        sigmoid: "[31mbf16[0m[34m[1, s18, 1024][0m[2m[34m[1024*s18, 1024, 1][0m[2m[32mcuda:0[0m" = torch.sigmoid(add_5);  [2madd_5 = None[0m
        view_5: "[31mbf16[0m[34m[1, s18, 8, 128][0m[2m[34m[1024*s18, 1024, 128, 1][0m[2m[32mcuda:0[0m" = sigmoid.view([34m1[0m, s18, [34m8[0m, [34m128[0m);  [2msigmoid = None[0m
        mul_10: "[31mbf16[0m[34m[1, s18, 8, 128][0m[2m[34m[1024*s18, 1024, 128, 1][0m[2m[32mcuda:0[0m" = sub * view_5;  [2msub = view_5 = None[0m
        v_2: "[31mbf16[0m[34m[1, s18, 8, 128][0m[2m[34m[1024*s18, 1024, 128, 1][0m[2m[32mcuda:0[0m" = v_1 + mul_10;  [2mv_1 = mul_10 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:585 in hxa079_TimeMix, code: k = k + (k_first - k) * torch.sigmoid(xk@k2 + k0).view(B, T, kv_per_head, N)[0m
        sub_1: "[31mbf16[0m[34m[1, s18, 8, 128][0m[2m[34m[1024*s18, 1024, 128, 1][0m[2m[32mcuda:0[0m" = l_k_first_ - k_embed;  [2ml_k_first_ = None[0m
        matmul_2: "[31mbf16[0m[34m[1, s18, 1024][0m[2m[34m[1024*s18, 1024, 1][0m[2m[32mcuda:0[0m" = xk @ l_k2_;  [2mxk = l_k2_ = None[0m
        add_7: "[31mbf16[0m[34m[1, s18, 1024][0m[2m[34m[1024*s18, 1024, 1][0m[2m[32mcuda:0[0m" = matmul_2 + l_k0_;  [2mmatmul_2 = l_k0_ = None[0m
        sigmoid_1: "[31mbf16[0m[34m[1, s18, 1024][0m[2m[34m[1024*s18, 1024, 1][0m[2m[32mcuda:0[0m" = torch.sigmoid(add_7);  [2madd_7 = None[0m
        view_6: "[31mbf16[0m[34m[1, s18, 8, 128][0m[2m[34m[1024*s18, 1024, 128, 1][0m[2m[32mcuda:0[0m" = sigmoid_1.view([34m1[0m, s18, [34m8[0m, [34m128[0m);  [2msigmoid_1 = None[0m
        mul_11: "[31mbf16[0m[34m[1, s18, 8, 128][0m[2m[34m[1024*s18, 1024, 128, 1][0m[2m[32mcuda:0[0m" = sub_1 * view_6;  [2msub_1 = view_6 = None[0m
        k_3: "[31mbf16[0m[34m[1, s18, 8, 128][0m[2m[34m[1024*s18, 1024, 128, 1][0m[2m[32mcuda:0[0m" = k_embed + mul_11;  [2mk_embed = mul_11 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:357 in repeat_kv, code: hidden_states = hidden_states[:, :, :, None, :]  # (B, T, H_kv, 1, D)[0m
        hidden_states_6: "[31mbf16[0m[34m[1, s18, 8, 1, 128][0m[2m[34m[1024*s18, 1024, 128, 128, 1][0m[2m[32mcuda:0[0m" = k_3[(slice([34mNone[0m, [34mNone[0m, [34mNone[0m), slice([34mNone[0m, [34mNone[0m, [34mNone[0m), slice([34mNone[0m, [34mNone[0m, [34mNone[0m), [34mNone[0m, slice([34mNone[0m, [34mNone[0m, [34mNone[0m))];  [2mk_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:358 in repeat_kv, code: hidden_states = hidden_states.expand(B, T, H_kv, n_rep, D)  # (B, T, H_kv, n_rep, D)[0m
        hidden_states_7: "[31mbf16[0m[34m[1, s18, 8, 8, 128][0m[2m[34m[1024*s18, 1024, 128, 0, 1][0m[2m[32mcuda:0[0m" = hidden_states_6.expand([34m1[0m, s18, [34m8[0m, [34m8[0m, [34m128[0m);  [2mhidden_states_6 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv, code: return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()[0m
        reshape: "[31mbf16[0m[34m[1, s18, 64, 128][0m[2m[34m[8192*s18, 8192, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_7.reshape([34m1[0m, s18, [34m64[0m, [34m128[0m);  [2mhidden_states_7 = None[0m
        contiguous: "[31mbf16[0m[34m[1, s18, 64, 128][0m[2m[34m[8192*s18, 8192, 128, 1][0m[2m[32mcuda:0[0m" = reshape.contiguous();  [2mreshape = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:589 in hxa079_TimeMix, code: k = repeat_kv(k, kv_repeat).view(B, T, -1)[0m
        k_4: "[31mbf16[0m[34m[1, s18, 8192][0m[2m[34m[8192*s18, 8192, 1][0m[2m[32mcuda:0[0m" = contiguous.view([34m1[0m, s18, [34m-1[0m);  [2mcontiguous = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:357 in repeat_kv, code: hidden_states = hidden_states[:, :, :, None, :]  # (B, T, H_kv, 1, D)[0m
        hidden_states_8: "[31mbf16[0m[34m[1, s18, 8, 1, 128][0m[2m[34m[1024*s18, 1024, 128, 128, 1][0m[2m[32mcuda:0[0m" = v_2[(slice([34mNone[0m, [34mNone[0m, [34mNone[0m), slice([34mNone[0m, [34mNone[0m, [34mNone[0m), slice([34mNone[0m, [34mNone[0m, [34mNone[0m), [34mNone[0m, slice([34mNone[0m, [34mNone[0m, [34mNone[0m))];  [2mv_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:358 in repeat_kv, code: hidden_states = hidden_states.expand(B, T, H_kv, n_rep, D)  # (B, T, H_kv, n_rep, D)[0m
        hidden_states_9: "[31mbf16[0m[34m[1, s18, 8, 8, 128][0m[2m[34m[1024*s18, 1024, 128, 0, 1][0m[2m[32mcuda:0[0m" = hidden_states_8.expand([34m1[0m, s18, [34m8[0m, [34m8[0m, [34m128[0m);  [2mhidden_states_8 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv, code: return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()[0m
        reshape_1: "[31mbf16[0m[34m[1, s18, 64, 128][0m[2m[34m[8192*s18, 8192, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_9.reshape([34m1[0m, s18, [34m64[0m, [34m128[0m);  [2mhidden_states_9 = None[0m
        contiguous_1: "[31mbf16[0m[34m[1, s18, 64, 128][0m[2m[34m[8192*s18, 8192, 128, 1][0m[2m[32mcuda:0[0m" = reshape_1.contiguous();  [2mreshape_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:590 in hxa079_TimeMix, code: v = repeat_kv(v, kv_repeat).view(B, T, -1)[0m
        v_3: "[31mbf16[0m[34m[1, s18, 8192][0m[2m[34m[8192*s18, 8192, 1][0m[2m[32mcuda:0[0m" = contiguous_1.view([34m1[0m, s18, [34m-1[0m);  [2mcontiguous_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:593 in hxa079_TimeMix, code: a = torch.sigmoid(xa @ a2 + a0)[0m
        matmul_3: "[31mbf16[0m[34m[1, s18, 8192][0m[2m[34m[8192*s18, 8192, 1][0m[2m[32mcuda:0[0m" = xa @ l_a2_;  [2mxa = l_a2_ = None[0m
        add_9: "[31mbf16[0m[34m[1, s18, 8192][0m[2m[34m[8192*s18, 8192, 1][0m[2m[32mcuda:0[0m" = matmul_3 + l_a0_;  [2mmatmul_3 = l_a0_ = None[0m
        a: "[31mbf16[0m[34m[1, s18, 8192][0m[2m[34m[8192*s18, 8192, 1][0m[2m[32mcuda:0[0m" = torch.sigmoid(add_9);  [2madd_9 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:595 in hxa079_TimeMix, code: kk = F.normalize(k.view(B, T, H, N), p=2.0, dim=-1).view(B, T, H*N)[0m
        view_9: "[31mbf16[0m[34m[1, s18, 64, 128][0m[2m[34m[8192*s18, 8192, 128, 1][0m[2m[32mcuda:0[0m" = k_4.view([34m1[0m, s18, [34m64[0m, [34m128[0m)
        normalize: "[31mbf16[0m[34m[1, s18, 64, 128][0m[2m[34m[8192*s18, 8192, 128, 1][0m[2m[32mcuda:0[0m" = torch.nn.functional.normalize(view_9, p = [34m2.0[0m, dim = [34m-1[0m);  [2mview_9 = None[0m
        kk: "[31mbf16[0m[34m[1, s18, 8192][0m[2m[34m[8192*s18, 8192, 1][0m[2m[32mcuda:0[0m" = normalize.view([34m1[0m, s18, [34m8192[0m);  [2mnormalize = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:596 in hxa079_TimeMix, code: w = torch.tanh(xw) @ w2 + w0[0m
        tanh: "[31mbf16[0m[34m[1, s18, 480][0m[2m[34m[480*s18, 480, 1][0m[2m[32mcuda:0[0m" = torch.tanh(xw);  [2mxw = None[0m
        matmul_4: "[31mbf16[0m[34m[1, s18, 8192][0m[2m[34m[8192*s18, 8192, 1][0m[2m[32mcuda:0[0m" = tanh @ l_w2_;  [2mtanh = l_w2_ = None[0m
        w: "[31mbf16[0m[34m[1, s18, 8192][0m[2m[34m[8192*s18, 8192, 1][0m[2m[32mcuda:0[0m" = matmul_4 + l_w0_;  [2mmatmul_4 = l_w0_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:597 in hxa079_TimeMix, code: w = -F.softplus(-w) - 0.5[0m
        neg_2: "[31mbf16[0m[34m[1, s18, 8192][0m[2m[34m[8192*s18, 8192, 1][0m[2m[32mcuda:0[0m" = -w;  [2mw = None[0m
        softplus: "[31mbf16[0m[34m[1, s18, 8192][0m[2m[34m[8192*s18, 8192, 1][0m[2m[32mcuda:0[0m" = torch._C._nn.softplus(neg_2);  [2mneg_2 = None[0m
        neg_3: "[31mbf16[0m[34m[1, s18, 8192][0m[2m[34m[8192*s18, 8192, 1][0m[2m[32mcuda:0[0m" = -softplus;  [2msoftplus = None[0m
        w_1: "[31mbf16[0m[34m[1, s18, 8192][0m[2m[34m[8192*s18, 8192, 1][0m[2m[32mcuda:0[0m" = neg_3 - [34m0.5[0m;  [2mneg_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:598 in hxa079_TimeMix, code: k = k * (1.0 - w + a)[0m
        sub_3: "[31mbf16[0m[34m[1, s18, 8192][0m[2m[34m[8192*s18, 8192, 1][0m[2m[32mcuda:0[0m" = [34m1.0[0m - w_1
        add_11: "[31mbf16[0m[34m[1, s18, 8192][0m[2m[34m[8192*s18, 8192, 1][0m[2m[32mcuda:0[0m" = sub_3 + a;  [2msub_3 = None[0m
        k_5: "[31mbf16[0m[34m[1, s18, 8192][0m[2m[34m[8192*s18, 8192, 1][0m[2m[32mcuda:0[0m" = k_4 * add_11;  [2mk_4 = add_11 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:600 in hxa079_TimeMix, code: aa = -kk[0m
        aa: "[31mbf16[0m[34m[1, s18, 8192][0m[2m[34m[8192*s18, 8192, 1][0m[2m[32mcuda:0[0m" = -kk
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:601 in hxa079_TimeMix, code: bb = kk * a[0m
        bb: "[31mbf16[0m[34m[1, s18, 8192][0m[2m[34m[8192*s18, 8192, 1][0m[2m[32mcuda:0[0m" = kk * a;  [2mkk = a = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:603 in hxa079_TimeMix, code: w = -w.exp()#.to(dtype=torch.float32).exp()[0m
        exp: "[31mbf16[0m[34m[1, s18, 8192][0m[2m[34m[8192*s18, 8192, 1][0m[2m[32mcuda:0[0m" = w_1.exp();  [2mw_1 = None[0m
        w_2: "[31mbf16[0m[34m[1, s18, 8192][0m[2m[34m[8192*s18, 8192, 1][0m[2m[32mcuda:0[0m" = -exp;  [2mexp = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:604 in hxa079_TimeMix, code: r_,w_,k_,v_,aa_,bb_ = [i.view(B,T,H,N) for i in [r,w,k,v,aa,bb]][0m
        r_: "[31mbf16[0m[34m[1, s18, 64, 128][0m[2m[34m[8192*s18, 8192, 128, 1][0m[2m[32mcuda:0[0m" = q_embed.view([34m1[0m, s18, [34m64[0m, [34m128[0m)
        w_: "[31mbf16[0m[34m[1, s18, 64, 128][0m[2m[34m[8192*s18, 8192, 128, 1][0m[2m[32mcuda:0[0m" = w_2.view([34m1[0m, s18, [34m64[0m, [34m128[0m);  [2mw_2 = None[0m
        k_: "[31mbf16[0m[34m[1, s18, 64, 128][0m[2m[34m[8192*s18, 8192, 128, 1][0m[2m[32mcuda:0[0m" = k_5.view([34m1[0m, s18, [34m64[0m, [34m128[0m)
        v_: "[31mbf16[0m[34m[1, s18, 64, 128][0m[2m[34m[8192*s18, 8192, 128, 1][0m[2m[32mcuda:0[0m" = v_3.view([34m1[0m, s18, [34m64[0m, [34m128[0m)
        aa_: "[31mbf16[0m[34m[1, s18, 64, 128][0m[2m[34m[8192*s18, 8192, 128, 1][0m[2m[32mcuda:0[0m" = aa.view([34m1[0m, s18, [34m64[0m, [34m128[0m);  [2maa = None[0m
        bb_: "[31mbf16[0m[34m[1, s18, 64, 128][0m[2m[34m[8192*s18, 8192, 128, 1][0m[2m[32mcuda:0[0m" = bb.view([34m1[0m, s18, [34m64[0m, [34m128[0m);  [2mbb = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:19 in <genexpr>, code: *(i if not isinstance(i, torch.Tensor) else i.contiguous() for i in args),[0m
        contiguous_2: "[31mbf16[0m[34m[1, s18, 64, 128][0m[2m[34m[8192*s18, 8192, 128, 1][0m[2m[32mcuda:0[0m" = r_.contiguous();  [2mr_ = None[0m
        contiguous_3: "[31mbf16[0m[34m[1, s18, 64, 128][0m[2m[34m[8192*s18, 8192, 128, 1][0m[2m[32mcuda:0[0m" = k_.contiguous();  [2mk_ = None[0m
        contiguous_4: "[31mbf16[0m[34m[1, s18, 64, 128][0m[2m[34m[8192*s18, 8192, 128, 1][0m[2m[32mcuda:0[0m" = v_.contiguous();  [2mv_ = None[0m
        contiguous_5: "[31mbf16[0m[34m[1, s18, 64, 128][0m[2m[34m[8192*s18, 8192, 128, 1][0m[2m[32mcuda:0[0m" = aa_.contiguous();  [2maa_ = None[0m
        contiguous_6: "[31mbf16[0m[34m[1, s18, 64, 128][0m[2m[34m[8192*s18, 8192, 128, 1][0m[2m[32mcuda:0[0m" = bb_.contiguous();  [2mbb_ = None[0m
        contiguous_7: "[31mbf16[0m[34m[1, s18, 64, 128][0m[2m[34m[8192*s18, 8192, 128, 1][0m[2m[32mcuda:0[0m" = w_.contiguous();  [2mw_ = None[0m
        contiguous_8: "[31mbf16[0m[34m[1, 64, 128, 128][0m[2m[34m[1048576, 16384, 128, 1][0m[2m[32mcuda:0[0m" = l_state_.contiguous();  [2ml_state_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:148 in forward, code: final_state = q.new_empty(B, H, K, V, dtype=torch.float32)[0m
        final_state: "[31mf32[0m[34m[1, 64, 128, 128][0m[2m[34m[1048576, 16384, 128, 1][0m[2m[32mcuda:0[0m" = contiguous_2.new_empty([34m1[0m, [34m64[0m, [34m128[0m, [34m128[0m, dtype = [34mtorch.float32[0m)
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:152 in forward, code: ha = torch.empty_like(v, dtype=torch.float32)[0m
        ha: "[31mf32[0m[34m[1, s18, 64, 128][0m[2m[34m[8192*s18, 8192, 128, 1][0m[2m[32mcuda:0[0m" = torch.empty_like(contiguous_4, dtype = [34mtorch.float32[0m)
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:155 in forward, code: o = torch.empty_like(v)[0m
        o: "[31mbf16[0m[34m[1, s18, 64, 128][0m[2m[34m[8192*s18, 8192, 128, 1][0m[2m[32mcuda:0[0m" = torch.empty_like(contiguous_4)
        
         [2m# File: /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:452 in run, code: return self.fn.run(*args, **kwargs)[0m
        triton_kernel_wrapper_mutation = torch.ops.higher_order.triton_kernel_wrapper_mutation(kernel_idx = [34m0[0m, constant_args_idx = [34m5[0m, grid = [([34m4[0m, [34m64[0m, [34m1[0m), ([34m4[0m, [34m64[0m, [34m1[0m), ([34m4[0m, [34m64[0m, [34m1[0m)], tma_descriptor_metadata = [34m{}[0m, kwargs = [34m{'q': contiguous_2, 'k': contiguous_3, 'v': contiguous_4, 'a': contiguous_5, 'b': contiguous_6, 'gk': contiguous_7, 'o': o, 'ha': ha, 'h0': contiguous_8, 'ht': final_state, 'T': s18}[0m);  [2mcontiguous_2 = contiguous_3 = contiguous_4 = contiguous_5 = contiguous_6 = contiguous_7 = ha = contiguous_8 = triton_kernel_wrapper_mutation = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:612 in hxa079_TimeMix, code: xx = xx.view(B,T,-1) * (float(N) ** -0.5)[0m
        view_17: "[31mbf16[0m[34m[1, s18, 8192][0m[2m[34m[8192*s18, 8192, 1][0m[2m[32mcuda:0[0m" = o.view([34m1[0m, s18, [34m-1[0m);  [2mo = None[0m
        xx: "[31mbf16[0m[34m[1, s18, 8192][0m[2m[34m[8192*s18, 8192, 1][0m[2m[32mcuda:0[0m" = view_17 * [34m0.08838834764831845[0m;  [2mview_17 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix, code: xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)[0m
        to_10: "[31mbf16[0m[34m[1, s18, 8192][0m[2m[34m[8192*s18, 8192, 1][0m[2m[32mcuda:0[0m" = xx.to(dtype = [34mtorch.bfloat16[0m);  [2mxx = None[0m
        view_18: "[31mbf16[0m[34m[1, s18, 64, 128][0m[2m[34m[8192*s18, 8192, 128, 1][0m[2m[32mcuda:0[0m" = q_embed.view([34m1[0m, s18, [34m64[0m, [34m128[0m);  [2mq_embed = None[0m
        view_19: "[31mbf16[0m[34m[1, s18, 64, 128][0m[2m[34m[8192*s18, 8192, 128, 1][0m[2m[32mcuda:0[0m" = k_5.view([34m1[0m, s18, [34m64[0m, [34m128[0m);  [2mk_5 = None[0m
        mul_15: "[31mbf16[0m[34m[1, s18, 64, 128][0m[2m[34m[8192*s18, 8192, 128, 1][0m[2m[32mcuda:0[0m" = view_18 * view_19;  [2mview_18 = view_19 = None[0m
        view_20: "[31mbf16[0m[34m[64, 128][0m[2m[34m[128, 1][0m[2m[32mcuda:0[0m" = l_r_k_.view([34m64[0m, [34m128[0m);  [2ml_r_k_ = None[0m
        mul_16: "[31mbf16[0m[34m[1, s18, 64, 128][0m[2m[34m[8192*s18, 8192, 128, 1][0m[2m[32mcuda:0[0m" = mul_15 * view_20;  [2mmul_15 = view_20 = None[0m
        sum_1: "[31mbf16[0m[34m[1, s18, 64, 1][0m[2m[34m[64*s18, 64, 1, 1][0m[2m[32mcuda:0[0m" = mul_16.sum(dim = [34m-1[0m, keepdim = [34mTrue[0m);  [2mmul_16 = None[0m
        view_21: "[31mbf16[0m[34m[1, s18, 64, 128][0m[2m[34m[8192*s18, 8192, 128, 1][0m[2m[32mcuda:0[0m" = v_3.view([34m1[0m, s18, [34m64[0m, [34m128[0m);  [2mv_3 = None[0m
        mul_17: "[31mbf16[0m[34m[1, s18, 64, 128][0m[2m[34m[8192*s18, 8192, 128, 1][0m[2m[32mcuda:0[0m" = sum_1 * view_21;  [2msum_1 = view_21 = None[0m
        view_22: "[31mbf16[0m[34m[1, s18, 8192][0m[2m[34m[8192*s18, 8192, 1][0m[2m[32mcuda:0[0m" = mul_17.view([34m1[0m, s18, [34m8192[0m);  [2mmul_17 = None[0m
        xx_1: "[31mbf16[0m[34m[1, s18, 8192][0m[2m[34m[8192*s18, 8192, 1][0m[2m[32mcuda:0[0m" = to_10 + view_22;  [2mto_10 = view_22 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:616 in hxa079_TimeMix, code: output = fpx_matmul((xx * (torch.sigmoid(xg) @ g2)), O_, O_state,ebits,mbits)[0m
        sigmoid_3: "[31mbf16[0m[34m[1, s18, 480][0m[2m[34m[480*s18, 480, 1][0m[2m[32mcuda:0[0m" = torch.sigmoid(xg);  [2mxg = None[0m
        matmul_5: "[31mbf16[0m[34m[1, s18, 8192][0m[2m[34m[8192*s18, 8192, 1][0m[2m[32mcuda:0[0m" = sigmoid_3 @ l_g2_;  [2msigmoid_3 = l_g2_ = None[0m
        mul_18: "[31mbf16[0m[34m[1, s18, 8192][0m[2m[34m[8192*s18, 8192, 1][0m[2m[32mcuda:0[0m" = xx_1 * matmul_5;  [2mxx_1 = matmul_5 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul, code: x = x.to(dtype=torch.float16).view(-1,x.shape[2])[0m
        to_11: "[31mf16[0m[34m[1, s18, 8192][0m[2m[34m[8192*s18, 8192, 1][0m[2m[32mcuda:0[0m" = mul_18.to(dtype = [34mtorch.float16[0m);  [2mmul_18 = None[0m
        x_2: "[31mf16[0m[34m[s18, 8192][0m[2m[34m[8192, 1][0m[2m[32mcuda:0[0m" = to_11.view([34m-1[0m, [34m8192[0m);  [2mto_11 = None[0m
        
         [2m# File: /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__, code: return self._opoverload(*args, **kwargs)[0m
        forward_functional_default_1: "[31mf16[0m[34m[s18, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m" = torch.ops.gemlite.forward_functional.default(x_2, [34mNone[0m, [l_o_w_q, l_o_parameters_scales_, l_o_parameters_zeros_], [[34m0[0m, [34m4[0m, [34m64[0m, [34m15[0m, [34m8[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m0[0m, [34m4[0m, [34m1[0m], [34m4[0m);  [2mx_2 = l_o_w_q = l_o_parameters_scales_ = l_o_parameters_zeros_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul, code: out = weight.forward_manual(x).to(dtype=dtype)[0m
        out_1: "[31mbf16[0m[34m[s18, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m" = forward_functional_default_1.to(dtype = [34mtorch.bfloat16[0m);  [2mforward_functional_default_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul, code: return out.view(S0,S1,-1)[0m
        output: "[31mbf16[0m[34m[1, s18, 5120][0m[2m[34m[5120*s18, 5120, 1][0m[2m[32mcuda:0[0m" = out_1.view([34m1[0m, s18, [34m-1[0m);  [2mout_1 = s18 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:618 in hxa079_TimeMix, code: x_in = x_in + output[0m
        x_in: "[31mbf16[0m[34m[1, s18, 5120][0m[2m[34m[5120*s18, 5120, 1][0m[2m[32mcuda:0[0m" = l_x_in_ + output;  [2ml_x_in_ = output = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states_10: "[31mf32[0m[34m[1, s18, 5120][0m[2m[34m[5120*s18, 5120, 1][0m[2m[32mcuda:0[0m" = x_in.to([34mtorch.float32[0m)
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_4: "[31mf32[0m[34m[1, s18, 5120][0m[2m[34m[5120*s18, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states_10.pow([34m2[0m)
        variance_3: "[31mf32[0m[34m[1, s18, 1][0m[2m[34m[s18, 1, 1][0m[2m[32mcuda:0[0m" = pow_4.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_4 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add_14: "[31mf32[0m[34m[1, s18, 1][0m[2m[34m[s18, 1, 1][0m[2m[32mcuda:0[0m" = variance_3 + [34m1e-06[0m;  [2mvariance_3 = None[0m
        rsqrt_3: "[31mf32[0m[34m[1, s18, 1][0m[2m[34m[s18, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add_14);  [2madd_14 = None[0m
        hidden_states_11: "[31mf32[0m[34m[1, s18, 5120][0m[2m[34m[5120*s18, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states_10 * rsqrt_3;  [2mhidden_states_10 = rsqrt_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_20: "[31mf32[0m[34m[1, s18, 5120][0m[2m[34m[5120*s18, 5120, 1][0m[2m[32mcuda:0[0m" = l_ln2_ * hidden_states_11;  [2ml_ln2_ = hidden_states_11 = None[0m
        output_1: "[31mbf16[0m[34m[1, s18, 5120][0m[2m[34m[5120*s18, 5120, 1][0m[2m[32mcuda:0[0m" = mul_20.to([34mtorch.bfloat16[0m);  [2mmul_20 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:621 in hxa079_TimeMix, code: return  output, x[:,-1], state, v_first, k_first, x_in[0m
        getitem_74: "[31mbf16[0m[34m[1, 5120][0m[2m[34m[5120*s18, 1][0m[2m[32mcuda:0[0m" = x[(slice([34mNone[0m, [34mNone[0m, [34mNone[0m), [34m-1[0m)];  [2mx = None[0m
        return (output_1, getitem_74, final_state, x_in)
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing GQA_Attention_Flash_ /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:875
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:875 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7)
        @torch.compile(mode="max-autotune-no-cudagraphs")
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:904 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            B, T, C = x_in.shape
TRACE LOAD_FAST x_in []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
automatic dynamic size L['x_in'] size(1) 128 != 512
wrap_to_fake L['x_in'] (1, 128, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='x_in', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_x_in_ L['x_in'] FakeTensor(..., device='cuda:0', size=(1, s52, 5120), dtype=torch.bfloat16) at debug_level 0 before=False
create_graph_input s52 L['x_in'].size()[1] s52 at debug_level 0 before=True
_lift_symbols_in_symint s52 from L['x_in'].size()[1] at debug_level 0
TRACE FX call size from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:904 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        B, T, C = x_in.shape
                  ^^^^^^^^^^
TRACE UNPACK_SEQUENCE 3 [SizeVariable(length=3)]
TRACE STORE_FAST B [ConstantVariable(int: 5120), SymNodeVariable(), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 5120), SymNodeVariable()]
TRACE STORE_FAST C [ConstantVariable(int: 5120)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:905 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            device = x_in.device
TRACE LOAD_FAST x_in []
TRACE LOAD_ATTR device [TensorVariable()]
TRACE STORE_FAST device [ConstantVariable(device: device(type='cuda', index=0))]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:906 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            Lmax = past_key_value.shape[3]
TRACE LOAD_FAST past_key_value []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
wrap_to_fake L['past_key_value'] (8, 1, 2, 8192, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='past_key_value', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}), tensor_source=LocalSource(local_name='past_key_value', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_past_key_value_ L['past_key_value'] FakeTensor(..., device='cuda:0', size=(8, 1, 2, 8192, 1024),
           dtype=torch.bfloat16) at debug_level 0 before=False
wrap_to_fake L['past_key_value']._base (8, 1, 2, 8192, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='past_key_value', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
TRACE LOAD_CONST 3 [SizeVariable(length=5)]
TRACE BINARY_SUBSCR None [SizeVariable(length=5), ConstantVariable(int: 3)]
TRACE STORE_FAST Lmax [ConstantVariable(int: 8192)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            starts = cache_position[:, 0].clone()
TRACE LOAD_FAST cache_position []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE LOAD_CONST None [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [LazyVariableTracker(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST 0 [LazyVariableTracker(), SliceVariable()]
TRACE BUILD_TUPLE 2 [LazyVariableTracker(), SliceVariable(), ConstantVariable(int: 0)]
TRACE BINARY_SUBSCR None [LazyVariableTracker(), TupleVariable(length=2)]
wrap_to_fake L['cache_position'] (1, 1) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='cache_position', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_cache_position_ L['cache_position'] FakeTensor(..., device='cuda:0', size=(1, 1), dtype=torch.int64) at debug_level 0 before=False
TRACE FX call getitem_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        starts = cache_position[:, 0].clone()
                 ~~~~~~~~~~~~~~^^^^^^
TRACE LOAD_ATTR clone [TensorVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), clone)]
TRACE FX call clone from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        starts = cache_position[:, 0].clone()
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST starts [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:910 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            starts.clamp_(min=0, max=Lmax)
TRACE LOAD_FAST starts []
TRACE LOAD_ATTR clamp_ [TensorVariable()]
TRACE LOAD_CONST 0 [NullVariable, GetAttrVariable(TensorVariable(), clamp_)]
TRACE LOAD_FAST Lmax [NullVariable, GetAttrVariable(TensorVariable(), clamp_), ConstantVariable(int: 0)]
TRACE KW_NAMES ('min', 'max') [NullVariable, GetAttrVariable(TensorVariable(), clamp_), ConstantVariable(int: 0), ConstantVariable(int: 8192)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), clamp_), ConstantVariable(int: 0), ConstantVariable(int: 8192)]
TRACE FX call clamp_ from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:910 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        starts.clamp_(min=0, max=Lmax)
        ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:913 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            x = T5RMSNorm(x_in, ln1, rmsnorm_epsilon)  # 実装は外部
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST x_in [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:913 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        x = T5RMSNorm(x_in, ln1, rmsnorm_epsilon)  # 実装は外部
            ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE FX call add from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln1'] (5120,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln1', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln1_ L['ln1'] FakeTensor(..., device='cuda:0', size=(5120,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:915 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            HN = H * N
TRACE LOAD_FAST H []
TRACE LOAD_FAST N [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), LazyVariableTracker()]
TRACE STORE_FAST HN [ConstantVariable(int: 8192)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:918 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            qkv = fpx_matmul(x, QKV_, QKV_state, ebits, mbits)  # [B,T, QHN + KVd + KVd]
TRACE LOAD_GLOBAL fpx_matmul []
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST QKV_ [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST QKV_state [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_FAST ebits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST mbits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call fpx_matmul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:918 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        qkv = fpx_matmul(x, QKV_, QKV_state, ebits, mbits)  # [B,T, QHN + KVd + KVd]
              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object fpx_matmul at 0x3063a810, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:420 in fpx_matmul (fpx_matmul) (inline depth: 1)
    def fpx_matmul(x,weight,weight_state,ebits:int=3,mbits:int=2):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:421 in fpx_matmul (fpx_matmul) (inline depth: 1)
        if ebits == -44: #hqq
TRACE LOAD_FAST ebits []
TRACE LOAD_CONST -44 [LazyVariableTracker()]
TRACE COMPARE_OP == [LazyVariableTracker(), ConstantVariable(int: -44)]
TRACE POP_JUMP_IF_FALSE 322 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S0=x.shape[0]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE FX call size_1 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul) (inline depth: 1)
        S0=x.shape[0]
           ^^^^^^^
TRACE LOAD_CONST 0 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 0)]
TRACE STORE_FAST S0 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S1=x.shape[1]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE FX call size_2 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul) (inline depth: 1)
        S1=x.shape[1]
           ^^^^^^^
TRACE LOAD_CONST 1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 1)]
TRACE STORE_FAST S1 [SymNodeVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:424 in fpx_matmul (fpx_matmul) (inline depth: 1)
            dtype = x.dtype
TRACE LOAD_FAST x []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
            x = x.to(dtype=torch.float16).view(-1,x.shape[2])
TRACE LOAD_FAST x []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float16 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_2 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST x [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1)]
TRACE LOAD_ATTR shape [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), TensorVariable()]
TRACE FX call size_3 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
                                              ^^^^^^^
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3), ConstantVariable(int: 2)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), ConstantVariable(int: 5120)]
TRACE FX call view from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
            out = weight.forward_manual(x).to(dtype=dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_ATTR forward_manual [LazyVariableTracker()]
TRACE LOAD_FAST x [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE CALL 1 [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton)), TensorVariable()]
TRACE inlined call forward_manual from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:543 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        def forward_manual(self, x: Tensor, matmul_type: str="GEMM") -> Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE LOAD_GLOBAL forward_functional []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:545 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                x,
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:546 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.bias,
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR bias [NullVariable, LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_tensor_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_ATTR get_tensor_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_tensor_args at 0x70c98a9e9080>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_tensor_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_tensor_args(),
            ~~~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:524 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
        def get_tensor_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:525 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
            return [self.W_q, self.scales, self.zeros]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR W_q [UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_FAST self [LazyVariableTracker()]
TRACE LOAD_ATTR scales [LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['QKV_']._parameters['scales'] (80, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='QKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='scales'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_QKV_parameters_scales_ L['QKV_']._parameters['scales'] Parameter(FakeTensor(..., device='cuda:0', size=(80, 10240), dtype=torch.float16)) at debug_level 0 before=False
TRACE LOAD_FAST self [LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR zeros [LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['QKV_']._parameters['zeros'] (80, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='QKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='zeros'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_QKV_parameters_zeros_ L['QKV_']._parameters['zeros'] Parameter(FakeTensor(..., device='cuda:0', size=(80, 10240), dtype=torch.float16)) at debug_level 0 before=False
TRACE BUILD_LIST 3 [LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [ListVariable(length=3)]
DONE INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_meta_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3)]
TRACE LOAD_ATTR get_meta_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_meta_args at 0x70c98a9e9120>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_meta_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_meta_args(),
            ~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:527 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
        def get_meta_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE LOAD_GLOBAL int []
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR scaled_activations [NullVariable, LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:529 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_nbits,
TRACE LOAD_FAST self [ConstantVariable(int: 0)]
TRACE LOAD_ATTR W_nbits [ConstantVariable(int: 0), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:530 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.group_size,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker()]
TRACE LOAD_ATTR group_size [ConstantVariable(int: 0), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:531 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.unpack_mask,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR unpack_mask [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:532 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.elements_per_sample,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR elements_per_sample [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:533 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.input_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR input_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:534 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.output_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR output_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:535 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.acc_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR acc_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:536 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.meta_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR meta_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:537 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.channel_scale_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR channel_scale_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:538 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_group_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR W_group_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:539 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    int(self.data_contiguous),
TRACE LOAD_GLOBAL int [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int)]
TRACE LOAD_ATTR data_contiguous [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE BUILD_LIST 12 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [ListVariable(length=12)]
DONE INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:549 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
TRACE LOAD_GLOBAL GEMLITE_MATMUL_TYPES_MAPPING [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12)]
TRACE LOAD_FAST matmul_type [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker(), ConstantVariable(str: 'GEMM')]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        return forward_functional(
               ~~~~~~~~~~~~~~~~~~^
            x,
            ^^
            self.bias,
            ^^^^^^^^^^
            self.get_tensor_args(),
            ^^^^^^^^^^^^^^^^^^^^^^^
            self.get_meta_args(),
            ^^^^^^^^^^^^^^^^^^^^^
            GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:675 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        def __call__(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
            return self._opoverload(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR _opoverload [NullVariable, UserDefinedObjectVariable(CustomOpDef)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=5)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
wrap_to_fake L['QKV_'].W_q (640, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=AttrSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='QKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='W_q'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_QKV_W_q L['QKV_'].W_q FakeTensor(..., device='cuda:0', size=(640, 10240), dtype=torch.int32) at debug_level 0 before=False
TRACE FX call forward_functional_default from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        return self._opoverload(*args, **kwargs)
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_3 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE STORE_FAST out [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
            return out.view(S0,S1,-1)
TRACE LOAD_FAST out []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST S0 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST S1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: -1)]
TRACE FX call view_1 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
        return out.view(S0,S1,-1)
               ~~~~~~~~^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object fpx_matmul at 0x3063a810, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>
TRACE STORE_FAST qkv [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:919 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q, k, v = qkv.split(qkv_split_list, dim=-1)
TRACE LOAD_FAST qkv []
TRACE LOAD_ATTR split [TensorVariable()]
TRACE LOAD_FAST qkv_split_list [NullVariable, GetAttrVariable(TensorVariable(), split)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker()]
TRACE KW_NAMES ('dim',) [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE FX call split from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:919 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        q, k, v = qkv.split(qkv_split_list, dim=-1)
                  ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
TRACE UNPACK_SEQUENCE 3 [TupleVariable(length=3)]
TRACE STORE_FAST q [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST k [TensorVariable(), TensorVariable()]
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:922 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q.add_(Q_bias)
TRACE LOAD_FAST q []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST Q_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
wrap_to_fake L['Q_bias'] () StatefulSymbolicContext(dynamic_sizes=[], dynamic_strides=[], constraint_sizes=[], constraint_strides=[], specialize_on=[], view_base_context=None, tensor_source=LocalSource(local_name='Q_bias', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_Q_bias_ L['Q_bias'] FakeTensor(..., device='cuda:0', size=(), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call add_ from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:922 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        q.add_(Q_bias)
        ~~~~~~^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:923 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k.add_(K_bias)
TRACE LOAD_FAST k []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST K_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
TRACE FX call add__1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:923 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        k.add_(K_bias)
        ~~~~~~^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:924 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            v.add_(V_bias)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST V_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
TRACE FX call add__2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:924 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        v.add_(V_bias)
        ~~~~~~^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:927 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q = q.view(B, T, H, N)  # [B,T,H,N]
TRACE LOAD_FAST q []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:927 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        q = q.view(B, T, H, N)  # [B,T,H,N]
            ~~~~~~^^^^^^^^^^^^
TRACE STORE_FAST q [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:928 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            kv_dim_flat = k.shape[-1]     # kv_heads * N
TRACE LOAD_FAST k []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE FX call size_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:928 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        kv_dim_flat = k.shape[-1]     # kv_heads * N
                      ^^^^^^^
TRACE LOAD_CONST -1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: -1)]
TRACE STORE_FAST kv_dim_flat [ConstantVariable(int: 1024)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:929 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            kv_heads = kv_dim_flat // N
TRACE LOAD_FAST kv_dim_flat []
TRACE LOAD_FAST N [ConstantVariable(int: 1024)]
TRACE BINARY_OP 2 [ConstantVariable(int: 1024), ConstantVariable(int: 128)]
TRACE STORE_FAST kv_heads [ConstantVariable(int: 8)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:930 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k = k.view(B, T, kv_heads, N) # [B,T,kv_h,N]
TRACE LOAD_FAST k []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_heads [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:930 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        k = k.view(B, T, kv_heads, N) # [B,T,kv_h,N]
            ~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:931 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            v = v.view(B, T, kv_heads, N)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_heads [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:931 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        v = v.view(B, T, kv_heads, N)
            ~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:934 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            if ln_r is not None:
TRACE LOAD_FAST ln_r []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 0 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
wrap_to_fake L['ln_r'] (128,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln_r', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln_r_ L['ln_r'] FakeTensor(..., device='cuda:0', size=(128,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE POP_JUMP_IF_TRUE 606 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:935 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
                q = T5RMSNorm(q, ln_r, rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln_r [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:935 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q = T5RMSNorm(q, ln_r, rmsnorm_epsilon)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST q [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:936 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
                k = T5RMSNorm(k, ln_k, rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln_k [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:936 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k = T5RMSNorm(k, ln_k, rmsnorm_epsilon)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln_k'] (128,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln_k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln_k_ L['ln_k'] FakeTensor(..., device='cuda:0', size=(128,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:940 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k_write = k.view(B, T, -1)
TRACE LOAD_FAST k []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: -1)]
TRACE FX call view_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:940 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        k_write = k.view(B, T, -1)
                  ~~~~~~^^^^^^^^^^
TRACE STORE_FAST k_write [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:941 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            v_write = v.view(B, T, -1)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: -1)]
TRACE FX call view_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:941 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        v_write = v.view(B, T, -1)
                  ~~~~~~^^^^^^^^^^
TRACE STORE_FAST v_write [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:944 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            new_lengths = starts + T
TRACE LOAD_FAST starts []
TRACE LOAD_FAST T [TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), SymNodeVariable()]
TRACE FX call add_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:944 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        new_lengths = starts + T
                      ~~~~~~~^~~
TRACE STORE_FAST new_lengths [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            excess_tokens = torch.clamp(new_lengths - Lmax, min=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR clamp [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST new_lengths [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST Lmax [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 10 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 8192)]
TRACE FX call sub from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        excess_tokens = torch.clamp(new_lengths - Lmax, min=0)
                                    ~~~~~~~~~~~~^~~~~~
TRACE LOAD_CONST 0 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE KW_NAMES ('min',) [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 0)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 0)]
TRACE FX call clamp from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        excess_tokens = torch.clamp(new_lengths - Lmax, min=0)
                        ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST excess_tokens [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:946 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            batches_to_evict = excess_tokens > 0
TRACE LOAD_FAST excess_tokens []
TRACE LOAD_CONST 0 [TensorVariable()]
TRACE COMPARE_OP > [TensorVariable(), ConstantVariable(int: 0)]
TRACE FX call gt from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:946 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        batches_to_evict = excess_tokens > 0
                           ^^^^^^^^^^^^^^^^^
TRACE STORE_FAST batches_to_evict [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            if bool(batches_to_evict.any()):
TRACE LOAD_GLOBAL bool []
TRACE LOAD_FAST batches_to_evict [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR any [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), any)]
TRACE FX call any_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        if bool(batches_to_evict.any()):
                ~~~~~~~~~~~~~~~~~~~~^^
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
Graph break (user stack suppressed due to duplicate graph break) in user code at /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949
Graph Break Reason: Failed to trace builtin operator
  Explanation: Dynamo does not know how to trace builtin operator `bool` with argument types ['Tensor'] (has_kwargs False)
  Hint: Avoid calling builtin `bool` with argument types ['Tensor']. Consider using an equivalent alternative function/method to `bool`.
  Hint: If you are attempting to call a logging function (e.g. `print`), you can try adding it to `torch._dynamo.config.reorderable_logging_functions`.
  Hint: Please report an issue to PyTorch.

  Developer debug context: builtin bool [<class 'torch._dynamo.variables.tensor.TensorVariable'>] False

 For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0059.html
Step 1: torchdynamo start tracing GQA_Attention_Flash_ /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:875
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:875 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7)
        @torch.compile(mode="max-autotune-no-cudagraphs")
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:904 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            B, T, C = x_in.shape
TRACE LOAD_FAST x_in []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
wrap_to_fake L['x_in'] (1, 128, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='x_in', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_x_in_ L['x_in'] FakeTensor(..., device='cuda:0', size=(1, s52, 5120), dtype=torch.bfloat16) at debug_level 0 before=False
create_graph_input s52 L['x_in'].size()[1] s52 at debug_level 0 before=True
_lift_symbols_in_symint s52 from L['x_in'].size()[1] at debug_level 0
TRACE FX call size from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:904 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        B, T, C = x_in.shape
                  ^^^^^^^^^^
TRACE UNPACK_SEQUENCE 3 [SizeVariable(length=3)]
TRACE STORE_FAST B [ConstantVariable(int: 5120), SymNodeVariable(), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 5120), SymNodeVariable()]
TRACE STORE_FAST C [ConstantVariable(int: 5120)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:905 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            device = x_in.device
TRACE LOAD_FAST x_in []
TRACE LOAD_ATTR device [TensorVariable()]
TRACE STORE_FAST device [ConstantVariable(device: device(type='cuda', index=0))]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:906 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            Lmax = past_key_value.shape[3]
TRACE LOAD_FAST past_key_value []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
wrap_to_fake L['past_key_value'] (8, 1, 2, 8192, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='past_key_value', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}), tensor_source=LocalSource(local_name='past_key_value', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_past_key_value_ L['past_key_value'] FakeTensor(..., device='cuda:0', size=(8, 1, 2, 8192, 1024),
           dtype=torch.bfloat16) at debug_level 0 before=False
wrap_to_fake L['past_key_value']._base (8, 1, 2, 8192, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='past_key_value', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
TRACE LOAD_CONST 3 [SizeVariable(length=5)]
TRACE BINARY_SUBSCR None [SizeVariable(length=5), ConstantVariable(int: 3)]
TRACE STORE_FAST Lmax [ConstantVariable(int: 8192)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            starts = cache_position[:, 0].clone()
TRACE LOAD_FAST cache_position []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE LOAD_CONST None [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [LazyVariableTracker(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST 0 [LazyVariableTracker(), SliceVariable()]
TRACE BUILD_TUPLE 2 [LazyVariableTracker(), SliceVariable(), ConstantVariable(int: 0)]
TRACE BINARY_SUBSCR None [LazyVariableTracker(), TupleVariable(length=2)]
wrap_to_fake L['cache_position'] (1, 1) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='cache_position', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_cache_position_ L['cache_position'] FakeTensor(..., device='cuda:0', size=(1, 1), dtype=torch.int64) at debug_level 0 before=False
TRACE FX call getitem_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        starts = cache_position[:, 0].clone()
                 ~~~~~~~~~~~~~~^^^^^^
TRACE LOAD_ATTR clone [TensorVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), clone)]
TRACE FX call clone from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        starts = cache_position[:, 0].clone()
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST starts [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:910 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            starts.clamp_(min=0, max=Lmax)
TRACE LOAD_FAST starts []
TRACE LOAD_ATTR clamp_ [TensorVariable()]
TRACE LOAD_CONST 0 [NullVariable, GetAttrVariable(TensorVariable(), clamp_)]
TRACE LOAD_FAST Lmax [NullVariable, GetAttrVariable(TensorVariable(), clamp_), ConstantVariable(int: 0)]
TRACE KW_NAMES ('min', 'max') [NullVariable, GetAttrVariable(TensorVariable(), clamp_), ConstantVariable(int: 0), ConstantVariable(int: 8192)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), clamp_), ConstantVariable(int: 0), ConstantVariable(int: 8192)]
TRACE FX call clamp_ from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:910 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        starts.clamp_(min=0, max=Lmax)
        ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:913 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            x = T5RMSNorm(x_in, ln1, rmsnorm_epsilon)  # 実装は外部
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST x_in [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:913 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        x = T5RMSNorm(x_in, ln1, rmsnorm_epsilon)  # 実装は外部
            ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE FX call add from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln1'] (5120,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln1', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln1_ L['ln1'] FakeTensor(..., device='cuda:0', size=(5120,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:915 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            HN = H * N
TRACE LOAD_FAST H []
TRACE LOAD_FAST N [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), LazyVariableTracker()]
TRACE STORE_FAST HN [ConstantVariable(int: 8192)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:918 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            qkv = fpx_matmul(x, QKV_, QKV_state, ebits, mbits)  # [B,T, QHN + KVd + KVd]
TRACE LOAD_GLOBAL fpx_matmul []
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST QKV_ [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST QKV_state [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_FAST ebits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST mbits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call fpx_matmul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:918 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        qkv = fpx_matmul(x, QKV_, QKV_state, ebits, mbits)  # [B,T, QHN + KVd + KVd]
              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object fpx_matmul at 0x3063a810, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:420 in fpx_matmul (fpx_matmul) (inline depth: 1)
    def fpx_matmul(x,weight,weight_state,ebits:int=3,mbits:int=2):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:421 in fpx_matmul (fpx_matmul) (inline depth: 1)
        if ebits == -44: #hqq
TRACE LOAD_FAST ebits []
TRACE LOAD_CONST -44 [LazyVariableTracker()]
TRACE COMPARE_OP == [LazyVariableTracker(), ConstantVariable(int: -44)]
TRACE POP_JUMP_IF_FALSE 322 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S0=x.shape[0]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE FX call size_1 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul) (inline depth: 1)
        S0=x.shape[0]
           ^^^^^^^
TRACE LOAD_CONST 0 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 0)]
TRACE STORE_FAST S0 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S1=x.shape[1]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE FX call size_2 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul) (inline depth: 1)
        S1=x.shape[1]
           ^^^^^^^
TRACE LOAD_CONST 1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 1)]
TRACE STORE_FAST S1 [SymNodeVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:424 in fpx_matmul (fpx_matmul) (inline depth: 1)
            dtype = x.dtype
TRACE LOAD_FAST x []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
            x = x.to(dtype=torch.float16).view(-1,x.shape[2])
TRACE LOAD_FAST x []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float16 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_2 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST x [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1)]
TRACE LOAD_ATTR shape [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), TensorVariable()]
TRACE FX call size_3 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
                                              ^^^^^^^
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3), ConstantVariable(int: 2)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), ConstantVariable(int: 5120)]
TRACE FX call view from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
            out = weight.forward_manual(x).to(dtype=dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_ATTR forward_manual [LazyVariableTracker()]
TRACE LOAD_FAST x [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE CALL 1 [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton)), TensorVariable()]
TRACE inlined call forward_manual from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:543 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        def forward_manual(self, x: Tensor, matmul_type: str="GEMM") -> Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE LOAD_GLOBAL forward_functional []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:545 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                x,
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:546 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.bias,
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR bias [NullVariable, LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_tensor_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_ATTR get_tensor_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_tensor_args at 0x70c98a9e9080>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_tensor_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_tensor_args(),
            ~~~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:524 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
        def get_tensor_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:525 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
            return [self.W_q, self.scales, self.zeros]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR W_q [UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_FAST self [LazyVariableTracker()]
TRACE LOAD_ATTR scales [LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['QKV_']._parameters['scales'] (80, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='QKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='scales'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_QKV_parameters_scales_ L['QKV_']._parameters['scales'] Parameter(FakeTensor(..., device='cuda:0', size=(80, 10240), dtype=torch.float16)) at debug_level 0 before=False
TRACE LOAD_FAST self [LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR zeros [LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['QKV_']._parameters['zeros'] (80, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='QKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='zeros'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_QKV_parameters_zeros_ L['QKV_']._parameters['zeros'] Parameter(FakeTensor(..., device='cuda:0', size=(80, 10240), dtype=torch.float16)) at debug_level 0 before=False
TRACE BUILD_LIST 3 [LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [ListVariable(length=3)]
DONE INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_meta_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3)]
TRACE LOAD_ATTR get_meta_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_meta_args at 0x70c98a9e9120>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_meta_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_meta_args(),
            ~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:527 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
        def get_meta_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE LOAD_GLOBAL int []
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR scaled_activations [NullVariable, LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:529 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_nbits,
TRACE LOAD_FAST self [ConstantVariable(int: 0)]
TRACE LOAD_ATTR W_nbits [ConstantVariable(int: 0), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:530 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.group_size,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker()]
TRACE LOAD_ATTR group_size [ConstantVariable(int: 0), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:531 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.unpack_mask,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR unpack_mask [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:532 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.elements_per_sample,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR elements_per_sample [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:533 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.input_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR input_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:534 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.output_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR output_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:535 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.acc_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR acc_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:536 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.meta_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR meta_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:537 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.channel_scale_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR channel_scale_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:538 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_group_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR W_group_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:539 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    int(self.data_contiguous),
TRACE LOAD_GLOBAL int [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int)]
TRACE LOAD_ATTR data_contiguous [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE BUILD_LIST 12 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [ListVariable(length=12)]
DONE INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:549 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
TRACE LOAD_GLOBAL GEMLITE_MATMUL_TYPES_MAPPING [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12)]
TRACE LOAD_FAST matmul_type [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker(), ConstantVariable(str: 'GEMM')]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        return forward_functional(
               ~~~~~~~~~~~~~~~~~~^
            x,
            ^^
            self.bias,
            ^^^^^^^^^^
            self.get_tensor_args(),
            ^^^^^^^^^^^^^^^^^^^^^^^
            self.get_meta_args(),
            ^^^^^^^^^^^^^^^^^^^^^
            GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:675 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        def __call__(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
            return self._opoverload(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR _opoverload [NullVariable, UserDefinedObjectVariable(CustomOpDef)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=5)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
wrap_to_fake L['QKV_'].W_q (640, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=AttrSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='QKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='W_q'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_QKV_W_q L['QKV_'].W_q FakeTensor(..., device='cuda:0', size=(640, 10240), dtype=torch.int32) at debug_level 0 before=False
TRACE FX call forward_functional_default from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        return self._opoverload(*args, **kwargs)
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_3 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE STORE_FAST out [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
            return out.view(S0,S1,-1)
TRACE LOAD_FAST out []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST S0 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST S1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: -1)]
TRACE FX call view_1 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
        return out.view(S0,S1,-1)
               ~~~~~~~~^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object fpx_matmul at 0x3063a810, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>
TRACE STORE_FAST qkv [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:919 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q, k, v = qkv.split(qkv_split_list, dim=-1)
TRACE LOAD_FAST qkv []
TRACE LOAD_ATTR split [TensorVariable()]
TRACE LOAD_FAST qkv_split_list [NullVariable, GetAttrVariable(TensorVariable(), split)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker()]
TRACE KW_NAMES ('dim',) [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE FX call split from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:919 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        q, k, v = qkv.split(qkv_split_list, dim=-1)
                  ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
TRACE UNPACK_SEQUENCE 3 [TupleVariable(length=3)]
TRACE STORE_FAST q [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST k [TensorVariable(), TensorVariable()]
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:922 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q.add_(Q_bias)
TRACE LOAD_FAST q []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST Q_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
wrap_to_fake L['Q_bias'] () StatefulSymbolicContext(dynamic_sizes=[], dynamic_strides=[], constraint_sizes=[], constraint_strides=[], specialize_on=[], view_base_context=None, tensor_source=LocalSource(local_name='Q_bias', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_Q_bias_ L['Q_bias'] FakeTensor(..., device='cuda:0', size=(), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call add_ from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:922 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        q.add_(Q_bias)
        ~~~~~~^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:923 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k.add_(K_bias)
TRACE LOAD_FAST k []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST K_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
TRACE FX call add__1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:923 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        k.add_(K_bias)
        ~~~~~~^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:924 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            v.add_(V_bias)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST V_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
TRACE FX call add__2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:924 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        v.add_(V_bias)
        ~~~~~~^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:927 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q = q.view(B, T, H, N)  # [B,T,H,N]
TRACE LOAD_FAST q []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:927 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        q = q.view(B, T, H, N)  # [B,T,H,N]
            ~~~~~~^^^^^^^^^^^^
TRACE STORE_FAST q [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:928 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            kv_dim_flat = k.shape[-1]     # kv_heads * N
TRACE LOAD_FAST k []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE FX call size_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:928 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        kv_dim_flat = k.shape[-1]     # kv_heads * N
                      ^^^^^^^
TRACE LOAD_CONST -1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: -1)]
TRACE STORE_FAST kv_dim_flat [ConstantVariable(int: 1024)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:929 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            kv_heads = kv_dim_flat // N
TRACE LOAD_FAST kv_dim_flat []
TRACE LOAD_FAST N [ConstantVariable(int: 1024)]
TRACE BINARY_OP 2 [ConstantVariable(int: 1024), ConstantVariable(int: 128)]
TRACE STORE_FAST kv_heads [ConstantVariable(int: 8)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:930 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k = k.view(B, T, kv_heads, N) # [B,T,kv_h,N]
TRACE LOAD_FAST k []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_heads [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:930 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        k = k.view(B, T, kv_heads, N) # [B,T,kv_h,N]
            ~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:931 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            v = v.view(B, T, kv_heads, N)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_heads [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:931 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        v = v.view(B, T, kv_heads, N)
            ~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:934 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            if ln_r is not None:
TRACE LOAD_FAST ln_r []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 0 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
wrap_to_fake L['ln_r'] (128,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln_r', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln_r_ L['ln_r'] FakeTensor(..., device='cuda:0', size=(128,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE POP_JUMP_IF_TRUE 606 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:935 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
                q = T5RMSNorm(q, ln_r, rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln_r [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:935 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q = T5RMSNorm(q, ln_r, rmsnorm_epsilon)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST q [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:936 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
                k = T5RMSNorm(k, ln_k, rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln_k [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:936 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k = T5RMSNorm(k, ln_k, rmsnorm_epsilon)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln_k'] (128,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln_k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln_k_ L['ln_k'] FakeTensor(..., device='cuda:0', size=(128,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:940 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k_write = k.view(B, T, -1)
TRACE LOAD_FAST k []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: -1)]
TRACE FX call view_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:940 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        k_write = k.view(B, T, -1)
                  ~~~~~~^^^^^^^^^^
TRACE STORE_FAST k_write [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:941 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            v_write = v.view(B, T, -1)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: -1)]
TRACE FX call view_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:941 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        v_write = v.view(B, T, -1)
                  ~~~~~~^^^^^^^^^^
TRACE STORE_FAST v_write [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:944 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            new_lengths = starts + T
TRACE LOAD_FAST starts []
TRACE LOAD_FAST T [TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), SymNodeVariable()]
TRACE FX call add_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:944 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        new_lengths = starts + T
                      ~~~~~~~^~~
TRACE STORE_FAST new_lengths [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            excess_tokens = torch.clamp(new_lengths - Lmax, min=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR clamp [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST new_lengths [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST Lmax [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 10 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 8192)]
TRACE FX call sub from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        excess_tokens = torch.clamp(new_lengths - Lmax, min=0)
                                    ~~~~~~~~~~~~^~~~~~
TRACE LOAD_CONST 0 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE KW_NAMES ('min',) [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 0)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 0)]
TRACE FX call clamp from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        excess_tokens = torch.clamp(new_lengths - Lmax, min=0)
                        ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST excess_tokens [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:946 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            batches_to_evict = excess_tokens > 0
TRACE LOAD_FAST excess_tokens []
TRACE LOAD_CONST 0 [TensorVariable()]
TRACE COMPARE_OP > [TensorVariable(), ConstantVariable(int: 0)]
TRACE FX call gt from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:946 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        batches_to_evict = excess_tokens > 0
                           ^^^^^^^^^^^^^^^^^
TRACE STORE_FAST batches_to_evict [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            if bool(batches_to_evict.any()):
TRACE LOAD_GLOBAL bool []
TRACE LOAD_FAST batches_to_evict [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR any [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), any)]
TRACE FX call any_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        if bool(batches_to_evict.any()):
                ~~~~~~~~~~~~~~~~~~~~^^
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
COMPILING GRAPH due to GraphCompileReason(reason="Failed to trace builtin operator\n  Explanation: Dynamo does not know how to trace builtin operator `bool` with argument types ['Tensor'] (has_kwargs False)\n  Hint: Avoid calling builtin `bool` with argument types ['Tensor']. Consider using an equivalent alternative function/method to `bool`.\n  Hint: If you are attempting to call a logging function (e.g. `print`), you can try adding it to `torch._dynamo.config.reorderable_logging_functions`.\n  Hint: Please report an issue to PyTorch.\n\n  Developer debug context: builtin bool [<class 'torch._dynamo.variables.tensor.TensorVariable'>] False\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0059.html", user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py, line 949 in GQA_Attention_Flash_>], graph_break=True)
REMOVE UNUSED GRAPHARG L['past_key_value']
TRACED GRAPH
 ===== __compiled_fn_26_d12cc727_90f0_459d_8204_ca446ce70b51 =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, s52: "Sym(s52)", L_x_in_: "[31mbf16[0m[34m[1, s52, 5120][0m[2m[34m[5120*s52, 5120, 1][0m[2m[32mcuda:0[0m", L_cache_position_: "[31mi64[0m[34m[1, 1][0m[2m[34m[1, 1][0m[2m[32mcuda:0[0m", L_ln1_: "[31mbf16[0m[34m[5120][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_QKV_parameters_scales_: "[31mf16[0m[34m[80, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m", L_QKV_parameters_zeros_: "[31mf16[0m[34m[80, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m", L_QKV_W_q: "[31mi32[0m[34m[640, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m", L_Q_bias_: "[31mbf16[0m[34m[][0m[2m[34m[][0m[2m[32mcuda:0[0m", L_ln_r_: "[31mbf16[0m[34m[128][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_ln_k_: "[31mbf16[0m[34m[128][0m[2m[34m[1][0m[2m[32mcuda:0[0m"):
        l_x_in_ = L_x_in_
        l_cache_position_ = L_cache_position_
        l_ln1_ = L_ln1_
        l_qkv_parameters_scales_ = L_QKV_parameters_scales_
        l_qkv_parameters_zeros_ = L_QKV_parameters_zeros_
        l_qkv_w_q = L_QKV_W_q
        l_q_bias_ = L_Q_bias_
        l_ln_r_ = L_ln_r_
        l_ln_k_ = L_ln_k_
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_, code: starts = cache_position[:, 0].clone()[0m
        getitem_3: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = l_cache_position_[(slice([34mNone[0m, [34mNone[0m, [34mNone[0m), [34m0[0m)];  [2ml_cache_position_ = None[0m
        starts: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = getitem_3.clone();  [2mgetitem_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:910 in GQA_Attention_Flash_, code: starts.clamp_(min=0, max=Lmax)[0m
        clamp_: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = starts.clamp_(min = [34m0[0m, max = [34m8192[0m);  [2mclamp_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states: "[31mf32[0m[34m[1, s52, 5120][0m[2m[34m[5120*s52, 5120, 1][0m[2m[32mcuda:0[0m" = l_x_in_.to([34mtorch.float32[0m);  [2ml_x_in_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_1: "[31mf32[0m[34m[1, s52, 5120][0m[2m[34m[5120*s52, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states.pow([34m2[0m)
        variance: "[31mf32[0m[34m[1, s52, 1][0m[2m[34m[s52, 1, 1][0m[2m[32mcuda:0[0m" = pow_1.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add: "[31mf32[0m[34m[1, s52, 1][0m[2m[34m[s52, 1, 1][0m[2m[32mcuda:0[0m" = variance + [34m1e-06[0m;  [2mvariance = None[0m
        rsqrt: "[31mf32[0m[34m[1, s52, 1][0m[2m[34m[s52, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add);  [2madd = None[0m
        hidden_states_1: "[31mf32[0m[34m[1, s52, 5120][0m[2m[34m[5120*s52, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states * rsqrt;  [2mhidden_states = rsqrt = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_1: "[31mf32[0m[34m[1, s52, 5120][0m[2m[34m[5120*s52, 5120, 1][0m[2m[32mcuda:0[0m" = l_ln1_ * hidden_states_1;  [2ml_ln1_ = hidden_states_1 = None[0m
        x: "[31mbf16[0m[34m[1, s52, 5120][0m[2m[34m[5120*s52, 5120, 1][0m[2m[32mcuda:0[0m" = mul_1.to([34mtorch.bfloat16[0m);  [2mmul_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul, code: x = x.to(dtype=torch.float16).view(-1,x.shape[2])[0m
        to_2: "[31mf16[0m[34m[1, s52, 5120][0m[2m[34m[5120*s52, 5120, 1][0m[2m[32mcuda:0[0m" = x.to(dtype = [34mtorch.float16[0m);  [2mx = None[0m
        x_1: "[31mf16[0m[34m[s52, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m" = to_2.view([34m-1[0m, [34m5120[0m);  [2mto_2 = None[0m
        
         [2m# File: /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__, code: return self._opoverload(*args, **kwargs)[0m
        forward_functional_default: "[31mf16[0m[34m[s52, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m" = torch.ops.gemlite.forward_functional.default(x_1, [34mNone[0m, [l_qkv_w_q, l_qkv_parameters_scales_, l_qkv_parameters_zeros_], [[34m0[0m, [34m4[0m, [34m64[0m, [34m15[0m, [34m8[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m0[0m, [34m4[0m, [34m1[0m], [34m4[0m);  [2mx_1 = l_qkv_w_q = l_qkv_parameters_scales_ = l_qkv_parameters_zeros_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul, code: out = weight.forward_manual(x).to(dtype=dtype)[0m
        out: "[31mbf16[0m[34m[s52, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m" = forward_functional_default.to(dtype = [34mtorch.bfloat16[0m);  [2mforward_functional_default = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul, code: return out.view(S0,S1,-1)[0m
        qkv: "[31mbf16[0m[34m[1, s52, 10240][0m[2m[34m[10240*s52, 10240, 1][0m[2m[32mcuda:0[0m" = out.view([34m1[0m, s52, [34m-1[0m);  [2mout = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:919 in GQA_Attention_Flash_, code: q, k, v = qkv.split(qkv_split_list, dim=-1)[0m
        split = qkv.split([[34m8192[0m, [34m1024[0m, [34m1024[0m], dim = [34m-1[0m);  [2mqkv = None[0m
        q: "[31mbf16[0m[34m[1, s52, 8192][0m[2m[34m[10240*s52, 10240, 1][0m[2m[32mcuda:0[0m" = split[[34m0[0m]
        k: "[31mbf16[0m[34m[1, s52, 1024][0m[2m[34m[10240*s52, 10240, 1][0m[2m[32mcuda:0[0m" = split[[34m1[0m]
        v: "[31mbf16[0m[34m[1, s52, 1024][0m[2m[34m[10240*s52, 10240, 1][0m[2m[32mcuda:0[0m" = split[[34m2[0m];  [2msplit = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:922 in GQA_Attention_Flash_, code: q.add_(Q_bias)[0m
        add_: "[31mbf16[0m[34m[1, s52, 8192][0m[2m[34m[10240*s52, 10240, 1][0m[2m[32mcuda:0[0m" = q.add_(l_q_bias_);  [2madd_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:923 in GQA_Attention_Flash_, code: k.add_(K_bias)[0m
        add__1: "[31mbf16[0m[34m[1, s52, 1024][0m[2m[34m[10240*s52, 10240, 1][0m[2m[32mcuda:0[0m" = k.add_(l_q_bias_);  [2madd__1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:924 in GQA_Attention_Flash_, code: v.add_(V_bias)[0m
        add__2: "[31mbf16[0m[34m[1, s52, 1024][0m[2m[34m[10240*s52, 10240, 1][0m[2m[32mcuda:0[0m" = v.add_(l_q_bias_);  [2ml_q_bias_ = add__2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:927 in GQA_Attention_Flash_, code: q = q.view(B, T, H, N)  # [B,T,H,N][0m
        q_1: "[31mbf16[0m[34m[1, s52, 64, 128][0m[2m[34m[10240*s52, 10240, 128, 1][0m[2m[32mcuda:0[0m" = q.view([34m1[0m, s52, [34m64[0m, [34m128[0m);  [2mq = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:930 in GQA_Attention_Flash_, code: k = k.view(B, T, kv_heads, N) # [B,T,kv_h,N][0m
        k_1: "[31mbf16[0m[34m[1, s52, 8, 128][0m[2m[34m[10240*s52, 10240, 128, 1][0m[2m[32mcuda:0[0m" = k.view([34m1[0m, s52, [34m8[0m, [34m128[0m);  [2mk = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:931 in GQA_Attention_Flash_, code: v = v.view(B, T, kv_heads, N)[0m
        v_1: "[31mbf16[0m[34m[1, s52, 8, 128][0m[2m[34m[10240*s52, 10240, 128, 1][0m[2m[32mcuda:0[0m" = v.view([34m1[0m, s52, [34m8[0m, [34m128[0m);  [2mv = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states_2: "[31mf32[0m[34m[1, s52, 64, 128][0m[2m[34m[8192*s52, 8192, 128, 1][0m[2m[32mcuda:0[0m" = q_1.to([34mtorch.float32[0m);  [2mq_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_2: "[31mf32[0m[34m[1, s52, 64, 128][0m[2m[34m[8192*s52, 8192, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_2.pow([34m2[0m)
        variance_1: "[31mf32[0m[34m[1, s52, 64, 1][0m[2m[34m[64*s52, 64, 1, 1][0m[2m[32mcuda:0[0m" = pow_2.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add_1: "[31mf32[0m[34m[1, s52, 64, 1][0m[2m[34m[64*s52, 64, 1, 1][0m[2m[32mcuda:0[0m" = variance_1 + [34m1e-06[0m;  [2mvariance_1 = None[0m
        rsqrt_1: "[31mf32[0m[34m[1, s52, 64, 1][0m[2m[34m[64*s52, 64, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add_1);  [2madd_1 = None[0m
        hidden_states_3: "[31mf32[0m[34m[1, s52, 64, 128][0m[2m[34m[8192*s52, 8192, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_2 * rsqrt_1;  [2mhidden_states_2 = rsqrt_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_3: "[31mf32[0m[34m[1, s52, 64, 128][0m[2m[34m[8192*s52, 8192, 128, 1][0m[2m[32mcuda:0[0m" = l_ln_r_ * hidden_states_3;  [2ml_ln_r_ = hidden_states_3 = None[0m
        q_2: "[31mbf16[0m[34m[1, s52, 64, 128][0m[2m[34m[8192*s52, 8192, 128, 1][0m[2m[32mcuda:0[0m" = mul_3.to([34mtorch.bfloat16[0m);  [2mmul_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states_4: "[31mf32[0m[34m[1, s52, 8, 128][0m[2m[34m[1024*s52, 1024, 128, 1][0m[2m[32mcuda:0[0m" = k_1.to([34mtorch.float32[0m);  [2mk_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_3: "[31mf32[0m[34m[1, s52, 8, 128][0m[2m[34m[1024*s52, 1024, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_4.pow([34m2[0m)
        variance_2: "[31mf32[0m[34m[1, s52, 8, 1][0m[2m[34m[8*s52, 8, 1, 1][0m[2m[32mcuda:0[0m" = pow_3.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add_2: "[31mf32[0m[34m[1, s52, 8, 1][0m[2m[34m[8*s52, 8, 1, 1][0m[2m[32mcuda:0[0m" = variance_2 + [34m1e-06[0m;  [2mvariance_2 = None[0m
        rsqrt_2: "[31mf32[0m[34m[1, s52, 8, 1][0m[2m[34m[8*s52, 8, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add_2);  [2madd_2 = None[0m
        hidden_states_5: "[31mf32[0m[34m[1, s52, 8, 128][0m[2m[34m[1024*s52, 1024, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_4 * rsqrt_2;  [2mhidden_states_4 = rsqrt_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_5: "[31mf32[0m[34m[1, s52, 8, 128][0m[2m[34m[1024*s52, 1024, 128, 1][0m[2m[32mcuda:0[0m" = l_ln_k_ * hidden_states_5;  [2ml_ln_k_ = hidden_states_5 = None[0m
        k_2: "[31mbf16[0m[34m[1, s52, 8, 128][0m[2m[34m[1024*s52, 1024, 128, 1][0m[2m[32mcuda:0[0m" = mul_5.to([34mtorch.bfloat16[0m);  [2mmul_5 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:940 in GQA_Attention_Flash_, code: k_write = k.view(B, T, -1)[0m
        k_write: "[31mbf16[0m[34m[1, s52, 1024][0m[2m[34m[1024*s52, 1024, 1][0m[2m[32mcuda:0[0m" = k_2.view([34m1[0m, s52, [34m-1[0m)
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:941 in GQA_Attention_Flash_, code: v_write = v.view(B, T, -1)[0m
        v_write: "[31mbf16[0m[34m[1, s52, 1024][0m[2m[34m[10240*s52, 10240, 1][0m[2m[32mcuda:0[0m" = v_1.view([34m1[0m, s52, [34m-1[0m)
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:944 in GQA_Attention_Flash_, code: new_lengths = starts + T[0m
        new_lengths: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = starts + s52
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_, code: excess_tokens = torch.clamp(new_lengths - Lmax, min=0)[0m
        sub: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = new_lengths - [34m8192[0m;  [2mnew_lengths = None[0m
        excess_tokens: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = torch.clamp(sub, min = [34m0[0m);  [2msub = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:946 in GQA_Attention_Flash_, code: batches_to_evict = excess_tokens > 0[0m
        batches_to_evict: "[31mb8[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = excess_tokens > [34m0[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949 in GQA_Attention_Flash_, code: if bool(batches_to_evict.any()):[0m
        any_1: "[31mb8[0m[34m[][0m[2m[34m[][0m[2m[32mcuda:0[0m" = batches_to_evict.any()
        return (any_1, s52, starts, q_2, k_2, v_1, k_write, v_write, excess_tokens, batches_to_evict)
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing forward /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:831
TRACE MAKE_CELL max_seqlens_q []
TRACE MAKE_CELL batch []
TRACE MAKE_CELL nheads_q []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:831 in forward (_attention)
        @staticmethod
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:848 in forward (_attention.forward)
            use_fp8 = False
TRACE LOAD_CONST False []
TRACE STORE_FAST use_fp8 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:849 in forward (_attention.forward)
            fp8_out_scale=None
TRACE LOAD_CONST None []
TRACE STORE_FAST fp8_out_scale [ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:850 in forward (_attention.forward)
            fp8_scales=None
TRACE LOAD_CONST None []
TRACE STORE_FAST fp8_scales [ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:851 in forward (_attention.forward)
            q_scale = k_scale = v_scale = p_scale = 1.0
TRACE LOAD_CONST 1.0 []
TRACE COPY 1 [ConstantVariable(float: 1.0)]
TRACE STORE_FAST q_scale [ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE COPY 1 [ConstantVariable(float: 1.0)]
TRACE STORE_FAST k_scale [ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE COPY 1 [ConstantVariable(float: 1.0)]
TRACE STORE_FAST v_scale [ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE STORE_FAST p_scale [ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:853 in forward (_attention.forward)
            if o is None:
TRACE LOAD_FAST o []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
automatic dynamic size L['o'] size(0) 128 != 512
wrap_to_fake L['o'] (128, 64, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='o', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_o_ L['o'] FakeTensor(..., device='cuda:0', size=(s45, 64, 128), dtype=torch.bfloat16) at debug_level 0 before=False
create_graph_input s45 L['o'].size()[0] s45 at debug_level 0 before=True
_lift_symbols_in_symint s45 from L['o'].size()[0] at debug_level 0
TRACE POP_JUMP_IF_TRUE 110 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:865 in forward (_attention.forward)
            if True:  # varlen
TRACE NOP None []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:866 in forward (_attention.forward)
                total_q, nheads_q, head_size = q.shape
TRACE LOAD_FAST q []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
automatic dynamic size L['q']._base size(1) 128 != 512
automatic dynamic size L['q'] size(0) 128 != 512
wrap_to_fake L['q'] (128, 64, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None, None], specialize_on=[[], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='q', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}), tensor_source=LocalSource(local_name='q', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_q_ L['q'] FakeTensor(..., device='cuda:0', size=(s85, 64, 128), dtype=torch.bfloat16) at debug_level 0 before=False
create_graph_input s85 L['q'].size()[0] s85 at debug_level 0 before=True
_lift_symbols_in_symint s85 from L['q'].size()[0] at debug_level 0
wrap_to_fake L['q']._base (1, 128, 64, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None, None], specialize_on=[[], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='q', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
TRACE FX call size from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:866 in forward (_attention.forward)
            total_q, nheads_q, head_size = q.shape
                                           ^^^^^^^
TRACE UNPACK_SEQUENCE 3 [SizeVariable(length=3)]
TRACE STORE_FAST total_q [ConstantVariable(int: 128), ConstantVariable(int: 64), SymNodeVariable()]
TRACE STORE_DEREF nheads_q [ConstantVariable(int: 128), ConstantVariable(int: 64)]
TRACE STORE_FAST head_size [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:867 in forward (_attention.forward)
                total_k, nheads_k, _ = k.shape
TRACE LOAD_FAST k []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
wrap_to_fake L['k'] (1152, 8, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_k_ L['k'] FakeTensor(..., device='cuda:0', size=(s37, 8, 128), dtype=torch.bfloat16) at debug_level 0 before=False
create_graph_input s37 L['k'].size()[0] s37 at debug_level 0 before=True
_lift_symbols_in_symint s37 from L['k'].size()[0] at debug_level 0
TRACE FX call size_1 from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:867 in forward (_attention.forward)
            total_k, nheads_k, _ = k.shape
                                   ^^^^^^^
TRACE UNPACK_SEQUENCE 3 [SizeVariable(length=3)]
TRACE STORE_FAST total_k [ConstantVariable(int: 128), ConstantVariable(int: 8), SymNodeVariable()]
TRACE STORE_FAST nheads_k [ConstantVariable(int: 128), ConstantVariable(int: 8)]
TRACE STORE_FAST _ [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:868 in forward (_attention.forward)
                batch = len(cu_seqlens_q) - 1
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST cu_seqlens_q [NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
wrap_to_fake L['cu_seqlens_q'] (2,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='cu_seqlens_q', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_cu_seqlens_q_ L['cu_seqlens_q'] FakeTensor(..., device='cuda:0', size=(2,), dtype=torch.int32) at debug_level 0 before=False
TRACE LOAD_CONST 1 [ConstantVariable(int: 2)]
TRACE BINARY_OP 10 [ConstantVariable(int: 2), ConstantVariable(int: 1)]
TRACE STORE_DEREF batch [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:869 in forward (_attention.forward)
                q_strides = (0, q.stride(1), q.stride(0), q.stride(2))
TRACE LOAD_CONST 0 []
TRACE LOAD_FAST q [ConstantVariable(int: 0)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), TensorVariable()]
TRACE LOAD_CONST 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 1)]
TRACE LOAD_FAST q [ConstantVariable(int: 0), ConstantVariable(int: 128)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 0)]
TRACE LOAD_FAST q [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), TensorVariable()]
TRACE LOAD_CONST 2 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 2)]
TRACE BUILD_TUPLE 4 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), ConstantVariable(int: 1)]
TRACE STORE_FAST q_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:870 in forward (_attention.forward)
                k_strides = (0, k.stride(1), k.stride(0), k.stride(2))
TRACE LOAD_CONST 0 []
TRACE LOAD_FAST k [ConstantVariable(int: 0)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), TensorVariable()]
TRACE LOAD_CONST 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 1)]
TRACE LOAD_FAST k [ConstantVariable(int: 0), ConstantVariable(int: 128)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 0)]
TRACE LOAD_FAST k [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), TensorVariable()]
TRACE LOAD_CONST 2 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 2)]
TRACE BUILD_TUPLE 4 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), ConstantVariable(int: 1)]
TRACE STORE_FAST k_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:871 in forward (_attention.forward)
                v_strides = (0, v.stride(1), v.stride(0), v.stride(2))
TRACE LOAD_CONST 0 []
TRACE LOAD_FAST v [ConstantVariable(int: 0)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), LazyVariableTracker()]
wrap_to_fake L['v'] (1152, 8, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='v', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_v_ L['v'] FakeTensor(..., device='cuda:0', size=(s33, 8, 128), dtype=torch.bfloat16) at debug_level 0 before=False
create_graph_input s33 L['v'].size()[0] s33 at debug_level 0 before=True
_lift_symbols_in_symint s33 from L['v'].size()[0] at debug_level 0
TRACE LOAD_CONST 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 1)]
TRACE LOAD_FAST v [ConstantVariable(int: 0), ConstantVariable(int: 128)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 0)]
TRACE LOAD_FAST v [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), TensorVariable()]
TRACE LOAD_CONST 2 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 2)]
TRACE BUILD_TUPLE 4 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), ConstantVariable(int: 1)]
TRACE STORE_FAST v_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:872 in forward (_attention.forward)
                o_strides = (0, o.stride(1), o.stride(0), o.stride(2))
TRACE LOAD_CONST 0 []
TRACE LOAD_FAST o [ConstantVariable(int: 0)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), TensorVariable()]
TRACE LOAD_CONST 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 1)]
TRACE LOAD_FAST o [ConstantVariable(int: 0), ConstantVariable(int: 128)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 0)]
TRACE LOAD_FAST o [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), TensorVariable()]
TRACE LOAD_CONST 2 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 2)]
TRACE BUILD_TUPLE 4 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), ConstantVariable(int: 1)]
TRACE STORE_FAST o_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:882 in forward (_attention.forward)
            unpadded_head_dims = {32, 64, 128, 256}
TRACE BUILD_SET 0 []
TRACE LOAD_CONST frozenset({256, 32, 64, 128}) [SetVariable()]
TRACE SET_UPDATE 1 [SetVariable(), FrozensetVariable()]
TRACE inlined call set_update from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:882 in forward (_attention.forward)
        unpadded_head_dims = {32, 64, 128, 256}
                             ^^^^^^^^^^^^^^^^^^
INLINING <code object set_update at 0x70c9a06d2630, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 210>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:210 in set_update (set_update) (inline depth: 1)
    def set_update(set1, *others):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:211 in set_update (set_update) (inline depth: 1)
        if len(others) == 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST others [NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=1)]
TRACE LOAD_CONST 0 [ConstantVariable(int: 1)]
TRACE COMPARE_OP == [ConstantVariable(int: 1), ConstantVariable(int: 0)]
TRACE POP_JUMP_IF_FALSE 34 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:214 in set_update (set_update) (inline depth: 1)
        for set2 in others:
TRACE LOAD_FAST others []
TRACE GET_ITER None [TupleVariable(length=1)]
TRACE FOR_ITER 104 [ListIteratorVariable(length=1, index=0)]
TRACE STORE_FAST set2 [ListIteratorVariable(length=1, index=1), FrozensetVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE LOAD_FAST set2 [ListIteratorVariable(length=1, index=1)]
TRACE GET_ITER None [ListIteratorVariable(length=1, index=1), FrozensetVariable()]
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=0)]
TRACE STORE_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(int: 256)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:216 in set_update (set_update) (inline depth: 1)
                if x not in set1:
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1)]
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(int: 256)]
TRACE CONTAINS_OP 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(int: 256), SetVariable()]
TRACE POP_JUMP_IF_TRUE 64 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:217 in set_update (set_update) (inline depth: 1)
                    set1.add(x)
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1)]
TRACE LOAD_ATTR add [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), SetVariable()]
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), NullVariable, GetAttrVariable(SetVariable(), add)]
TRACE CALL 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), NullVariable, GetAttrVariable(SetVariable(), add), ConstantVariable(int: 256)]
TRACE POP_TOP None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 48 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1)]
TRACE STORE_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(int: 32)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:216 in set_update (set_update) (inline depth: 1)
                if x not in set1:
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2)]
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(int: 32)]
TRACE CONTAINS_OP 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(int: 32), SetVariable()]
TRACE POP_JUMP_IF_TRUE 64 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:217 in set_update (set_update) (inline depth: 1)
                    set1.add(x)
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2)]
TRACE LOAD_ATTR add [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), SetVariable()]
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), NullVariable, GetAttrVariable(SetVariable(), add)]
TRACE CALL 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), NullVariable, GetAttrVariable(SetVariable(), add), ConstantVariable(int: 32)]
TRACE POP_TOP None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 48 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2)]
TRACE STORE_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(int: 64)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:216 in set_update (set_update) (inline depth: 1)
                if x not in set1:
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3)]
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(int: 64)]
TRACE CONTAINS_OP 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(int: 64), SetVariable()]
TRACE POP_JUMP_IF_TRUE 64 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:217 in set_update (set_update) (inline depth: 1)
                    set1.add(x)
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3)]
TRACE LOAD_ATTR add [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), SetVariable()]
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), NullVariable, GetAttrVariable(SetVariable(), add)]
TRACE CALL 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), NullVariable, GetAttrVariable(SetVariable(), add), ConstantVariable(int: 64)]
TRACE POP_TOP None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 48 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3)]
TRACE STORE_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(int: 128)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:216 in set_update (set_update) (inline depth: 1)
                if x not in set1:
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4)]
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(int: 128)]
TRACE CONTAINS_OP 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(int: 128), SetVariable()]
TRACE POP_JUMP_IF_TRUE 64 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:217 in set_update (set_update) (inline depth: 1)
                    set1.add(x)
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4)]
TRACE LOAD_ATTR add [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), SetVariable()]
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), NullVariable, GetAttrVariable(SetVariable(), add)]
TRACE CALL 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), NullVariable, GetAttrVariable(SetVariable(), add), ConstantVariable(int: 128)]
TRACE POP_TOP None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 48 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4)]
TRACE END_FOR None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 38 [ListIteratorVariable(length=1, index=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:214 in set_update (set_update) (inline depth: 1)
        for set2 in others:
TRACE FOR_ITER 104 [ListIteratorVariable(length=1, index=1)]
TRACE END_FOR None [ListIteratorVariable(length=1, index=1), ConstantVariable(NoneType: None)]
TRACE RETURN_CONST None []
DONE INLINING <code object set_update at 0x70c9a06d2630, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 210>
TRACE STORE_FAST unpadded_head_dims [SetVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:883 in forward (_attention.forward)
            if head_size not in unpadded_head_dims:
TRACE LOAD_FAST head_size []
TRACE LOAD_FAST unpadded_head_dims [ConstantVariable(int: 128)]
TRACE CONTAINS_OP 1 [ConstantVariable(int: 128), SetVariable()]
TRACE POP_JUMP_IF_FALSE 676 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:891 in forward (_attention.forward)
                padded_d_model = head_size
TRACE LOAD_FAST head_size []
TRACE STORE_FAST padded_d_model [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in forward (_attention.forward)
            grid = lambda META: (
TRACE LOAD_CLOSURE batch []
TRACE LOAD_CLOSURE max_seqlens_q [CellVariable()]
TRACE LOAD_CLOSURE nheads_q [CellVariable(), CellVariable()]
TRACE BUILD_TUPLE 3 [CellVariable(), CellVariable(), CellVariable()]
TRACE LOAD_CONST <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893> [TupleVariable(length=3)]
TRACE MAKE_FUNCTION 8 [TupleVariable(length=3), ConstantVariable(code: <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>)]
TRACE STORE_FAST grid [NestedUserFunctionVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:899 in forward (_attention.forward)
            encoded_softmax = None
TRACE LOAD_CONST None []
TRACE STORE_FAST encoded_softmax [ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:902 in forward (_attention.forward)
            philox_seed = 0x1BF52
TRACE LOAD_CONST 114514 []
TRACE STORE_FAST philox_seed [ConstantVariable(int: 114514)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:903 in forward (_attention.forward)
            philox_offset = 0x1D4B42
TRACE LOAD_CONST 1919810 []
TRACE STORE_FAST philox_offset [ConstantVariable(int: 1919810)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:905 in forward (_attention.forward)
            if bias is not None:
TRACE LOAD_FAST bias []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 0 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 848 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:913 in forward (_attention.forward)
                bias_strides = (0, 0, 0, 0)
TRACE LOAD_CONST (0, 0, 0, 0) []
TRACE STORE_FAST bias_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:915 in forward (_attention.forward)
            p_descale = 1.0 / p_scale
TRACE LOAD_CONST 1.0 []
TRACE LOAD_FAST p_scale [ConstantVariable(float: 1.0)]
TRACE BINARY_OP 11 [ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE STORE_FAST p_descale [ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:917 in forward (_attention.forward)
            ) if fp8_out_scale is not None else 1.0
TRACE LOAD_FAST fp8_out_scale []
TRACE LOAD_CONST None [ConstantVariable(NoneType: None)]
TRACE IS_OP 0 [ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 908 [ConstantVariable(bool: True)]
TRACE LOAD_CONST 1.0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:916 in forward (_attention.forward)
            o_descale = 1.0 / fp8_out_scale.item(
TRACE STORE_FAST o_descale [ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:919 in forward (_attention.forward)
            arg_max_seqlens_q = 0 if on_gfx1x() else max_seqlens_q
TRACE LOAD_GLOBAL on_gfx1x []
TRACE CALL 0 [NullVariable, LazyVariableTracker()]
TRACE inlined call on_gfx1x from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:919 in forward (_attention.forward)
        arg_max_seqlens_q = 0 if on_gfx1x() else max_seqlens_q
                                 ~~~~~~~~^^
INLINING <code object on_gfx1x at 0x70c98a3392e0, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 35>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:35 in on_gfx1x (on_gfx1x) (inline depth: 1)
    def on_gfx1x():
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:36 in on_gfx1x (on_gfx1x) (inline depth: 1)
        return True
TRACE RETURN_CONST True []
DONE INLINING <code object on_gfx1x at 0x70c98a3392e0, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 35>
TRACE POP_JUMP_IF_FALSE 936 [ConstantVariable(bool: True)]
TRACE LOAD_CONST 0 []
TRACE JUMP_FORWARD 938 [ConstantVariable(int: 0)]
TRACE STORE_FAST arg_max_seqlens_q [ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:920 in forward (_attention.forward)
            arg_max_seqlens_k = 0 if on_gfx1x() else max_seqlens_k
TRACE LOAD_GLOBAL on_gfx1x []
TRACE CALL 0 [NullVariable, LazyVariableTracker()]
TRACE inlined call on_gfx1x from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:920 in forward (_attention.forward)
        arg_max_seqlens_k = 0 if on_gfx1x() else max_seqlens_k
                                 ~~~~~~~~^^
INLINING <code object on_gfx1x at 0x70c98a3392e0, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 35>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:35 in on_gfx1x (on_gfx1x) (inline depth: 1)
    def on_gfx1x():
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:36 in on_gfx1x (on_gfx1x) (inline depth: 1)
        return True
TRACE RETURN_CONST True []
DONE INLINING <code object on_gfx1x at 0x70c98a3392e0, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 35>
TRACE POP_JUMP_IF_FALSE 964 [ConstantVariable(bool: True)]
TRACE LOAD_CONST 0 []
TRACE JUMP_FORWARD 966 [ConstantVariable(int: 0)]
TRACE STORE_FAST arg_max_seqlens_k [ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_GLOBAL attn_fwd []
TRACE LOAD_FAST grid [NullVariable, LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), NestedUserFunctionVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:923 in forward (_attention.forward)
                q,
TRACE LOAD_FAST q [NullVariable, TritonKernelVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:924 in forward (_attention.forward)
                k,
TRACE LOAD_FAST k [NullVariable, TritonKernelVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:925 in forward (_attention.forward)
                v,
TRACE LOAD_FAST v [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:926 in forward (_attention.forward)
                bias,
TRACE LOAD_FAST bias [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:927 in forward (_attention.forward)
                sm_scale,
TRACE LOAD_FAST sm_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:928 in forward (_attention.forward)
                q_scale,
TRACE LOAD_FAST q_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:929 in forward (_attention.forward)
                k_scale,
TRACE LOAD_FAST k_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:930 in forward (_attention.forward)
                v_scale,
TRACE LOAD_FAST v_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:931 in forward (_attention.forward)
                p_scale,
TRACE LOAD_FAST p_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:932 in forward (_attention.forward)
                p_descale,
TRACE LOAD_FAST p_descale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:933 in forward (_attention.forward)
                o_descale,
TRACE LOAD_FAST o_descale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:934 in forward (_attention.forward)
                None,
TRACE LOAD_CONST None [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:935 in forward (_attention.forward)
                o,
TRACE LOAD_FAST o [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE BUILD_LIST 13 [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(NoneType: None), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:936 in forward (_attention.forward)
                *q_strides,
TRACE LOAD_FAST q_strides [NullVariable, TritonKernelVariable(), ListVariable(length=13)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=13), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:937 in forward (_attention.forward)
                *k_strides,
TRACE LOAD_FAST k_strides [NullVariable, TritonKernelVariable(), ListVariable(length=17)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=17), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:938 in forward (_attention.forward)
                *v_strides,
TRACE LOAD_FAST v_strides [NullVariable, TritonKernelVariable(), ListVariable(length=21)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=21), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:939 in forward (_attention.forward)
                *o_strides,
TRACE LOAD_FAST o_strides [NullVariable, TritonKernelVariable(), ListVariable(length=25)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=25), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:940 in forward (_attention.forward)
                *bias_strides,
TRACE LOAD_FAST bias_strides [NullVariable, TritonKernelVariable(), ListVariable(length=29)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=29), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:941 in forward (_attention.forward)
                cu_seqlens_q,
TRACE LOAD_FAST cu_seqlens_q [NullVariable, TritonKernelVariable(), ListVariable(length=33)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_APPEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=33), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:942 in forward (_attention.forward)
                cu_seqlens_k,
TRACE LOAD_FAST cu_seqlens_k [NullVariable, TritonKernelVariable(), ListVariable(length=34)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_APPEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=34), LazyVariableTracker()]
TRACE CALL_INTRINSIC_1 6 [NullVariable, TritonKernelVariable(), ListVariable(length=35)]
TRACE BUILD_MAP 0 [NullVariable, TritonKernelVariable(), TupleVariable(length=35)]
TRACE LOAD_CONST dropout_p [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:943 in forward (_attention.forward)
                dropout_p=0.0,
TRACE LOAD_CONST 0.0 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'dropout_p')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'dropout_p'), ConstantVariable(float: 0.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST philox_seed [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:944 in forward (_attention.forward)
                philox_seed=philox_seed,
TRACE LOAD_FAST philox_seed [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'philox_seed')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'philox_seed'), ConstantVariable(int: 114514)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST philox_offset_base [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:945 in forward (_attention.forward)
                philox_offset_base=philox_offset,
TRACE LOAD_FAST philox_offset [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'philox_offset_base')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'philox_offset_base'), ConstantVariable(int: 1919810)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST encoded_softmax [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:946 in forward (_attention.forward)
                encoded_softmax=encoded_softmax,
TRACE LOAD_FAST encoded_softmax [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'encoded_softmax')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'encoded_softmax'), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST HQ [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:947 in forward (_attention.forward)
                HQ=nheads_q,
TRACE LOAD_DEREF nheads_q [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'HQ')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'HQ'), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST HK [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:948 in forward (_attention.forward)
                HK=nheads_k,
TRACE LOAD_FAST nheads_k [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'HK')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'HK'), ConstantVariable(int: 8)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST ACTUAL_BLOCK_DMODEL [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:949 in forward (_attention.forward)
                ACTUAL_BLOCK_DMODEL=head_size,
TRACE LOAD_FAST head_size [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'ACTUAL_BLOCK_DMODEL')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'ACTUAL_BLOCK_DMODEL'), ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST MAX_SEQLENS_Q [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:950 in forward (_attention.forward)
                MAX_SEQLENS_Q=arg_max_seqlens_q,
TRACE LOAD_FAST arg_max_seqlens_q [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'MAX_SEQLENS_Q')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'MAX_SEQLENS_Q'), ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST MAX_SEQLENS_K [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:951 in forward (_attention.forward)
                MAX_SEQLENS_K=arg_max_seqlens_k,
TRACE LOAD_FAST arg_max_seqlens_k [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'MAX_SEQLENS_K')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'MAX_SEQLENS_K'), ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST IS_CAUSAL [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:952 in forward (_attention.forward)
                IS_CAUSAL=causal,
TRACE LOAD_FAST causal [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'IS_CAUSAL')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'IS_CAUSAL'), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST VARLEN [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:953 in forward (_attention.forward)
                VARLEN=True,
TRACE LOAD_CONST True [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'VARLEN')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'VARLEN'), ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST BLOCK_DMODEL [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:954 in forward (_attention.forward)
                BLOCK_DMODEL=padded_d_model,
TRACE LOAD_FAST padded_d_model [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BLOCK_DMODEL')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BLOCK_DMODEL'), ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST BIAS_TYPE [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:955 in forward (_attention.forward)
                BIAS_TYPE=0 if bias is None else 1,
TRACE LOAD_FAST bias [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE')]
TRACE LOAD_CONST None [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(NoneType: None)]
TRACE IS_OP 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 1130 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(bool: False)]
TRACE LOAD_CONST 0 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE')]
TRACE JUMP_FORWARD 1132 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(int: 0)]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST ENABLE_DROPOUT [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:956 in forward (_attention.forward)
                ENABLE_DROPOUT=False,
TRACE LOAD_CONST False [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'ENABLE_DROPOUT')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'ENABLE_DROPOUT'), ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST RETURN_ENCODED_SOFTMAX [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:957 in forward (_attention.forward)
                RETURN_ENCODED_SOFTMAX=False,
TRACE LOAD_CONST False [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'RETURN_ENCODED_SOFTMAX')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'RETURN_ENCODED_SOFTMAX'), ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST USE_FP8 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:958 in forward (_attention.forward)
                USE_FP8=use_fp8,
TRACE LOAD_FAST use_fp8 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8'), ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST USE_FP8_OUT [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:959 in forward (_attention.forward)
                USE_FP8_OUT=fp8_out_scale is not None,
TRACE LOAD_FAST fp8_out_scale [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8_OUT')]
TRACE LOAD_CONST None [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8_OUT'), ConstantVariable(NoneType: None)]
TRACE IS_OP 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8_OUT'), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8_OUT'), ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE CALL_FUNCTION_EX 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE inlined call <lambda> from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
                triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF max_seqlens_q [NullVariable, LazyVariableTracker()]
automatic dynamic int L['max_seqlens_q'] val 128 != 512
create_graph_input L_max_seqlens_q_ L['max_seqlens_q'] s30 at debug_level 0 before=False
TRACE LOAD_FAST META [NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE LOAD_CONST BLOCK_M [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstDictVariable(), ConstantVariable(str: 'BLOCK_M')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
            triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
            ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), SymNodeVariable()]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), SymNodeVariable()]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 3)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [SymNodeVariable()]
TRACE BINARY_OP 0 [SymNodeVariable(), ConstantVariable(int: 32)]
TRACE FX call add from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
            ~~^~~
TRACE LOAD_CONST 1 [SymNodeVariable()]
TRACE BINARY_OP 10 [SymNodeVariable(), ConstantVariable(int: 1)]
TRACE FX call sub from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
            ~~~~~~^~~
TRACE LOAD_FAST y [SymNodeVariable()]
TRACE BINARY_OP 2 [SymNodeVariable(), ConstantVariable(int: 32)]
TRACE FX call floordiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
           ~~~~~~~~~~~~^^~~
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [SymNodeVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:895 in <lambda> (_attention.forward) (inline depth: 1)
                nheads_q,
TRACE LOAD_DEREF nheads_q [SymNodeVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:896 in <lambda> (_attention.forward) (inline depth: 1)
                batch,
TRACE LOAD_DEREF batch [SymNodeVariable(), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE BUILD_TUPLE 3 [SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [TupleVariable(length=3)]
DONE INLINING <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>
TRACE inlined call <lambda> from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
                triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF max_seqlens_q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST META [NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE LOAD_CONST BLOCK_M [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstDictVariable(), ConstantVariable(str: 'BLOCK_M')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
            triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
            ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), SymNodeVariable()]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), SymNodeVariable()]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 3)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [SymNodeVariable()]
TRACE BINARY_OP 0 [SymNodeVariable(), ConstantVariable(int: 32)]
TRACE FX call add_1 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
            ~~^~~
TRACE LOAD_CONST 1 [SymNodeVariable()]
TRACE BINARY_OP 10 [SymNodeVariable(), ConstantVariable(int: 1)]
TRACE FX call sub_1 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
            ~~~~~~^~~
TRACE LOAD_FAST y [SymNodeVariable()]
TRACE BINARY_OP 2 [SymNodeVariable(), ConstantVariable(int: 32)]
TRACE FX call floordiv_1 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
           ~~~~~~~~~~~~^^~~
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [SymNodeVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:895 in <lambda> (_attention.forward) (inline depth: 1)
                nheads_q,
TRACE LOAD_DEREF nheads_q [SymNodeVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:896 in <lambda> (_attention.forward) (inline depth: 1)
                batch,
TRACE LOAD_DEREF batch [SymNodeVariable(), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE BUILD_TUPLE 3 [SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [TupleVariable(length=3)]
DONE INLINING <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>
TRACE inlined call <lambda> from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
                triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF max_seqlens_q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST META [NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE LOAD_CONST BLOCK_M [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstDictVariable(), ConstantVariable(str: 'BLOCK_M')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
            triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
            ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), SymNodeVariable()]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), SymNodeVariable()]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 3)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [SymNodeVariable()]
TRACE BINARY_OP 0 [SymNodeVariable(), ConstantVariable(int: 32)]
TRACE FX call add_2 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
            ~~^~~
TRACE LOAD_CONST 1 [SymNodeVariable()]
TRACE BINARY_OP 10 [SymNodeVariable(), ConstantVariable(int: 1)]
TRACE FX call sub_2 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
            ~~~~~~^~~
TRACE LOAD_FAST y [SymNodeVariable()]
TRACE BINARY_OP 2 [SymNodeVariable(), ConstantVariable(int: 32)]
TRACE FX call floordiv_2 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
           ~~~~~~~~~~~~^^~~
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [SymNodeVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:895 in <lambda> (_attention.forward) (inline depth: 1)
                nheads_q,
TRACE LOAD_DEREF nheads_q [SymNodeVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:896 in <lambda> (_attention.forward) (inline depth: 1)
                batch,
TRACE LOAD_DEREF batch [SymNodeVariable(), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE BUILD_TUPLE 3 [SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [TupleVariable(length=3)]
DONE INLINING <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>
TRACE inlined call <lambda> from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
                triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF max_seqlens_q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST META [NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE LOAD_CONST BLOCK_M [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstDictVariable(), ConstantVariable(str: 'BLOCK_M')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
            triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
            ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), SymNodeVariable()]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), SymNodeVariable()]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 3)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [SymNodeVariable()]
TRACE BINARY_OP 0 [SymNodeVariable(), ConstantVariable(int: 32)]
TRACE FX call add_3 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
            ~~^~~
TRACE LOAD_CONST 1 [SymNodeVariable()]
TRACE BINARY_OP 10 [SymNodeVariable(), ConstantVariable(int: 1)]
TRACE FX call sub_3 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
            ~~~~~~^~~
TRACE LOAD_FAST y [SymNodeVariable()]
TRACE BINARY_OP 2 [SymNodeVariable(), ConstantVariable(int: 32)]
TRACE FX call floordiv_3 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
           ~~~~~~~~~~~~^^~~
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [SymNodeVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:895 in <lambda> (_attention.forward) (inline depth: 1)
                nheads_q,
TRACE LOAD_DEREF nheads_q [SymNodeVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:896 in <lambda> (_attention.forward) (inline depth: 1)
                batch,
TRACE LOAD_DEREF batch [SymNodeVariable(), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE BUILD_TUPLE 3 [SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [TupleVariable(length=3)]
DONE INLINING <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>
wrap_to_fake L['cu_seqlens_k'] (2,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='cu_seqlens_k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_cu_seqlens_k_ L['cu_seqlens_k'] FakeTensor(..., device='cuda:0', size=(2,), dtype=torch.int32) at debug_level 0 before=False
TRACE FX call triton_kernel_wrapper_mutation from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
TRACE POP_TOP None [ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:962 in forward (_attention.forward)
            return o, encoded_softmax
TRACE LOAD_FAST o []
TRACE LOAD_FAST encoded_softmax [TensorVariable()]
TRACE BUILD_TUPLE 2 [TensorVariable(), ConstantVariable(NoneType: None)]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
Step 1: torchdynamo done tracing forward (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py, line 962 in forward>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_29_0bb6fe39_66e7_4b36_b87a_103c9643c737 =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, s45: "Sym(s45)", L_o_: "[31mbf16[0m[34m[s45, 64, 128][0m[2m[34m[8192, 128, 1][0m[2m[32mcuda:0[0m", s85: "Sym(s85)", L_q_: "[31mbf16[0m[34m[s85, 64, 128][0m[2m[34m[8192, 128, 1][0m[2m[32mcuda:0[0m", s37: "Sym(s37)", L_k_: "[31mbf16[0m[34m[s37, 8, 128][0m[2m[34m[1024, 128, 1][0m[2m[32mcuda:0[0m", L_cu_seqlens_q_: "[31mi32[0m[34m[2][0m[2m[34m[1][0m[2m[32mcuda:0[0m", s33: "Sym(s33)", L_v_: "[31mbf16[0m[34m[s33, 8, 128][0m[2m[34m[1024, 128, 1][0m[2m[32mcuda:0[0m", L_max_seqlens_q_: "Sym(s30)", L_cu_seqlens_k_: "[31mi32[0m[34m[2][0m[2m[34m[1][0m[2m[32mcuda:0[0m"):
        l_o_ = L_o_
        l_q_ = L_q_
        l_k_ = L_k_
        l_cu_seqlens_q_ = L_cu_seqlens_q_
        l_v_ = L_v_
        l_max_seqlens_q_ = L_max_seqlens_q_
        l_cu_seqlens_k_ = L_cu_seqlens_k_
        
         [2m# File: /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv, code: return (x + y - 1) // y[0m
        add: "Sym(s30 + 32)" = l_max_seqlens_q_ + [34m32[0m;  [2ml_max_seqlens_q_ = None[0m
        sub: "Sym(s30 + 31)" = add - [34m1[0m;  [2madd = None[0m
        floordiv: "Sym(((s30 + 31)//32))" = sub // [34m32[0m;  [2msub = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward, code: attn_fwd[grid]([0m
        triton_kernel_wrapper_mutation = torch.ops.higher_order.triton_kernel_wrapper_mutation(kernel_idx = [34m1[0m, constant_args_idx = [34m6[0m, grid = [(floordiv, [34m64[0m, [34m1[0m), (floordiv, [34m64[0m, [34m1[0m), (floordiv, [34m64[0m, [34m1[0m), (floordiv, [34m64[0m, [34m1[0m)], tma_descriptor_metadata = [34m{}[0m, kwargs = [34m{'Q': l_q_, 'K': l_k_, 'V': l_v_, 'Out': l_o_, 'cu_seqlens_q': l_cu_seqlens_q_, 'cu_seqlens_k': l_cu_seqlens_k_}[0m);  [2mfloordiv = l_q_ = l_k_ = l_v_ = l_o_ = l_cu_seqlens_q_ = l_cu_seqlens_k_ = triton_kernel_wrapper_mutation = None[0m
        return ()
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing fpx_matmul /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:420
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:420 in fpx_matmul (fpx_matmul)
    def fpx_matmul(x,weight,weight_state,ebits:int=3,mbits:int=2):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:421 in fpx_matmul (fpx_matmul)
        if ebits == -44: #hqq
TRACE LOAD_FAST ebits []
TRACE LOAD_CONST -44 [LazyVariableTracker()]
TRACE COMPARE_OP == [LazyVariableTracker(), ConstantVariable(int: -44)]
TRACE POP_JUMP_IF_FALSE 322 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul)
            S0=x.shape[0]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
automatic dynamic size L['x']._base size(0) 128 != 512
automatic dynamic size L['x'] size(1) 128 != 512
wrap_to_fake L['x'] (1, 128, 8192) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='x', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}), tensor_source=LocalSource(local_name='x', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_x_ L['x'] FakeTensor(..., device='cuda:0', size=(1, s27, 8192), dtype=torch.bfloat16) at debug_level 0 before=False
create_graph_input s27 L['x'].size()[1] s27 at debug_level 0 before=True
_lift_symbols_in_symint s27 from L['x'].size()[1] at debug_level 0
wrap_to_fake L['x']._base (128, 64, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='x', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
TRACE FX call size from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul)
        S0=x.shape[0]
           ^^^^^^^
TRACE LOAD_CONST 0 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 0)]
TRACE STORE_FAST S0 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul)
            S1=x.shape[1]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE FX call size_1 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul)
        S1=x.shape[1]
           ^^^^^^^
TRACE LOAD_CONST 1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 1)]
TRACE STORE_FAST S1 [SymNodeVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:424 in fpx_matmul (fpx_matmul)
            dtype = x.dtype
TRACE LOAD_FAST x []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul)
            x = x.to(dtype=torch.float16).view(-1,x.shape[2])
TRACE LOAD_FAST x []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float16 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST x [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1)]
TRACE LOAD_ATTR shape [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), TensorVariable()]
TRACE FX call size_2 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
                                              ^^^^^^^
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3), ConstantVariable(int: 2)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), ConstantVariable(int: 8192)]
TRACE FX call view from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul)
            out = weight.forward_manual(x).to(dtype=dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_ATTR forward_manual [LazyVariableTracker()]
TRACE LOAD_FAST x [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE CALL 1 [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton)), TensorVariable()]
TRACE inlined call forward_manual from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:543 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
        def forward_manual(self, x: Tensor, matmul_type: str="GEMM") -> Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
            return forward_functional(
TRACE LOAD_GLOBAL forward_functional []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:545 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
                x,
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:546 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
                self.bias,
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR bias [NullVariable, LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
                self.get_tensor_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_ATTR get_tensor_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_tensor_args at 0x70c98a9e9080>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_tensor_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
            self.get_tensor_args(),
            ~~~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:524 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 2)
        def get_tensor_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:525 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 2)
            return [self.W_q, self.scales, self.zeros]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR W_q [UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_FAST self [LazyVariableTracker()]
TRACE LOAD_ATTR scales [LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['weight']._parameters['scales'] (128, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='weight', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='scales'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_weight_parameters_scales_ L['weight']._parameters['scales'] Parameter(FakeTensor(..., device='cuda:0', size=(128, 5120), dtype=torch.float16)) at debug_level 0 before=False
TRACE LOAD_FAST self [LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR zeros [LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['weight']._parameters['zeros'] (128, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='weight', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='zeros'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_weight_parameters_zeros_ L['weight']._parameters['zeros'] Parameter(FakeTensor(..., device='cuda:0', size=(128, 5120), dtype=torch.float16)) at debug_level 0 before=False
TRACE BUILD_LIST 3 [LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [ListVariable(length=3)]
DONE INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
                self.get_meta_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3)]
TRACE LOAD_ATTR get_meta_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_meta_args at 0x70c98a9e9120>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_meta_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
            self.get_meta_args(),
            ~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:527 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
        def get_meta_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
            return [int(self.scaled_activations),
TRACE LOAD_GLOBAL int []
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR scaled_activations [NullVariable, LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:529 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.W_nbits,
TRACE LOAD_FAST self [ConstantVariable(int: 0)]
TRACE LOAD_ATTR W_nbits [ConstantVariable(int: 0), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:530 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.group_size,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker()]
TRACE LOAD_ATTR group_size [ConstantVariable(int: 0), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:531 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.unpack_mask,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR unpack_mask [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:532 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.elements_per_sample,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR elements_per_sample [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:533 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.input_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR input_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:534 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.output_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR output_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:535 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.acc_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR acc_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:536 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.meta_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR meta_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:537 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.channel_scale_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR channel_scale_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:538 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.W_group_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR W_group_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:539 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    int(self.data_contiguous),
TRACE LOAD_GLOBAL int [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int)]
TRACE LOAD_ATTR data_contiguous [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
            return [int(self.scaled_activations),
TRACE BUILD_LIST 12 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [ListVariable(length=12)]
DONE INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:549 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
                GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
TRACE LOAD_GLOBAL GEMLITE_MATMUL_TYPES_MAPPING [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12)]
TRACE LOAD_FAST matmul_type [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker(), ConstantVariable(str: 'GEMM')]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
            return forward_functional(
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
        return forward_functional(
               ~~~~~~~~~~~~~~~~~~^
            x,
            ^^
            self.bias,
            ^^^^^^^^^^
            self.get_tensor_args(),
            ^^^^^^^^^^^^^^^^^^^^^^^
            self.get_meta_args(),
            ^^^^^^^^^^^^^^^^^^^^^
            GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:675 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 2)
        def __call__(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 2)
            return self._opoverload(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR _opoverload [NullVariable, UserDefinedObjectVariable(CustomOpDef)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=5)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
wrap_to_fake L['weight'].W_q (1024, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=AttrSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='weight', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='W_q'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_weight_W_q L['weight'].W_q FakeTensor(..., device='cuda:0', size=(1024, 5120), dtype=torch.int32) at debug_level 0 before=False
TRACE FX call forward_functional_default from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 2)
        return self._opoverload(*args, **kwargs)
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_1 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE STORE_FAST out [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul)
            return out.view(S0,S1,-1)
TRACE LOAD_FAST out []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST S0 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST S1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable()]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), SymNodeVariable(), ConstantVariable(int: -1)]
TRACE FX call view_1 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul)
        return out.view(S0,S1,-1)
               ~~~~~~~~^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
Step 1: torchdynamo done tracing fpx_matmul (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py, line 440 in fpx_matmul>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_31_8e3c66e5_7d72_406e_8265_3135938a56f2 =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, s27: "Sym(s27)", L_x_: "[31mbf16[0m[34m[1, s27, 8192][0m[2m[34m[8192*s27, 8192, 1][0m[2m[32mcuda:0[0m", L_weight_parameters_scales_: "[31mf16[0m[34m[128, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m", L_weight_parameters_zeros_: "[31mf16[0m[34m[128, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m", L_weight_W_q: "[31mi32[0m[34m[1024, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m"):
        l_x_ = L_x_
        l_weight_parameters_scales_ = L_weight_parameters_scales_
        l_weight_parameters_zeros_ = L_weight_parameters_zeros_
        l_weight_w_q = L_weight_W_q
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul, code: x = x.to(dtype=torch.float16).view(-1,x.shape[2])[0m
        to: "[31mf16[0m[34m[1, s27, 8192][0m[2m[34m[8192*s27, 8192, 1][0m[2m[32mcuda:0[0m" = l_x_.to(dtype = [34mtorch.float16[0m);  [2ml_x_ = None[0m
        x: "[31mf16[0m[34m[s27, 8192][0m[2m[34m[8192, 1][0m[2m[32mcuda:0[0m" = to.view([34m-1[0m, [34m8192[0m);  [2mto = None[0m
        
         [2m# File: /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__, code: return self._opoverload(*args, **kwargs)[0m
        forward_functional_default: "[31mf16[0m[34m[s27, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m" = torch.ops.gemlite.forward_functional.default(x, [34mNone[0m, [l_weight_w_q, l_weight_parameters_scales_, l_weight_parameters_zeros_], [[34m0[0m, [34m4[0m, [34m64[0m, [34m15[0m, [34m8[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m0[0m, [34m4[0m, [34m1[0m], [34m4[0m);  [2mx = l_weight_w_q = l_weight_parameters_scales_ = l_weight_parameters_zeros_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul, code: out = weight.forward_manual(x).to(dtype=dtype)[0m
        out: "[31mbf16[0m[34m[s27, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m" = forward_functional_default.to(dtype = [34mtorch.bfloat16[0m);  [2mforward_functional_default = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul, code: return out.view(S0,S1,-1)[0m
        view_1: "[31mbf16[0m[34m[1, s27, 5120][0m[2m[34m[5120*s27, 5120, 1][0m[2m[32mcuda:0[0m" = out.view([34m1[0m, s27, [34m-1[0m);  [2mout = s27 = None[0m
        return (view_1,)
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing T5RMSNorm /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [LazyVariableTracker()]
automatic dynamic size L['hidden_states'] size(1) 128 != 512
wrap_to_fake L['hidden_states'] (1, 128, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='hidden_states', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_hidden_states_ L['hidden_states'] FakeTensor(..., device='cuda:0', size=(1, s87, 5120), dtype=torch.bfloat16) at debug_level 0 before=False
create_graph_input s87 L['hidden_states'].size()[1] s87 at debug_level 0 before=True
_lift_symbols_in_symint s87 from L['hidden_states'].size()[1] at debug_level 0
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE FX call add from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['weight'] (5120,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='weight', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_weight_ L['weight'] FakeTensor(..., device='cuda:0', size=(5120,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
Step 1: torchdynamo done tracing T5RMSNorm (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py, line 378 in T5RMSNorm>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_33_beeb7250_f5d0_4c82_a64a_1e16b3d9dbd9 =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, s87: "Sym(s87)", L_hidden_states_: "[31mbf16[0m[34m[1, s87, 5120][0m[2m[34m[5120*s87, 5120, 1][0m[2m[32mcuda:0[0m", L_weight_: "[31mbf16[0m[34m[5120][0m[2m[34m[1][0m[2m[32mcuda:0[0m"):
        l_hidden_states_ = L_hidden_states_
        l_weight_ = L_weight_
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states: "[31mf32[0m[34m[1, s87, 5120][0m[2m[34m[5120*s87, 5120, 1][0m[2m[32mcuda:0[0m" = l_hidden_states_.to([34mtorch.float32[0m);  [2ml_hidden_states_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_1: "[31mf32[0m[34m[1, s87, 5120][0m[2m[34m[5120*s87, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states.pow([34m2[0m)
        variance: "[31mf32[0m[34m[1, s87, 1][0m[2m[34m[s87, 1, 1][0m[2m[32mcuda:0[0m" = pow_1.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add: "[31mf32[0m[34m[1, s87, 1][0m[2m[34m[s87, 1, 1][0m[2m[32mcuda:0[0m" = variance + [34m1e-06[0m;  [2mvariance = None[0m
        rsqrt: "[31mf32[0m[34m[1, s87, 1][0m[2m[34m[s87, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add);  [2madd = None[0m
        hidden_states_1: "[31mf32[0m[34m[1, s87, 5120][0m[2m[34m[5120*s87, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states * rsqrt;  [2mhidden_states = rsqrt = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_1: "[31mf32[0m[34m[1, s87, 5120][0m[2m[34m[5120*s87, 5120, 1][0m[2m[32mcuda:0[0m" = l_weight_ * hidden_states_1;  [2ml_weight_ = hidden_states_1 = None[0m
        to_1: "[31mbf16[0m[34m[1, s87, 5120][0m[2m[34m[5120*s87, 5120, 1][0m[2m[32mcuda:0[0m" = mul_1.to([34mtorch.bfloat16[0m);  [2mmul_1 = None[0m
        return (to_1,)
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing reference_dequant_gemm /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:213
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:213 in reference_dequant_gemm ()
    @torch.compile
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:219 in reference_dequant_gemm (reference_dequant_gemm)
        W_fp16 = W_int8.to(torch.float16) * scale.view(-1, 1)
TRACE LOAD_FAST W_int8 []
TRACE LOAD_ATTR to [LazyVariableTracker()]
wrap_to_fake L['W_int8'] (5120, 151936) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='W_int8', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_W_int8_ L['W_int8'] FakeTensor(..., device='cuda:0', size=(5120, 151936), dtype=torch.int8) at debug_level 0 before=False
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float16 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to from /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:219 in reference_dequant_gemm (reference_dequant_gemm)
    W_fp16 = W_int8.to(torch.float16) * scale.view(-1, 1)
             ~~~~~~~~~^^^^^^^^^^^^^^^
TRACE LOAD_FAST scale [TensorVariable()]
TRACE LOAD_ATTR view [TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['scale'] (5120,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='scale', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_scale_ L['scale'] FakeTensor(..., device='cuda:0', size=(5120,), dtype=torch.float16) at debug_level 0 before=False
TRACE LOAD_CONST -1 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_CONST 1 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1)]
TRACE CALL 2 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), ConstantVariable(int: 1)]
TRACE FX call view from /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:219 in reference_dequant_gemm (reference_dequant_gemm)
    W_fp16 = W_int8.to(torch.float16) * scale.view(-1, 1)
                                        ~~~~~~~~~~^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul from /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:219 in reference_dequant_gemm (reference_dequant_gemm)
    W_fp16 = W_int8.to(torch.float16) * scale.view(-1, 1)
             ~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST W_fp16 [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:220 in reference_dequant_gemm (reference_dequant_gemm)
        return torch.matmul(A, W_fp16)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR matmul [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST A [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST W_fp16 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), LazyVariableTracker(), TensorVariable()]
automatic dynamic size L['A'] size(1) 128 != 512
wrap_to_fake L['A'] (1, 128, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='A', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_A_ L['A'] FakeTensor(..., device='cuda:0', size=(1, s84, 5120), dtype=torch.float16) at debug_level 0 before=False
create_graph_input s84 L['A'].size()[1] s84 at debug_level 0 before=True
_lift_symbols_in_symint s84 from L['A'].size()[1] at debug_level 0
TRACE FX call matmul from /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:220 in reference_dequant_gemm (reference_dequant_gemm)
    return torch.matmul(A, W_fp16)
           ~~~~~~~~~~~~^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
Step 1: torchdynamo done tracing reference_dequant_gemm (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py, line 220 in reference_dequant_gemm>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_35_6bfc55ab_8e30_414f_901f_b0974e56bd8b =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, L_W_int8_: "[31mi8[0m[34m[5120, 151936][0m[2m[34m[1, 5120][0m[2m[32mcuda:0[0m", L_scale_: "[31mf16[0m[34m[5120][0m[2m[34m[1][0m[2m[32mcuda:0[0m", s84: "Sym(s84)", L_A_: "[31mf16[0m[34m[1, s84, 5120][0m[2m[34m[5120*s84, 5120, 1][0m[2m[32mcuda:0[0m"):
        l_w_int8_ = L_W_int8_
        l_scale_ = L_scale_
        l_a_ = L_A_
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:219 in reference_dequant_gemm, code: W_fp16 = W_int8.to(torch.float16) * scale.view(-1, 1)[0m
        to: "[31mf16[0m[34m[5120, 151936][0m[2m[34m[1, 5120][0m[2m[32mcuda:0[0m" = l_w_int8_.to([34mtorch.float16[0m);  [2ml_w_int8_ = None[0m
        view: "[31mf16[0m[34m[5120, 1][0m[2m[34m[1, 1][0m[2m[32mcuda:0[0m" = l_scale_.view([34m-1[0m, [34m1[0m);  [2ml_scale_ = None[0m
        W_fp16: "[31mf16[0m[34m[5120, 151936][0m[2m[34m[1, 5120][0m[2m[32mcuda:0[0m" = to * view;  [2mto = view = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/matmulhell.py:220 in reference_dequant_gemm, code: return torch.matmul(A, W_fp16)[0m
        matmul: "[31mf16[0m[34m[1, s84, 151936][0m[2m[34m[151936*s84, 151936, 1][0m[2m[32mcuda:0[0m" = torch.matmul(l_a_, W_fp16);  [2ml_a_ = W_fp16 = None[0m
        return (matmul,)
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing nucleous_sample /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:501
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:501 in nucleous_sample (PIPELINE)
        @torch.compile
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:508 in nucleous_sample (PIPELINE.nucleous_sample)
            B, V = logits.shape
TRACE LOAD_FAST logits []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
wrap_to_fake L['logits'] (1, 151936) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='logits', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_logits_ L['logits'] FakeTensor(..., device='cuda:0', size=(1, 151936), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE UNPACK_SEQUENCE 2 [SizeVariable(length=2)]
TRACE STORE_FAST B [ConstantVariable(int: 151936), ConstantVariable(int: 1)]
TRACE STORE_FAST V [ConstantVariable(int: 151936)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:509 in nucleous_sample (PIPELINE.nucleous_sample)
            device = logits.device
TRACE LOAD_FAST logits []
TRACE LOAD_ATTR device [TensorVariable()]
TRACE STORE_FAST device [ConstantVariable(device: device(type='cuda', index=0))]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:510 in nucleous_sample (PIPELINE.nucleous_sample)
            dtype = logits.dtype
TRACE LOAD_FAST logits []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:513 in nucleous_sample (PIPELINE.nucleous_sample)
            temperature = temperature.view(-1, 1).to(device, dtype)
TRACE LOAD_FAST temperature []
TRACE LOAD_ATTR view [LazyVariableTracker()]
wrap_to_fake L['temperature'] (1, 1) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='temperature', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_temperature_ L['temperature'] FakeTensor(..., size=(1, 1)) at debug_level 0 before=False
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_CONST 1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), ConstantVariable(int: 1)]
TRACE FX call view from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:513 in nucleous_sample (PIPELINE.nucleous_sample)
        temperature = temperature.view(-1, 1).to(device, dtype)
                      ~~~~~~~~~~~~~~~~^^^^^^^
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST device [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_FAST dtype [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device: device(type='cuda', index=0))]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device: device(type='cuda', index=0)), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:513 in nucleous_sample (PIPELINE.nucleous_sample)
        temperature = temperature.view(-1, 1).to(device, dtype)
                      ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST temperature [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:515 in nucleous_sample (PIPELINE.nucleous_sample)
            temperature.masked_fill_(temperature == 0.0, 1.0)
TRACE LOAD_FAST temperature []
TRACE LOAD_ATTR masked_fill_ [TensorVariable()]
TRACE LOAD_FAST temperature [NullVariable, GetAttrVariable(TensorVariable(), masked_fill_)]
TRACE LOAD_CONST 0.0 [NullVariable, GetAttrVariable(TensorVariable(), masked_fill_), TensorVariable()]
TRACE COMPARE_OP == [NullVariable, GetAttrVariable(TensorVariable(), masked_fill_), TensorVariable(), ConstantVariable(float: 0.0)]
TRACE FX call eq from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:515 in nucleous_sample (PIPELINE.nucleous_sample)
        temperature.masked_fill_(temperature == 0.0, 1.0)
                                 ^^^^^^^^^^^^^^^^^^
TRACE LOAD_CONST 1.0 [NullVariable, GetAttrVariable(TensorVariable(), masked_fill_), TensorVariable()]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), masked_fill_), TensorVariable(), ConstantVariable(float: 1.0)]
TRACE FX call masked_fill_ from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:515 in nucleous_sample (PIPELINE.nucleous_sample)
        temperature.masked_fill_(temperature == 0.0, 1.0)
        ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:517 in nucleous_sample (PIPELINE.nucleous_sample)
            p = top_p.view(-1, 1).to(device, dtype)
TRACE LOAD_FAST top_p []
TRACE LOAD_ATTR view [LazyVariableTracker()]
wrap_to_fake L['top_p'] (1, 1) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='top_p', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_top_p_ L['top_p'] FakeTensor(..., size=(1, 1)) at debug_level 0 before=False
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_CONST 1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), ConstantVariable(int: 1)]
TRACE FX call view_1 from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:517 in nucleous_sample (PIPELINE.nucleous_sample)
        p = top_p.view(-1, 1).to(device, dtype)
            ~~~~~~~~~~^^^^^^^
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST device [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_FAST dtype [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device: device(type='cuda', index=0))]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device: device(type='cuda', index=0)), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_1 from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:517 in nucleous_sample (PIPELINE.nucleous_sample)
        p = top_p.view(-1, 1).to(device, dtype)
            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST p [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:520 in nucleous_sample (PIPELINE.nucleous_sample)
            probs = F.softmax(logits.to(torch.bfloat16), dim=-1)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR softmax [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST logits [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR to [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR bfloat16 [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_2 from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:520 in nucleous_sample (PIPELINE.nucleous_sample)
        probs = F.softmax(logits.to(torch.bfloat16), dim=-1)
                          ~~~~~~~~~^^^^^^^^^^^^^^^^
TRACE LOAD_CONST -1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: -1)]
TRACE FX call softmax from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:520 in nucleous_sample (PIPELINE.nucleous_sample)
        probs = F.softmax(logits.to(torch.bfloat16), dim=-1)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST probs [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:521 in nucleous_sample (PIPELINE.nucleous_sample)
            self.max_k = 1024
TRACE LOAD_CONST 1024 []
TRACE LOAD_FAST self [ConstantVariable(int: 1024)]
TRACE STORE_ATTR max_k [ConstantVariable(int: 1024), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:523 in nucleous_sample (PIPELINE.nucleous_sample)
            k = min(self.max_k, V)
TRACE LOAD_GLOBAL min []
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR max_k [NullVariable, LazyVariableTracker(), UserDefinedObjectVariable(PIPELINE)]
TRACE LOAD_FAST V [NullVariable, LazyVariableTracker(), ConstantVariable(int: 1024)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 1024), ConstantVariable(int: 151936)]
TRACE STORE_FAST k [ConstantVariable(int: 1024)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:524 in nucleous_sample (PIPELINE.nucleous_sample)
            topk_probs, topk_indices = torch.topk(probs, k, dim=-1, largest=True, sorted=True)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR topk [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST probs [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 1024)]
TRACE LOAD_CONST True [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 1024), ConstantVariable(int: -1)]
TRACE LOAD_CONST True [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 1024), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE KW_NAMES ('dim', 'largest', 'sorted') [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 1024), ConstantVariable(int: -1), ConstantVariable(bool: True), ConstantVariable(bool: True)]
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 1024), ConstantVariable(int: -1), ConstantVariable(bool: True), ConstantVariable(bool: True)]
TRACE FX call topk from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:524 in nucleous_sample (PIPELINE.nucleous_sample)
        topk_probs, topk_indices = torch.topk(probs, k, dim=-1, largest=True, sorted=True)
                                   ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE UNPACK_SEQUENCE 2 [NamedTupleVariable(length=2)]
TRACE STORE_FAST topk_probs [TensorVariable(), TensorVariable()]
TRACE STORE_FAST topk_indices [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:527 in nucleous_sample (PIPELINE.nucleous_sample)
            cum_probs = torch.cumsum(topk_probs, dim=-1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cumsum [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST topk_probs [NullVariable, LazyVariableTracker()]
TRACE LOAD_CONST -1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: -1)]
TRACE FX call cumsum from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:527 in nucleous_sample (PIPELINE.nucleous_sample)
        cum_probs = torch.cumsum(topk_probs, dim=-1)
                    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST cum_probs [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:531 in nucleous_sample (PIPELINE.nucleous_sample)
            mask = cum_probs > p
TRACE LOAD_FAST cum_probs []
TRACE LOAD_FAST p [TensorVariable()]
TRACE COMPARE_OP > [TensorVariable(), TensorVariable()]
TRACE FX call gt from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:531 in nucleous_sample (PIPELINE.nucleous_sample)
        mask = cum_probs > p
               ^^^^^^^^^^^^^
TRACE STORE_FAST mask [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:533 in nucleous_sample (PIPELINE.nucleous_sample)
            mask[..., 0] = False
TRACE LOAD_CONST False []
TRACE LOAD_FAST mask [ConstantVariable(bool: False)]
TRACE LOAD_CONST (Ellipsis, 0) [ConstantVariable(bool: False), TensorVariable()]
TRACE STORE_SUBSCR None [ConstantVariable(bool: False), TensorVariable(), TupleVariable(length=2)]
TRACE FX call setitem from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:533 in nucleous_sample (PIPELINE.nucleous_sample)
        mask[..., 0] = False
        ~~~~^^^^^^^^
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:535 in nucleous_sample (PIPELINE.nucleous_sample)
            mask[..., 1:] = mask[..., :-1].clone()
TRACE LOAD_FAST mask []
TRACE LOAD_CONST Ellipsis [TensorVariable()]
TRACE LOAD_CONST None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis)]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), ConstantVariable(int: -1)]
TRACE BUILD_TUPLE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SliceVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), TupleVariable(length=2)]
TRACE FX call getitem_2 from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:535 in nucleous_sample (PIPELINE.nucleous_sample)
        mask[..., 1:] = mask[..., :-1].clone()
                        ~~~~^^^^^^^^^^
TRACE LOAD_ATTR clone [TensorVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), clone)]
TRACE FX call clone from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:535 in nucleous_sample (PIPELINE.nucleous_sample)
        mask[..., 1:] = mask[..., :-1].clone()
                        ~~~~~~~~~~~~~~~~~~~~^^
TRACE LOAD_FAST mask [TensorVariable()]
TRACE LOAD_CONST Ellipsis [TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 1 [TensorVariable(), TensorVariable(), ConstantVariable(ellipsis: Ellipsis)]
TRACE LOAD_CONST None [TensorVariable(), TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 1)]
TRACE BUILD_SLICE 2 [TensorVariable(), TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 1), ConstantVariable(NoneType: None)]
TRACE BUILD_TUPLE 2 [TensorVariable(), TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SliceVariable()]
TRACE STORE_SUBSCR None [TensorVariable(), TensorVariable(), TupleVariable(length=2)]
TRACE FX call setitem_1 from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:535 in nucleous_sample (PIPELINE.nucleous_sample)
        mask[..., 1:] = mask[..., :-1].clone()
        ~~~~^^^^^^^^^
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:538 in nucleous_sample (PIPELINE.nucleous_sample)
            topk_probs.masked_fill_(mask, 0.0)
TRACE LOAD_FAST topk_probs []
TRACE LOAD_ATTR masked_fill_ [TensorVariable()]
TRACE LOAD_FAST mask [NullVariable, GetAttrVariable(TensorVariable(), masked_fill_)]
TRACE LOAD_CONST 0.0 [NullVariable, GetAttrVariable(TensorVariable(), masked_fill_), TensorVariable()]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), masked_fill_), TensorVariable(), ConstantVariable(float: 0.0)]
TRACE FX call masked_fill__1 from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:538 in nucleous_sample (PIPELINE.nucleous_sample)
        topk_probs.masked_fill_(mask, 0.0)
        ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:541 in nucleous_sample (PIPELINE.nucleous_sample)
            if not torch.all(temperature == 1.0):
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR all [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST temperature [NullVariable, LazyVariableTracker()]
TRACE LOAD_CONST 1.0 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE COMPARE_OP == [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1.0)]
TRACE FX call eq_1 from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:541 in nucleous_sample (PIPELINE.nucleous_sample)
        if not torch.all(temperature == 1.0):
                         ^^^^^^^^^^^^^^^^^^
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call all_1 from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:541 in nucleous_sample (PIPELINE.nucleous_sample)
        if not torch.all(temperature == 1.0):
               ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
TRACE POP_JUMP_IF_TRUE 762 [TensorVariable()]
Graph break in user code at /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:541
Graph Break Reason: Data-dependent branching
  Explanation: Detected data-dependent branching (e.g. `if my_tensor.sum() > 0:`). Dynamo does not support tracing dynamic control flow.
  Hint: This graph break is fundamental - it is unlikely that Dynamo will ever be able to trace through your code. Consider finding a workaround.
  Hint: Use `torch.cond` to express dynamic control flow.

  Developer debug context: attempted to jump with TensorVariable()

User code traceback:
  File "/home/client/Projects/RWKV-Infer/rwkv_server_fla_fastapi.py", line 1182, in <module>
    asyncio.run(main())
  File "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
  File "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/asyncio/base_events.py", line 678, in run_until_complete
    self.run_forever()
  File "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/asyncio/base_events.py", line 645, in run_forever
    self._run_once()
  File "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/asyncio/base_events.py", line 1999, in _run_once
    handle._run()
  File "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/home/client/Projects/RWKV-Infer/rwkvengine/rwkvinfer_fla.py", line 958, in RunLLM
    otokens = self.pipeline.nucleous_sample(BatchProbs, temperature=torch.stack(temperature), top_p=torch.stack(top_p)).tolist()
  File "/home/client/Projects/RWKV-Infer/rwkvengine/misc.py", line 541, in nucleous_sample
    if not torch.all(temperature == 1.0):

generic_jump triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='generic_jump TensorVariable()', user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/misc.py, line 541 in nucleous_sample>], graph_break=True)
TRACED GRAPH
 ===== __compiled_fn_37_a4f6185e_d81e_4f84_8be9_c4a68f24d7ed =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, L_logits_: "[31mbf16[0m[34m[1, 151936][0m[2m[34m[151936, 1][0m[2m[32mcuda:0[0m", L_temperature_: "[31mf32[0m[34m[1, 1][0m[2m[34m[1, 1][0m[2m[32mcpu[0m", L_top_p_: "[31mf32[0m[34m[1, 1][0m[2m[34m[1, 1][0m[2m[32mcpu[0m"):
        l_logits_ = L_logits_
        l_temperature_ = L_temperature_
        l_top_p_ = L_top_p_
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:513 in nucleous_sample, code: temperature = temperature.view(-1, 1).to(device, dtype)[0m
        view: "[31mf32[0m[34m[1, 1][0m[2m[34m[1, 1][0m[2m[32mcpu[0m" = l_temperature_.view([34m-1[0m, [34m1[0m);  [2ml_temperature_ = None[0m
        temperature: "[31mbf16[0m[34m[1, 1][0m[2m[34m[1, 1][0m[2m[32mcuda:0[0m" = view.to([34mdevice(type='cuda', index=0)[0m, [34mtorch.bfloat16[0m);  [2mview = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:515 in nucleous_sample, code: temperature.masked_fill_(temperature == 0.0, 1.0)[0m
        eq: "[31mb8[0m[34m[1, 1][0m[2m[34m[1, 1][0m[2m[32mcuda:0[0m" = temperature.__eq__([34m0.0[0m)
        masked_fill_: "[31mbf16[0m[34m[1, 1][0m[2m[34m[1, 1][0m[2m[32mcuda:0[0m" = temperature.masked_fill_(eq, [34m1.0[0m);  [2meq = masked_fill_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:517 in nucleous_sample, code: p = top_p.view(-1, 1).to(device, dtype)[0m
        view_1: "[31mf32[0m[34m[1, 1][0m[2m[34m[1, 1][0m[2m[32mcpu[0m" = l_top_p_.view([34m-1[0m, [34m1[0m);  [2ml_top_p_ = None[0m
        p: "[31mbf16[0m[34m[1, 1][0m[2m[34m[1, 1][0m[2m[32mcuda:0[0m" = view_1.to([34mdevice(type='cuda', index=0)[0m, [34mtorch.bfloat16[0m);  [2mview_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:520 in nucleous_sample, code: probs = F.softmax(logits.to(torch.bfloat16), dim=-1)[0m
        to_2: "[31mbf16[0m[34m[1, 151936][0m[2m[34m[151936, 1][0m[2m[32mcuda:0[0m" = l_logits_.to([34mtorch.bfloat16[0m);  [2ml_logits_ = None[0m
        probs: "[31mbf16[0m[34m[1, 151936][0m[2m[34m[151936, 1][0m[2m[32mcuda:0[0m" = torch.nn.functional.softmax(to_2, dim = [34m-1[0m);  [2mto_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:524 in nucleous_sample, code: topk_probs, topk_indices = torch.topk(probs, k, dim=-1, largest=True, sorted=True)[0m
        topk = torch.topk(probs, [34m1024[0m, dim = [34m-1[0m, largest = [34mTrue[0m, sorted = [34mTrue[0m);  [2mprobs = None[0m
        topk_probs: "[31mbf16[0m[34m[1, 1024][0m[2m[34m[1024, 1][0m[2m[32mcuda:0[0m" = topk[[34m0[0m]
        topk_indices: "[31mi64[0m[34m[1, 1024][0m[2m[34m[1024, 1][0m[2m[32mcuda:0[0m" = topk[[34m1[0m];  [2mtopk = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:527 in nucleous_sample, code: cum_probs = torch.cumsum(topk_probs, dim=-1)[0m
        cum_probs: "[31mbf16[0m[34m[1, 1024][0m[2m[34m[1024, 1][0m[2m[32mcuda:0[0m" = torch.cumsum(topk_probs, dim = [34m-1[0m)
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:531 in nucleous_sample, code: mask = cum_probs > p[0m
        mask: "[31mb8[0m[34m[1, 1024][0m[2m[34m[1024, 1][0m[2m[32mcuda:0[0m" = cum_probs > p;  [2mcum_probs = p = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:533 in nucleous_sample, code: mask[..., 0] = False[0m
        mask[([34mEllipsis[0m, [34m0[0m)] = [34mFalse[0m;  setitem = mask;  [2msetitem = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:535 in nucleous_sample, code: mask[..., 1:] = mask[..., :-1].clone()[0m
        getitem_2: "[31mb8[0m[34m[1, 1023][0m[2m[34m[1024, 1][0m[2m[32mcuda:0[0m" = mask[([34mEllipsis[0m, slice([34mNone[0m, [34m-1[0m, [34mNone[0m))]
        clone: "[31mb8[0m[34m[1, 1023][0m[2m[34m[1023, 1][0m[2m[32mcuda:0[0m" = getitem_2.clone();  [2mgetitem_2 = None[0m
        mask[([34mEllipsis[0m, slice([34m1[0m, [34mNone[0m, [34mNone[0m))] = clone;  setitem_1 = mask;  [2mclone = setitem_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:538 in nucleous_sample, code: topk_probs.masked_fill_(mask, 0.0)[0m
        masked_fill__1: "[31mbf16[0m[34m[1, 1024][0m[2m[34m[1024, 1][0m[2m[32mcuda:0[0m" = topk_probs.masked_fill_(mask, [34m0.0[0m);  [2mmask = masked_fill__1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:541 in nucleous_sample, code: if not torch.all(temperature == 1.0):[0m
        eq_1: "[31mb8[0m[34m[1, 1][0m[2m[34m[1, 1][0m[2m[32mcuda:0[0m" = temperature.__eq__([34m1.0[0m)
        all_1: "[31mb8[0m[34m[][0m[2m[34m[][0m[2m[32mcuda:0[0m" = torch.all(eq_1);  [2meq_1 = None[0m
        return (all_1, temperature, topk_probs, topk_indices)
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing torch_dynamo_resume_in_nucleous_sample_at_541 /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:541
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:541 in torch_dynamo_resume_in_nucleous_sample_at_541 (PIPELINE.nucleous_sample)
            if not torch.all(temperature == 1.0):
TRACE RESUME 0 []
TRACE LOAD_CONST True []
TRACE STORE_FAST __is_tracing_resume_prologue [ConstantVariable(bool: True)]
TRACE LOAD_CONST False []
TRACE STORE_FAST __is_tracing_resume_prologue [ConstantVariable(bool: False)]
TRACE JUMP_FORWARD 774 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:545 in torch_dynamo_resume_in_nucleous_sample_at_541 (PIPELINE.nucleous_sample)
            topk_probs.div_(topk_probs.sum(dim=-1, keepdim=True))
TRACE LOAD_FAST topk_probs []
TRACE LOAD_ATTR div_ [LazyVariableTracker()]
wrap_to_fake L['topk_probs'] (1, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='topk_probs', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_topk_probs_ L['topk_probs'] FakeTensor(..., device='cuda:0', size=(1, 1024), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE LOAD_FAST topk_probs [NullVariable, GetAttrVariable(TensorVariable(), div_)]
TRACE LOAD_ATTR sum [NullVariable, GetAttrVariable(TensorVariable(), div_), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), div_), NullVariable, GetAttrVariable(TensorVariable(), sum)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), div_), NullVariable, GetAttrVariable(TensorVariable(), sum), ConstantVariable(int: -1)]
TRACE KW_NAMES ('dim', 'keepdim') [NullVariable, GetAttrVariable(TensorVariable(), div_), NullVariable, GetAttrVariable(TensorVariable(), sum), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), div_), NullVariable, GetAttrVariable(TensorVariable(), sum), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call sum_1 from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:545 in torch_dynamo_resume_in_nucleous_sample_at_541 (PIPELINE.nucleous_sample)
        topk_probs.div_(topk_probs.sum(dim=-1, keepdim=True))
                        ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), div_), TensorVariable()]
TRACE FX call div_ from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:545 in torch_dynamo_resume_in_nucleous_sample_at_541 (PIPELINE.nucleous_sample)
        topk_probs.div_(topk_probs.sum(dim=-1, keepdim=True))
        ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:549 in torch_dynamo_resume_in_nucleous_sample_at_541 (PIPELINE.nucleous_sample)
            idx_in_topk = torch.multinomial(topk_probs, num_samples=1).squeeze(-1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR multinomial [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST topk_probs [NullVariable, LazyVariableTracker()]
TRACE LOAD_CONST 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE KW_NAMES ('num_samples',) [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 1)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 1)]
TRACE FX call multinomial from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:549 in torch_dynamo_resume_in_nucleous_sample_at_541 (PIPELINE.nucleous_sample)
        idx_in_topk = torch.multinomial(topk_probs, num_samples=1).squeeze(-1)
                      ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR squeeze [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), squeeze)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), squeeze), ConstantVariable(int: -1)]
TRACE FX call squeeze from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:549 in torch_dynamo_resume_in_nucleous_sample_at_541 (PIPELINE.nucleous_sample)
        idx_in_topk = torch.multinomial(topk_probs, num_samples=1).squeeze(-1)
                      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^
TRACE STORE_FAST idx_in_topk [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:550 in torch_dynamo_resume_in_nucleous_sample_at_541 (PIPELINE.nucleous_sample)
            samples = topk_indices.gather(1, idx_in_topk.unsqueeze(-1)).squeeze(-1)
TRACE LOAD_FAST topk_indices []
TRACE LOAD_ATTR gather [LazyVariableTracker()]
wrap_to_fake L['topk_indices'] (1, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='topk_indices', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_topk_indices_ L['topk_indices'] FakeTensor(..., device='cuda:0', size=(1, 1024), dtype=torch.int64) at debug_level 0 before=False
TRACE LOAD_CONST 1 [NullVariable, GetAttrVariable(TensorVariable(), gather)]
TRACE LOAD_FAST idx_in_topk [NullVariable, GetAttrVariable(TensorVariable(), gather), ConstantVariable(int: 1)]
TRACE LOAD_ATTR unsqueeze [NullVariable, GetAttrVariable(TensorVariable(), gather), ConstantVariable(int: 1), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), gather), ConstantVariable(int: 1), NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), gather), ConstantVariable(int: 1), NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int: -1)]
TRACE FX call unsqueeze from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:550 in torch_dynamo_resume_in_nucleous_sample_at_541 (PIPELINE.nucleous_sample)
        samples = topk_indices.gather(1, idx_in_topk.unsqueeze(-1)).squeeze(-1)
                                         ~~~~~~~~~~~~~~~~~~~~~^^^^
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), gather), ConstantVariable(int: 1), TensorVariable()]
TRACE FX call gather from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:550 in torch_dynamo_resume_in_nucleous_sample_at_541 (PIPELINE.nucleous_sample)
        samples = topk_indices.gather(1, idx_in_topk.unsqueeze(-1)).squeeze(-1)
                  ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR squeeze [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), squeeze)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), squeeze), ConstantVariable(int: -1)]
TRACE FX call squeeze_1 from /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:550 in torch_dynamo_resume_in_nucleous_sample_at_541 (PIPELINE.nucleous_sample)
        samples = topk_indices.gather(1, idx_in_topk.unsqueeze(-1)).squeeze(-1)
                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^
TRACE STORE_FAST samples [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:552 in torch_dynamo_resume_in_nucleous_sample_at_541 (PIPELINE.nucleous_sample)
            return samples
TRACE LOAD_FAST samples []
TRACE RETURN_VALUE None [TensorVariable()]
Step 1: torchdynamo done tracing torch_dynamo_resume_in_nucleous_sample_at_541 (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/misc.py, line 552 in torch_dynamo_resume_in_nucleous_sample_at_541>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_41_a6ddd413_c89f_4d14_bdd3_dc0f91fd3cd7 =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, L_topk_probs_: "[31mbf16[0m[34m[1, 1024][0m[2m[34m[1024, 1][0m[2m[32mcuda:0[0m", L_topk_indices_: "[31mi64[0m[34m[1, 1024][0m[2m[34m[1024, 1][0m[2m[32mcuda:0[0m"):
        l_topk_probs_ = L_topk_probs_
        l_topk_indices_ = L_topk_indices_
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:545 in torch_dynamo_resume_in_nucleous_sample_at_541, code: topk_probs.div_(topk_probs.sum(dim=-1, keepdim=True))[0m
        sum_1: "[31mbf16[0m[34m[1, 1][0m[2m[34m[1, 1][0m[2m[32mcuda:0[0m" = l_topk_probs_.sum(dim = [34m-1[0m, keepdim = [34mTrue[0m)
        div_: "[31mbf16[0m[34m[1, 1024][0m[2m[34m[1024, 1][0m[2m[32mcuda:0[0m" = l_topk_probs_.div_(sum_1);  [2msum_1 = div_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:549 in torch_dynamo_resume_in_nucleous_sample_at_541, code: idx_in_topk = torch.multinomial(topk_probs, num_samples=1).squeeze(-1)[0m
        multinomial: "[31mi64[0m[34m[1, 1][0m[2m[34m[1, 1][0m[2m[32mcuda:0[0m" = torch.multinomial(l_topk_probs_, num_samples = [34m1[0m);  [2ml_topk_probs_ = None[0m
        idx_in_topk: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = multinomial.squeeze([34m-1[0m);  [2mmultinomial = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/misc.py:550 in torch_dynamo_resume_in_nucleous_sample_at_541, code: samples = topk_indices.gather(1, idx_in_topk.unsqueeze(-1)).squeeze(-1)[0m
        unsqueeze: "[31mi64[0m[34m[1, 1][0m[2m[34m[1, 1][0m[2m[32mcuda:0[0m" = idx_in_topk.unsqueeze([34m-1[0m);  [2midx_in_topk = None[0m
        gather: "[31mi64[0m[34m[1, 1][0m[2m[34m[1, 1][0m[2m[32mcuda:0[0m" = l_topk_indices_.gather([34m1[0m, unsqueeze);  [2ml_topk_indices_ = unsqueeze = None[0m
        samples: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = gather.squeeze([34m-1[0m);  [2mgather = None[0m
        return (samples,)
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing hxa079_TimeMix /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:524
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:524 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7)
        @torch.compile
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:550 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            x = T5RMSNorm(x_in,ln1,variance_epsilon=rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST x_in [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE KW_NAMES ('variance_epsilon',) [NullVariable, LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:550 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        x = T5RMSNorm(x_in,ln1,variance_epsilon=rmsnorm_epsilon)
            ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
automatic dynamic stride L['x_in'] stride(0) InferStride(dim=2) != InferStride(dim=1)
wrap_to_fake L['x_in'] (1, 1, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='x_in', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_x_in_ L['x_in'] FakeTensor(..., device='cuda:0', size=(1, 1, 5120), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE FX call add from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln1'] (5120,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln1', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln1_ L['ln1'] FakeTensor(..., device='cuda:0', size=(5120,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:551 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            xw,xa,xv,xg,xk = (x @ wavgk1).split(wavgk_split_list, dim=-1)
TRACE LOAD_FAST x []
TRACE LOAD_FAST wavgk1 [TensorVariable()]
TRACE BINARY_OP 4 [TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['wavgk1'] (5120, 1376) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='wavgk1', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_wavgk1_ L['wavgk1'] FakeTensor(..., device='cuda:0', size=(5120, 1376), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call matmul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:551 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xw,xa,xv,xg,xk = (x @ wavgk1).split(wavgk_split_list, dim=-1)
                          ~~^~~~~~~~
TRACE LOAD_ATTR split [TensorVariable()]
TRACE LOAD_FAST wavgk_split_list [NullVariable, GetAttrVariable(TensorVariable(), split)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker()]
TRACE KW_NAMES ('dim',) [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE FX call split from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:551 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xw,xa,xv,xg,xk = (x @ wavgk1).split(wavgk_split_list, dim=-1)
                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE UNPACK_SEQUENCE 5 [TupleVariable(length=5)]
TRACE STORE_FAST xw [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST xa [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST xv [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST xg [TensorVariable(), TensorVariable()]
TRACE STORE_FAST xk [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:553 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            B, T, HN = x.shape
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 3 [SizeVariable(length=3)]
TRACE STORE_FAST B [ConstantVariable(int: 5120), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 5120), ConstantVariable(int: 1)]
TRACE STORE_FAST HN [ConstantVariable(int: 5120)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:555 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            rkv = fpx_matmul(x, RKV_,RKV_state, ebits, mbits)
TRACE LOAD_GLOBAL fpx_matmul []
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST RKV_ [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST RKV_state [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_FAST ebits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST mbits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call fpx_matmul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:555 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        rkv = fpx_matmul(x, RKV_,RKV_state, ebits, mbits)
              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object fpx_matmul at 0x3063a810, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:420 in fpx_matmul (fpx_matmul) (inline depth: 1)
    def fpx_matmul(x,weight,weight_state,ebits:int=3,mbits:int=2):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:421 in fpx_matmul (fpx_matmul) (inline depth: 1)
        if ebits == -44: #hqq
TRACE LOAD_FAST ebits []
TRACE LOAD_CONST -44 [LazyVariableTracker()]
TRACE COMPARE_OP == [LazyVariableTracker(), ConstantVariable(int: -44)]
TRACE POP_JUMP_IF_FALSE 322 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S0=x.shape[0]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 0 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 0)]
TRACE STORE_FAST S0 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S1=x.shape[1]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 1)]
TRACE STORE_FAST S1 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:424 in fpx_matmul (fpx_matmul) (inline depth: 1)
            dtype = x.dtype
TRACE LOAD_FAST x []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
            x = x.to(dtype=torch.float16).view(-1,x.shape[2])
TRACE LOAD_FAST x []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float16 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_2 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST x [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1)]
TRACE LOAD_ATTR shape [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3), ConstantVariable(int: 2)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), ConstantVariable(int: 5120)]
TRACE FX call view from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
            out = weight.forward_manual(x).to(dtype=dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_ATTR forward_manual [LazyVariableTracker()]
TRACE LOAD_FAST x [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE CALL 1 [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton)), TensorVariable()]
TRACE inlined call forward_manual from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:543 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        def forward_manual(self, x: Tensor, matmul_type: str="GEMM") -> Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE LOAD_GLOBAL forward_functional []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:545 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                x,
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:546 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.bias,
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR bias [NullVariable, LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_tensor_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_ATTR get_tensor_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_tensor_args at 0x70c98a9e9080>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_tensor_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_tensor_args(),
            ~~~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:524 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
        def get_tensor_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:525 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
            return [self.W_q, self.scales, self.zeros]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR W_q [UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_FAST self [LazyVariableTracker()]
TRACE LOAD_ATTR scales [LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['RKV_']._parameters['scales'] (80, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='RKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='scales'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_RKV_parameters_scales_ L['RKV_']._parameters['scales'] Parameter(FakeTensor(..., device='cuda:0', size=(80, 10240), dtype=torch.float16)) at debug_level 0 before=False
TRACE LOAD_FAST self [LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR zeros [LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['RKV_']._parameters['zeros'] (80, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='RKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='zeros'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_RKV_parameters_zeros_ L['RKV_']._parameters['zeros'] Parameter(FakeTensor(..., device='cuda:0', size=(80, 10240), dtype=torch.float16)) at debug_level 0 before=False
TRACE BUILD_LIST 3 [LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [ListVariable(length=3)]
DONE INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_meta_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3)]
TRACE LOAD_ATTR get_meta_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_meta_args at 0x70c98a9e9120>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_meta_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_meta_args(),
            ~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:527 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
        def get_meta_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE LOAD_GLOBAL int []
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR scaled_activations [NullVariable, LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:529 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_nbits,
TRACE LOAD_FAST self [ConstantVariable(int: 0)]
TRACE LOAD_ATTR W_nbits [ConstantVariable(int: 0), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:530 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.group_size,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker()]
TRACE LOAD_ATTR group_size [ConstantVariable(int: 0), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:531 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.unpack_mask,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR unpack_mask [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:532 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.elements_per_sample,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR elements_per_sample [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:533 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.input_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR input_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:534 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.output_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR output_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:535 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.acc_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR acc_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:536 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.meta_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR meta_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:537 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.channel_scale_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR channel_scale_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:538 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_group_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR W_group_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:539 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    int(self.data_contiguous),
TRACE LOAD_GLOBAL int [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int)]
TRACE LOAD_ATTR data_contiguous [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE BUILD_LIST 12 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [ListVariable(length=12)]
DONE INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:549 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
TRACE LOAD_GLOBAL GEMLITE_MATMUL_TYPES_MAPPING [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12)]
TRACE LOAD_FAST matmul_type [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker(), ConstantVariable(str: 'GEMM')]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        return forward_functional(
               ~~~~~~~~~~~~~~~~~~^
            x,
            ^^
            self.bias,
            ^^^^^^^^^^
            self.get_tensor_args(),
            ^^^^^^^^^^^^^^^^^^^^^^^
            self.get_meta_args(),
            ^^^^^^^^^^^^^^^^^^^^^
            GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:675 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        def __call__(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
            return self._opoverload(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR _opoverload [NullVariable, UserDefinedObjectVariable(CustomOpDef)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=5)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
wrap_to_fake L['RKV_'].W_q (640, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=AttrSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='RKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='W_q'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_RKV_W_q L['RKV_'].W_q FakeTensor(..., device='cuda:0', size=(640, 10240), dtype=torch.int32) at debug_level 0 before=False
TRACE FX call forward_functional_default from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        return self._opoverload(*args, **kwargs)
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_3 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE STORE_FAST out [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
            return out.view(S0,S1,-1)
TRACE LOAD_FAST out []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST S0 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST S1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: -1)]
TRACE FX call view_1 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
        return out.view(S0,S1,-1)
               ~~~~~~~~^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object fpx_matmul at 0x3063a810, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>
TRACE STORE_FAST rkv [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:556 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            r,k,v = rkv.split(rkv_split_list,dim=-1)
TRACE LOAD_FAST rkv []
TRACE LOAD_ATTR split [TensorVariable()]
TRACE LOAD_FAST rkv_split_list [NullVariable, GetAttrVariable(TensorVariable(), split)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker()]
TRACE KW_NAMES ('dim',) [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE FX call split_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:556 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        r,k,v = rkv.split(rkv_split_list,dim=-1)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
TRACE UNPACK_SEQUENCE 3 [TupleVariable(length=3)]
TRACE STORE_FAST r [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST k [TensorVariable(), TensorVariable()]
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:558 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            kv_dim = k.shape[2] # B,T,kv_dim
TRACE LOAD_FAST k []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 2 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 2)]
TRACE STORE_FAST kv_dim [ConstantVariable(int: 1024)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:559 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            kv_repeat = H*N // kv_dim
TRACE LOAD_FAST H []
TRACE LOAD_FAST N [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST kv_dim [ConstantVariable(int: 8192)]
TRACE BINARY_OP 2 [ConstantVariable(int: 8192), ConstantVariable(int: 1024)]
TRACE STORE_FAST kv_repeat [ConstantVariable(int: 8)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:560 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            kv_per_head = kv_dim // N
TRACE LOAD_FAST kv_dim []
TRACE LOAD_FAST N [ConstantVariable(int: 1024)]
TRACE BINARY_OP 2 [ConstantVariable(int: 1024), ConstantVariable(int: 128)]
TRACE STORE_FAST kv_per_head [ConstantVariable(int: 8)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:562 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            r = r.add_(R_bias)
TRACE LOAD_FAST r []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST R_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
wrap_to_fake L['R_bias'] () StatefulSymbolicContext(dynamic_sizes=[], dynamic_strides=[], constraint_sizes=[], constraint_strides=[], specialize_on=[], view_base_context=None, tensor_source=LocalSource(local_name='R_bias', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_R_bias_ L['R_bias'] FakeTensor(..., device='cuda:0', size=(), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call add_ from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:562 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        r = r.add_(R_bias)
            ~~~~~~^^^^^^^^
TRACE STORE_FAST r [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:563 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = k.add_(K_bias).view(B, T, kv_per_head, N)
TRACE LOAD_FAST k []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST K_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
TRACE FX call add__1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:563 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = k.add_(K_bias).view(B, T, kv_per_head, N)
            ~~~~~~^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_per_head [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:563 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = k.add_(K_bias).view(B, T, kv_per_head, N)
            ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:564 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            v = v.add_(V_bias).view(B, T, kv_per_head, N)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST V_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
TRACE FX call add__2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:564 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        v = v.add_(V_bias).view(B, T, kv_per_head, N)
            ~~~~~~^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_per_head [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:564 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        v = v.add_(V_bias).view(B, T, kv_per_head, N)
            ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:568 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            if ln_r is None:
TRACE LOAD_FAST ln_r []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
wrap_to_fake L['ln_r'] (128,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln_r', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln_r_ L['ln_r'] FakeTensor(..., device='cuda:0', size=(128,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE POP_JUMP_IF_TRUE 478 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:572 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
                r = T5RMSNorm(r.view(B,T,H,N), ln_r, variance_epsilon=rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST r [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR view [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:572 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            r = T5RMSNorm(r.view(B,T,H,N), ln_r, variance_epsilon=rmsnorm_epsilon)
                          ~~~~~~^^^^^^^^^
TRACE LOAD_FAST ln_r [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE KW_NAMES ('variance_epsilon',) [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:572 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            r = T5RMSNorm(r.view(B,T,H,N), ln_r, variance_epsilon=rmsnorm_epsilon)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST r [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:573 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
                k = T5RMSNorm(k, ln_k, variance_epsilon=rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln_k [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE KW_NAMES ('variance_epsilon',) [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ConstantVariable(float: 1e-06)]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:573 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = T5RMSNorm(k, ln_k, variance_epsilon=rmsnorm_epsilon)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln_k'] (128,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln_k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln_k_ L['ln_k'] FakeTensor(..., device='cuda:0', size=(128,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:576 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            cos, sin = calc_cos.to(k.dtype), calc_sin.to(k.dtype)
TRACE LOAD_FAST calc_cos []
TRACE LOAD_ATTR to [LazyVariableTracker()]
automatic dynamic stride L['calc_cos'] stride(0) InferStride(dim=2) != InferStride(dim=1)
wrap_to_fake L['calc_cos'] (1, 1, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='calc_cos', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_calc_cos_ L['calc_cos'] FakeTensor(..., device='cuda:0', size=(1, 1, 128)) at debug_level 0 before=False
TRACE LOAD_FAST k [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR dtype [NullVariable, GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_8 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:576 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        cos, sin = calc_cos.to(k.dtype), calc_sin.to(k.dtype)
                   ~~~~~~~~~~~^^^^^^^^^
TRACE LOAD_FAST calc_sin [TensorVariable()]
TRACE LOAD_ATTR to [TensorVariable(), LazyVariableTracker()]
automatic dynamic stride L['calc_sin'] stride(0) InferStride(dim=2) != InferStride(dim=1)
wrap_to_fake L['calc_sin'] (1, 1, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='calc_sin', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_calc_sin_ L['calc_sin'] FakeTensor(..., device='cuda:0', size=(1, 1, 128)) at debug_level 0 before=False
TRACE LOAD_FAST k [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR dtype [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE CALL 1 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_9 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:576 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        cos, sin = calc_cos.to(k.dtype), calc_sin.to(k.dtype)
                                         ~~~~~~~~~~~^^^^^^^^^
TRACE STORE_FAST sin [TensorVariable(), TensorVariable()]
TRACE STORE_FAST cos [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:577 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            r, k = apply_rotary_pos_emb(r, k, cos, sin,unsqueeze_dim=2)
TRACE LOAD_GLOBAL apply_rotary_pos_emb []
TRACE LOAD_FAST r [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST cos [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST sin [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE KW_NAMES ('unsqueeze_dim',) [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(int: 2)]
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(int: 2)]
TRACE inlined call apply_rotary_pos_emb from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:577 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        r, k = apply_rotary_pos_emb(r, k, cos, sin,unsqueeze_dim=2)
               ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object apply_rotary_pos_emb at 0x70c98a344710, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 473>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:473 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    def apply_rotary_pos_emb(q, k, cos, sin, position_ids=None, unsqueeze_dim=1):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:493 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
        cos = cos.unsqueeze(unsqueeze_dim)
TRACE LOAD_FAST cos []
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_FAST unsqueeze_dim [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int: 2)]
TRACE FX call unsqueeze from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:493 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    cos = cos.unsqueeze(unsqueeze_dim)
          ~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST cos [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:494 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
        sin = sin.unsqueeze(unsqueeze_dim)
TRACE LOAD_FAST sin []
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_FAST unsqueeze_dim [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int: 2)]
TRACE FX call unsqueeze_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:494 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    sin = sin.unsqueeze(unsqueeze_dim)
          ~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST sin [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
        q_embed = (q * cos) + (rotate_half(q) * sin)
TRACE LOAD_FAST q []
TRACE LOAD_FAST cos [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    q_embed = (q * cos) + (rotate_half(q) * sin)
               ~~^~~~~
TRACE LOAD_GLOBAL rotate_half [TensorVariable()]
TRACE LOAD_FAST q [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE inlined call rotate_half from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    q_embed = (q * cos) + (rotate_half(q) * sin)
                           ~~~~~~~~~~~^^^
INLINING <code object rotate_half at 0x70c98a344450, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 467>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:467 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    def rotate_half(x):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
        x1 = x[..., : x.shape[-1] // 2]
TRACE LOAD_FAST x []
TRACE LOAD_CONST Ellipsis [TensorVariable()]
TRACE LOAD_CONST None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis)]
TRACE LOAD_FAST x [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None)]
TRACE LOAD_ATTR shape [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), SizeVariable(length=4)]
TRACE BINARY_SUBSCR None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), SizeVariable(length=4), ConstantVariable(int: -1)]
TRACE LOAD_CONST 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), ConstantVariable(int: 128)]
TRACE BINARY_OP 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), ConstantVariable(int: 128), ConstantVariable(int: 2)]
TRACE BUILD_SLICE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), ConstantVariable(int: 64)]
TRACE BUILD_TUPLE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SliceVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), TupleVariable(length=2)]
TRACE FX call getitem_8 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    x1 = x[..., : x.shape[-1] // 2]
         ~^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST x1 [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
        x2 = x[..., x.shape[-1] // 2 :]
TRACE LOAD_FAST x []
TRACE LOAD_CONST Ellipsis [TensorVariable()]
TRACE LOAD_FAST x [TensorVariable(), ConstantVariable(ellipsis: Ellipsis)]
TRACE LOAD_ATTR shape [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SizeVariable(length=4)]
TRACE BINARY_SUBSCR None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SizeVariable(length=4), ConstantVariable(int: -1)]
TRACE LOAD_CONST 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 128)]
TRACE BINARY_OP 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 128), ConstantVariable(int: 2)]
TRACE LOAD_CONST None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 64)]
TRACE BUILD_SLICE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 64), ConstantVariable(NoneType: None)]
TRACE BUILD_TUPLE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SliceVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), TupleVariable(length=2)]
TRACE FX call getitem_9 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    x2 = x[..., x.shape[-1] // 2 :]
         ~^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST x2 [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
        return torch.cat((-x2, x1), dim=-1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST x2 [NullVariable, LazyVariableTracker()]
TRACE UNARY_NEGATIVE None [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call neg from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    return torch.cat((-x2, x1), dim=-1)
                      ^^^
TRACE LOAD_FAST x1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, LazyVariableTracker(), TupleVariable(length=2)]
TRACE KW_NAMES ('dim',) [NullVariable, LazyVariableTracker(), TupleVariable(length=2), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TupleVariable(length=2), ConstantVariable(int: -1)]
TRACE FX call cat from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    return torch.cat((-x2, x1), dim=-1)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object rotate_half at 0x70c98a344450, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 467>
TRACE LOAD_FAST sin [TensorVariable(), TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call mul_7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    q_embed = (q * cos) + (rotate_half(q) * sin)
                           ~~~~~~~~~~~~~~~^~~~~
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable()]
TRACE FX call add_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    q_embed = (q * cos) + (rotate_half(q) * sin)
              ~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST q_embed [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
        k_embed = (k * cos) + (rotate_half(k) * sin)
TRACE LOAD_FAST k []
TRACE LOAD_FAST cos [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_8 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    k_embed = (k * cos) + (rotate_half(k) * sin)
               ~~^~~~~
TRACE LOAD_GLOBAL rotate_half [TensorVariable()]
TRACE LOAD_FAST k [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE inlined call rotate_half from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    k_embed = (k * cos) + (rotate_half(k) * sin)
                           ~~~~~~~~~~~^^^
INLINING <code object rotate_half at 0x70c98a344450, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 467>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:467 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    def rotate_half(x):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
        x1 = x[..., : x.shape[-1] // 2]
TRACE LOAD_FAST x []
TRACE LOAD_CONST Ellipsis [TensorVariable()]
TRACE LOAD_CONST None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis)]
TRACE LOAD_FAST x [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None)]
TRACE LOAD_ATTR shape [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), SizeVariable(length=4)]
TRACE BINARY_SUBSCR None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), SizeVariable(length=4), ConstantVariable(int: -1)]
TRACE LOAD_CONST 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), ConstantVariable(int: 128)]
TRACE BINARY_OP 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), ConstantVariable(int: 128), ConstantVariable(int: 2)]
TRACE BUILD_SLICE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), ConstantVariable(int: 64)]
TRACE BUILD_TUPLE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SliceVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), TupleVariable(length=2)]
TRACE FX call getitem_10 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    x1 = x[..., : x.shape[-1] // 2]
         ~^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST x1 [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
        x2 = x[..., x.shape[-1] // 2 :]
TRACE LOAD_FAST x []
TRACE LOAD_CONST Ellipsis [TensorVariable()]
TRACE LOAD_FAST x [TensorVariable(), ConstantVariable(ellipsis: Ellipsis)]
TRACE LOAD_ATTR shape [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SizeVariable(length=4)]
TRACE BINARY_SUBSCR None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SizeVariable(length=4), ConstantVariable(int: -1)]
TRACE LOAD_CONST 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 128)]
TRACE BINARY_OP 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 128), ConstantVariable(int: 2)]
TRACE LOAD_CONST None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 64)]
TRACE BUILD_SLICE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 64), ConstantVariable(NoneType: None)]
TRACE BUILD_TUPLE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SliceVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), TupleVariable(length=2)]
TRACE FX call getitem_11 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    x2 = x[..., x.shape[-1] // 2 :]
         ~^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST x2 [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
        return torch.cat((-x2, x1), dim=-1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST x2 [NullVariable, LazyVariableTracker()]
TRACE UNARY_NEGATIVE None [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call neg_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    return torch.cat((-x2, x1), dim=-1)
                      ^^^
TRACE LOAD_FAST x1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, LazyVariableTracker(), TupleVariable(length=2)]
TRACE KW_NAMES ('dim',) [NullVariable, LazyVariableTracker(), TupleVariable(length=2), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TupleVariable(length=2), ConstantVariable(int: -1)]
TRACE FX call cat_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    return torch.cat((-x2, x1), dim=-1)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object rotate_half at 0x70c98a344450, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 467>
TRACE LOAD_FAST sin [TensorVariable(), TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call mul_9 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    k_embed = (k * cos) + (rotate_half(k) * sin)
                           ~~~~~~~~~~~~~~~^~~~~
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable()]
TRACE FX call add_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    k_embed = (k * cos) + (rotate_half(k) * sin)
              ~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST k_embed [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:497 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
        return q_embed, k_embed
TRACE LOAD_FAST q_embed []
TRACE LOAD_FAST k_embed [TensorVariable()]
TRACE BUILD_TUPLE 2 [TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object apply_rotary_pos_emb at 0x70c98a344710, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 473>
TRACE UNPACK_SEQUENCE 2 [TupleVariable(length=2)]
TRACE STORE_FAST r [TensorVariable(), TensorVariable()]
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:579 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            if layer_id == 0:
TRACE LOAD_FAST layer_id []
TRACE LOAD_CONST 0 [LazyVariableTracker()]
TRACE COMPARE_OP == [LazyVariableTracker(), ConstantVariable(int: 0)]
create_graph_input L_layer_id_ L['layer_id'] s56 at debug_level 0 before=False
TRACE FX call eq from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:579 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        if layer_id == 0:
           ^^^^^^^^^^^^^
TRACE POP_JUMP_IF_FALSE 736 [SymNodeVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:580 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
                v_first = v
TRACE LOAD_FAST v []
TRACE STORE_FAST v_first [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:581 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
                k_first = k
TRACE LOAD_FAST k []
TRACE STORE_FAST k_first [TensorVariable()]
TRACE JUMP_FORWARD 952 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:589 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = repeat_kv(k, kv_repeat).view(B, T, -1)
TRACE LOAD_GLOBAL repeat_kv []
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST kv_repeat [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 8)]
TRACE inlined call repeat_kv from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:589 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = repeat_kv(k, kv_repeat).view(B, T, -1)
            ~~~~~~~~~^^^^^^^^^^^^^^
INLINING <code object repeat_kv at 0x70c98a2f25b0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 347>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:347 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    def repeat_kv(hidden_states: torch.Tensor, n_rep: int) -> torch.Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:353 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        B, T, H_kv, D = hidden_states.shape
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 4 [SizeVariable(length=4)]
TRACE STORE_FAST B [ConstantVariable(int: 128), ConstantVariable(int: 8), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 128), ConstantVariable(int: 8), ConstantVariable(int: 1)]
TRACE STORE_FAST H_kv [ConstantVariable(int: 128), ConstantVariable(int: 8)]
TRACE STORE_FAST D [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:354 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        if n_rep == 1:
TRACE LOAD_FAST n_rep []
TRACE LOAD_CONST 1 [ConstantVariable(int: 8)]
TRACE COMPARE_OP == [ConstantVariable(int: 8), ConstantVariable(int: 1)]
TRACE POP_JUMP_IF_FALSE 50 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:357 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        hidden_states = hidden_states[:, :, :, None, :]  # (B, T, H_kv, 1, D)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_CONST None [TensorVariable()]
TRACE LOAD_CONST None [TensorVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable()]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable()]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable()]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE BUILD_TUPLE 5 [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), SliceVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), TupleVariable(length=5)]
TRACE FX call getitem_12 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:357 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    hidden_states = hidden_states[:, :, :, None, :]  # (B, T, H_kv, 1, D)
                    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:358 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        hidden_states = hidden_states.expand(B, T, H_kv, n_rep, D)  # (B, T, H_kv, n_rep, D)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR expand [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), expand)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1)]
TRACE LOAD_FAST H_kv [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST n_rep [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8)]
TRACE LOAD_FAST D [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8), ConstantVariable(int: 8)]
TRACE CALL 5 [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call expand from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:358 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    hidden_states = hidden_states.expand(B, T, H_kv, n_rep, D)  # (B, T, H_kv, n_rep, D)
                    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR reshape [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), reshape)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1)]
TRACE LOAD_FAST H_kv [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST n_rep [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8)]
TRACE BINARY_OP 5 [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8), ConstantVariable(int: 8)]
TRACE LOAD_FAST D [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call reshape from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR contiguous [TensorVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE FX call contiguous from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object repeat_kv at 0x70c98a2f25b0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 347>
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: -1)]
TRACE FX call view_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:589 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = repeat_kv(k, kv_repeat).view(B, T, -1)
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:590 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            v = repeat_kv(v, kv_repeat).view(B, T, -1)
TRACE LOAD_GLOBAL repeat_kv []
TRACE LOAD_FAST v [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST kv_repeat [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 8)]
TRACE inlined call repeat_kv from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:590 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        v = repeat_kv(v, kv_repeat).view(B, T, -1)
            ~~~~~~~~~^^^^^^^^^^^^^^
INLINING <code object repeat_kv at 0x70c98a2f25b0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 347>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:347 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    def repeat_kv(hidden_states: torch.Tensor, n_rep: int) -> torch.Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:353 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        B, T, H_kv, D = hidden_states.shape
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 4 [SizeVariable(length=4)]
TRACE STORE_FAST B [ConstantVariable(int: 128), ConstantVariable(int: 8), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 128), ConstantVariable(int: 8), ConstantVariable(int: 1)]
TRACE STORE_FAST H_kv [ConstantVariable(int: 128), ConstantVariable(int: 8)]
TRACE STORE_FAST D [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:354 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        if n_rep == 1:
TRACE LOAD_FAST n_rep []
TRACE LOAD_CONST 1 [ConstantVariable(int: 8)]
TRACE COMPARE_OP == [ConstantVariable(int: 8), ConstantVariable(int: 1)]
TRACE POP_JUMP_IF_FALSE 50 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:357 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        hidden_states = hidden_states[:, :, :, None, :]  # (B, T, H_kv, 1, D)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_CONST None [TensorVariable()]
TRACE LOAD_CONST None [TensorVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable()]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable()]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable()]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE BUILD_TUPLE 5 [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), SliceVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), TupleVariable(length=5)]
TRACE FX call getitem_13 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:357 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    hidden_states = hidden_states[:, :, :, None, :]  # (B, T, H_kv, 1, D)
                    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:358 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        hidden_states = hidden_states.expand(B, T, H_kv, n_rep, D)  # (B, T, H_kv, n_rep, D)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR expand [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), expand)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1)]
TRACE LOAD_FAST H_kv [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST n_rep [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8)]
TRACE LOAD_FAST D [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8), ConstantVariable(int: 8)]
TRACE CALL 5 [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call expand_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:358 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    hidden_states = hidden_states.expand(B, T, H_kv, n_rep, D)  # (B, T, H_kv, n_rep, D)
                    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR reshape [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), reshape)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1)]
TRACE LOAD_FAST H_kv [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST n_rep [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8)]
TRACE BINARY_OP 5 [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8), ConstantVariable(int: 8)]
TRACE LOAD_FAST D [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call reshape_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR contiguous [TensorVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE FX call contiguous_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object repeat_kv at 0x70c98a2f25b0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 347>
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: -1)]
TRACE FX call view_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:590 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        v = repeat_kv(v, kv_repeat).view(B, T, -1)
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:593 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            a = torch.sigmoid(xa @ a2 + a0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR sigmoid [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST xa [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST a2 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 4 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['a2'] (160, 8192) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='a2', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_a2_ L['a2'] FakeTensor(..., device='cuda:0', size=(160, 8192), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call matmul_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:593 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        a = torch.sigmoid(xa @ a2 + a0)
                          ~~~^~~~
TRACE LOAD_FAST a0 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['a0'] (1, 1, 8192) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='a0', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_a0_ L['a0'] FakeTensor(..., device='cuda:0', size=(1, 1, 8192), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call add_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:593 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        a = torch.sigmoid(xa @ a2 + a0)
                          ~~~~~~~~^~~~
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call sigmoid from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:593 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        a = torch.sigmoid(xa @ a2 + a0)
            ~~~~~~~~~~~~~^^^^^^^^^^^^^^
TRACE STORE_FAST a [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:595 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            kk = F.normalize(k.view(B, T, H, N), p=2.0, dim=-1).view(B, T, H*N)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR normalize [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR view [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:595 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        kk = F.normalize(k.view(B, T, H, N), p=2.0, dim=-1).view(B, T, H*N)
                         ~~~~~~^^^^^^^^^^^^
TRACE LOAD_CONST 2.0 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 2.0)]
TRACE KW_NAMES ('p', 'dim') [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 2.0), ConstantVariable(int: -1)]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 2.0), ConstantVariable(int: -1)]
TRACE FX call normalize from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:595 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        kk = F.normalize(k.view(B, T, H, N), p=2.0, dim=-1).view(B, T, H*N)
             ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE BINARY_OP 5 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8192)]
TRACE FX call view_8 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:595 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        kk = F.normalize(k.view(B, T, H, N), p=2.0, dim=-1).view(B, T, H*N)
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
TRACE STORE_FAST kk [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:596 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            w = torch.tanh(xw) @ w2 + w0
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR tanh [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST xw [NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call tanh from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:596 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = torch.tanh(xw) @ w2 + w0
            ~~~~~~~~~~^^^^
TRACE LOAD_FAST w2 [TensorVariable()]
TRACE BINARY_OP 4 [TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['w2'] (480, 8192) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='w2', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_w2_ L['w2'] FakeTensor(..., device='cuda:0', size=(480, 8192), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call matmul_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:596 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = torch.tanh(xw) @ w2 + w0
            ~~~~~~~~~~~~~~~^~~~
TRACE LOAD_FAST w0 [TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['w0'] (1, 1, 8192) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='w0', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_w0_ L['w0'] FakeTensor(..., device='cuda:0', size=(1, 1, 8192), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call add_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:596 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = torch.tanh(xw) @ w2 + w0
            ~~~~~~~~~~~~~~~~~~~~^~~~
TRACE STORE_FAST w [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:597 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            w = -F.softplus(-w) - 0.5
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR softplus [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST w [NullVariable, LazyVariableTracker()]
TRACE UNARY_NEGATIVE None [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call neg_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:597 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = -F.softplus(-w) - 0.5
                        ^^
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call softplus from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:597 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = -F.softplus(-w) - 0.5
             ~~~~~~~~~~^^^^
TRACE UNARY_NEGATIVE None [TensorVariable()]
TRACE FX call neg_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:597 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = -F.softplus(-w) - 0.5
            ^^^^^^^^^^^^^^^
TRACE LOAD_CONST 0.5 [TensorVariable()]
TRACE BINARY_OP 10 [TensorVariable(), ConstantVariable(float: 0.5)]
TRACE FX call sub from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:597 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = -F.softplus(-w) - 0.5
            ~~~~~~~~~~~~~~~~^~~~~
TRACE STORE_FAST w [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:598 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = k * (1.0 - w + a)
TRACE LOAD_FAST k []
TRACE LOAD_CONST 1.0 [TensorVariable()]
TRACE LOAD_FAST w [TensorVariable(), ConstantVariable(float: 1.0)]
TRACE BINARY_OP 10 [TensorVariable(), ConstantVariable(float: 1.0), TensorVariable()]
TRACE FX call sub_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:598 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = k * (1.0 - w + a)
                 ~~~~^~~
TRACE LOAD_FAST a [TensorVariable(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call add_7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:598 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = k * (1.0 - w + a)
                 ~~~~~~~~^~~
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_10 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:598 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = k * (1.0 - w + a)
            ~~^~~~~~~~~~~~~~~
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:600 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            aa = -kk
TRACE LOAD_FAST kk []
TRACE UNARY_NEGATIVE None [TensorVariable()]
TRACE FX call neg_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:600 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        aa = -kk
             ^^^
TRACE STORE_FAST aa [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:601 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            bb = kk * a
TRACE LOAD_FAST kk []
TRACE LOAD_FAST a [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_11 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:601 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        bb = kk * a
             ~~~^~~
TRACE STORE_FAST bb [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:603 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            w = -w.exp()#.to(dtype=torch.float32).exp()
TRACE LOAD_FAST w []
TRACE LOAD_ATTR exp [TensorVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), exp)]
TRACE FX call exp from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:603 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = -w.exp()#.to(dtype=torch.float32).exp()
             ~~~~~^^
TRACE UNARY_NEGATIVE None [TensorVariable()]
TRACE FX call neg_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:603 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = -w.exp()#.to(dtype=torch.float32).exp()
            ^^^^^^^^
TRACE STORE_FAST w [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:604 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            r_,w_,k_,v_,aa_,bb_ = [i.view(B,T,H,N) for i in [r,w,k,v,aa,bb]]
TRACE LOAD_FAST r []
TRACE LOAD_FAST w [TensorVariable()]
TRACE LOAD_FAST k [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST v [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST aa [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST bb [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 6 [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE GET_ITER None [TupleVariable(length=6)]
TRACE LOAD_FAST_AND_CLEAR i [ListIteratorVariable(length=6, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=6, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=6, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=6, index=0), ListVariable(length=0)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=0)]
TRACE STORE_FAST i [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), TensorVariable()]
TRACE LOAD_FAST i [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1)]
TRACE LOAD_ATTR view [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_9 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:604 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        r_,w_,k_,v_,aa_,bb_ = [i.view(B,T,H,N) for i in [r,w,k,v,aa,bb]]
                               ~~~~~~^^^^^^^^^
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), TensorVariable()]
TRACE JUMP_BACKWARD 1448 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=1)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=1)]
TRACE STORE_FAST i [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), TensorVariable()]
TRACE LOAD_FAST i [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2)]
TRACE LOAD_ATTR view [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), TensorVariable()]
TRACE JUMP_BACKWARD 1448 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=2)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=2)]
TRACE STORE_FAST i [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), TensorVariable()]
TRACE LOAD_FAST i [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3)]
TRACE LOAD_ATTR view [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), TensorVariable()]
TRACE JUMP_BACKWARD 1448 [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=3)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=3)]
TRACE STORE_FAST i [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), TensorVariable()]
TRACE LOAD_FAST i [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4)]
TRACE LOAD_ATTR view [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), TensorVariable()]
TRACE JUMP_BACKWARD 1448 [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=4)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=4)]
TRACE STORE_FAST i [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), TensorVariable()]
TRACE LOAD_FAST i [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5)]
TRACE LOAD_ATTR view [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), TensorVariable()]
TRACE JUMP_BACKWARD 1448 [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=5)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=5)]
TRACE STORE_FAST i [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), TensorVariable()]
TRACE LOAD_FAST i [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6)]
TRACE LOAD_ATTR view [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), TensorVariable()]
TRACE JUMP_BACKWARD 1448 [NullVariable, ListVariable(length=6), ListIteratorVariable(length=6, index=6)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=6), ListIteratorVariable(length=6, index=6)]
TRACE END_FOR None [NullVariable, ListVariable(length=6), ListIteratorVariable(length=6, index=6), ConstantVariable(NoneType: None)]
TRACE SWAP 2 [NullVariable, ListVariable(length=6)]
TRACE STORE_FAST i [ListVariable(length=6), NullVariable]
TRACE UNPACK_SEQUENCE 6 [ListVariable(length=6)]
TRACE STORE_FAST r_ [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST w_ [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST k_ [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST v_ [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST aa_ [TensorVariable(), TensorVariable()]
TRACE STORE_FAST bb_ [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:605 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            B,T,_,_ = r_.shape
TRACE LOAD_FAST r_ []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 4 [SizeVariable(length=4)]
TRACE STORE_FAST B [ConstantVariable(int: 128), ConstantVariable(int: 64), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 128), ConstantVariable(int: 64), ConstantVariable(int: 1)]
TRACE STORE_FAST _ [ConstantVariable(int: 128), ConstantVariable(int: 64)]
TRACE STORE_FAST _ [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:609 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            xx, state = fused_recurrent_rwkv7(r_, w_, k_, v_, aa_, bb_, scale=1.0, initial_state=state, output_final_state=True, head_first=False)
TRACE LOAD_GLOBAL fused_recurrent_rwkv7 []
TRACE LOAD_FAST r_ [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST w_ [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST k_ [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST v_ [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST aa_ [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST bb_ [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 1.0 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST state [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0)]
TRACE LOAD_CONST True [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker()]
TRACE LOAD_CONST False [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True)]
TRACE KW_NAMES ('scale', 'initial_state', 'output_final_state', 'head_first') [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(bool: False)]
TRACE CALL 10 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(bool: False)]
TRACE inlined call fused_recurrent_rwkv7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:609 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx, state = fused_recurrent_rwkv7(r_, w_, k_, v_, aa_, bb_, scale=1.0, initial_state=state, output_final_state=True, head_first=False)
                    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object fused_recurrent_rwkv7 at 0x70c98d0c9890, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py", line 11>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:11 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
    def fused_recurrent_rwkv7(
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:50 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
        return fused_recurrent_dplr_delta_rule(
TRACE LOAD_GLOBAL fused_recurrent_dplr_delta_rule []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:51 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            q=r,
TRACE LOAD_FAST r [NullVariable, LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:52 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            k=k,
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:53 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            v=v,
TRACE LOAD_FAST v [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:54 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            a=a,
TRACE LOAD_FAST a [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:55 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            b=b,
TRACE LOAD_FAST b [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:56 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            gk=log_w,
TRACE LOAD_FAST log_w [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:57 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            scale=scale,
TRACE LOAD_FAST scale [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:58 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            initial_state=initial_state,
TRACE LOAD_FAST initial_state [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:59 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            output_final_state=output_final_state,
TRACE LOAD_FAST output_final_state [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:60 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            cu_seqlens=cu_seqlens,
TRACE LOAD_FAST cu_seqlens [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:61 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            head_first=head_first
TRACE LOAD_FAST head_first [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:50 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
        return fused_recurrent_dplr_delta_rule(
TRACE KW_NAMES ('q', 'k', 'v', 'a', 'b', 'gk', 'scale', 'initial_state', 'output_final_state', 'cu_seqlens', 'head_first') [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(NoneType: None), ConstantVariable(bool: False)]
TRACE CALL 11 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(NoneType: None), ConstantVariable(bool: False)]
TRACE inlined call fused_recurrent_dplr_delta_rule from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:50 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
    return fused_recurrent_dplr_delta_rule(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        q=r,
        ^^^^
        k=k,
        ^^^^
        v=v,
        ^^^^
        a=a,
        ^^^^
        b=b,
        ^^^^
        gk=log_w,
        ^^^^^^^^^
        scale=scale,
        ^^^^^^^^^^^^
        initial_state=initial_state,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        output_final_state=output_final_state,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        cu_seqlens=cu_seqlens,
        ^^^^^^^^^^^^^^^^^^^^^^
        head_first=head_first
        ^^^^^^^^^^^^^^^^^^^^^
    )
    ^
INLINING <code object fused_recurrent_dplr_delta_rule at 0x305fb4e0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 188>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:188 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
    def fused_recurrent_dplr_delta_rule(
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:231 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
        if cu_seqlens is not None:
TRACE LOAD_FAST cu_seqlens []
TRACE LOAD_CONST None [ConstantVariable(NoneType: None)]
TRACE IS_OP 0 [ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 282 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:240 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
        if scale is None:
TRACE LOAD_FAST scale []
TRACE LOAD_CONST None [ConstantVariable(float: 1.0)]
TRACE IS_OP 1 [ConstantVariable(float: 1.0), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 328 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:243 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            assert scale > 0, "scale must be positive"
TRACE LOAD_FAST scale []
TRACE LOAD_CONST 0 [ConstantVariable(float: 1.0)]
TRACE COMPARE_OP > [ConstantVariable(float: 1.0), ConstantVariable(int: 0)]
TRACE POP_JUMP_IF_TRUE 352 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:244 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
        o, final_state = FusedRecurrentDPLRDeltaRuleFunction.apply(
TRACE LOAD_GLOBAL FusedRecurrentDPLRDeltaRuleFunction []
TRACE LOAD_ATTR apply [LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:245 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            q,
TRACE LOAD_FAST q [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:246 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            k,
TRACE LOAD_FAST k [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:247 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            v,
TRACE LOAD_FAST v [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:248 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            a,
TRACE LOAD_FAST a [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:249 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            b,
TRACE LOAD_FAST b [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:250 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            gk,
TRACE LOAD_FAST gk [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:251 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            scale,
TRACE LOAD_FAST scale [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:252 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            initial_state,
TRACE LOAD_FAST initial_state [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:253 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            output_final_state,
TRACE LOAD_FAST output_final_state [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:254 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            cu_seqlens,
TRACE LOAD_FAST cu_seqlens [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:255 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            head_first
TRACE LOAD_FAST head_first [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:244 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
        o, final_state = FusedRecurrentDPLRDeltaRuleFunction.apply(
TRACE CALL 11 [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(NoneType: None), ConstantVariable(bool: False)]
wrap_to_fake L['state'] (1, 64, 128, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None], constraint_strides=[None, None, None, None], specialize_on=[[], [], [], []], view_base_context=StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='state', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}), tensor_source=LocalSource(local_name='state', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_state_ L['state'] FakeTensor(..., device='cuda:0', size=(1, 64, 128, 128), dtype=torch.bfloat16) at debug_level 0 before=False
wrap_to_fake L['state']._base (56, 1, 64, 128, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='state', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
TRACE inlined call wrapper from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:244 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
    o, final_state = FusedRecurrentDPLRDeltaRuleFunction.apply(
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        q,
        ^^
        k,
        ^^
        v,
        ^^
        a,
        ^^
        b,
        ^^
        gk,
        ^^^
        scale,
        ^^^^^^
        initial_state,
        ^^^^^^^^^^^^^^
        output_final_state,
        ^^^^^^^^^^^^^^^^^^^
        cu_seqlens,
        ^^^^^^^^^^^
        head_first
        ^^^^^^^^^^
    )
    ^
INLINING <code object wrapper at 0x70c98d04f0a0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 16>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 1 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:16 in wrapper (contiguous) (inline depth: 3)
        @functools.wraps(fn)
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:18 in wrapper (contiguous.wrapper) (inline depth: 3)
            return fn(ctx,
TRACE PUSH_NULL None []
TRACE LOAD_DEREF fn [NullVariable]
TRACE LOAD_FAST ctx [NullVariable, LazyVariableTracker()]
TRACE BUILD_LIST 1 [NullVariable, LazyVariableTracker(), AutogradFunctionContextVariable(Function)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:19 in wrapper (contiguous.wrapper) (inline depth: 3)
                      *(i if not isinstance(i, torch.Tensor) else i.contiguous() for i in args),
TRACE LOAD_CONST <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19> [NullVariable, LazyVariableTracker(), ListVariable(length=1)]
TRACE MAKE_FUNCTION 0 [NullVariable, LazyVariableTracker(), ListVariable(length=1), ConstantVariable(code: <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker(), ListVariable(length=1), NestedUserFunctionVariable()]
TRACE GET_ITER None [NullVariable, LazyVariableTracker(), ListVariable(length=1), NestedUserFunctionVariable(), TupleVariable(length=11)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), ListVariable(length=1), NestedUserFunctionVariable(), ListIteratorVariable(length=11, index=0)]
TRACE inlined call <genexpr> from /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:19 in wrapper (contiguous.wrapper) (inline depth: 3)
                  *(i if not isinstance(i, torch.Tensor) else i.contiguous() for i in args),
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:18 in wrapper (contiguous.wrapper) (inline depth: 3)
            return fn(ctx,
TRACE LIST_EXTEND 1 [NullVariable, LazyVariableTracker(), ListVariable(length=1), LocalGeneratorObjectVariable(<genexpr>)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:19 in <genexpr> (contiguous.wrapper) (inline depth: 4)
                      *(i if not isinstance(i, torch.Tensor) else i.contiguous() for i in args),
TRACE RETURN_GENERATOR None [BuiltinVariable(None)]
TRACE POP_TOP None [BuiltinVariable(None)]
TRACE RESUME 0 []
TRACE LOAD_FAST .0 []
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=0)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=1), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=1)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=1), NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=1), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=1), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=1), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=1), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=1)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=1), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=1), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE FX call contiguous_2 from /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:19 in <genexpr> (contiguous.wrapper) (inline depth: 4)
                  *(i if not isinstance(i, torch.Tensor) else i.contiguous() for i in args),
                                                              ~~~~~~~~~~~~^^
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=1), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=1), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=1), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=1)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=1)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=2), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=2)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=2), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=2), NullVariable, BuiltinVariable(isinstance), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=2), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=2), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=2), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=2)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=2), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=2), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=2), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=2), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=2), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=2)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=2)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=3), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=3)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=3), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=3), NullVariable, BuiltinVariable(isinstance), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=3), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=3), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=3), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=3)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=3), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=3), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=3), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=3), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=3), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=3)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=3)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=4), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=4)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=4), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=4), NullVariable, BuiltinVariable(isinstance), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=4), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=4), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=4), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=4)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=4), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=4), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=4), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=4), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=4), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=4)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=4)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=5), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=5)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=5), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=5), NullVariable, BuiltinVariable(isinstance), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=5), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=5), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=5), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=5)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=5), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=5), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=5), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=5), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=5), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=5)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=5)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=6), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=6)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=6), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=6), NullVariable, BuiltinVariable(isinstance), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=6), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=6), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=6), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=6)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=6), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=6), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=6), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=6), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=6), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=6)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=6)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=7), ConstantVariable(float: 1.0)]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=7)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=7), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=7), NullVariable, BuiltinVariable(isinstance), ConstantVariable(float: 1.0)]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=7), NullVariable, BuiltinVariable(isinstance), ConstantVariable(float: 1.0), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=7), NullVariable, BuiltinVariable(isinstance), ConstantVariable(float: 1.0), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=7), ConstantVariable(bool: False)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=7)]
TRACE JUMP_FORWARD 100 [ListIteratorVariable(length=11, index=7), ConstantVariable(float: 1.0)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=7), ConstantVariable(float: 1.0)]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=7), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=7), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=7)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=7)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=8), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=8)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=8), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=8), NullVariable, BuiltinVariable(isinstance), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=8), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=8), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=8), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=8)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=8), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=8), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=8), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=8), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=8), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=8)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=8)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=9), ConstantVariable(bool: True)]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=9)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=9), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=9), NullVariable, BuiltinVariable(isinstance), ConstantVariable(bool: True)]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=9), NullVariable, BuiltinVariable(isinstance), ConstantVariable(bool: True), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=9), NullVariable, BuiltinVariable(isinstance), ConstantVariable(bool: True), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=9), ConstantVariable(bool: False)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=9)]
TRACE JUMP_FORWARD 100 [ListIteratorVariable(length=11, index=9), ConstantVariable(bool: True)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=9), ConstantVariable(bool: True)]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=9), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=9), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=9)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=9)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=10), ConstantVariable(NoneType: None)]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=10)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=10), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=10), NullVariable, BuiltinVariable(isinstance), ConstantVariable(NoneType: None)]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=10), NullVariable, BuiltinVariable(isinstance), ConstantVariable(NoneType: None), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=10), NullVariable, BuiltinVariable(isinstance), ConstantVariable(NoneType: None), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=10), ConstantVariable(bool: False)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=10)]
TRACE JUMP_FORWARD 100 [ListIteratorVariable(length=11, index=10), ConstantVariable(NoneType: None)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=10), ConstantVariable(NoneType: None)]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=10), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=10), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=10)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=10)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=11), ConstantVariable(bool: False)]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=11)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=11), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=11), NullVariable, BuiltinVariable(isinstance), ConstantVariable(bool: False)]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=11), NullVariable, BuiltinVariable(isinstance), ConstantVariable(bool: False), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=11), NullVariable, BuiltinVariable(isinstance), ConstantVariable(bool: False), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=11), ConstantVariable(bool: False)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=11)]
TRACE JUMP_FORWARD 100 [ListIteratorVariable(length=11, index=11), ConstantVariable(bool: False)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=11), ConstantVariable(bool: False)]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=11), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=11), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=11)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=11)]
TRACE END_FOR None [ListIteratorVariable(length=11, index=11), ConstantVariable(NoneType: None)]
TRACE RETURN_CONST None []
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE CALL_INTRINSIC_1 6 [NullVariable, LazyVariableTracker(), ListVariable(length=12)]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=12)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:20 in wrapper (contiguous.wrapper) (inline depth: 3)
                      **{k: (v if not isinstance(v, torch.Tensor) else v.contiguous()) for k, v in kwargs.items()})
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable()]
TRACE LOAD_ATTR items [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ConstDictVariable()]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 180 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE SWAP 3 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST v [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ConstDictVariable(), NullVariable, NullVariable]
TRACE STORE_FAST k [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ConstDictVariable(), NullVariable]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:18 in wrapper (contiguous.wrapper) (inline depth: 3)
            return fn(ctx,
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable()]
TRACE inlined call forward from /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:18 in wrapper (contiguous.wrapper) (inline depth: 3)
        return fn(ctx,
               ~~^^^^^
                  *(i if not isinstance(i, torch.Tensor) else i.contiguous() for i in args),
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                  **{k: (v if not isinstance(v, torch.Tensor) else v.contiguous()) for k, v in kwargs.items()})
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object forward at 0x3060e8b0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 124>, inlined according trace_rules.lookup inlined by default
TRACE MAKE_CELL H []
TRACE MAKE_CELL N []
TRACE MAKE_CELL V []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:124 in forward (FusedRecurrentDPLRDeltaRuleFunction) (inline depth: 4)
        @staticmethod
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:140 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            if head_first:
TRACE LOAD_FAST head_first []
TRACE POP_JUMP_IF_FALSE 86 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:143 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
                B, T, H, K, V = *k.shape, v.shape[-1]
TRACE BUILD_LIST 0 []
TRACE LOAD_FAST k [ListVariable(length=0)]
TRACE LOAD_ATTR shape [ListVariable(length=0), TensorVariable()]
TRACE LIST_EXTEND 1 [ListVariable(length=0), SizeVariable(length=4)]
TRACE LOAD_FAST v [ListVariable(length=4)]
TRACE LOAD_ATTR shape [ListVariable(length=4), TensorVariable()]
TRACE LOAD_CONST -1 [ListVariable(length=4), SizeVariable(length=4)]
TRACE BINARY_SUBSCR None [ListVariable(length=4), SizeVariable(length=4), ConstantVariable(int: -1)]
TRACE LIST_APPEND 1 [ListVariable(length=4), ConstantVariable(int: 128)]
TRACE CALL_INTRINSIC_1 6 [ListVariable(length=5)]
TRACE UNPACK_SEQUENCE 5 [TupleVariable(length=5)]
TRACE STORE_FAST B [ConstantVariable(int: 128), ConstantVariable(int: 128), ConstantVariable(int: 64), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 128), ConstantVariable(int: 128), ConstantVariable(int: 64), ConstantVariable(int: 1)]
TRACE STORE_DEREF H [ConstantVariable(int: 128), ConstantVariable(int: 128), ConstantVariable(int: 64)]
TRACE STORE_FAST K [ConstantVariable(int: 128), ConstantVariable(int: 128)]
TRACE STORE_DEREF V [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:144 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            N = B if offsets is None else len(offsets) - 1
TRACE LOAD_FAST offsets []
TRACE LOAD_CONST None [ConstantVariable(NoneType: None)]
TRACE IS_OP 1 [ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 170 [ConstantVariable(bool: False)]
TRACE LOAD_FAST B []
TRACE JUMP_FORWARD 196 [ConstantVariable(int: 1)]
TRACE STORE_DEREF N [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:146 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            BK = triton.next_power_of_2(K)
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR next_power_of_2 [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST K [NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:146 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
        BK = triton.next_power_of_2(K)
             ~~~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=1)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=1, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=1, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=1, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=1, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=1), ConstantVariable(int: 128)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 6)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 6)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 6)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 6)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 6)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 128)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=1), ConstantVariable(int: 128)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=1, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=1, index=1)]
TRACE END_FOR None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=1, index=1), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=1)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=1)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=1), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=1), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=1), ConstDictVariable()]
TRACE inlined call next_power_of_2 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object next_power_of_2 at 0x70c9a955f730, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 71>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:71 in next_power_of_2 () (inline depth: 6)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:74 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n -= 1
TRACE LOAD_FAST n []
TRACE LOAD_CONST 1 [ConstantVariable(int: 128)]
TRACE BINARY_OP 23 [ConstantVariable(int: 128), ConstantVariable(int: 1)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:75 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n |= n >> 1
TRACE LOAD_FAST n []
TRACE LOAD_FAST n [ConstantVariable(int: 127)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 127), ConstantVariable(int: 127)]
TRACE BINARY_OP 9 [ConstantVariable(int: 127), ConstantVariable(int: 127), ConstantVariable(int: 1)]
TRACE BINARY_OP 20 [ConstantVariable(int: 127), ConstantVariable(int: 63)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:76 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n |= n >> 2
TRACE LOAD_FAST n []
TRACE LOAD_FAST n [ConstantVariable(int: 127)]
TRACE LOAD_CONST 2 [ConstantVariable(int: 127), ConstantVariable(int: 127)]
TRACE BINARY_OP 9 [ConstantVariable(int: 127), ConstantVariable(int: 127), ConstantVariable(int: 2)]
TRACE BINARY_OP 20 [ConstantVariable(int: 127), ConstantVariable(int: 31)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:77 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n |= n >> 4
TRACE LOAD_FAST n []
TRACE LOAD_FAST n [ConstantVariable(int: 127)]
TRACE LOAD_CONST 4 [ConstantVariable(int: 127), ConstantVariable(int: 127)]
TRACE BINARY_OP 9 [ConstantVariable(int: 127), ConstantVariable(int: 127), ConstantVariable(int: 4)]
TRACE BINARY_OP 20 [ConstantVariable(int: 127), ConstantVariable(int: 7)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:78 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n |= n >> 8
TRACE LOAD_FAST n []
TRACE LOAD_FAST n [ConstantVariable(int: 127)]
TRACE LOAD_CONST 8 [ConstantVariable(int: 127), ConstantVariable(int: 127)]
TRACE BINARY_OP 9 [ConstantVariable(int: 127), ConstantVariable(int: 127), ConstantVariable(int: 8)]
TRACE BINARY_OP 20 [ConstantVariable(int: 127), ConstantVariable(int: 0)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:79 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n |= n >> 16
TRACE LOAD_FAST n []
TRACE LOAD_FAST n [ConstantVariable(int: 127)]
TRACE LOAD_CONST 16 [ConstantVariable(int: 127), ConstantVariable(int: 127)]
TRACE BINARY_OP 9 [ConstantVariable(int: 127), ConstantVariable(int: 127), ConstantVariable(int: 16)]
TRACE BINARY_OP 20 [ConstantVariable(int: 127), ConstantVariable(int: 0)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:80 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n |= n >> 32
TRACE LOAD_FAST n []
TRACE LOAD_FAST n [ConstantVariable(int: 127)]
TRACE LOAD_CONST 32 [ConstantVariable(int: 127), ConstantVariable(int: 127)]
TRACE BINARY_OP 9 [ConstantVariable(int: 127), ConstantVariable(int: 127), ConstantVariable(int: 32)]
TRACE BINARY_OP 20 [ConstantVariable(int: 127), ConstantVariable(int: 0)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:81 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n += 1
TRACE LOAD_FAST n []
TRACE LOAD_CONST 1 [ConstantVariable(int: 127)]
TRACE BINARY_OP 13 [ConstantVariable(int: 127), ConstantVariable(int: 1)]
TRACE STORE_FAST n [ConstantVariable(int: 128)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:82 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        return n
TRACE LOAD_FAST n []
TRACE RETURN_VALUE None [ConstantVariable(int: 128)]
DONE INLINING <code object next_power_of_2 at 0x70c9a955f730, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 71>
TRACE STORE_FAST res [ConstantVariable(int: 128)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 128)]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE STORE_FAST BK [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:147 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            if output_final_state:
TRACE LOAD_FAST output_final_state []
TRACE POP_JUMP_IF_FALSE 318 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:148 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
                final_state = q.new_empty(B, H, K, V, dtype=torch.float32)
TRACE LOAD_FAST q []
TRACE LOAD_ATTR new_empty [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), new_empty)]
TRACE LOAD_DEREF H [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1)]
TRACE LOAD_FAST K [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE LOAD_DEREF V [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128), ConstantVariable(int: 128)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE CALL 5 [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE FX call new_empty from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:148 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            final_state = q.new_empty(B, H, K, V, dtype=torch.float32)
                          ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST final_state [TensorVariable()]
TRACE JUMP_FORWARD 322 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:152 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            ha = torch.empty_like(v, dtype=torch.float32)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR empty_like [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST v [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL torch [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR float32 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE FX call empty_like from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:152 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
        ha = torch.empty_like(v, dtype=torch.float32)
             ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST ha [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
TRACE LOAD_CLOSURE H []
TRACE LOAD_CLOSURE N [CellVariable()]
TRACE LOAD_CLOSURE V [CellVariable(), CellVariable()]
TRACE BUILD_TUPLE 3 [CellVariable(), CellVariable(), CellVariable()]
TRACE LOAD_CONST <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154> [TupleVariable(length=3)]
TRACE MAKE_FUNCTION 8 [TupleVariable(length=3), ConstantVariable(code: <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>)]
TRACE STORE_FAST grid [NestedUserFunctionVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:155 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            o = torch.empty_like(v)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR empty_like [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST v [NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call empty_like_1 from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:155 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
        o = torch.empty_like(v)
            ~~~~~~~~~~~~~~~~^^^
TRACE STORE_FAST o [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_GLOBAL fused_recurrent_fwd_kernel []
TRACE LOAD_FAST grid [NullVariable, LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), NestedUserFunctionVariable()]
TRACE inlined call __getitem__ from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
        fused_recurrent_fwd_kernel[grid](
        ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
INLINING <code object __getitem__ at 0x70c9a94dd6f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 413>, inlined according trace_rules.lookup inlined by default
TRACE MAKE_CELL self []
TRACE MAKE_CELL grid []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:413 in __getitem__ (KernelInterface.__getitem__) (inline depth: 5)
        def __getitem__(self, grid) -> T:
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:419 in __getitem__ (KernelInterface.__getitem__) (inline depth: 5)
            return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
TRACE LOAD_CLOSURE grid []
TRACE LOAD_CLOSURE self [CellVariable()]
TRACE BUILD_TUPLE 2 [CellVariable(), CellVariable()]
TRACE LOAD_CONST <code object <lambda> at 0x70c9a9437780, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 419> [TupleVariable(length=2)]
TRACE MAKE_FUNCTION 8 [TupleVariable(length=2), ConstantVariable(code: <code object <lambda> at 0x70c9a9437780, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 419>)]
TRACE RETURN_VALUE None [NestedUserFunctionVariable()]
DONE INLINING <code object __getitem__ at 0x70c9a94dd6f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 413>
TRACE LOAD_CONST () [NullVariable, NestedUserFunctionVariable()]
TRACE BUILD_MAP 0 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0)]
TRACE LOAD_CONST q [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:157 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                q=q,
TRACE LOAD_FAST q [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'q')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'q'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST k [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:158 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                k=k,
TRACE LOAD_FAST k [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'k')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'k'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST v [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:159 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                v=v,
TRACE LOAD_FAST v [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'v')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'v'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST a [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:160 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                a=a,
TRACE LOAD_FAST a [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'a')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'a'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST b [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:161 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                b=b,
TRACE LOAD_FAST b [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'b')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'b'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST gk [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:162 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                gk=gk,
TRACE LOAD_FAST gk [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'gk')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'gk'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST o [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:163 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                o=o,
TRACE LOAD_FAST o [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'o')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'o'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST ha [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:164 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                ha=ha,
TRACE LOAD_FAST ha [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'ha')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'ha'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST h0 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:165 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                h0=initial_state,
TRACE LOAD_FAST initial_state [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'h0')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'h0'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST ht [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:166 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                ht=final_state,
TRACE LOAD_FAST final_state [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'ht')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'ht'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST scale [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:167 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                scale=scale,
TRACE LOAD_FAST scale [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'scale')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'scale'), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST offsets [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:168 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                offsets=offsets,
TRACE LOAD_FAST offsets [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'offsets')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'offsets'), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST H [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:169 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                H=H,
TRACE LOAD_DEREF H [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'H')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'H'), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST T [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:170 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                T=T,
TRACE LOAD_FAST T [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'T')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'T'), ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST K [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:171 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                K=K,
TRACE LOAD_FAST K [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'K')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'K'), ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST V [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:172 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                V=V,
TRACE LOAD_DEREF V [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'V')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'V'), ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST BK [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:173 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                BK=BK,
TRACE LOAD_FAST BK [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'BK')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'BK'), ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST HEAD_FIRST [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:174 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                HEAD_FIRST=head_first
TRACE LOAD_FAST head_first [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'HEAD_FIRST')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'HEAD_FIRST'), ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE CALL_FUNCTION_EX 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE inlined call <lambda> from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
        fused_recurrent_fwd_kernel[grid](
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
            q=q,
            ^^^^
            k=k,
            ^^^^
            v=v,
            ^^^^
            a=a,
            ^^^^
            b=b,
            ^^^^
            gk=gk,
            ^^^^^^
            o=o,
            ^^^^
            ha=ha,
            ^^^^^^
            h0=initial_state,
            ^^^^^^^^^^^^^^^^^
            ht=final_state,
            ^^^^^^^^^^^^^^^
            scale=scale,
            ^^^^^^^^^^^^
            offsets=offsets,
            ^^^^^^^^^^^^^^^^
            H=H,
            ^^^^
            T=T,
            ^^^^
            K=K,
            ^^^^
            V=V,
            ^^^^
            BK=BK,
            ^^^^^^
            HEAD_FIRST=head_first
            ^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object <lambda> at 0x70c9a9437780, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 419>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 2 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:419 in <lambda> (KernelInterface.__getitem__) (inline depth: 5)
            return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
TRACE RESUME 0 []
TRACE PUSH_NULL None []
TRACE LOAD_DEREF self [NullVariable]
TRACE LOAD_ATTR run [NullVariable, UserDefinedObjectVariable(Heuristics)]
TRACE LOAD_FAST args [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics))]
TRACE LOAD_DEREF grid [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0)]
TRACE LOAD_CONST False [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0), NestedUserFunctionVariable()]
TRACE LOAD_CONST ('grid', 'warmup') [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0), NestedUserFunctionVariable(), ConstantVariable(bool: False)]
TRACE BUILD_CONST_KEY_MAP 2 [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0), NestedUserFunctionVariable(), ConstantVariable(bool: False), TupleVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0), ConstDictVariable()]
TRACE inlined call run from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:419 in <lambda> (KernelInterface.__getitem__) (inline depth: 5)
        return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
                                       ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object run at 0x70c9a971df10, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py", line 449>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:449 in run (Heuristics.run) (inline depth: 6)
        def run(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:450 in run (Heuristics.run) (inline depth: 6)
            for v, heur in self.values.items():
TRACE LOAD_FAST self []
TRACE LOAD_ATTR values [UserDefinedObjectVariable(Heuristics)]
TRACE LOAD_ATTR items [LazyVariableTracker()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE FOR_ITER 156 [ListIteratorVariable(length=3, index=0)]
TRACE UNPACK_SEQUENCE 2 [ListIteratorVariable(length=3, index=1), TupleVariable(length=2)]
TRACE STORE_FAST v [ListIteratorVariable(length=3, index=1), LazyVariableTracker(), ConstantVariable(str: 'USE_INITIAL_STATE')]
TRACE STORE_FAST heur [ListIteratorVariable(length=3, index=1), LazyVariableTracker()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
                kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
TRACE PUSH_NULL None [ListIteratorVariable(length=3, index=1)]
TRACE LOAD_FAST heur [ListIteratorVariable(length=3, index=1), NullVariable]
TRACE BUILD_MAP 0 [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL dict [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE LOAD_GLOBAL zip [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST self [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, LazyVariableTracker(), NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR arg_names [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, LazyVariableTracker(), NullVariable, LazyVariableTracker(), UserDefinedObjectVariable(Heuristics)]
TRACE LOAD_FAST args [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, LazyVariableTracker(), NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, LazyVariableTracker(), NullVariable, LazyVariableTracker(), LazyVariableTracker(), TupleVariable(length=0)]
TRACE CALL 1 [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, LazyVariableTracker(), ZipVariable()]
TRACE inlined call construct_dict from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
            kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
                                ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object construct_dict at 0x70c9a070b0a0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 285>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:285 in construct_dict (construct_dict) (inline depth: 7)
    def construct_dict(cls, /, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:286 in construct_dict (construct_dict) (inline depth: 7)
        dst = cls.__new__(cls)
TRACE LOAD_FAST cls []
TRACE LOAD_ATTR __new__ [BuiltinVariable(dict)]
TRACE LOAD_FAST cls [NullVariable, GetAttrVariable(BuiltinVariable(dict), __new__)]
TRACE CALL 1 [NullVariable, GetAttrVariable(BuiltinVariable(dict), __new__), BuiltinVariable(dict)]
TRACE STORE_FAST dst [ConstDictVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:288 in construct_dict (construct_dict) (inline depth: 7)
        if args:
TRACE LOAD_FAST args []
TRACE POP_JUMP_IF_FALSE 264 [TupleVariable(length=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:289 in construct_dict (construct_dict) (inline depth: 7)
            src = args[0]
TRACE LOAD_FAST args []
TRACE LOAD_CONST 0 [TupleVariable(length=1)]
TRACE BINARY_SUBSCR None [TupleVariable(length=1), ConstantVariable(int: 0)]
TRACE STORE_FAST src [ZipVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:291 in construct_dict (construct_dict) (inline depth: 7)
            if not isinstance(src, Iterable):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST src [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL Iterable [NullVariable, LazyVariableTracker(), ZipVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ZipVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 128 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:295 in construct_dict (construct_dict) (inline depth: 7)
            if isinstance(src, (dict, MutableMapping, types.MappingProxyType)):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST src [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL dict [NullVariable, BuiltinVariable(isinstance), ZipVariable()]
TRACE LOAD_GLOBAL MutableMapping [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker()]
TRACE LOAD_GLOBAL types [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR MappingProxyType [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE BUILD_TUPLE 3 [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ZipVariable(), TupleVariable(length=3)]
TRACE POP_JUMP_IF_FALSE 234 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:301 in construct_dict (construct_dict) (inline depth: 7)
                for key, value in src:
TRACE LOAD_FAST src []
TRACE GET_ITER None [ZipVariable()]
TRACE FOR_ITER 262 [ZipVariable()]
TRACE END_FOR None [ZipVariable(), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:304 in construct_dict (construct_dict) (inline depth: 7)
        if kwargs:
TRACE LOAD_FAST kwargs []
TRACE POP_JUMP_IF_FALSE 298 [ConstDictVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:308 in construct_dict (construct_dict) (inline depth: 7)
        return dst
TRACE LOAD_FAST dst []
TRACE RETURN_VALUE None [ConstDictVariable()]
DONE INLINING <code object construct_dict at 0x70c9a070b0a0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 285>
TRACE DICT_UPDATE 1 [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), ConstDictVariable()]
TRACE LOAD_FAST kwargs [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE DICT_UPDATE 1 [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), ConstDictVariable()]
TRACE CALL 1 [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE inlined call <lambda> from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
            kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
                        ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object <lambda> at 0x70c98ce24d30, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 14>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:14 in <lambda> () (inline depth: 7)
        'USE_INITIAL_STATE': lambda args: args['h0'] is not None,
TRACE RESUME 0 []
TRACE LOAD_FAST args []
TRACE LOAD_CONST h0 [ConstDictVariable()]
TRACE BINARY_SUBSCR None [ConstDictVariable(), ConstantVariable(str: 'h0')]
TRACE LOAD_CONST None [TensorVariable()]
TRACE IS_OP 1 [TensorVariable(), ConstantVariable(NoneType: None)]
TRACE RETURN_VALUE None [ConstantVariable(bool: True)]
DONE INLINING <code object <lambda> at 0x70c98ce24d30, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 14>
TRACE LOAD_FAST kwargs [ListIteratorVariable(length=3, index=1), ConstantVariable(bool: True)]
TRACE LOAD_FAST v [ListIteratorVariable(length=3, index=1), ConstantVariable(bool: True), ConstDictVariable()]
TRACE STORE_SUBSCR None [ListIteratorVariable(length=3, index=1), ConstantVariable(bool: True), ConstDictVariable(), ConstantVariable(str: 'USE_INITIAL_STATE')]
TRACE JUMP_BACKWARD 54 [ListIteratorVariable(length=3, index=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:450 in run (Heuristics.run) (inline depth: 6)
            for v, heur in self.values.items():
TRACE FOR_ITER 156 [ListIteratorVariable(length=3, index=1)]
TRACE UNPACK_SEQUENCE 2 [ListIteratorVariable(length=3, index=2), TupleVariable(length=2)]
TRACE STORE_FAST v [ListIteratorVariable(length=3, index=2), LazyVariableTracker(), ConstantVariable(str: 'STORE_FINAL_STATE')]
TRACE STORE_FAST heur [ListIteratorVariable(length=3, index=2), LazyVariableTracker()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
                kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
TRACE PUSH_NULL None [ListIteratorVariable(length=3, index=2)]
TRACE LOAD_FAST heur [ListIteratorVariable(length=3, index=2), NullVariable]
TRACE BUILD_MAP 0 [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL dict [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE LOAD_GLOBAL zip [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict)]
TRACE LOAD_FAST self [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip)]
TRACE LOAD_ATTR arg_names [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip), UserDefinedObjectVariable(Heuristics)]
TRACE LOAD_FAST args [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip), LazyVariableTracker(), TupleVariable(length=0)]
TRACE CALL 1 [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), ZipVariable()]
TRACE inlined call construct_dict from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
            kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
                                ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object construct_dict at 0x70c9a070b0a0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 285>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:285 in construct_dict (construct_dict) (inline depth: 7)
    def construct_dict(cls, /, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:286 in construct_dict (construct_dict) (inline depth: 7)
        dst = cls.__new__(cls)
TRACE LOAD_FAST cls []
TRACE LOAD_ATTR __new__ [BuiltinVariable(dict)]
TRACE LOAD_FAST cls [NullVariable, GetAttrVariable(BuiltinVariable(dict), __new__)]
TRACE CALL 1 [NullVariable, GetAttrVariable(BuiltinVariable(dict), __new__), BuiltinVariable(dict)]
TRACE STORE_FAST dst [ConstDictVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:288 in construct_dict (construct_dict) (inline depth: 7)
        if args:
TRACE LOAD_FAST args []
TRACE POP_JUMP_IF_FALSE 264 [TupleVariable(length=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:289 in construct_dict (construct_dict) (inline depth: 7)
            src = args[0]
TRACE LOAD_FAST args []
TRACE LOAD_CONST 0 [TupleVariable(length=1)]
TRACE BINARY_SUBSCR None [TupleVariable(length=1), ConstantVariable(int: 0)]
TRACE STORE_FAST src [ZipVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:291 in construct_dict (construct_dict) (inline depth: 7)
            if not isinstance(src, Iterable):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST src [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL Iterable [NullVariable, LazyVariableTracker(), ZipVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ZipVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 128 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:295 in construct_dict (construct_dict) (inline depth: 7)
            if isinstance(src, (dict, MutableMapping, types.MappingProxyType)):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST src [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL dict [NullVariable, BuiltinVariable(isinstance), ZipVariable()]
TRACE LOAD_GLOBAL MutableMapping [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker()]
TRACE LOAD_GLOBAL types [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR MappingProxyType [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE BUILD_TUPLE 3 [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ZipVariable(), TupleVariable(length=3)]
TRACE POP_JUMP_IF_FALSE 234 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:301 in construct_dict (construct_dict) (inline depth: 7)
                for key, value in src:
TRACE LOAD_FAST src []
TRACE GET_ITER None [ZipVariable()]
TRACE FOR_ITER 262 [ZipVariable()]
TRACE END_FOR None [ZipVariable(), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:304 in construct_dict (construct_dict) (inline depth: 7)
        if kwargs:
TRACE LOAD_FAST kwargs []
TRACE POP_JUMP_IF_FALSE 298 [ConstDictVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:308 in construct_dict (construct_dict) (inline depth: 7)
        return dst
TRACE LOAD_FAST dst []
TRACE RETURN_VALUE None [ConstDictVariable()]
DONE INLINING <code object construct_dict at 0x70c9a070b0a0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 285>
TRACE DICT_UPDATE 1 [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), ConstDictVariable()]
TRACE LOAD_FAST kwargs [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE DICT_UPDATE 1 [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), ConstDictVariable()]
TRACE CALL 1 [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE inlined call <lambda> from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
            kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
                        ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object <lambda> at 0x70c98ce257c0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 15>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:15 in <lambda> () (inline depth: 7)
        'STORE_FINAL_STATE': lambda args: args['ht'] is not None,
TRACE RESUME 0 []
TRACE LOAD_FAST args []
TRACE LOAD_CONST ht [ConstDictVariable()]
TRACE BINARY_SUBSCR None [ConstDictVariable(), ConstantVariable(str: 'ht')]
TRACE LOAD_CONST None [TensorVariable()]
TRACE IS_OP 1 [TensorVariable(), ConstantVariable(NoneType: None)]
TRACE RETURN_VALUE None [ConstantVariable(bool: True)]
DONE INLINING <code object <lambda> at 0x70c98ce257c0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 15>
TRACE LOAD_FAST kwargs [ListIteratorVariable(length=3, index=2), ConstantVariable(bool: True)]
TRACE LOAD_FAST v [ListIteratorVariable(length=3, index=2), ConstantVariable(bool: True), ConstDictVariable()]
TRACE STORE_SUBSCR None [ListIteratorVariable(length=3, index=2), ConstantVariable(bool: True), ConstDictVariable(), ConstantVariable(str: 'STORE_FINAL_STATE')]
TRACE JUMP_BACKWARD 54 [ListIteratorVariable(length=3, index=2)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:450 in run (Heuristics.run) (inline depth: 6)
            for v, heur in self.values.items():
TRACE FOR_ITER 156 [ListIteratorVariable(length=3, index=2)]
TRACE UNPACK_SEQUENCE 2 [ListIteratorVariable(length=3, index=3), TupleVariable(length=2)]
TRACE STORE_FAST v [ListIteratorVariable(length=3, index=3), LazyVariableTracker(), ConstantVariable(str: 'USE_OFFSETS')]
TRACE STORE_FAST heur [ListIteratorVariable(length=3, index=3), LazyVariableTracker()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
                kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
TRACE PUSH_NULL None [ListIteratorVariable(length=3, index=3)]
TRACE LOAD_FAST heur [ListIteratorVariable(length=3, index=3), NullVariable]
TRACE BUILD_MAP 0 [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL dict [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE LOAD_GLOBAL zip [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict)]
TRACE LOAD_FAST self [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip)]
TRACE LOAD_ATTR arg_names [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip), UserDefinedObjectVariable(Heuristics)]
TRACE LOAD_FAST args [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip), LazyVariableTracker(), TupleVariable(length=0)]
TRACE CALL 1 [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), ZipVariable()]
TRACE inlined call construct_dict from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
            kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
                                ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object construct_dict at 0x70c9a070b0a0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 285>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:285 in construct_dict (construct_dict) (inline depth: 7)
    def construct_dict(cls, /, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:286 in construct_dict (construct_dict) (inline depth: 7)
        dst = cls.__new__(cls)
TRACE LOAD_FAST cls []
TRACE LOAD_ATTR __new__ [BuiltinVariable(dict)]
TRACE LOAD_FAST cls [NullVariable, GetAttrVariable(BuiltinVariable(dict), __new__)]
TRACE CALL 1 [NullVariable, GetAttrVariable(BuiltinVariable(dict), __new__), BuiltinVariable(dict)]
TRACE STORE_FAST dst [ConstDictVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:288 in construct_dict (construct_dict) (inline depth: 7)
        if args:
TRACE LOAD_FAST args []
TRACE POP_JUMP_IF_FALSE 264 [TupleVariable(length=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:289 in construct_dict (construct_dict) (inline depth: 7)
            src = args[0]
TRACE LOAD_FAST args []
TRACE LOAD_CONST 0 [TupleVariable(length=1)]
TRACE BINARY_SUBSCR None [TupleVariable(length=1), ConstantVariable(int: 0)]
TRACE STORE_FAST src [ZipVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:291 in construct_dict (construct_dict) (inline depth: 7)
            if not isinstance(src, Iterable):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST src [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL Iterable [NullVariable, LazyVariableTracker(), ZipVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ZipVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 128 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:295 in construct_dict (construct_dict) (inline depth: 7)
            if isinstance(src, (dict, MutableMapping, types.MappingProxyType)):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST src [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL dict [NullVariable, BuiltinVariable(isinstance), ZipVariable()]
TRACE LOAD_GLOBAL MutableMapping [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker()]
TRACE LOAD_GLOBAL types [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR MappingProxyType [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE BUILD_TUPLE 3 [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ZipVariable(), TupleVariable(length=3)]
TRACE POP_JUMP_IF_FALSE 234 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:301 in construct_dict (construct_dict) (inline depth: 7)
                for key, value in src:
TRACE LOAD_FAST src []
TRACE GET_ITER None [ZipVariable()]
TRACE FOR_ITER 262 [ZipVariable()]
TRACE END_FOR None [ZipVariable(), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:304 in construct_dict (construct_dict) (inline depth: 7)
        if kwargs:
TRACE LOAD_FAST kwargs []
TRACE POP_JUMP_IF_FALSE 298 [ConstDictVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:308 in construct_dict (construct_dict) (inline depth: 7)
        return dst
TRACE LOAD_FAST dst []
TRACE RETURN_VALUE None [ConstDictVariable()]
DONE INLINING <code object construct_dict at 0x70c9a070b0a0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 285>
TRACE DICT_UPDATE 1 [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), ConstDictVariable()]
TRACE LOAD_FAST kwargs [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE DICT_UPDATE 1 [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), ConstDictVariable()]
TRACE CALL 1 [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE inlined call <lambda> from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
            kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
                        ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object <lambda> at 0x70c98ce25a30, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 16>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:16 in <lambda> () (inline depth: 7)
        'USE_OFFSETS': lambda args: args['offsets'] is not None
TRACE RESUME 0 []
TRACE LOAD_FAST args []
TRACE LOAD_CONST offsets [ConstDictVariable()]
TRACE BINARY_SUBSCR None [ConstDictVariable(), ConstantVariable(str: 'offsets')]
TRACE LOAD_CONST None [ConstantVariable(NoneType: None)]
TRACE IS_OP 1 [ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE RETURN_VALUE None [ConstantVariable(bool: False)]
DONE INLINING <code object <lambda> at 0x70c98ce25a30, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 16>
TRACE LOAD_FAST kwargs [ListIteratorVariable(length=3, index=3), ConstantVariable(bool: False)]
TRACE LOAD_FAST v [ListIteratorVariable(length=3, index=3), ConstantVariable(bool: False), ConstDictVariable()]
TRACE STORE_SUBSCR None [ListIteratorVariable(length=3, index=3), ConstantVariable(bool: False), ConstDictVariable(), ConstantVariable(str: 'USE_OFFSETS')]
TRACE JUMP_BACKWARD 54 [ListIteratorVariable(length=3, index=3)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:450 in run (Heuristics.run) (inline depth: 6)
            for v, heur in self.values.items():
TRACE FOR_ITER 156 [ListIteratorVariable(length=3, index=3)]
TRACE END_FOR None [ListIteratorVariable(length=3, index=3), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:452 in run (Heuristics.run) (inline depth: 6)
            return self.fn.run(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(Heuristics)]
TRACE LOAD_ATTR run [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST args [NullVariable, GetAttrVariable(TritonKernelVariable(), run)]
TRACE BUILD_MAP 0 [NullVariable, GetAttrVariable(TritonKernelVariable(), run), TupleVariable(length=0)]
TRACE LOAD_FAST kwargs [NullVariable, GetAttrVariable(TritonKernelVariable(), run), TupleVariable(length=0), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, GetAttrVariable(TritonKernelVariable(), run), TupleVariable(length=0), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, GetAttrVariable(TritonKernelVariable(), run), TupleVariable(length=0), ConstDictVariable()]
TRACE inlined call grid from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:452 in run (Heuristics.run) (inline depth: 6)
        return self.fn.run(*args, **kwargs)
               ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in grid (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 7)
            def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
TRACE RESUME 0 []
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF V [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST meta [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE LOAD_CONST BV [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstDictVariable(), ConstantVariable(str: 'BV')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in grid (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 7)
        def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
                                ~~~~~~~~~~~^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 128)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 128)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 128)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 9)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 9)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [ConstantVariable(int: 128)]
TRACE BINARY_OP 0 [ConstantVariable(int: 128), ConstantVariable(int: 32)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 160)]
TRACE BINARY_OP 10 [ConstantVariable(int: 160), ConstantVariable(int: 1)]
TRACE LOAD_FAST y [ConstantVariable(int: 159)]
TRACE BINARY_OP 2 [ConstantVariable(int: 159), ConstantVariable(int: 32)]
TRACE RETURN_VALUE None [ConstantVariable(int: 4)]
DONE INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [ConstantVariable(int: 4)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 4)]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE LOAD_DEREF N [ConstantVariable(int: 4)]
TRACE LOAD_DEREF H [ConstantVariable(int: 4), ConstantVariable(int: 1)]
TRACE BINARY_OP 5 [ConstantVariable(int: 4), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE BUILD_TUPLE 2 [ConstantVariable(int: 4), ConstantVariable(int: 64)]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>
TRACE inlined call grid from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:452 in run (Heuristics.run) (inline depth: 6)
        return self.fn.run(*args, **kwargs)
               ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in grid (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 7)
            def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
TRACE RESUME 0 []
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF V [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST meta [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE LOAD_CONST BV [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstDictVariable(), ConstantVariable(str: 'BV')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in grid (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 7)
        def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
                                ~~~~~~~~~~~^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 128)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 128)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 128)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 9)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 9)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [ConstantVariable(int: 128)]
TRACE BINARY_OP 0 [ConstantVariable(int: 128), ConstantVariable(int: 32)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 160)]
TRACE BINARY_OP 10 [ConstantVariable(int: 160), ConstantVariable(int: 1)]
TRACE LOAD_FAST y [ConstantVariable(int: 159)]
TRACE BINARY_OP 2 [ConstantVariable(int: 159), ConstantVariable(int: 32)]
TRACE RETURN_VALUE None [ConstantVariable(int: 4)]
DONE INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [ConstantVariable(int: 4)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 4)]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE LOAD_DEREF N [ConstantVariable(int: 4)]
TRACE LOAD_DEREF H [ConstantVariable(int: 4), ConstantVariable(int: 1)]
TRACE BINARY_OP 5 [ConstantVariable(int: 4), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE BUILD_TUPLE 2 [ConstantVariable(int: 4), ConstantVariable(int: 64)]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>
TRACE inlined call grid from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:452 in run (Heuristics.run) (inline depth: 6)
        return self.fn.run(*args, **kwargs)
               ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in grid (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 7)
            def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
TRACE RESUME 0 []
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF V [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST meta [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE LOAD_CONST BV [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstDictVariable(), ConstantVariable(str: 'BV')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in grid (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 7)
        def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
                                ~~~~~~~~~~~^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 128)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 128)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 128)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 9)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 9)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [ConstantVariable(int: 128)]
TRACE BINARY_OP 0 [ConstantVariable(int: 128), ConstantVariable(int: 32)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 160)]
TRACE BINARY_OP 10 [ConstantVariable(int: 160), ConstantVariable(int: 1)]
TRACE LOAD_FAST y [ConstantVariable(int: 159)]
TRACE BINARY_OP 2 [ConstantVariable(int: 159), ConstantVariable(int: 32)]
TRACE RETURN_VALUE None [ConstantVariable(int: 4)]
DONE INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [ConstantVariable(int: 4)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 4)]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE LOAD_DEREF N [ConstantVariable(int: 4)]
TRACE LOAD_DEREF H [ConstantVariable(int: 4), ConstantVariable(int: 1)]
TRACE BINARY_OP 5 [ConstantVariable(int: 4), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE BUILD_TUPLE 2 [ConstantVariable(int: 4), ConstantVariable(int: 64)]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>
TRACE FX call triton_kernel_wrapper_mutation from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:452 in run (Heuristics.run) (inline depth: 6)
        return self.fn.run(*args, **kwargs)
               ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [ConstantVariable(NoneType: None)]
DONE INLINING <code object run at 0x70c9a971df10, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py", line 449>
TRACE RETURN_VALUE None [ConstantVariable(NoneType: None)]
DONE INLINING <code object <lambda> at 0x70c9a9437780, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 419>
TRACE POP_TOP None [ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:176 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            return o, final_state
TRACE LOAD_FAST o []
TRACE LOAD_FAST final_state [TensorVariable()]
TRACE BUILD_TUPLE 2 [TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object forward at 0x3060e8b0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 124>
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object wrapper at 0x70c98d04f0a0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 16>
TRACE UNPACK_SEQUENCE 2 [TupleVariable(length=2)]
TRACE STORE_FAST o [TensorVariable(), TensorVariable()]
TRACE STORE_FAST final_state [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:258 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
        return o, final_state
TRACE LOAD_FAST o []
TRACE LOAD_FAST final_state [TensorVariable()]
TRACE BUILD_TUPLE 2 [TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object fused_recurrent_dplr_delta_rule at 0x305fb4e0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 188>
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object fused_recurrent_rwkv7 at 0x70c98d0c9890, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py", line 11>
TRACE UNPACK_SEQUENCE 2 [TupleVariable(length=2)]
TRACE STORE_FAST xx [TensorVariable(), TensorVariable()]
TRACE STORE_FAST state [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:612 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            xx = xx.view(B,T,-1) * (float(N) ** -0.5)
TRACE LOAD_FAST xx []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: -1)]
TRACE FX call view_15 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:612 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.view(B,T,-1) * (float(N) ** -0.5)
             ~~~~~~~^^^^^^^^
TRACE LOAD_GLOBAL float [TensorVariable()]
TRACE LOAD_FAST N [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE LOAD_CONST -0.5 [TensorVariable(), ConstantVariable(float: 128.0)]
TRACE BINARY_OP 8 [TensorVariable(), ConstantVariable(float: 128.0), ConstantVariable(float: -0.5)]
TRACE BINARY_OP 5 [TensorVariable(), ConstantVariable(float: 0.08838834764831845)]
TRACE FX call mul_12 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:612 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.view(B,T,-1) * (float(N) ** -0.5)
             ~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST xx [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
TRACE LOAD_FAST xx []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST r [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR dtype [NullVariable, GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_10 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
             ~~~~~^^^^^^^^^^^^^^^
TRACE LOAD_FAST r [TensorVariable()]
TRACE LOAD_ATTR view [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST B [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE CALL 4 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_16 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                      ~~~~~~^^^^^^^^^
TRACE LOAD_FAST k [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR view [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST B [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE CALL 4 [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_17 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                                      ~~~~~~^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call mul_13 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                      ~~~~~~~~~~~~~~~^^~~~~~~~~~~~~~~
TRACE LOAD_FAST r_k [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR view [TensorVariable(), TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['r_k'] (8192,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='r_k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_r_k_ L['r_k'] FakeTensor(..., device='cuda:0', size=(8192,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE LOAD_FAST H [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST N [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 64)]
TRACE CALL 2 [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_18 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                                                      ~~~~~~~~^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call mul_14 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^~~~~~~~~~~~~
TRACE LOAD_ATTR sum [TensorVariable(), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), sum)]
TRACE LOAD_CONST True [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), sum), ConstantVariable(int: -1)]
TRACE KW_NAMES ('dim', 'keepdim') [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), sum), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), sum), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call sum_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_FAST v [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR view [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST B [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE CALL 4 [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_19 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                                                                                                 ~~~~~~^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call mul_15 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~
TRACE LOAD_ATTR view [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST B [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE BINARY_OP 5 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE CALL 3 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8192)]
TRACE FX call view_20 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable()]
TRACE FX call add_8 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
             ~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST xx [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:616 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            output = fpx_matmul((xx * (torch.sigmoid(xg) @ g2)), O_, O_state,ebits,mbits)
TRACE LOAD_GLOBAL fpx_matmul []
TRACE LOAD_FAST xx [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL torch [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR sigmoid [NullVariable, LazyVariableTracker(), TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST xg [NullVariable, LazyVariableTracker(), TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call sigmoid_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:616 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        output = fpx_matmul((xx * (torch.sigmoid(xg) @ g2)), O_, O_state,ebits,mbits)
                                   ~~~~~~~~~~~~~^^^^
TRACE LOAD_FAST g2 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE BINARY_OP 4 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['g2'] (480, 8192) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='g2', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_g2_ L['g2'] FakeTensor(..., device='cuda:0', size=(480, 8192), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call matmul_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:616 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        output = fpx_matmul((xx * (torch.sigmoid(xg) @ g2)), O_, O_state,ebits,mbits)
                                   ~~~~~~~~~~~~~~~~~~^~~~
TRACE BINARY_OP 5 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE FX call mul_16 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:616 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        output = fpx_matmul((xx * (torch.sigmoid(xg) @ g2)), O_, O_state,ebits,mbits)
                             ~~~^~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_FAST O_ [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST O_state [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_FAST ebits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST mbits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: -44)]
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: -44), LazyVariableTracker()]
TRACE inlined call fpx_matmul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:616 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        output = fpx_matmul((xx * (torch.sigmoid(xg) @ g2)), O_, O_state,ebits,mbits)
                 ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object fpx_matmul at 0x3063a810, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:420 in fpx_matmul (fpx_matmul) (inline depth: 1)
    def fpx_matmul(x,weight,weight_state,ebits:int=3,mbits:int=2):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:421 in fpx_matmul (fpx_matmul) (inline depth: 1)
        if ebits == -44: #hqq
TRACE LOAD_FAST ebits []
TRACE LOAD_CONST -44 [ConstantVariable(int: -44)]
TRACE COMPARE_OP == [ConstantVariable(int: -44), ConstantVariable(int: -44)]
TRACE POP_JUMP_IF_FALSE 322 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S0=x.shape[0]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 0 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 0)]
TRACE STORE_FAST S0 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S1=x.shape[1]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 1)]
TRACE STORE_FAST S1 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:424 in fpx_matmul (fpx_matmul) (inline depth: 1)
            dtype = x.dtype
TRACE LOAD_FAST x []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
            x = x.to(dtype=torch.float16).view(-1,x.shape[2])
TRACE LOAD_FAST x []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float16 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_11 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST x [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1)]
TRACE LOAD_ATTR shape [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3), ConstantVariable(int: 2)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), ConstantVariable(int: 8192)]
TRACE FX call view_21 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
            out = weight.forward_manual(x).to(dtype=dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_ATTR forward_manual [LazyVariableTracker()]
TRACE LOAD_FAST x [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE CALL 1 [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton)), TensorVariable()]
TRACE inlined call forward_manual from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:543 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        def forward_manual(self, x: Tensor, matmul_type: str="GEMM") -> Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE LOAD_GLOBAL forward_functional []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:545 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                x,
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:546 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.bias,
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR bias [NullVariable, LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_tensor_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_ATTR get_tensor_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_tensor_args at 0x70c98a9e9080>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_tensor_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_tensor_args(),
            ~~~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:524 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
        def get_tensor_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:525 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
            return [self.W_q, self.scales, self.zeros]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR W_q [UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_FAST self [LazyVariableTracker()]
TRACE LOAD_ATTR scales [LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['O_']._parameters['scales'] (128, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='O_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='scales'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_O_parameters_scales_ L['O_']._parameters['scales'] Parameter(FakeTensor(..., device='cuda:0', size=(128, 5120), dtype=torch.float16)) at debug_level 0 before=False
TRACE LOAD_FAST self [LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR zeros [LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['O_']._parameters['zeros'] (128, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='O_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='zeros'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_O_parameters_zeros_ L['O_']._parameters['zeros'] Parameter(FakeTensor(..., device='cuda:0', size=(128, 5120), dtype=torch.float16)) at debug_level 0 before=False
TRACE BUILD_LIST 3 [LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [ListVariable(length=3)]
DONE INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_meta_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3)]
TRACE LOAD_ATTR get_meta_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_meta_args at 0x70c98a9e9120>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_meta_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_meta_args(),
            ~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:527 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
        def get_meta_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE LOAD_GLOBAL int []
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR scaled_activations [NullVariable, LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:529 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_nbits,
TRACE LOAD_FAST self [ConstantVariable(int: 0)]
TRACE LOAD_ATTR W_nbits [ConstantVariable(int: 0), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:530 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.group_size,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker()]
TRACE LOAD_ATTR group_size [ConstantVariable(int: 0), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:531 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.unpack_mask,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR unpack_mask [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:532 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.elements_per_sample,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR elements_per_sample [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:533 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.input_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR input_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:534 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.output_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR output_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:535 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.acc_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR acc_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:536 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.meta_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR meta_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:537 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.channel_scale_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR channel_scale_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:538 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_group_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR W_group_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:539 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    int(self.data_contiguous),
TRACE LOAD_GLOBAL int [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int)]
TRACE LOAD_ATTR data_contiguous [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE BUILD_LIST 12 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [ListVariable(length=12)]
DONE INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:549 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
TRACE LOAD_GLOBAL GEMLITE_MATMUL_TYPES_MAPPING [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12)]
TRACE LOAD_FAST matmul_type [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker(), ConstantVariable(str: 'GEMM')]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), ConstantVariable(int: 4)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        return forward_functional(
               ~~~~~~~~~~~~~~~~~~^
            x,
            ^^
            self.bias,
            ^^^^^^^^^^
            self.get_tensor_args(),
            ^^^^^^^^^^^^^^^^^^^^^^^
            self.get_meta_args(),
            ^^^^^^^^^^^^^^^^^^^^^
            GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:675 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        def __call__(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
            return self._opoverload(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR _opoverload [NullVariable, UserDefinedObjectVariable(CustomOpDef)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=5)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
wrap_to_fake L['O_'].W_q (1024, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=AttrSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='O_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='W_q'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_O_W_q L['O_'].W_q FakeTensor(..., device='cuda:0', size=(1024, 5120), dtype=torch.int32) at debug_level 0 before=False
TRACE FX call forward_functional_default_1 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        return self._opoverload(*args, **kwargs)
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_12 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE STORE_FAST out [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
            return out.view(S0,S1,-1)
TRACE LOAD_FAST out []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST S0 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST S1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: -1)]
TRACE FX call view_22 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
        return out.view(S0,S1,-1)
               ~~~~~~~~^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object fpx_matmul at 0x3063a810, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>
TRACE STORE_FAST output [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:618 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            x_in = x_in + output
TRACE LOAD_FAST x_in []
TRACE LOAD_FAST output [TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable()]
TRACE FX call add_9 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:618 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        x_in = x_in + output
               ~~~~~^~~~~~~~
TRACE STORE_FAST x_in [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:619 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            output = T5RMSNorm(x_in,ln2,variance_epsilon=rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST x_in [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln2 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE KW_NAMES ('variance_epsilon',) [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ConstantVariable(float: 1e-06)]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:619 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        output = T5RMSNorm(x_in,ln2,variance_epsilon=rmsnorm_epsilon)
                 ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_13 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_10 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_17 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln2'] (5120,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln2', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln2_ L['ln2'] FakeTensor(..., device='cuda:0', size=(5120,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_18 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_14 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST output [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:621 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            return  output, x[:,-1], state, v_first, k_first, x_in
TRACE LOAD_FAST output []
TRACE LOAD_FAST x [TensorVariable()]
TRACE LOAD_CONST None [TensorVariable(), TensorVariable()]
TRACE LOAD_CONST None [TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST -1 [TensorVariable(), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [TensorVariable(), TensorVariable(), SliceVariable(), ConstantVariable(int: -1)]
TRACE BINARY_SUBSCR None [TensorVariable(), TensorVariable(), TupleVariable(length=2)]
TRACE FX call getitem_14 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:621 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        return  output, x[:,-1], state, v_first, k_first, x_in
                        ~^^^^^^
TRACE LOAD_FAST state [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST v_first [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST k_first [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST x_in [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 6 [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [TupleVariable(length=6)]
Step 1: torchdynamo done tracing hxa079_TimeMix (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py, line 621 in hxa079_TimeMix>], graph_break=False)
REMOVE UNUSED GRAPHARG L['layer_id']
TRACED GRAPH
 ===== __compiled_fn_43_15094fa8_4aff_45d5_aa78_ba2b061963fe =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, L_x_in_: "[31mbf16[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m", L_ln1_: "[31mbf16[0m[34m[5120][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_wavgk1_: "[31mbf16[0m[34m[5120, 1376][0m[2m[34m[1376, 1][0m[2m[32mcuda:0[0m", L_RKV_parameters_scales_: "[31mf16[0m[34m[80, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m", L_RKV_parameters_zeros_: "[31mf16[0m[34m[80, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m", L_RKV_W_q: "[31mi32[0m[34m[640, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m", L_R_bias_: "[31mbf16[0m[34m[][0m[2m[34m[][0m[2m[32mcuda:0[0m", L_ln_r_: "[31mbf16[0m[34m[128][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_ln_k_: "[31mbf16[0m[34m[128][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_calc_cos_: "[31mf32[0m[34m[1, 1, 128][0m[2m[34m[128, 128, 1][0m[2m[32mcuda:0[0m", L_calc_sin_: "[31mf32[0m[34m[1, 1, 128][0m[2m[34m[128, 128, 1][0m[2m[32mcuda:0[0m", L_a2_: "[31mbf16[0m[34m[160, 8192][0m[2m[34m[8192, 1][0m[2m[32mcuda:0[0m", L_a0_: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m", L_w2_: "[31mbf16[0m[34m[480, 8192][0m[2m[34m[8192, 1][0m[2m[32mcuda:0[0m", L_w0_: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m", L_state_: "[31mbf16[0m[34m[1, 64, 128, 128][0m[2m[34m[1048576, 16384, 128, 1][0m[2m[32mcuda:0[0m", L_r_k_: "[31mbf16[0m[34m[8192][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_g2_: "[31mbf16[0m[34m[480, 8192][0m[2m[34m[8192, 1][0m[2m[32mcuda:0[0m", L_O_parameters_scales_: "[31mf16[0m[34m[128, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m", L_O_parameters_zeros_: "[31mf16[0m[34m[128, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m", L_O_W_q: "[31mi32[0m[34m[1024, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m", L_ln2_: "[31mbf16[0m[34m[5120][0m[2m[34m[1][0m[2m[32mcuda:0[0m"):
        l_x_in_ = L_x_in_
        l_ln1_ = L_ln1_
        l_wavgk1_ = L_wavgk1_
        l_rkv_parameters_scales_ = L_RKV_parameters_scales_
        l_rkv_parameters_zeros_ = L_RKV_parameters_zeros_
        l_rkv_w_q = L_RKV_W_q
        l_r_bias_ = L_R_bias_
        l_ln_r_ = L_ln_r_
        l_ln_k_ = L_ln_k_
        l_calc_cos_ = L_calc_cos_
        l_calc_sin_ = L_calc_sin_
        l_a2_ = L_a2_
        l_a0_ = L_a0_
        l_w2_ = L_w2_
        l_w0_ = L_w0_
        l_state_ = L_state_
        l_r_k_ = L_r_k_
        l_g2_ = L_g2_
        l_o_parameters_scales_ = L_O_parameters_scales_
        l_o_parameters_zeros_ = L_O_parameters_zeros_
        l_o_w_q = L_O_W_q
        l_ln2_ = L_ln2_
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states: "[31mf32[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = l_x_in_.to([34mtorch.float32[0m)
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_1: "[31mf32[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states.pow([34m2[0m)
        variance: "[31mf32[0m[34m[1, 1, 1][0m[2m[34m[1, 1, 1][0m[2m[32mcuda:0[0m" = pow_1.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add: "[31mf32[0m[34m[1, 1, 1][0m[2m[34m[1, 1, 1][0m[2m[32mcuda:0[0m" = variance + [34m1e-06[0m;  [2mvariance = None[0m
        rsqrt: "[31mf32[0m[34m[1, 1, 1][0m[2m[34m[1, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add);  [2madd = None[0m
        hidden_states_1: "[31mf32[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states * rsqrt;  [2mhidden_states = rsqrt = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_1: "[31mf32[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = l_ln1_ * hidden_states_1;  [2ml_ln1_ = hidden_states_1 = None[0m
        x: "[31mbf16[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = mul_1.to([34mtorch.bfloat16[0m);  [2mmul_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:551 in hxa079_TimeMix, code: xw,xa,xv,xg,xk = (x @ wavgk1).split(wavgk_split_list, dim=-1)[0m
        matmul: "[31mbf16[0m[34m[1, 1, 1376][0m[2m[34m[1376, 1376, 1][0m[2m[32mcuda:0[0m" = x @ l_wavgk1_;  [2ml_wavgk1_ = None[0m
        split = matmul.split([[34m480[0m, [34m160[0m, [34m128[0m, [34m480[0m, [34m128[0m], dim = [34m-1[0m);  [2mmatmul = None[0m
        xw: "[31mbf16[0m[34m[1, 1, 480][0m[2m[34m[1376, 1376, 1][0m[2m[32mcuda:0[0m" = split[[34m0[0m]
        xa: "[31mbf16[0m[34m[1, 1, 160][0m[2m[34m[1376, 1376, 1][0m[2m[32mcuda:0[0m" = split[[34m1[0m]
        xg: "[31mbf16[0m[34m[1, 1, 480][0m[2m[34m[1376, 1376, 1][0m[2m[32mcuda:0[0m" = split[[34m3[0m];  [2msplit = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul, code: x = x.to(dtype=torch.float16).view(-1,x.shape[2])[0m
        to_2: "[31mf16[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = x.to(dtype = [34mtorch.float16[0m)
        x_1: "[31mf16[0m[34m[1, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m" = to_2.view([34m-1[0m, [34m5120[0m);  [2mto_2 = None[0m
        
         [2m# File: /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__, code: return self._opoverload(*args, **kwargs)[0m
        forward_functional_default: "[31mf16[0m[34m[1, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m" = torch.ops.gemlite.forward_functional.default(x_1, [34mNone[0m, [l_rkv_w_q, l_rkv_parameters_scales_, l_rkv_parameters_zeros_], [[34m0[0m, [34m4[0m, [34m64[0m, [34m15[0m, [34m8[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m0[0m, [34m4[0m, [34m1[0m], [34m4[0m);  [2mx_1 = l_rkv_w_q = l_rkv_parameters_scales_ = l_rkv_parameters_zeros_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul, code: out = weight.forward_manual(x).to(dtype=dtype)[0m
        out: "[31mbf16[0m[34m[1, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m" = forward_functional_default.to(dtype = [34mtorch.bfloat16[0m);  [2mforward_functional_default = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul, code: return out.view(S0,S1,-1)[0m
        rkv: "[31mbf16[0m[34m[1, 1, 10240][0m[2m[34m[10240, 10240, 1][0m[2m[32mcuda:0[0m" = out.view([34m1[0m, [34m1[0m, [34m-1[0m);  [2mout = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:556 in hxa079_TimeMix, code: r,k,v = rkv.split(rkv_split_list,dim=-1)[0m
        split_1 = rkv.split([[34m8192[0m, [34m1024[0m, [34m1024[0m], dim = [34m-1[0m);  [2mrkv = None[0m
        r: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[10240, 10240, 1][0m[2m[32mcuda:0[0m" = split_1[[34m0[0m]
        k: "[31mbf16[0m[34m[1, 1, 1024][0m[2m[34m[10240, 10240, 1][0m[2m[32mcuda:0[0m" = split_1[[34m1[0m]
        v: "[31mbf16[0m[34m[1, 1, 1024][0m[2m[34m[10240, 10240, 1][0m[2m[32mcuda:0[0m" = split_1[[34m2[0m];  [2msplit_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:562 in hxa079_TimeMix, code: r = r.add_(R_bias)[0m
        r_1: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[10240, 10240, 1][0m[2m[32mcuda:0[0m" = r.add_(l_r_bias_);  [2mr = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:563 in hxa079_TimeMix, code: k = k.add_(K_bias).view(B, T, kv_per_head, N)[0m
        add__1: "[31mbf16[0m[34m[1, 1, 1024][0m[2m[34m[10240, 10240, 1][0m[2m[32mcuda:0[0m" = k.add_(l_r_bias_);  [2mk = None[0m
        k_1: "[31mbf16[0m[34m[1, 1, 8, 128][0m[2m[34m[10240, 10240, 128, 1][0m[2m[32mcuda:0[0m" = add__1.view([34m1[0m, [34m1[0m, [34m8[0m, [34m128[0m);  [2madd__1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:564 in hxa079_TimeMix, code: v = v.add_(V_bias).view(B, T, kv_per_head, N)[0m
        add__2: "[31mbf16[0m[34m[1, 1, 1024][0m[2m[34m[10240, 10240, 1][0m[2m[32mcuda:0[0m" = v.add_(l_r_bias_);  [2mv = l_r_bias_ = None[0m
        v_1: "[31mbf16[0m[34m[1, 1, 8, 128][0m[2m[34m[10240, 10240, 128, 1][0m[2m[32mcuda:0[0m" = add__2.view([34m1[0m, [34m1[0m, [34m8[0m, [34m128[0m);  [2madd__2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:572 in hxa079_TimeMix, code: r = T5RMSNorm(r.view(B,T,H,N), ln_r, variance_epsilon=rmsnorm_epsilon)[0m
        view_4: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[10240, 10240, 128, 1][0m[2m[32mcuda:0[0m" = r_1.view([34m1[0m, [34m1[0m, [34m64[0m, [34m128[0m);  [2mr_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states_2: "[31mf32[0m[34m[1, 1, 64, 128][0m[2m[34m[10240, 10240, 128, 1][0m[2m[32mcuda:0[0m" = view_4.to([34mtorch.float32[0m);  [2mview_4 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_2: "[31mf32[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_2.pow([34m2[0m)
        variance_1: "[31mf32[0m[34m[1, 1, 64, 1][0m[2m[34m[64, 64, 1, 1][0m[2m[32mcuda:0[0m" = pow_2.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add_1: "[31mf32[0m[34m[1, 1, 64, 1][0m[2m[34m[64, 64, 1, 1][0m[2m[32mcuda:0[0m" = variance_1 + [34m1e-06[0m;  [2mvariance_1 = None[0m
        rsqrt_1: "[31mf32[0m[34m[1, 1, 64, 1][0m[2m[34m[64, 64, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add_1);  [2madd_1 = None[0m
        hidden_states_3: "[31mf32[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_2 * rsqrt_1;  [2mhidden_states_2 = rsqrt_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_3: "[31mf32[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = l_ln_r_ * hidden_states_3;  [2ml_ln_r_ = hidden_states_3 = None[0m
        r_2: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = mul_3.to([34mtorch.bfloat16[0m);  [2mmul_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states_4: "[31mf32[0m[34m[1, 1, 8, 128][0m[2m[34m[10240, 10240, 128, 1][0m[2m[32mcuda:0[0m" = k_1.to([34mtorch.float32[0m);  [2mk_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_3: "[31mf32[0m[34m[1, 1, 8, 128][0m[2m[34m[1024, 1024, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_4.pow([34m2[0m)
        variance_2: "[31mf32[0m[34m[1, 1, 8, 1][0m[2m[34m[8, 8, 1, 1][0m[2m[32mcuda:0[0m" = pow_3.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add_2: "[31mf32[0m[34m[1, 1, 8, 1][0m[2m[34m[8, 8, 1, 1][0m[2m[32mcuda:0[0m" = variance_2 + [34m1e-06[0m;  [2mvariance_2 = None[0m
        rsqrt_2: "[31mf32[0m[34m[1, 1, 8, 1][0m[2m[34m[8, 8, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add_2);  [2madd_2 = None[0m
        hidden_states_5: "[31mf32[0m[34m[1, 1, 8, 128][0m[2m[34m[1024, 1024, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_4 * rsqrt_2;  [2mhidden_states_4 = rsqrt_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_5: "[31mf32[0m[34m[1, 1, 8, 128][0m[2m[34m[1024, 1024, 128, 1][0m[2m[32mcuda:0[0m" = l_ln_k_ * hidden_states_5;  [2ml_ln_k_ = hidden_states_5 = None[0m
        k_2: "[31mbf16[0m[34m[1, 1, 8, 128][0m[2m[34m[1024, 1024, 128, 1][0m[2m[32mcuda:0[0m" = mul_5.to([34mtorch.bfloat16[0m);  [2mmul_5 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:576 in hxa079_TimeMix, code: cos, sin = calc_cos.to(k.dtype), calc_sin.to(k.dtype)[0m
        cos: "[31mbf16[0m[34m[1, 1, 128][0m[2m[34m[128, 128, 1][0m[2m[32mcuda:0[0m" = l_calc_cos_.to([34mtorch.bfloat16[0m);  [2ml_calc_cos_ = None[0m
        sin: "[31mbf16[0m[34m[1, 1, 128][0m[2m[34m[128, 128, 1][0m[2m[32mcuda:0[0m" = l_calc_sin_.to([34mtorch.bfloat16[0m);  [2ml_calc_sin_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:493 in apply_rotary_pos_emb, code: cos = cos.unsqueeze(unsqueeze_dim)[0m
        cos_1: "[31mbf16[0m[34m[1, 1, 1, 128][0m[2m[34m[128, 128, 128, 1][0m[2m[32mcuda:0[0m" = cos.unsqueeze([34m2[0m);  [2mcos = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:494 in apply_rotary_pos_emb, code: sin = sin.unsqueeze(unsqueeze_dim)[0m
        sin_1: "[31mbf16[0m[34m[1, 1, 1, 128][0m[2m[34m[128, 128, 128, 1][0m[2m[32mcuda:0[0m" = sin.unsqueeze([34m2[0m);  [2msin = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb, code: q_embed = (q * cos) + (rotate_half(q) * sin)[0m
        mul_6: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = r_2 * cos_1
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half, code: x1 = x[..., : x.shape[-1] // 2][0m
        x1: "[31mbf16[0m[34m[1, 1, 64, 64][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = r_2[([34mEllipsis[0m, slice([34mNone[0m, [34m64[0m, [34mNone[0m))]
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half, code: x2 = x[..., x.shape[-1] // 2 :][0m
        x2: "[31mbf16[0m[34m[1, 1, 64, 64][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = r_2[([34mEllipsis[0m, slice([34m64[0m, [34mNone[0m, [34mNone[0m))];  [2mr_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half, code: return torch.cat((-x2, x1), dim=-1)[0m
        neg: "[31mbf16[0m[34m[1, 1, 64, 64][0m[2m[34m[4096, 4096, 64, 1][0m[2m[32mcuda:0[0m" = -x2;  [2mx2 = None[0m
        cat: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = torch.cat((neg, x1), dim = [34m-1[0m);  [2mneg = x1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb, code: q_embed = (q * cos) + (rotate_half(q) * sin)[0m
        mul_7: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = cat * sin_1;  [2mcat = None[0m
        q_embed: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = mul_6 + mul_7;  [2mmul_6 = mul_7 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb, code: k_embed = (k * cos) + (rotate_half(k) * sin)[0m
        mul_8: "[31mbf16[0m[34m[1, 1, 8, 128][0m[2m[34m[1024, 1024, 128, 1][0m[2m[32mcuda:0[0m" = k_2 * cos_1;  [2mcos_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half, code: x1 = x[..., : x.shape[-1] // 2][0m
        x1_1: "[31mbf16[0m[34m[1, 1, 8, 64][0m[2m[34m[1024, 1024, 128, 1][0m[2m[32mcuda:0[0m" = k_2[([34mEllipsis[0m, slice([34mNone[0m, [34m64[0m, [34mNone[0m))]
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half, code: x2 = x[..., x.shape[-1] // 2 :][0m
        x2_1: "[31mbf16[0m[34m[1, 1, 8, 64][0m[2m[34m[1024, 1024, 128, 1][0m[2m[32mcuda:0[0m" = k_2[([34mEllipsis[0m, slice([34m64[0m, [34mNone[0m, [34mNone[0m))];  [2mk_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half, code: return torch.cat((-x2, x1), dim=-1)[0m
        neg_1: "[31mbf16[0m[34m[1, 1, 8, 64][0m[2m[34m[512, 512, 64, 1][0m[2m[32mcuda:0[0m" = -x2_1;  [2mx2_1 = None[0m
        cat_1: "[31mbf16[0m[34m[1, 1, 8, 128][0m[2m[34m[1024, 1024, 128, 1][0m[2m[32mcuda:0[0m" = torch.cat((neg_1, x1_1), dim = [34m-1[0m);  [2mneg_1 = x1_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb, code: k_embed = (k * cos) + (rotate_half(k) * sin)[0m
        mul_9: "[31mbf16[0m[34m[1, 1, 8, 128][0m[2m[34m[1024, 1024, 128, 1][0m[2m[32mcuda:0[0m" = cat_1 * sin_1;  [2mcat_1 = sin_1 = None[0m
        k_embed: "[31mbf16[0m[34m[1, 1, 8, 128][0m[2m[34m[1024, 1024, 128, 1][0m[2m[32mcuda:0[0m" = mul_8 + mul_9;  [2mmul_8 = mul_9 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:357 in repeat_kv, code: hidden_states = hidden_states[:, :, :, None, :]  # (B, T, H_kv, 1, D)[0m
        hidden_states_6: "[31mbf16[0m[34m[1, 1, 8, 1, 128][0m[2m[34m[1024, 1024, 128, 128, 1][0m[2m[32mcuda:0[0m" = k_embed[(slice([34mNone[0m, [34mNone[0m, [34mNone[0m), slice([34mNone[0m, [34mNone[0m, [34mNone[0m), slice([34mNone[0m, [34mNone[0m, [34mNone[0m), [34mNone[0m, slice([34mNone[0m, [34mNone[0m, [34mNone[0m))]
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:358 in repeat_kv, code: hidden_states = hidden_states.expand(B, T, H_kv, n_rep, D)  # (B, T, H_kv, n_rep, D)[0m
        hidden_states_7: "[31mbf16[0m[34m[1, 1, 8, 8, 128][0m[2m[34m[1024, 1024, 128, 0, 1][0m[2m[32mcuda:0[0m" = hidden_states_6.expand([34m1[0m, [34m1[0m, [34m8[0m, [34m8[0m, [34m128[0m);  [2mhidden_states_6 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv, code: return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()[0m
        reshape: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_7.reshape([34m1[0m, [34m1[0m, [34m64[0m, [34m128[0m);  [2mhidden_states_7 = None[0m
        contiguous: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = reshape.contiguous();  [2mreshape = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:589 in hxa079_TimeMix, code: k = repeat_kv(k, kv_repeat).view(B, T, -1)[0m
        k_3: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = contiguous.view([34m1[0m, [34m1[0m, [34m-1[0m);  [2mcontiguous = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:357 in repeat_kv, code: hidden_states = hidden_states[:, :, :, None, :]  # (B, T, H_kv, 1, D)[0m
        hidden_states_8: "[31mbf16[0m[34m[1, 1, 8, 1, 128][0m[2m[34m[10240, 10240, 128, 128, 1][0m[2m[32mcuda:0[0m" = v_1[(slice([34mNone[0m, [34mNone[0m, [34mNone[0m), slice([34mNone[0m, [34mNone[0m, [34mNone[0m), slice([34mNone[0m, [34mNone[0m, [34mNone[0m), [34mNone[0m, slice([34mNone[0m, [34mNone[0m, [34mNone[0m))]
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:358 in repeat_kv, code: hidden_states = hidden_states.expand(B, T, H_kv, n_rep, D)  # (B, T, H_kv, n_rep, D)[0m
        hidden_states_9: "[31mbf16[0m[34m[1, 1, 8, 8, 128][0m[2m[34m[10240, 10240, 128, 0, 1][0m[2m[32mcuda:0[0m" = hidden_states_8.expand([34m1[0m, [34m1[0m, [34m8[0m, [34m8[0m, [34m128[0m);  [2mhidden_states_8 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv, code: return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()[0m
        reshape_1: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_9.reshape([34m1[0m, [34m1[0m, [34m64[0m, [34m128[0m);  [2mhidden_states_9 = None[0m
        contiguous_1: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = reshape_1.contiguous();  [2mreshape_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:590 in hxa079_TimeMix, code: v = repeat_kv(v, kv_repeat).view(B, T, -1)[0m
        v_2: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = contiguous_1.view([34m1[0m, [34m1[0m, [34m-1[0m);  [2mcontiguous_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:593 in hxa079_TimeMix, code: a = torch.sigmoid(xa @ a2 + a0)[0m
        matmul_1: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = xa @ l_a2_;  [2mxa = l_a2_ = None[0m
        add_5: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = matmul_1 + l_a0_;  [2mmatmul_1 = l_a0_ = None[0m
        a: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = torch.sigmoid(add_5);  [2madd_5 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:595 in hxa079_TimeMix, code: kk = F.normalize(k.view(B, T, H, N), p=2.0, dim=-1).view(B, T, H*N)[0m
        view_7: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = k_3.view([34m1[0m, [34m1[0m, [34m64[0m, [34m128[0m)
        normalize: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = torch.nn.functional.normalize(view_7, p = [34m2.0[0m, dim = [34m-1[0m);  [2mview_7 = None[0m
        kk: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = normalize.view([34m1[0m, [34m1[0m, [34m8192[0m);  [2mnormalize = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:596 in hxa079_TimeMix, code: w = torch.tanh(xw) @ w2 + w0[0m
        tanh: "[31mbf16[0m[34m[1, 1, 480][0m[2m[34m[480, 480, 1][0m[2m[32mcuda:0[0m" = torch.tanh(xw);  [2mxw = None[0m
        matmul_2: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = tanh @ l_w2_;  [2mtanh = l_w2_ = None[0m
        w: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = matmul_2 + l_w0_;  [2mmatmul_2 = l_w0_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:597 in hxa079_TimeMix, code: w = -F.softplus(-w) - 0.5[0m
        neg_2: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = -w;  [2mw = None[0m
        softplus: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = torch._C._nn.softplus(neg_2);  [2mneg_2 = None[0m
        neg_3: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = -softplus;  [2msoftplus = None[0m
        w_1: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = neg_3 - [34m0.5[0m;  [2mneg_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:598 in hxa079_TimeMix, code: k = k * (1.0 - w + a)[0m
        sub_1: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = [34m1.0[0m - w_1
        add_7: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = sub_1 + a;  [2msub_1 = None[0m
        k_4: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = k_3 * add_7;  [2mk_3 = add_7 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:600 in hxa079_TimeMix, code: aa = -kk[0m
        aa: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = -kk
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:601 in hxa079_TimeMix, code: bb = kk * a[0m
        bb: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = kk * a;  [2mkk = a = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:603 in hxa079_TimeMix, code: w = -w.exp()#.to(dtype=torch.float32).exp()[0m
        exp: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = w_1.exp();  [2mw_1 = None[0m
        w_2: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = -exp;  [2mexp = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:604 in hxa079_TimeMix, code: r_,w_,k_,v_,aa_,bb_ = [i.view(B,T,H,N) for i in [r,w,k,v,aa,bb]][0m
        r_: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = q_embed.view([34m1[0m, [34m1[0m, [34m64[0m, [34m128[0m)
        w_: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = w_2.view([34m1[0m, [34m1[0m, [34m64[0m, [34m128[0m);  [2mw_2 = None[0m
        k_: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = k_4.view([34m1[0m, [34m1[0m, [34m64[0m, [34m128[0m)
        v_: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = v_2.view([34m1[0m, [34m1[0m, [34m64[0m, [34m128[0m)
        aa_: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = aa.view([34m1[0m, [34m1[0m, [34m64[0m, [34m128[0m);  [2maa = None[0m
        bb_: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = bb.view([34m1[0m, [34m1[0m, [34m64[0m, [34m128[0m);  [2mbb = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:19 in <genexpr>, code: *(i if not isinstance(i, torch.Tensor) else i.contiguous() for i in args),[0m
        contiguous_2: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = r_.contiguous();  [2mr_ = None[0m
        contiguous_3: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = k_.contiguous();  [2mk_ = None[0m
        contiguous_4: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = v_.contiguous();  [2mv_ = None[0m
        contiguous_5: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = aa_.contiguous();  [2maa_ = None[0m
        contiguous_6: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = bb_.contiguous();  [2mbb_ = None[0m
        contiguous_7: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = w_.contiguous();  [2mw_ = None[0m
        contiguous_8: "[31mbf16[0m[34m[1, 64, 128, 128][0m[2m[34m[1048576, 16384, 128, 1][0m[2m[32mcuda:0[0m" = l_state_.contiguous();  [2ml_state_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:148 in forward, code: final_state = q.new_empty(B, H, K, V, dtype=torch.float32)[0m
        final_state: "[31mf32[0m[34m[1, 64, 128, 128][0m[2m[34m[1048576, 16384, 128, 1][0m[2m[32mcuda:0[0m" = contiguous_2.new_empty([34m1[0m, [34m64[0m, [34m128[0m, [34m128[0m, dtype = [34mtorch.float32[0m)
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:152 in forward, code: ha = torch.empty_like(v, dtype=torch.float32)[0m
        ha: "[31mf32[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = torch.empty_like(contiguous_4, dtype = [34mtorch.float32[0m)
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:155 in forward, code: o = torch.empty_like(v)[0m
        o: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = torch.empty_like(contiguous_4)
        
         [2m# File: /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:452 in run, code: return self.fn.run(*args, **kwargs)[0m
        triton_kernel_wrapper_mutation = torch.ops.higher_order.triton_kernel_wrapper_mutation(kernel_idx = [34m0[0m, constant_args_idx = [34m7[0m, grid = [([34m4[0m, [34m64[0m, [34m1[0m), ([34m4[0m, [34m64[0m, [34m1[0m), ([34m4[0m, [34m64[0m, [34m1[0m)], tma_descriptor_metadata = [34m{}[0m, kwargs = [34m{'q': contiguous_2, 'k': contiguous_3, 'v': contiguous_4, 'a': contiguous_5, 'b': contiguous_6, 'gk': contiguous_7, 'o': o, 'ha': ha, 'h0': contiguous_8, 'ht': final_state}[0m);  [2mcontiguous_2 = contiguous_3 = contiguous_4 = contiguous_5 = contiguous_6 = contiguous_7 = ha = contiguous_8 = triton_kernel_wrapper_mutation = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:612 in hxa079_TimeMix, code: xx = xx.view(B,T,-1) * (float(N) ** -0.5)[0m
        view_15: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = o.view([34m1[0m, [34m1[0m, [34m-1[0m);  [2mo = None[0m
        xx: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = view_15 * [34m0.08838834764831845[0m;  [2mview_15 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix, code: xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)[0m
        to_10: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = xx.to(dtype = [34mtorch.bfloat16[0m);  [2mxx = None[0m
        view_16: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = q_embed.view([34m1[0m, [34m1[0m, [34m64[0m, [34m128[0m);  [2mq_embed = None[0m
        view_17: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = k_4.view([34m1[0m, [34m1[0m, [34m64[0m, [34m128[0m);  [2mk_4 = None[0m
        mul_13: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = view_16 * view_17;  [2mview_16 = view_17 = None[0m
        view_18: "[31mbf16[0m[34m[64, 128][0m[2m[34m[128, 1][0m[2m[32mcuda:0[0m" = l_r_k_.view([34m64[0m, [34m128[0m);  [2ml_r_k_ = None[0m
        mul_14: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = mul_13 * view_18;  [2mmul_13 = view_18 = None[0m
        sum_1: "[31mbf16[0m[34m[1, 1, 64, 1][0m[2m[34m[64, 64, 1, 1][0m[2m[32mcuda:0[0m" = mul_14.sum(dim = [34m-1[0m, keepdim = [34mTrue[0m);  [2mmul_14 = None[0m
        view_19: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = v_2.view([34m1[0m, [34m1[0m, [34m64[0m, [34m128[0m);  [2mv_2 = None[0m
        mul_15: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = sum_1 * view_19;  [2msum_1 = view_19 = None[0m
        view_20: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = mul_15.view([34m1[0m, [34m1[0m, [34m8192[0m);  [2mmul_15 = None[0m
        xx_1: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = to_10 + view_20;  [2mto_10 = view_20 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:616 in hxa079_TimeMix, code: output = fpx_matmul((xx * (torch.sigmoid(xg) @ g2)), O_, O_state,ebits,mbits)[0m
        sigmoid_1: "[31mbf16[0m[34m[1, 1, 480][0m[2m[34m[480, 480, 1][0m[2m[32mcuda:0[0m" = torch.sigmoid(xg);  [2mxg = None[0m
        matmul_3: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = sigmoid_1 @ l_g2_;  [2msigmoid_1 = l_g2_ = None[0m
        mul_16: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = xx_1 * matmul_3;  [2mxx_1 = matmul_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul, code: x = x.to(dtype=torch.float16).view(-1,x.shape[2])[0m
        to_11: "[31mf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = mul_16.to(dtype = [34mtorch.float16[0m);  [2mmul_16 = None[0m
        x_2: "[31mf16[0m[34m[1, 8192][0m[2m[34m[8192, 1][0m[2m[32mcuda:0[0m" = to_11.view([34m-1[0m, [34m8192[0m);  [2mto_11 = None[0m
        
         [2m# File: /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__, code: return self._opoverload(*args, **kwargs)[0m
        forward_functional_default_1: "[31mf16[0m[34m[1, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m" = torch.ops.gemlite.forward_functional.default(x_2, [34mNone[0m, [l_o_w_q, l_o_parameters_scales_, l_o_parameters_zeros_], [[34m0[0m, [34m4[0m, [34m64[0m, [34m15[0m, [34m8[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m0[0m, [34m4[0m, [34m1[0m], [34m4[0m);  [2mx_2 = l_o_w_q = l_o_parameters_scales_ = l_o_parameters_zeros_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul, code: out = weight.forward_manual(x).to(dtype=dtype)[0m
        out_1: "[31mbf16[0m[34m[1, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m" = forward_functional_default_1.to(dtype = [34mtorch.bfloat16[0m);  [2mforward_functional_default_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul, code: return out.view(S0,S1,-1)[0m
        output: "[31mbf16[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = out_1.view([34m1[0m, [34m1[0m, [34m-1[0m);  [2mout_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:618 in hxa079_TimeMix, code: x_in = x_in + output[0m
        x_in: "[31mbf16[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = l_x_in_ + output;  [2ml_x_in_ = output = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states_10: "[31mf32[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = x_in.to([34mtorch.float32[0m)
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_4: "[31mf32[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states_10.pow([34m2[0m)
        variance_3: "[31mf32[0m[34m[1, 1, 1][0m[2m[34m[1, 1, 1][0m[2m[32mcuda:0[0m" = pow_4.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_4 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add_10: "[31mf32[0m[34m[1, 1, 1][0m[2m[34m[1, 1, 1][0m[2m[32mcuda:0[0m" = variance_3 + [34m1e-06[0m;  [2mvariance_3 = None[0m
        rsqrt_3: "[31mf32[0m[34m[1, 1, 1][0m[2m[34m[1, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add_10);  [2madd_10 = None[0m
        hidden_states_11: "[31mf32[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states_10 * rsqrt_3;  [2mhidden_states_10 = rsqrt_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_18: "[31mf32[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = l_ln2_ * hidden_states_11;  [2ml_ln2_ = hidden_states_11 = None[0m
        output_1: "[31mbf16[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = mul_18.to([34mtorch.bfloat16[0m);  [2mmul_18 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:621 in hxa079_TimeMix, code: return  output, x[:,-1], state, v_first, k_first, x_in[0m
        getitem_14: "[31mbf16[0m[34m[1, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m" = x[(slice([34mNone[0m, [34mNone[0m, [34mNone[0m), [34m-1[0m)];  [2mx = None[0m
        return (output_1, getitem_14, final_state, v_1, k_embed, x_in)
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing hxa079_TimeMix /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:524
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:524 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7)
        @torch.compile
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:550 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            x = T5RMSNorm(x_in,ln1,variance_epsilon=rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST x_in [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE KW_NAMES ('variance_epsilon',) [NullVariable, LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:550 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        x = T5RMSNorm(x_in,ln1,variance_epsilon=rmsnorm_epsilon)
            ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
wrap_to_fake L['x_in'] (1, 1, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='x_in', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_x_in_ L['x_in'] FakeTensor(..., device='cuda:0', size=(1, 1, 5120), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE FX call add from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln1'] (5120,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln1', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln1_ L['ln1'] FakeTensor(..., device='cuda:0', size=(5120,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:551 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            xw,xa,xv,xg,xk = (x @ wavgk1).split(wavgk_split_list, dim=-1)
TRACE LOAD_FAST x []
TRACE LOAD_FAST wavgk1 [TensorVariable()]
TRACE BINARY_OP 4 [TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['wavgk1'] (5120, 1376) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='wavgk1', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_wavgk1_ L['wavgk1'] FakeTensor(..., device='cuda:0', size=(5120, 1376), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call matmul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:551 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xw,xa,xv,xg,xk = (x @ wavgk1).split(wavgk_split_list, dim=-1)
                          ~~^~~~~~~~
TRACE LOAD_ATTR split [TensorVariable()]
TRACE LOAD_FAST wavgk_split_list [NullVariable, GetAttrVariable(TensorVariable(), split)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker()]
TRACE KW_NAMES ('dim',) [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE FX call split from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:551 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xw,xa,xv,xg,xk = (x @ wavgk1).split(wavgk_split_list, dim=-1)
                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE UNPACK_SEQUENCE 5 [TupleVariable(length=5)]
TRACE STORE_FAST xw [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST xa [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST xv [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST xg [TensorVariable(), TensorVariable()]
TRACE STORE_FAST xk [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:553 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            B, T, HN = x.shape
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 3 [SizeVariable(length=3)]
TRACE STORE_FAST B [ConstantVariable(int: 5120), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 5120), ConstantVariable(int: 1)]
TRACE STORE_FAST HN [ConstantVariable(int: 5120)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:555 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            rkv = fpx_matmul(x, RKV_,RKV_state, ebits, mbits)
TRACE LOAD_GLOBAL fpx_matmul []
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST RKV_ [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST RKV_state [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_FAST ebits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST mbits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call fpx_matmul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:555 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        rkv = fpx_matmul(x, RKV_,RKV_state, ebits, mbits)
              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object fpx_matmul at 0x3063a810, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:420 in fpx_matmul (fpx_matmul) (inline depth: 1)
    def fpx_matmul(x,weight,weight_state,ebits:int=3,mbits:int=2):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:421 in fpx_matmul (fpx_matmul) (inline depth: 1)
        if ebits == -44: #hqq
TRACE LOAD_FAST ebits []
TRACE LOAD_CONST -44 [LazyVariableTracker()]
TRACE COMPARE_OP == [LazyVariableTracker(), ConstantVariable(int: -44)]
TRACE POP_JUMP_IF_FALSE 322 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S0=x.shape[0]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 0 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 0)]
TRACE STORE_FAST S0 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S1=x.shape[1]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 1)]
TRACE STORE_FAST S1 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:424 in fpx_matmul (fpx_matmul) (inline depth: 1)
            dtype = x.dtype
TRACE LOAD_FAST x []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
            x = x.to(dtype=torch.float16).view(-1,x.shape[2])
TRACE LOAD_FAST x []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float16 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_2 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST x [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1)]
TRACE LOAD_ATTR shape [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3), ConstantVariable(int: 2)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), ConstantVariable(int: 5120)]
TRACE FX call view from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
            out = weight.forward_manual(x).to(dtype=dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_ATTR forward_manual [LazyVariableTracker()]
TRACE LOAD_FAST x [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE CALL 1 [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton)), TensorVariable()]
TRACE inlined call forward_manual from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:543 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        def forward_manual(self, x: Tensor, matmul_type: str="GEMM") -> Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE LOAD_GLOBAL forward_functional []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:545 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                x,
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:546 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.bias,
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR bias [NullVariable, LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_tensor_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_ATTR get_tensor_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_tensor_args at 0x70c98a9e9080>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_tensor_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_tensor_args(),
            ~~~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:524 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
        def get_tensor_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:525 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
            return [self.W_q, self.scales, self.zeros]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR W_q [UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_FAST self [LazyVariableTracker()]
TRACE LOAD_ATTR scales [LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['RKV_']._parameters['scales'] (80, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='RKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='scales'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_RKV_parameters_scales_ L['RKV_']._parameters['scales'] Parameter(FakeTensor(..., device='cuda:0', size=(80, 10240), dtype=torch.float16)) at debug_level 0 before=False
TRACE LOAD_FAST self [LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR zeros [LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['RKV_']._parameters['zeros'] (80, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='RKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='zeros'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_RKV_parameters_zeros_ L['RKV_']._parameters['zeros'] Parameter(FakeTensor(..., device='cuda:0', size=(80, 10240), dtype=torch.float16)) at debug_level 0 before=False
TRACE BUILD_LIST 3 [LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [ListVariable(length=3)]
DONE INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_meta_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3)]
TRACE LOAD_ATTR get_meta_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_meta_args at 0x70c98a9e9120>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_meta_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_meta_args(),
            ~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:527 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
        def get_meta_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE LOAD_GLOBAL int []
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR scaled_activations [NullVariable, LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:529 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_nbits,
TRACE LOAD_FAST self [ConstantVariable(int: 0)]
TRACE LOAD_ATTR W_nbits [ConstantVariable(int: 0), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:530 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.group_size,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker()]
TRACE LOAD_ATTR group_size [ConstantVariable(int: 0), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:531 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.unpack_mask,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR unpack_mask [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:532 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.elements_per_sample,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR elements_per_sample [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:533 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.input_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR input_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:534 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.output_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR output_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:535 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.acc_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR acc_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:536 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.meta_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR meta_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:537 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.channel_scale_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR channel_scale_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:538 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_group_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR W_group_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:539 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    int(self.data_contiguous),
TRACE LOAD_GLOBAL int [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int)]
TRACE LOAD_ATTR data_contiguous [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE BUILD_LIST 12 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [ListVariable(length=12)]
DONE INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:549 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
TRACE LOAD_GLOBAL GEMLITE_MATMUL_TYPES_MAPPING [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12)]
TRACE LOAD_FAST matmul_type [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker(), ConstantVariable(str: 'GEMM')]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        return forward_functional(
               ~~~~~~~~~~~~~~~~~~^
            x,
            ^^
            self.bias,
            ^^^^^^^^^^
            self.get_tensor_args(),
            ^^^^^^^^^^^^^^^^^^^^^^^
            self.get_meta_args(),
            ^^^^^^^^^^^^^^^^^^^^^
            GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:675 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        def __call__(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
            return self._opoverload(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR _opoverload [NullVariable, UserDefinedObjectVariable(CustomOpDef)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=5)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
wrap_to_fake L['RKV_'].W_q (640, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=AttrSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='RKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='W_q'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_RKV_W_q L['RKV_'].W_q FakeTensor(..., device='cuda:0', size=(640, 10240), dtype=torch.int32) at debug_level 0 before=False
TRACE FX call forward_functional_default from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        return self._opoverload(*args, **kwargs)
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_3 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE STORE_FAST out [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
            return out.view(S0,S1,-1)
TRACE LOAD_FAST out []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST S0 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST S1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: -1)]
TRACE FX call view_1 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
        return out.view(S0,S1,-1)
               ~~~~~~~~^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object fpx_matmul at 0x3063a810, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>
TRACE STORE_FAST rkv [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:556 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            r,k,v = rkv.split(rkv_split_list,dim=-1)
TRACE LOAD_FAST rkv []
TRACE LOAD_ATTR split [TensorVariable()]
TRACE LOAD_FAST rkv_split_list [NullVariable, GetAttrVariable(TensorVariable(), split)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker()]
TRACE KW_NAMES ('dim',) [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE FX call split_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:556 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        r,k,v = rkv.split(rkv_split_list,dim=-1)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
TRACE UNPACK_SEQUENCE 3 [TupleVariable(length=3)]
TRACE STORE_FAST r [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST k [TensorVariable(), TensorVariable()]
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:558 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            kv_dim = k.shape[2] # B,T,kv_dim
TRACE LOAD_FAST k []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 2 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 2)]
TRACE STORE_FAST kv_dim [ConstantVariable(int: 1024)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:559 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            kv_repeat = H*N // kv_dim
TRACE LOAD_FAST H []
TRACE LOAD_FAST N [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST kv_dim [ConstantVariable(int: 8192)]
TRACE BINARY_OP 2 [ConstantVariable(int: 8192), ConstantVariable(int: 1024)]
TRACE STORE_FAST kv_repeat [ConstantVariable(int: 8)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:560 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            kv_per_head = kv_dim // N
TRACE LOAD_FAST kv_dim []
TRACE LOAD_FAST N [ConstantVariable(int: 1024)]
TRACE BINARY_OP 2 [ConstantVariable(int: 1024), ConstantVariable(int: 128)]
TRACE STORE_FAST kv_per_head [ConstantVariable(int: 8)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:562 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            r = r.add_(R_bias)
TRACE LOAD_FAST r []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST R_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
wrap_to_fake L['R_bias'] () StatefulSymbolicContext(dynamic_sizes=[], dynamic_strides=[], constraint_sizes=[], constraint_strides=[], specialize_on=[], view_base_context=None, tensor_source=LocalSource(local_name='R_bias', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_R_bias_ L['R_bias'] FakeTensor(..., device='cuda:0', size=(), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call add_ from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:562 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        r = r.add_(R_bias)
            ~~~~~~^^^^^^^^
TRACE STORE_FAST r [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:563 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = k.add_(K_bias).view(B, T, kv_per_head, N)
TRACE LOAD_FAST k []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST K_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
TRACE FX call add__1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:563 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = k.add_(K_bias).view(B, T, kv_per_head, N)
            ~~~~~~^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_per_head [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:563 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = k.add_(K_bias).view(B, T, kv_per_head, N)
            ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:564 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            v = v.add_(V_bias).view(B, T, kv_per_head, N)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST V_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
TRACE FX call add__2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:564 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        v = v.add_(V_bias).view(B, T, kv_per_head, N)
            ~~~~~~^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_per_head [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:564 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        v = v.add_(V_bias).view(B, T, kv_per_head, N)
            ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:568 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            if ln_r is None:
TRACE LOAD_FAST ln_r []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
wrap_to_fake L['ln_r'] (128,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln_r', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln_r_ L['ln_r'] FakeTensor(..., device='cuda:0', size=(128,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE POP_JUMP_IF_TRUE 478 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:572 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
                r = T5RMSNorm(r.view(B,T,H,N), ln_r, variance_epsilon=rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST r [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR view [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:572 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            r = T5RMSNorm(r.view(B,T,H,N), ln_r, variance_epsilon=rmsnorm_epsilon)
                          ~~~~~~^^^^^^^^^
TRACE LOAD_FAST ln_r [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE KW_NAMES ('variance_epsilon',) [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:572 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            r = T5RMSNorm(r.view(B,T,H,N), ln_r, variance_epsilon=rmsnorm_epsilon)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST r [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:573 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
                k = T5RMSNorm(k, ln_k, variance_epsilon=rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln_k [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE KW_NAMES ('variance_epsilon',) [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ConstantVariable(float: 1e-06)]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:573 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = T5RMSNorm(k, ln_k, variance_epsilon=rmsnorm_epsilon)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln_k'] (128,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln_k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln_k_ L['ln_k'] FakeTensor(..., device='cuda:0', size=(128,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:576 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            cos, sin = calc_cos.to(k.dtype), calc_sin.to(k.dtype)
TRACE LOAD_FAST calc_cos []
TRACE LOAD_ATTR to [LazyVariableTracker()]
wrap_to_fake L['calc_cos'] (1, 1, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='calc_cos', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_calc_cos_ L['calc_cos'] FakeTensor(..., device='cuda:0', size=(1, 1, 128)) at debug_level 0 before=False
TRACE LOAD_FAST k [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR dtype [NullVariable, GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_8 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:576 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        cos, sin = calc_cos.to(k.dtype), calc_sin.to(k.dtype)
                   ~~~~~~~~~~~^^^^^^^^^
TRACE LOAD_FAST calc_sin [TensorVariable()]
TRACE LOAD_ATTR to [TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['calc_sin'] (1, 1, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='calc_sin', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_calc_sin_ L['calc_sin'] FakeTensor(..., device='cuda:0', size=(1, 1, 128)) at debug_level 0 before=False
TRACE LOAD_FAST k [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR dtype [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE CALL 1 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_9 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:576 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        cos, sin = calc_cos.to(k.dtype), calc_sin.to(k.dtype)
                                         ~~~~~~~~~~~^^^^^^^^^
TRACE STORE_FAST sin [TensorVariable(), TensorVariable()]
TRACE STORE_FAST cos [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:577 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            r, k = apply_rotary_pos_emb(r, k, cos, sin,unsqueeze_dim=2)
TRACE LOAD_GLOBAL apply_rotary_pos_emb []
TRACE LOAD_FAST r [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST cos [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST sin [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE KW_NAMES ('unsqueeze_dim',) [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(int: 2)]
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(int: 2)]
TRACE inlined call apply_rotary_pos_emb from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:577 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        r, k = apply_rotary_pos_emb(r, k, cos, sin,unsqueeze_dim=2)
               ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object apply_rotary_pos_emb at 0x70c98a344710, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 473>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:473 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    def apply_rotary_pos_emb(q, k, cos, sin, position_ids=None, unsqueeze_dim=1):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:493 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
        cos = cos.unsqueeze(unsqueeze_dim)
TRACE LOAD_FAST cos []
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_FAST unsqueeze_dim [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int: 2)]
TRACE FX call unsqueeze from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:493 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    cos = cos.unsqueeze(unsqueeze_dim)
          ~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST cos [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:494 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
        sin = sin.unsqueeze(unsqueeze_dim)
TRACE LOAD_FAST sin []
TRACE LOAD_ATTR unsqueeze [TensorVariable()]
TRACE LOAD_FAST unsqueeze_dim [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int: 2)]
TRACE FX call unsqueeze_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:494 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    sin = sin.unsqueeze(unsqueeze_dim)
          ~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST sin [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
        q_embed = (q * cos) + (rotate_half(q) * sin)
TRACE LOAD_FAST q []
TRACE LOAD_FAST cos [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    q_embed = (q * cos) + (rotate_half(q) * sin)
               ~~^~~~~
TRACE LOAD_GLOBAL rotate_half [TensorVariable()]
TRACE LOAD_FAST q [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE inlined call rotate_half from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    q_embed = (q * cos) + (rotate_half(q) * sin)
                           ~~~~~~~~~~~^^^
INLINING <code object rotate_half at 0x70c98a344450, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 467>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:467 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    def rotate_half(x):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
        x1 = x[..., : x.shape[-1] // 2]
TRACE LOAD_FAST x []
TRACE LOAD_CONST Ellipsis [TensorVariable()]
TRACE LOAD_CONST None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis)]
TRACE LOAD_FAST x [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None)]
TRACE LOAD_ATTR shape [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), SizeVariable(length=4)]
TRACE BINARY_SUBSCR None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), SizeVariable(length=4), ConstantVariable(int: -1)]
TRACE LOAD_CONST 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), ConstantVariable(int: 128)]
TRACE BINARY_OP 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), ConstantVariable(int: 128), ConstantVariable(int: 2)]
TRACE BUILD_SLICE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), ConstantVariable(int: 64)]
TRACE BUILD_TUPLE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SliceVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), TupleVariable(length=2)]
TRACE FX call getitem_8 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    x1 = x[..., : x.shape[-1] // 2]
         ~^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST x1 [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
        x2 = x[..., x.shape[-1] // 2 :]
TRACE LOAD_FAST x []
TRACE LOAD_CONST Ellipsis [TensorVariable()]
TRACE LOAD_FAST x [TensorVariable(), ConstantVariable(ellipsis: Ellipsis)]
TRACE LOAD_ATTR shape [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SizeVariable(length=4)]
TRACE BINARY_SUBSCR None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SizeVariable(length=4), ConstantVariable(int: -1)]
TRACE LOAD_CONST 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 128)]
TRACE BINARY_OP 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 128), ConstantVariable(int: 2)]
TRACE LOAD_CONST None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 64)]
TRACE BUILD_SLICE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 64), ConstantVariable(NoneType: None)]
TRACE BUILD_TUPLE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SliceVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), TupleVariable(length=2)]
TRACE FX call getitem_9 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    x2 = x[..., x.shape[-1] // 2 :]
         ~^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST x2 [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
        return torch.cat((-x2, x1), dim=-1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST x2 [NullVariable, LazyVariableTracker()]
TRACE UNARY_NEGATIVE None [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call neg from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    return torch.cat((-x2, x1), dim=-1)
                      ^^^
TRACE LOAD_FAST x1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, LazyVariableTracker(), TupleVariable(length=2)]
TRACE KW_NAMES ('dim',) [NullVariable, LazyVariableTracker(), TupleVariable(length=2), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TupleVariable(length=2), ConstantVariable(int: -1)]
TRACE FX call cat from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    return torch.cat((-x2, x1), dim=-1)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object rotate_half at 0x70c98a344450, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 467>
TRACE LOAD_FAST sin [TensorVariable(), TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call mul_7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    q_embed = (q * cos) + (rotate_half(q) * sin)
                           ~~~~~~~~~~~~~~~^~~~~
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable()]
TRACE FX call add_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    q_embed = (q * cos) + (rotate_half(q) * sin)
              ~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST q_embed [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
        k_embed = (k * cos) + (rotate_half(k) * sin)
TRACE LOAD_FAST k []
TRACE LOAD_FAST cos [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_8 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    k_embed = (k * cos) + (rotate_half(k) * sin)
               ~~^~~~~
TRACE LOAD_GLOBAL rotate_half [TensorVariable()]
TRACE LOAD_FAST k [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE inlined call rotate_half from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    k_embed = (k * cos) + (rotate_half(k) * sin)
                           ~~~~~~~~~~~^^^
INLINING <code object rotate_half at 0x70c98a344450, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 467>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:467 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    def rotate_half(x):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
        x1 = x[..., : x.shape[-1] // 2]
TRACE LOAD_FAST x []
TRACE LOAD_CONST Ellipsis [TensorVariable()]
TRACE LOAD_CONST None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis)]
TRACE LOAD_FAST x [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None)]
TRACE LOAD_ATTR shape [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), SizeVariable(length=4)]
TRACE BINARY_SUBSCR None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), SizeVariable(length=4), ConstantVariable(int: -1)]
TRACE LOAD_CONST 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), ConstantVariable(int: 128)]
TRACE BINARY_OP 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), ConstantVariable(int: 128), ConstantVariable(int: 2)]
TRACE BUILD_SLICE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(NoneType: None), ConstantVariable(int: 64)]
TRACE BUILD_TUPLE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SliceVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), TupleVariable(length=2)]
TRACE FX call getitem_10 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    x1 = x[..., : x.shape[-1] // 2]
         ~^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST x1 [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
        x2 = x[..., x.shape[-1] // 2 :]
TRACE LOAD_FAST x []
TRACE LOAD_CONST Ellipsis [TensorVariable()]
TRACE LOAD_FAST x [TensorVariable(), ConstantVariable(ellipsis: Ellipsis)]
TRACE LOAD_ATTR shape [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SizeVariable(length=4)]
TRACE BINARY_SUBSCR None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SizeVariable(length=4), ConstantVariable(int: -1)]
TRACE LOAD_CONST 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 128)]
TRACE BINARY_OP 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 128), ConstantVariable(int: 2)]
TRACE LOAD_CONST None [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 64)]
TRACE BUILD_SLICE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), ConstantVariable(int: 64), ConstantVariable(NoneType: None)]
TRACE BUILD_TUPLE 2 [TensorVariable(), ConstantVariable(ellipsis: Ellipsis), SliceVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), TupleVariable(length=2)]
TRACE FX call getitem_11 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    x2 = x[..., x.shape[-1] // 2 :]
         ~^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST x2 [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
        return torch.cat((-x2, x1), dim=-1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST x2 [NullVariable, LazyVariableTracker()]
TRACE UNARY_NEGATIVE None [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call neg_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    return torch.cat((-x2, x1), dim=-1)
                      ^^^
TRACE LOAD_FAST x1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, LazyVariableTracker(), TupleVariable(length=2)]
TRACE KW_NAMES ('dim',) [NullVariable, LazyVariableTracker(), TupleVariable(length=2), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TupleVariable(length=2), ConstantVariable(int: -1)]
TRACE FX call cat_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half (fused_recurrent_dplr_delta_rule_decode_t1.grid.rotate_half) (inline depth: 2)
    return torch.cat((-x2, x1), dim=-1)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object rotate_half at 0x70c98a344450, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 467>
TRACE LOAD_FAST sin [TensorVariable(), TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call mul_9 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    k_embed = (k * cos) + (rotate_half(k) * sin)
                           ~~~~~~~~~~~~~~~^~~~~
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable()]
TRACE FX call add_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
    k_embed = (k * cos) + (rotate_half(k) * sin)
              ~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST k_embed [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:497 in apply_rotary_pos_emb (fused_recurrent_dplr_delta_rule_decode_t1.grid.apply_rotary_pos_emb) (inline depth: 1)
        return q_embed, k_embed
TRACE LOAD_FAST q_embed []
TRACE LOAD_FAST k_embed [TensorVariable()]
TRACE BUILD_TUPLE 2 [TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object apply_rotary_pos_emb at 0x70c98a344710, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 473>
TRACE UNPACK_SEQUENCE 2 [TupleVariable(length=2)]
TRACE STORE_FAST r [TensorVariable(), TensorVariable()]
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:579 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            if layer_id == 0:
TRACE LOAD_FAST layer_id []
TRACE LOAD_CONST 0 [LazyVariableTracker()]
TRACE COMPARE_OP == [LazyVariableTracker(), ConstantVariable(int: 0)]
create_graph_input L_layer_id_ L['layer_id'] s56 at debug_level 0 before=False
TRACE FX call eq from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:579 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        if layer_id == 0:
           ^^^^^^^^^^^^^
TRACE POP_JUMP_IF_FALSE 736 [SymNodeVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:584 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
                v = v + (v_first - v) * torch.sigmoid(xv@v2 + v0).view(B, T, kv_per_head, N)
TRACE LOAD_FAST v []
TRACE LOAD_FAST v_first [TensorVariable()]
TRACE LOAD_FAST v [TensorVariable(), LazyVariableTracker()]
TRACE BINARY_OP 10 [TensorVariable(), LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['v_first'] (1, 1, 8, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None, None], specialize_on=[[], [], [], []], view_base_context=None, tensor_source=LocalSource(local_name='v_first', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_v_first_ L['v_first'] FakeTensor(..., device='cuda:0', size=(1, 1, 8, 128), dtype=torch.bfloat16) at debug_level 0 before=False
create_graph_input s80 L['v_first'].stride()[0] s80 at debug_level 0 before=True
_lift_symbols_in_symint s80 from L['v_first'].stride()[0] at debug_level 0
create_graph_input s81 L['v_first'].storage_offset() s81 at debug_level 0 before=True
_lift_symbols_in_symint s81 from L['v_first'].storage_offset() at debug_level 0
TRACE FX call sub from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:584 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            v = v + (v_first - v) * torch.sigmoid(xv@v2 + v0).view(B, T, kv_per_head, N)
                     ~~~~~~~~^~~
TRACE LOAD_GLOBAL torch [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR sigmoid [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST xv [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST v2 [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 4 [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['v2'] (128, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='v2', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_v2_ L['v2'] FakeTensor(..., device='cuda:0', size=(128, 1024), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call matmul_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:584 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            v = v + (v_first - v) * torch.sigmoid(xv@v2 + v0).view(B, T, kv_per_head, N)
                                                  ~~^^~
TRACE LOAD_FAST v0 [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['v0'] (1, 1, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='v0', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_v0_ L['v0'] FakeTensor(..., device='cuda:0', size=(1, 1, 1024), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call add_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:584 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            v = v + (v_first - v) * torch.sigmoid(xv@v2 + v0).view(B, T, kv_per_head, N)
                                                  ~~~~~~^~~~
TRACE CALL 1 [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call sigmoid from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:584 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            v = v + (v_first - v) * torch.sigmoid(xv@v2 + v0).view(B, T, kv_per_head, N)
                                    ~~~~~~~~~~~~~^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST B [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_per_head [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8)]
TRACE CALL 4 [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:584 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            v = v + (v_first - v) * torch.sigmoid(xv@v2 + v0).view(B, T, kv_per_head, N)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call mul_10 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:584 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            v = v + (v_first - v) * torch.sigmoid(xv@v2 + v0).view(B, T, kv_per_head, N)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable()]
TRACE FX call add_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:584 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            v = v + (v_first - v) * torch.sigmoid(xv@v2 + v0).view(B, T, kv_per_head, N)
                ~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:585 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
                k = k + (k_first - k) * torch.sigmoid(xk@k2 + k0).view(B, T, kv_per_head, N)
TRACE LOAD_FAST k []
TRACE LOAD_FAST k_first [TensorVariable()]
TRACE LOAD_FAST k [TensorVariable(), LazyVariableTracker()]
TRACE BINARY_OP 10 [TensorVariable(), LazyVariableTracker(), TensorVariable()]
automatic dynamic stride L['k_first'] stride(0) InferStride(dim=2) != InferStride(dim=1)
wrap_to_fake L['k_first'] (1, 1, 8, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None, None], specialize_on=[[], [], [], []], view_base_context=None, tensor_source=LocalSource(local_name='k_first', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_k_first_ L['k_first'] FakeTensor(..., device='cuda:0', size=(1, 1, 8, 128), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call sub_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:585 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = k + (k_first - k) * torch.sigmoid(xk@k2 + k0).view(B, T, kv_per_head, N)
                     ~~~~~~~~^~~
TRACE LOAD_GLOBAL torch [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR sigmoid [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST xk [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST k2 [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 4 [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['k2'] (128, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='k2', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_k2_ L['k2'] FakeTensor(..., device='cuda:0', size=(128, 1024), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call matmul_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:585 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = k + (k_first - k) * torch.sigmoid(xk@k2 + k0).view(B, T, kv_per_head, N)
                                                  ~~^^~
TRACE LOAD_FAST k0 [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['k0'] (1, 1, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='k0', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_k0_ L['k0'] FakeTensor(..., device='cuda:0', size=(1, 1, 1024), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call add_7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:585 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = k + (k_first - k) * torch.sigmoid(xk@k2 + k0).view(B, T, kv_per_head, N)
                                                  ~~~~~~^~~~
TRACE CALL 1 [TensorVariable(), TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call sigmoid_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:585 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = k + (k_first - k) * torch.sigmoid(xk@k2 + k0).view(B, T, kv_per_head, N)
                                    ~~~~~~~~~~~~~^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST B [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_per_head [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8)]
TRACE CALL 4 [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:585 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = k + (k_first - k) * torch.sigmoid(xk@k2 + k0).view(B, T, kv_per_head, N)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call mul_11 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:585 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = k + (k_first - k) * torch.sigmoid(xk@k2 + k0).view(B, T, kv_per_head, N)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable()]
TRACE FX call add_8 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:585 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = k + (k_first - k) * torch.sigmoid(xk@k2 + k0).view(B, T, kv_per_head, N)
                ~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:589 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = repeat_kv(k, kv_repeat).view(B, T, -1)
TRACE LOAD_GLOBAL repeat_kv []
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST kv_repeat [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 8)]
TRACE inlined call repeat_kv from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:589 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = repeat_kv(k, kv_repeat).view(B, T, -1)
            ~~~~~~~~~^^^^^^^^^^^^^^
INLINING <code object repeat_kv at 0x70c98a2f25b0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 347>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:347 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    def repeat_kv(hidden_states: torch.Tensor, n_rep: int) -> torch.Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:353 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        B, T, H_kv, D = hidden_states.shape
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 4 [SizeVariable(length=4)]
TRACE STORE_FAST B [ConstantVariable(int: 128), ConstantVariable(int: 8), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 128), ConstantVariable(int: 8), ConstantVariable(int: 1)]
TRACE STORE_FAST H_kv [ConstantVariable(int: 128), ConstantVariable(int: 8)]
TRACE STORE_FAST D [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:354 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        if n_rep == 1:
TRACE LOAD_FAST n_rep []
TRACE LOAD_CONST 1 [ConstantVariable(int: 8)]
TRACE COMPARE_OP == [ConstantVariable(int: 8), ConstantVariable(int: 1)]
TRACE POP_JUMP_IF_FALSE 50 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:357 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        hidden_states = hidden_states[:, :, :, None, :]  # (B, T, H_kv, 1, D)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_CONST None [TensorVariable()]
TRACE LOAD_CONST None [TensorVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable()]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable()]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable()]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE BUILD_TUPLE 5 [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), SliceVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), TupleVariable(length=5)]
TRACE FX call getitem_12 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:357 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    hidden_states = hidden_states[:, :, :, None, :]  # (B, T, H_kv, 1, D)
                    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:358 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        hidden_states = hidden_states.expand(B, T, H_kv, n_rep, D)  # (B, T, H_kv, n_rep, D)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR expand [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), expand)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1)]
TRACE LOAD_FAST H_kv [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST n_rep [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8)]
TRACE LOAD_FAST D [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8), ConstantVariable(int: 8)]
TRACE CALL 5 [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call expand from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:358 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    hidden_states = hidden_states.expand(B, T, H_kv, n_rep, D)  # (B, T, H_kv, n_rep, D)
                    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR reshape [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), reshape)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1)]
TRACE LOAD_FAST H_kv [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST n_rep [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8)]
TRACE BINARY_OP 5 [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8), ConstantVariable(int: 8)]
TRACE LOAD_FAST D [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call reshape from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR contiguous [TensorVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE FX call contiguous from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object repeat_kv at 0x70c98a2f25b0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 347>
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: -1)]
TRACE FX call view_7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:589 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = repeat_kv(k, kv_repeat).view(B, T, -1)
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:590 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            v = repeat_kv(v, kv_repeat).view(B, T, -1)
TRACE LOAD_GLOBAL repeat_kv []
TRACE LOAD_FAST v [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST kv_repeat [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 8)]
TRACE inlined call repeat_kv from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:590 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        v = repeat_kv(v, kv_repeat).view(B, T, -1)
            ~~~~~~~~~^^^^^^^^^^^^^^
INLINING <code object repeat_kv at 0x70c98a2f25b0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 347>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:347 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    def repeat_kv(hidden_states: torch.Tensor, n_rep: int) -> torch.Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:353 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        B, T, H_kv, D = hidden_states.shape
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 4 [SizeVariable(length=4)]
TRACE STORE_FAST B [ConstantVariable(int: 128), ConstantVariable(int: 8), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 128), ConstantVariable(int: 8), ConstantVariable(int: 1)]
TRACE STORE_FAST H_kv [ConstantVariable(int: 128), ConstantVariable(int: 8)]
TRACE STORE_FAST D [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:354 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        if n_rep == 1:
TRACE LOAD_FAST n_rep []
TRACE LOAD_CONST 1 [ConstantVariable(int: 8)]
TRACE COMPARE_OP == [ConstantVariable(int: 8), ConstantVariable(int: 1)]
TRACE POP_JUMP_IF_FALSE 50 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:357 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        hidden_states = hidden_states[:, :, :, None, :]  # (B, T, H_kv, 1, D)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_CONST None [TensorVariable()]
TRACE LOAD_CONST None [TensorVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable()]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable()]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable()]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST None [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE BUILD_TUPLE 5 [TensorVariable(), SliceVariable(), SliceVariable(), SliceVariable(), ConstantVariable(NoneType: None), SliceVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), TupleVariable(length=5)]
TRACE FX call getitem_13 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:357 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    hidden_states = hidden_states[:, :, :, None, :]  # (B, T, H_kv, 1, D)
                    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:358 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        hidden_states = hidden_states.expand(B, T, H_kv, n_rep, D)  # (B, T, H_kv, n_rep, D)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR expand [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), expand)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1)]
TRACE LOAD_FAST H_kv [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST n_rep [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8)]
TRACE LOAD_FAST D [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8), ConstantVariable(int: 8)]
TRACE CALL 5 [NullVariable, GetAttrVariable(TensorVariable(), expand), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call expand_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:358 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    hidden_states = hidden_states.expand(B, T, H_kv, n_rep, D)  # (B, T, H_kv, n_rep, D)
                    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
        return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR reshape [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), reshape)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1)]
TRACE LOAD_FAST H_kv [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST n_rep [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8)]
TRACE BINARY_OP 5 [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8), ConstantVariable(int: 8)]
TRACE LOAD_FAST D [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), reshape), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call reshape_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR contiguous [TensorVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE FX call contiguous_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv (fused_recurrent_dplr_delta_rule_decode_t1.grid.repeat_kv) (inline depth: 1)
    return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object repeat_kv at 0x70c98a2f25b0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 347>
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: -1)]
TRACE FX call view_8 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:590 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        v = repeat_kv(v, kv_repeat).view(B, T, -1)
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:593 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            a = torch.sigmoid(xa @ a2 + a0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR sigmoid [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST xa [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST a2 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 4 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['a2'] (160, 8192) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='a2', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_a2_ L['a2'] FakeTensor(..., device='cuda:0', size=(160, 8192), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call matmul_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:593 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        a = torch.sigmoid(xa @ a2 + a0)
                          ~~~^~~~
TRACE LOAD_FAST a0 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['a0'] (1, 1, 8192) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='a0', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_a0_ L['a0'] FakeTensor(..., device='cuda:0', size=(1, 1, 8192), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call add_9 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:593 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        a = torch.sigmoid(xa @ a2 + a0)
                          ~~~~~~~~^~~~
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call sigmoid_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:593 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        a = torch.sigmoid(xa @ a2 + a0)
            ~~~~~~~~~~~~~^^^^^^^^^^^^^^
TRACE STORE_FAST a [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:595 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            kk = F.normalize(k.view(B, T, H, N), p=2.0, dim=-1).view(B, T, H*N)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR normalize [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR view [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_9 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:595 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        kk = F.normalize(k.view(B, T, H, N), p=2.0, dim=-1).view(B, T, H*N)
                         ~~~~~~^^^^^^^^^^^^
TRACE LOAD_CONST 2.0 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 2.0)]
TRACE KW_NAMES ('p', 'dim') [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 2.0), ConstantVariable(int: -1)]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 2.0), ConstantVariable(int: -1)]
TRACE FX call normalize from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:595 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        kk = F.normalize(k.view(B, T, H, N), p=2.0, dim=-1).view(B, T, H*N)
             ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE BINARY_OP 5 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8192)]
TRACE FX call view_10 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:595 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        kk = F.normalize(k.view(B, T, H, N), p=2.0, dim=-1).view(B, T, H*N)
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
TRACE STORE_FAST kk [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:596 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            w = torch.tanh(xw) @ w2 + w0
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR tanh [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST xw [NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call tanh from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:596 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = torch.tanh(xw) @ w2 + w0
            ~~~~~~~~~~^^^^
TRACE LOAD_FAST w2 [TensorVariable()]
TRACE BINARY_OP 4 [TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['w2'] (480, 8192) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='w2', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_w2_ L['w2'] FakeTensor(..., device='cuda:0', size=(480, 8192), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call matmul_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:596 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = torch.tanh(xw) @ w2 + w0
            ~~~~~~~~~~~~~~~^~~~
TRACE LOAD_FAST w0 [TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['w0'] (1, 1, 8192) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='w0', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_w0_ L['w0'] FakeTensor(..., device='cuda:0', size=(1, 1, 8192), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call add_10 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:596 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = torch.tanh(xw) @ w2 + w0
            ~~~~~~~~~~~~~~~~~~~~^~~~
TRACE STORE_FAST w [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:597 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            w = -F.softplus(-w) - 0.5
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR softplus [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST w [NullVariable, LazyVariableTracker()]
TRACE UNARY_NEGATIVE None [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call neg_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:597 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = -F.softplus(-w) - 0.5
                        ^^
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call softplus from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:597 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = -F.softplus(-w) - 0.5
             ~~~~~~~~~~^^^^
TRACE UNARY_NEGATIVE None [TensorVariable()]
TRACE FX call neg_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:597 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = -F.softplus(-w) - 0.5
            ^^^^^^^^^^^^^^^
TRACE LOAD_CONST 0.5 [TensorVariable()]
TRACE BINARY_OP 10 [TensorVariable(), ConstantVariable(float: 0.5)]
TRACE FX call sub_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:597 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = -F.softplus(-w) - 0.5
            ~~~~~~~~~~~~~~~~^~~~~
TRACE STORE_FAST w [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:598 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            k = k * (1.0 - w + a)
TRACE LOAD_FAST k []
TRACE LOAD_CONST 1.0 [TensorVariable()]
TRACE LOAD_FAST w [TensorVariable(), ConstantVariable(float: 1.0)]
TRACE BINARY_OP 10 [TensorVariable(), ConstantVariable(float: 1.0), TensorVariable()]
TRACE FX call sub_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:598 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = k * (1.0 - w + a)
                 ~~~~^~~
TRACE LOAD_FAST a [TensorVariable(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call add_11 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:598 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = k * (1.0 - w + a)
                 ~~~~~~~~^~~
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_12 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:598 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        k = k * (1.0 - w + a)
            ~~^~~~~~~~~~~~~~~
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:600 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            aa = -kk
TRACE LOAD_FAST kk []
TRACE UNARY_NEGATIVE None [TensorVariable()]
TRACE FX call neg_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:600 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        aa = -kk
             ^^^
TRACE STORE_FAST aa [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:601 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            bb = kk * a
TRACE LOAD_FAST kk []
TRACE LOAD_FAST a [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_13 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:601 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        bb = kk * a
             ~~~^~~
TRACE STORE_FAST bb [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:603 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            w = -w.exp()#.to(dtype=torch.float32).exp()
TRACE LOAD_FAST w []
TRACE LOAD_ATTR exp [TensorVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), exp)]
TRACE FX call exp from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:603 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = -w.exp()#.to(dtype=torch.float32).exp()
             ~~~~~^^
TRACE UNARY_NEGATIVE None [TensorVariable()]
TRACE FX call neg_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:603 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        w = -w.exp()#.to(dtype=torch.float32).exp()
            ^^^^^^^^
TRACE STORE_FAST w [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:604 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            r_,w_,k_,v_,aa_,bb_ = [i.view(B,T,H,N) for i in [r,w,k,v,aa,bb]]
TRACE LOAD_FAST r []
TRACE LOAD_FAST w [TensorVariable()]
TRACE LOAD_FAST k [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST v [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST aa [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST bb [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 6 [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE GET_ITER None [TupleVariable(length=6)]
TRACE LOAD_FAST_AND_CLEAR i [ListIteratorVariable(length=6, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=6, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=6, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=6, index=0), ListVariable(length=0)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=0)]
TRACE STORE_FAST i [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), TensorVariable()]
TRACE LOAD_FAST i [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1)]
TRACE LOAD_ATTR view [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_11 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:604 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        r_,w_,k_,v_,aa_,bb_ = [i.view(B,T,H,N) for i in [r,w,k,v,aa,bb]]
                               ~~~~~~^^^^^^^^^
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=6, index=1), TensorVariable()]
TRACE JUMP_BACKWARD 1448 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=1)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=1)]
TRACE STORE_FAST i [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), TensorVariable()]
TRACE LOAD_FAST i [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2)]
TRACE LOAD_ATTR view [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=6, index=2), TensorVariable()]
TRACE JUMP_BACKWARD 1448 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=2)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=2)]
TRACE STORE_FAST i [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), TensorVariable()]
TRACE LOAD_FAST i [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3)]
TRACE LOAD_ATTR view [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=6, index=3), TensorVariable()]
TRACE JUMP_BACKWARD 1448 [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=3)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=3)]
TRACE STORE_FAST i [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), TensorVariable()]
TRACE LOAD_FAST i [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4)]
TRACE LOAD_ATTR view [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=3), ListIteratorVariable(length=6, index=4), TensorVariable()]
TRACE JUMP_BACKWARD 1448 [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=4)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=4)]
TRACE STORE_FAST i [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), TensorVariable()]
TRACE LOAD_FAST i [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5)]
TRACE LOAD_ATTR view [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=4), ListIteratorVariable(length=6, index=5), TensorVariable()]
TRACE JUMP_BACKWARD 1448 [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=5)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=5)]
TRACE STORE_FAST i [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), TensorVariable()]
TRACE LOAD_FAST i [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6)]
TRACE LOAD_ATTR view [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), TensorVariable()]
TRACE LOAD_FAST B [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=5), ListIteratorVariable(length=6, index=6), TensorVariable()]
TRACE JUMP_BACKWARD 1448 [NullVariable, ListVariable(length=6), ListIteratorVariable(length=6, index=6)]
TRACE FOR_ITER 1496 [NullVariable, ListVariable(length=6), ListIteratorVariable(length=6, index=6)]
TRACE END_FOR None [NullVariable, ListVariable(length=6), ListIteratorVariable(length=6, index=6), ConstantVariable(NoneType: None)]
TRACE SWAP 2 [NullVariable, ListVariable(length=6)]
TRACE STORE_FAST i [ListVariable(length=6), NullVariable]
TRACE UNPACK_SEQUENCE 6 [ListVariable(length=6)]
TRACE STORE_FAST r_ [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST w_ [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST k_ [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST v_ [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST aa_ [TensorVariable(), TensorVariable()]
TRACE STORE_FAST bb_ [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:605 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            B,T,_,_ = r_.shape
TRACE LOAD_FAST r_ []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 4 [SizeVariable(length=4)]
TRACE STORE_FAST B [ConstantVariable(int: 128), ConstantVariable(int: 64), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 128), ConstantVariable(int: 64), ConstantVariable(int: 1)]
TRACE STORE_FAST _ [ConstantVariable(int: 128), ConstantVariable(int: 64)]
TRACE STORE_FAST _ [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:609 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            xx, state = fused_recurrent_rwkv7(r_, w_, k_, v_, aa_, bb_, scale=1.0, initial_state=state, output_final_state=True, head_first=False)
TRACE LOAD_GLOBAL fused_recurrent_rwkv7 []
TRACE LOAD_FAST r_ [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST w_ [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST k_ [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST v_ [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST aa_ [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST bb_ [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 1.0 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST state [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0)]
TRACE LOAD_CONST True [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker()]
TRACE LOAD_CONST False [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True)]
TRACE KW_NAMES ('scale', 'initial_state', 'output_final_state', 'head_first') [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(bool: False)]
TRACE CALL 10 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(bool: False)]
TRACE inlined call fused_recurrent_rwkv7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:609 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx, state = fused_recurrent_rwkv7(r_, w_, k_, v_, aa_, bb_, scale=1.0, initial_state=state, output_final_state=True, head_first=False)
                    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object fused_recurrent_rwkv7 at 0x70c98d0c9890, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py", line 11>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:11 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
    def fused_recurrent_rwkv7(
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:50 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
        return fused_recurrent_dplr_delta_rule(
TRACE LOAD_GLOBAL fused_recurrent_dplr_delta_rule []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:51 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            q=r,
TRACE LOAD_FAST r [NullVariable, LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:52 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            k=k,
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:53 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            v=v,
TRACE LOAD_FAST v [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:54 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            a=a,
TRACE LOAD_FAST a [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:55 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            b=b,
TRACE LOAD_FAST b [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:56 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            gk=log_w,
TRACE LOAD_FAST log_w [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:57 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            scale=scale,
TRACE LOAD_FAST scale [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:58 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            initial_state=initial_state,
TRACE LOAD_FAST initial_state [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:59 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            output_final_state=output_final_state,
TRACE LOAD_FAST output_final_state [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:60 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            cu_seqlens=cu_seqlens,
TRACE LOAD_FAST cu_seqlens [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:61 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
            head_first=head_first
TRACE LOAD_FAST head_first [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:50 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
        return fused_recurrent_dplr_delta_rule(
TRACE KW_NAMES ('q', 'k', 'v', 'a', 'b', 'gk', 'scale', 'initial_state', 'output_final_state', 'cu_seqlens', 'head_first') [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(NoneType: None), ConstantVariable(bool: False)]
TRACE CALL 11 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(NoneType: None), ConstantVariable(bool: False)]
TRACE inlined call fused_recurrent_dplr_delta_rule from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py:50 in fused_recurrent_rwkv7 (fused_recurrent_rwkv7) (inline depth: 1)
    return fused_recurrent_dplr_delta_rule(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        q=r,
        ^^^^
        k=k,
        ^^^^
        v=v,
        ^^^^
        a=a,
        ^^^^
        b=b,
        ^^^^
        gk=log_w,
        ^^^^^^^^^
        scale=scale,
        ^^^^^^^^^^^^
        initial_state=initial_state,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        output_final_state=output_final_state,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        cu_seqlens=cu_seqlens,
        ^^^^^^^^^^^^^^^^^^^^^^
        head_first=head_first
        ^^^^^^^^^^^^^^^^^^^^^
    )
    ^
INLINING <code object fused_recurrent_dplr_delta_rule at 0x305fb4e0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 188>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:188 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
    def fused_recurrent_dplr_delta_rule(
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:231 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
        if cu_seqlens is not None:
TRACE LOAD_FAST cu_seqlens []
TRACE LOAD_CONST None [ConstantVariable(NoneType: None)]
TRACE IS_OP 0 [ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 282 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:240 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
        if scale is None:
TRACE LOAD_FAST scale []
TRACE LOAD_CONST None [ConstantVariable(float: 1.0)]
TRACE IS_OP 1 [ConstantVariable(float: 1.0), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 328 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:243 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            assert scale > 0, "scale must be positive"
TRACE LOAD_FAST scale []
TRACE LOAD_CONST 0 [ConstantVariable(float: 1.0)]
TRACE COMPARE_OP > [ConstantVariable(float: 1.0), ConstantVariable(int: 0)]
TRACE POP_JUMP_IF_TRUE 352 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:244 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
        o, final_state = FusedRecurrentDPLRDeltaRuleFunction.apply(
TRACE LOAD_GLOBAL FusedRecurrentDPLRDeltaRuleFunction []
TRACE LOAD_ATTR apply [LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:245 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            q,
TRACE LOAD_FAST q [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:246 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            k,
TRACE LOAD_FAST k [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:247 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            v,
TRACE LOAD_FAST v [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:248 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            a,
TRACE LOAD_FAST a [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:249 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            b,
TRACE LOAD_FAST b [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:250 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            gk,
TRACE LOAD_FAST gk [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:251 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            scale,
TRACE LOAD_FAST scale [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:252 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            initial_state,
TRACE LOAD_FAST initial_state [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:253 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            output_final_state,
TRACE LOAD_FAST output_final_state [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:254 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            cu_seqlens,
TRACE LOAD_FAST cu_seqlens [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:255 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
            head_first
TRACE LOAD_FAST head_first [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:244 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
        o, final_state = FusedRecurrentDPLRDeltaRuleFunction.apply(
TRACE CALL 11 [NullVariable, GetAttrVariable(AutogradFunctionVariable(), apply), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1.0), LazyVariableTracker(), ConstantVariable(bool: True), ConstantVariable(NoneType: None), ConstantVariable(bool: False)]
wrap_to_fake L['state'] (1, 64, 128, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None], constraint_strides=[None, None, None, None], specialize_on=[[], [], [], []], view_base_context=StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='state', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}), tensor_source=LocalSource(local_name='state', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_state_ L['state'] FakeTensor(..., device='cuda:0', size=(1, 64, 128, 128), dtype=torch.bfloat16) at debug_level 0 before=False
wrap_to_fake L['state']._base (56, 1, 64, 128, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='state', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
TRACE inlined call wrapper from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:244 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
    o, final_state = FusedRecurrentDPLRDeltaRuleFunction.apply(
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        q,
        ^^
        k,
        ^^
        v,
        ^^
        a,
        ^^
        b,
        ^^
        gk,
        ^^^
        scale,
        ^^^^^^
        initial_state,
        ^^^^^^^^^^^^^^
        output_final_state,
        ^^^^^^^^^^^^^^^^^^^
        cu_seqlens,
        ^^^^^^^^^^^
        head_first
        ^^^^^^^^^^
    )
    ^
INLINING <code object wrapper at 0x70c98d04f0a0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 16>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 1 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:16 in wrapper (contiguous) (inline depth: 3)
        @functools.wraps(fn)
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:18 in wrapper (contiguous.wrapper) (inline depth: 3)
            return fn(ctx,
TRACE PUSH_NULL None []
TRACE LOAD_DEREF fn [NullVariable]
TRACE LOAD_FAST ctx [NullVariable, LazyVariableTracker()]
TRACE BUILD_LIST 1 [NullVariable, LazyVariableTracker(), AutogradFunctionContextVariable(Function)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:19 in wrapper (contiguous.wrapper) (inline depth: 3)
                      *(i if not isinstance(i, torch.Tensor) else i.contiguous() for i in args),
TRACE LOAD_CONST <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19> [NullVariable, LazyVariableTracker(), ListVariable(length=1)]
TRACE MAKE_FUNCTION 0 [NullVariable, LazyVariableTracker(), ListVariable(length=1), ConstantVariable(code: <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker(), ListVariable(length=1), NestedUserFunctionVariable()]
TRACE GET_ITER None [NullVariable, LazyVariableTracker(), ListVariable(length=1), NestedUserFunctionVariable(), TupleVariable(length=11)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), ListVariable(length=1), NestedUserFunctionVariable(), ListIteratorVariable(length=11, index=0)]
TRACE inlined call <genexpr> from /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:19 in wrapper (contiguous.wrapper) (inline depth: 3)
                  *(i if not isinstance(i, torch.Tensor) else i.contiguous() for i in args),
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:18 in wrapper (contiguous.wrapper) (inline depth: 3)
            return fn(ctx,
TRACE LIST_EXTEND 1 [NullVariable, LazyVariableTracker(), ListVariable(length=1), LocalGeneratorObjectVariable(<genexpr>)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:19 in <genexpr> (contiguous.wrapper) (inline depth: 4)
                      *(i if not isinstance(i, torch.Tensor) else i.contiguous() for i in args),
TRACE RETURN_GENERATOR None [BuiltinVariable(None)]
TRACE POP_TOP None [BuiltinVariable(None)]
TRACE RESUME 0 []
TRACE LOAD_FAST .0 []
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=0)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=1), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=1)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=1), NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=1), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=1), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=1), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=1), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=1)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=1), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=1), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE FX call contiguous_2 from /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:19 in <genexpr> (contiguous.wrapper) (inline depth: 4)
                  *(i if not isinstance(i, torch.Tensor) else i.contiguous() for i in args),
                                                              ~~~~~~~~~~~~^^
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=1), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=1), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=1), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=1)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=1)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=2), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=2)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=2), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=2), NullVariable, BuiltinVariable(isinstance), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=2), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=2), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=2), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=2)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=2), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=2), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=2), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=2), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=2), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=2)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=2)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=3), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=3)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=3), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=3), NullVariable, BuiltinVariable(isinstance), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=3), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=3), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=3), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=3)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=3), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=3), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=3), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=3), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=3), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=3)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=3)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=4), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=4)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=4), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=4), NullVariable, BuiltinVariable(isinstance), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=4), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=4), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=4), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=4)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=4), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=4), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=4), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=4), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=4), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=4)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=4)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=5), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=5)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=5), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=5), NullVariable, BuiltinVariable(isinstance), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=5), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=5), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=5), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=5)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=5), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=5), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=5), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=5), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=5), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=5)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=5)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=6), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=6)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=6), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=6), NullVariable, BuiltinVariable(isinstance), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=6), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=6), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=6), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=6)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=6), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=6), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=6), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=6), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=6), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=6)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=6)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=7), ConstantVariable(float: 1.0)]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=7)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=7), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=7), NullVariable, BuiltinVariable(isinstance), ConstantVariable(float: 1.0)]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=7), NullVariable, BuiltinVariable(isinstance), ConstantVariable(float: 1.0), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=7), NullVariable, BuiltinVariable(isinstance), ConstantVariable(float: 1.0), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=7), ConstantVariable(bool: False)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=7)]
TRACE JUMP_FORWARD 100 [ListIteratorVariable(length=11, index=7), ConstantVariable(float: 1.0)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=7), ConstantVariable(float: 1.0)]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=7), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=7), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=7)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=7)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=8), TensorVariable()]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=8)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=8), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=8), NullVariable, BuiltinVariable(isinstance), TensorVariable()]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=8), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=8), NullVariable, BuiltinVariable(isinstance), TensorVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=8), ConstantVariable(bool: True)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=8)]
TRACE LOAD_ATTR contiguous [ListIteratorVariable(length=11, index=8), TensorVariable()]
TRACE CALL 0 [ListIteratorVariable(length=11, index=8), NullVariable, GetAttrVariable(TensorVariable(), contiguous)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=8), TensorVariable()]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=8), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=8), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=8)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=8)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=9), ConstantVariable(bool: True)]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=9)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=9), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=9), NullVariable, BuiltinVariable(isinstance), ConstantVariable(bool: True)]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=9), NullVariable, BuiltinVariable(isinstance), ConstantVariable(bool: True), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=9), NullVariable, BuiltinVariable(isinstance), ConstantVariable(bool: True), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=9), ConstantVariable(bool: False)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=9)]
TRACE JUMP_FORWARD 100 [ListIteratorVariable(length=11, index=9), ConstantVariable(bool: True)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=9), ConstantVariable(bool: True)]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=9), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=9), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=9)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=9)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=10), ConstantVariable(NoneType: None)]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=10)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=10), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=10), NullVariable, BuiltinVariable(isinstance), ConstantVariable(NoneType: None)]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=10), NullVariable, BuiltinVariable(isinstance), ConstantVariable(NoneType: None), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=10), NullVariable, BuiltinVariable(isinstance), ConstantVariable(NoneType: None), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=10), ConstantVariable(bool: False)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=10)]
TRACE JUMP_FORWARD 100 [ListIteratorVariable(length=11, index=10), ConstantVariable(NoneType: None)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=10), ConstantVariable(NoneType: None)]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=10), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=10), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=10)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=10)]
TRACE STORE_FAST i [ListIteratorVariable(length=11, index=11), ConstantVariable(bool: False)]
TRACE LOAD_GLOBAL isinstance [ListIteratorVariable(length=11, index=11)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=11), NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL torch [ListIteratorVariable(length=11, index=11), NullVariable, BuiltinVariable(isinstance), ConstantVariable(bool: False)]
TRACE LOAD_ATTR Tensor [ListIteratorVariable(length=11, index=11), NullVariable, BuiltinVariable(isinstance), ConstantVariable(bool: False), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=11, index=11), NullVariable, BuiltinVariable(isinstance), ConstantVariable(bool: False), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 70 [ListIteratorVariable(length=11, index=11), ConstantVariable(bool: False)]
TRACE LOAD_FAST i [ListIteratorVariable(length=11, index=11)]
TRACE JUMP_FORWARD 100 [ListIteratorVariable(length=11, index=11), ConstantVariable(bool: False)]
TRACE YIELD_VALUE 1 [ListIteratorVariable(length=11, index=11), ConstantVariable(bool: False)]
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE RESUME 1 [ListIteratorVariable(length=11, index=11), ConstantVariable(NoneType: None)]
TRACE POP_TOP None [ListIteratorVariable(length=11, index=11), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 8 [ListIteratorVariable(length=11, index=11)]
TRACE FOR_ITER 108 [ListIteratorVariable(length=11, index=11)]
TRACE END_FOR None [ListIteratorVariable(length=11, index=11), ConstantVariable(NoneType: None)]
TRACE RETURN_CONST None []
DONE INLINING <code object <genexpr> at 0x70c98d1a2bf0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 19>
TRACE CALL_INTRINSIC_1 6 [NullVariable, LazyVariableTracker(), ListVariable(length=12)]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=12)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:20 in wrapper (contiguous.wrapper) (inline depth: 3)
                      **{k: (v if not isinstance(v, torch.Tensor) else v.contiguous()) for k, v in kwargs.items()})
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable()]
TRACE LOAD_ATTR items [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ConstDictVariable()]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 180 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE SWAP 3 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST v [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ConstDictVariable(), NullVariable, NullVariable]
TRACE STORE_FAST k [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ConstDictVariable(), NullVariable]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:18 in wrapper (contiguous.wrapper) (inline depth: 3)
            return fn(ctx,
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=12), ConstDictVariable()]
TRACE inlined call forward from /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:18 in wrapper (contiguous.wrapper) (inline depth: 3)
        return fn(ctx,
               ~~^^^^^
                  *(i if not isinstance(i, torch.Tensor) else i.contiguous() for i in args),
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                  **{k: (v if not isinstance(v, torch.Tensor) else v.contiguous()) for k, v in kwargs.items()})
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object forward at 0x3060e8b0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 124>, inlined according trace_rules.lookup inlined by default
TRACE MAKE_CELL H []
TRACE MAKE_CELL N []
TRACE MAKE_CELL V []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:124 in forward (FusedRecurrentDPLRDeltaRuleFunction) (inline depth: 4)
        @staticmethod
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:140 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            if head_first:
TRACE LOAD_FAST head_first []
TRACE POP_JUMP_IF_FALSE 86 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:143 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
                B, T, H, K, V = *k.shape, v.shape[-1]
TRACE BUILD_LIST 0 []
TRACE LOAD_FAST k [ListVariable(length=0)]
TRACE LOAD_ATTR shape [ListVariable(length=0), TensorVariable()]
TRACE LIST_EXTEND 1 [ListVariable(length=0), SizeVariable(length=4)]
TRACE LOAD_FAST v [ListVariable(length=4)]
TRACE LOAD_ATTR shape [ListVariable(length=4), TensorVariable()]
TRACE LOAD_CONST -1 [ListVariable(length=4), SizeVariable(length=4)]
TRACE BINARY_SUBSCR None [ListVariable(length=4), SizeVariable(length=4), ConstantVariable(int: -1)]
TRACE LIST_APPEND 1 [ListVariable(length=4), ConstantVariable(int: 128)]
TRACE CALL_INTRINSIC_1 6 [ListVariable(length=5)]
TRACE UNPACK_SEQUENCE 5 [TupleVariable(length=5)]
TRACE STORE_FAST B [ConstantVariable(int: 128), ConstantVariable(int: 128), ConstantVariable(int: 64), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 128), ConstantVariable(int: 128), ConstantVariable(int: 64), ConstantVariable(int: 1)]
TRACE STORE_DEREF H [ConstantVariable(int: 128), ConstantVariable(int: 128), ConstantVariable(int: 64)]
TRACE STORE_FAST K [ConstantVariable(int: 128), ConstantVariable(int: 128)]
TRACE STORE_DEREF V [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:144 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            N = B if offsets is None else len(offsets) - 1
TRACE LOAD_FAST offsets []
TRACE LOAD_CONST None [ConstantVariable(NoneType: None)]
TRACE IS_OP 1 [ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 170 [ConstantVariable(bool: False)]
TRACE LOAD_FAST B []
TRACE JUMP_FORWARD 196 [ConstantVariable(int: 1)]
TRACE STORE_DEREF N [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:146 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            BK = triton.next_power_of_2(K)
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR next_power_of_2 [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST K [NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:146 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
        BK = triton.next_power_of_2(K)
             ~~~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=1)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=1, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=1, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=1, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=1, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=1), ConstantVariable(int: 128)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 6)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 6)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 6)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 6)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 6)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 128)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=1, index=1), ConstantVariable(int: 128)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=1, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=1, index=1)]
TRACE END_FOR None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=1, index=1), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=1)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=1)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=1), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=1), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=1), ConstDictVariable()]
TRACE inlined call next_power_of_2 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object next_power_of_2 at 0x70c9a955f730, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 71>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:71 in next_power_of_2 () (inline depth: 6)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:74 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n -= 1
TRACE LOAD_FAST n []
TRACE LOAD_CONST 1 [ConstantVariable(int: 128)]
TRACE BINARY_OP 23 [ConstantVariable(int: 128), ConstantVariable(int: 1)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:75 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n |= n >> 1
TRACE LOAD_FAST n []
TRACE LOAD_FAST n [ConstantVariable(int: 127)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 127), ConstantVariable(int: 127)]
TRACE BINARY_OP 9 [ConstantVariable(int: 127), ConstantVariable(int: 127), ConstantVariable(int: 1)]
TRACE BINARY_OP 20 [ConstantVariable(int: 127), ConstantVariable(int: 63)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:76 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n |= n >> 2
TRACE LOAD_FAST n []
TRACE LOAD_FAST n [ConstantVariable(int: 127)]
TRACE LOAD_CONST 2 [ConstantVariable(int: 127), ConstantVariable(int: 127)]
TRACE BINARY_OP 9 [ConstantVariable(int: 127), ConstantVariable(int: 127), ConstantVariable(int: 2)]
TRACE BINARY_OP 20 [ConstantVariable(int: 127), ConstantVariable(int: 31)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:77 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n |= n >> 4
TRACE LOAD_FAST n []
TRACE LOAD_FAST n [ConstantVariable(int: 127)]
TRACE LOAD_CONST 4 [ConstantVariable(int: 127), ConstantVariable(int: 127)]
TRACE BINARY_OP 9 [ConstantVariable(int: 127), ConstantVariable(int: 127), ConstantVariable(int: 4)]
TRACE BINARY_OP 20 [ConstantVariable(int: 127), ConstantVariable(int: 7)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:78 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n |= n >> 8
TRACE LOAD_FAST n []
TRACE LOAD_FAST n [ConstantVariable(int: 127)]
TRACE LOAD_CONST 8 [ConstantVariable(int: 127), ConstantVariable(int: 127)]
TRACE BINARY_OP 9 [ConstantVariable(int: 127), ConstantVariable(int: 127), ConstantVariable(int: 8)]
TRACE BINARY_OP 20 [ConstantVariable(int: 127), ConstantVariable(int: 0)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:79 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n |= n >> 16
TRACE LOAD_FAST n []
TRACE LOAD_FAST n [ConstantVariable(int: 127)]
TRACE LOAD_CONST 16 [ConstantVariable(int: 127), ConstantVariable(int: 127)]
TRACE BINARY_OP 9 [ConstantVariable(int: 127), ConstantVariable(int: 127), ConstantVariable(int: 16)]
TRACE BINARY_OP 20 [ConstantVariable(int: 127), ConstantVariable(int: 0)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:80 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n |= n >> 32
TRACE LOAD_FAST n []
TRACE LOAD_FAST n [ConstantVariable(int: 127)]
TRACE LOAD_CONST 32 [ConstantVariable(int: 127), ConstantVariable(int: 127)]
TRACE BINARY_OP 9 [ConstantVariable(int: 127), ConstantVariable(int: 127), ConstantVariable(int: 32)]
TRACE BINARY_OP 20 [ConstantVariable(int: 127), ConstantVariable(int: 0)]
TRACE STORE_FAST n [ConstantVariable(int: 127)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:81 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        n += 1
TRACE LOAD_FAST n []
TRACE LOAD_CONST 1 [ConstantVariable(int: 127)]
TRACE BINARY_OP 13 [ConstantVariable(int: 127), ConstantVariable(int: 1)]
TRACE STORE_FAST n [ConstantVariable(int: 128)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:82 in next_power_of_2 (next_power_of_2) (inline depth: 6)
        return n
TRACE LOAD_FAST n []
TRACE RETURN_VALUE None [ConstantVariable(int: 128)]
DONE INLINING <code object next_power_of_2 at 0x70c9a955f730, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 71>
TRACE STORE_FAST res [ConstantVariable(int: 128)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 5)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 128)]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE STORE_FAST BK [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:147 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            if output_final_state:
TRACE LOAD_FAST output_final_state []
TRACE POP_JUMP_IF_FALSE 318 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:148 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
                final_state = q.new_empty(B, H, K, V, dtype=torch.float32)
TRACE LOAD_FAST q []
TRACE LOAD_ATTR new_empty [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), new_empty)]
TRACE LOAD_DEREF H [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1)]
TRACE LOAD_FAST K [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE LOAD_DEREF V [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128), ConstantVariable(int: 128)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE CALL 5 [NullVariable, GetAttrVariable(TensorVariable(), new_empty), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE FX call new_empty from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:148 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            final_state = q.new_empty(B, H, K, V, dtype=torch.float32)
                          ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST final_state [TensorVariable()]
TRACE JUMP_FORWARD 322 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:152 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
            ha = torch.empty_like(v, dtype=torch.float32)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR empty_like [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST v [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL torch [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR float32 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE FX call empty_like from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:152 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward) (inline depth: 4)
        ha = torch.empty_like(v, dtype=torch.float32)
             ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST ha [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
TRACE LOAD_CLOSURE H []
TRACE LOAD_CLOSURE N [CellVariable()]
TRACE LOAD_CLOSURE V [CellVariable(), CellVariable()]
TRACE BUILD_TUPLE 3 [CellVariable(), CellVariable(), CellVariable()]
TRACE LOAD_CONST <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154> [TupleVariable(length=3)]
TRACE MAKE_FUNCTION 8 [TupleVariable(length=3), ConstantVariable(code: <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>)]
TRACE STORE_FAST grid [NestedUserFunctionVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:155 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            o = torch.empty_like(v)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR empty_like [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST v [NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call empty_like_1 from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:155 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
        o = torch.empty_like(v)
            ~~~~~~~~~~~~~~~~^^^
TRACE STORE_FAST o [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_GLOBAL fused_recurrent_fwd_kernel []
TRACE LOAD_FAST grid [NullVariable, LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), NestedUserFunctionVariable()]
TRACE inlined call __getitem__ from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
        fused_recurrent_fwd_kernel[grid](
        ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
INLINING <code object __getitem__ at 0x70c9a94dd6f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 413>, inlined according trace_rules.lookup inlined by default
TRACE MAKE_CELL self []
TRACE MAKE_CELL grid []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:413 in __getitem__ (KernelInterface.__getitem__) (inline depth: 5)
        def __getitem__(self, grid) -> T:
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:419 in __getitem__ (KernelInterface.__getitem__) (inline depth: 5)
            return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
TRACE LOAD_CLOSURE grid []
TRACE LOAD_CLOSURE self [CellVariable()]
TRACE BUILD_TUPLE 2 [CellVariable(), CellVariable()]
TRACE LOAD_CONST <code object <lambda> at 0x70c9a9437780, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 419> [TupleVariable(length=2)]
TRACE MAKE_FUNCTION 8 [TupleVariable(length=2), ConstantVariable(code: <code object <lambda> at 0x70c9a9437780, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 419>)]
TRACE RETURN_VALUE None [NestedUserFunctionVariable()]
DONE INLINING <code object __getitem__ at 0x70c9a94dd6f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 413>
TRACE LOAD_CONST () [NullVariable, NestedUserFunctionVariable()]
TRACE BUILD_MAP 0 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0)]
TRACE LOAD_CONST q [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:157 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                q=q,
TRACE LOAD_FAST q [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'q')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'q'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST k [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:158 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                k=k,
TRACE LOAD_FAST k [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'k')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'k'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST v [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:159 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                v=v,
TRACE LOAD_FAST v [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'v')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'v'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST a [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:160 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                a=a,
TRACE LOAD_FAST a [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'a')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'a'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST b [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:161 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                b=b,
TRACE LOAD_FAST b [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'b')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'b'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST gk [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:162 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                gk=gk,
TRACE LOAD_FAST gk [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'gk')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'gk'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST o [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:163 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                o=o,
TRACE LOAD_FAST o [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'o')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'o'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST ha [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:164 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                ha=ha,
TRACE LOAD_FAST ha [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'ha')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'ha'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST h0 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:165 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                h0=initial_state,
TRACE LOAD_FAST initial_state [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'h0')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'h0'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST ht [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:166 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                ht=final_state,
TRACE LOAD_FAST final_state [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'ht')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'ht'), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST scale [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:167 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                scale=scale,
TRACE LOAD_FAST scale [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'scale')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'scale'), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST offsets [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:168 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                offsets=offsets,
TRACE LOAD_FAST offsets [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'offsets')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'offsets'), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST H [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:169 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                H=H,
TRACE LOAD_DEREF H [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'H')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'H'), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST T [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:170 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                T=T,
TRACE LOAD_FAST T [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'T')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'T'), ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST K [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:171 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                K=K,
TRACE LOAD_FAST K [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'K')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'K'), ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST V [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:172 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                V=V,
TRACE LOAD_DEREF V [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'V')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'V'), ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST BK [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:173 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                BK=BK,
TRACE LOAD_FAST BK [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'BK')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'BK'), ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE LOAD_CONST HEAD_FIRST [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:174 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
                HEAD_FIRST=head_first
TRACE LOAD_FAST head_first [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'HEAD_FIRST')]
TRACE MAP_ADD 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable(), ConstantVariable(str: 'HEAD_FIRST'), ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            fused_recurrent_fwd_kernel[grid](
TRACE CALL_FUNCTION_EX 1 [NullVariable, NestedUserFunctionVariable(), TupleVariable(length=0), ConstDictVariable()]
TRACE inlined call <lambda> from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:156 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
        fused_recurrent_fwd_kernel[grid](
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
            q=q,
            ^^^^
            k=k,
            ^^^^
            v=v,
            ^^^^
            a=a,
            ^^^^
            b=b,
            ^^^^
            gk=gk,
            ^^^^^^
            o=o,
            ^^^^
            ha=ha,
            ^^^^^^
            h0=initial_state,
            ^^^^^^^^^^^^^^^^^
            ht=final_state,
            ^^^^^^^^^^^^^^^
            scale=scale,
            ^^^^^^^^^^^^
            offsets=offsets,
            ^^^^^^^^^^^^^^^^
            H=H,
            ^^^^
            T=T,
            ^^^^
            K=K,
            ^^^^
            V=V,
            ^^^^
            BK=BK,
            ^^^^^^
            HEAD_FIRST=head_first
            ^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object <lambda> at 0x70c9a9437780, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 419>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 2 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:419 in <lambda> (KernelInterface.__getitem__) (inline depth: 5)
            return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
TRACE RESUME 0 []
TRACE PUSH_NULL None []
TRACE LOAD_DEREF self [NullVariable]
TRACE LOAD_ATTR run [NullVariable, UserDefinedObjectVariable(Heuristics)]
TRACE LOAD_FAST args [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics))]
TRACE LOAD_DEREF grid [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0)]
TRACE LOAD_CONST False [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0), NestedUserFunctionVariable()]
TRACE LOAD_CONST ('grid', 'warmup') [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0), NestedUserFunctionVariable(), ConstantVariable(bool: False)]
TRACE BUILD_CONST_KEY_MAP 2 [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0), NestedUserFunctionVariable(), ConstantVariable(bool: False), TupleVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, UserMethodVariable(<function Heuristics.run at 0x70c9a9414400>, UserDefinedObjectVariable(Heuristics)), TupleVariable(length=0), ConstDictVariable()]
TRACE inlined call run from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:419 in <lambda> (KernelInterface.__getitem__) (inline depth: 5)
        return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
                                       ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object run at 0x70c9a971df10, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py", line 449>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:449 in run (Heuristics.run) (inline depth: 6)
        def run(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:450 in run (Heuristics.run) (inline depth: 6)
            for v, heur in self.values.items():
TRACE LOAD_FAST self []
TRACE LOAD_ATTR values [UserDefinedObjectVariable(Heuristics)]
TRACE LOAD_ATTR items [LazyVariableTracker()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE FOR_ITER 156 [ListIteratorVariable(length=3, index=0)]
TRACE UNPACK_SEQUENCE 2 [ListIteratorVariable(length=3, index=1), TupleVariable(length=2)]
TRACE STORE_FAST v [ListIteratorVariable(length=3, index=1), LazyVariableTracker(), ConstantVariable(str: 'USE_INITIAL_STATE')]
TRACE STORE_FAST heur [ListIteratorVariable(length=3, index=1), LazyVariableTracker()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
                kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
TRACE PUSH_NULL None [ListIteratorVariable(length=3, index=1)]
TRACE LOAD_FAST heur [ListIteratorVariable(length=3, index=1), NullVariable]
TRACE BUILD_MAP 0 [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL dict [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE LOAD_GLOBAL zip [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST self [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, LazyVariableTracker(), NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR arg_names [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, LazyVariableTracker(), NullVariable, LazyVariableTracker(), UserDefinedObjectVariable(Heuristics)]
TRACE LOAD_FAST args [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, LazyVariableTracker(), NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, LazyVariableTracker(), NullVariable, LazyVariableTracker(), LazyVariableTracker(), TupleVariable(length=0)]
TRACE CALL 1 [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, LazyVariableTracker(), ZipVariable()]
TRACE inlined call construct_dict from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
            kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
                                ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object construct_dict at 0x70c9a070b0a0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 285>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:285 in construct_dict (construct_dict) (inline depth: 7)
    def construct_dict(cls, /, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:286 in construct_dict (construct_dict) (inline depth: 7)
        dst = cls.__new__(cls)
TRACE LOAD_FAST cls []
TRACE LOAD_ATTR __new__ [BuiltinVariable(dict)]
TRACE LOAD_FAST cls [NullVariable, GetAttrVariable(BuiltinVariable(dict), __new__)]
TRACE CALL 1 [NullVariable, GetAttrVariable(BuiltinVariable(dict), __new__), BuiltinVariable(dict)]
TRACE STORE_FAST dst [ConstDictVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:288 in construct_dict (construct_dict) (inline depth: 7)
        if args:
TRACE LOAD_FAST args []
TRACE POP_JUMP_IF_FALSE 264 [TupleVariable(length=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:289 in construct_dict (construct_dict) (inline depth: 7)
            src = args[0]
TRACE LOAD_FAST args []
TRACE LOAD_CONST 0 [TupleVariable(length=1)]
TRACE BINARY_SUBSCR None [TupleVariable(length=1), ConstantVariable(int: 0)]
TRACE STORE_FAST src [ZipVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:291 in construct_dict (construct_dict) (inline depth: 7)
            if not isinstance(src, Iterable):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST src [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL Iterable [NullVariable, LazyVariableTracker(), ZipVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ZipVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 128 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:295 in construct_dict (construct_dict) (inline depth: 7)
            if isinstance(src, (dict, MutableMapping, types.MappingProxyType)):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST src [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL dict [NullVariable, BuiltinVariable(isinstance), ZipVariable()]
TRACE LOAD_GLOBAL MutableMapping [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker()]
TRACE LOAD_GLOBAL types [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR MappingProxyType [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE BUILD_TUPLE 3 [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ZipVariable(), TupleVariable(length=3)]
TRACE POP_JUMP_IF_FALSE 234 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:301 in construct_dict (construct_dict) (inline depth: 7)
                for key, value in src:
TRACE LOAD_FAST src []
TRACE GET_ITER None [ZipVariable()]
TRACE FOR_ITER 262 [ZipVariable()]
TRACE END_FOR None [ZipVariable(), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:304 in construct_dict (construct_dict) (inline depth: 7)
        if kwargs:
TRACE LOAD_FAST kwargs []
TRACE POP_JUMP_IF_FALSE 298 [ConstDictVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:308 in construct_dict (construct_dict) (inline depth: 7)
        return dst
TRACE LOAD_FAST dst []
TRACE RETURN_VALUE None [ConstDictVariable()]
DONE INLINING <code object construct_dict at 0x70c9a070b0a0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 285>
TRACE DICT_UPDATE 1 [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), ConstDictVariable()]
TRACE LOAD_FAST kwargs [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE DICT_UPDATE 1 [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable(), ConstDictVariable()]
TRACE CALL 1 [ListIteratorVariable(length=3, index=1), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE inlined call <lambda> from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
            kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
                        ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object <lambda> at 0x70c98ce24d30, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 14>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:14 in <lambda> () (inline depth: 7)
        'USE_INITIAL_STATE': lambda args: args['h0'] is not None,
TRACE RESUME 0 []
TRACE LOAD_FAST args []
TRACE LOAD_CONST h0 [ConstDictVariable()]
TRACE BINARY_SUBSCR None [ConstDictVariable(), ConstantVariable(str: 'h0')]
TRACE LOAD_CONST None [TensorVariable()]
TRACE IS_OP 1 [TensorVariable(), ConstantVariable(NoneType: None)]
TRACE RETURN_VALUE None [ConstantVariable(bool: True)]
DONE INLINING <code object <lambda> at 0x70c98ce24d30, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 14>
TRACE LOAD_FAST kwargs [ListIteratorVariable(length=3, index=1), ConstantVariable(bool: True)]
TRACE LOAD_FAST v [ListIteratorVariable(length=3, index=1), ConstantVariable(bool: True), ConstDictVariable()]
TRACE STORE_SUBSCR None [ListIteratorVariable(length=3, index=1), ConstantVariable(bool: True), ConstDictVariable(), ConstantVariable(str: 'USE_INITIAL_STATE')]
TRACE JUMP_BACKWARD 54 [ListIteratorVariable(length=3, index=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:450 in run (Heuristics.run) (inline depth: 6)
            for v, heur in self.values.items():
TRACE FOR_ITER 156 [ListIteratorVariable(length=3, index=1)]
TRACE UNPACK_SEQUENCE 2 [ListIteratorVariable(length=3, index=2), TupleVariable(length=2)]
TRACE STORE_FAST v [ListIteratorVariable(length=3, index=2), LazyVariableTracker(), ConstantVariable(str: 'STORE_FINAL_STATE')]
TRACE STORE_FAST heur [ListIteratorVariable(length=3, index=2), LazyVariableTracker()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
                kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
TRACE PUSH_NULL None [ListIteratorVariable(length=3, index=2)]
TRACE LOAD_FAST heur [ListIteratorVariable(length=3, index=2), NullVariable]
TRACE BUILD_MAP 0 [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL dict [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE LOAD_GLOBAL zip [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict)]
TRACE LOAD_FAST self [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip)]
TRACE LOAD_ATTR arg_names [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip), UserDefinedObjectVariable(Heuristics)]
TRACE LOAD_FAST args [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip), LazyVariableTracker(), TupleVariable(length=0)]
TRACE CALL 1 [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), ZipVariable()]
TRACE inlined call construct_dict from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
            kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
                                ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object construct_dict at 0x70c9a070b0a0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 285>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:285 in construct_dict (construct_dict) (inline depth: 7)
    def construct_dict(cls, /, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:286 in construct_dict (construct_dict) (inline depth: 7)
        dst = cls.__new__(cls)
TRACE LOAD_FAST cls []
TRACE LOAD_ATTR __new__ [BuiltinVariable(dict)]
TRACE LOAD_FAST cls [NullVariable, GetAttrVariable(BuiltinVariable(dict), __new__)]
TRACE CALL 1 [NullVariable, GetAttrVariable(BuiltinVariable(dict), __new__), BuiltinVariable(dict)]
TRACE STORE_FAST dst [ConstDictVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:288 in construct_dict (construct_dict) (inline depth: 7)
        if args:
TRACE LOAD_FAST args []
TRACE POP_JUMP_IF_FALSE 264 [TupleVariable(length=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:289 in construct_dict (construct_dict) (inline depth: 7)
            src = args[0]
TRACE LOAD_FAST args []
TRACE LOAD_CONST 0 [TupleVariable(length=1)]
TRACE BINARY_SUBSCR None [TupleVariable(length=1), ConstantVariable(int: 0)]
TRACE STORE_FAST src [ZipVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:291 in construct_dict (construct_dict) (inline depth: 7)
            if not isinstance(src, Iterable):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST src [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL Iterable [NullVariable, LazyVariableTracker(), ZipVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ZipVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 128 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:295 in construct_dict (construct_dict) (inline depth: 7)
            if isinstance(src, (dict, MutableMapping, types.MappingProxyType)):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST src [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL dict [NullVariable, BuiltinVariable(isinstance), ZipVariable()]
TRACE LOAD_GLOBAL MutableMapping [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker()]
TRACE LOAD_GLOBAL types [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR MappingProxyType [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE BUILD_TUPLE 3 [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ZipVariable(), TupleVariable(length=3)]
TRACE POP_JUMP_IF_FALSE 234 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:301 in construct_dict (construct_dict) (inline depth: 7)
                for key, value in src:
TRACE LOAD_FAST src []
TRACE GET_ITER None [ZipVariable()]
TRACE FOR_ITER 262 [ZipVariable()]
TRACE END_FOR None [ZipVariable(), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:304 in construct_dict (construct_dict) (inline depth: 7)
        if kwargs:
TRACE LOAD_FAST kwargs []
TRACE POP_JUMP_IF_FALSE 298 [ConstDictVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:308 in construct_dict (construct_dict) (inline depth: 7)
        return dst
TRACE LOAD_FAST dst []
TRACE RETURN_VALUE None [ConstDictVariable()]
DONE INLINING <code object construct_dict at 0x70c9a070b0a0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 285>
TRACE DICT_UPDATE 1 [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), ConstDictVariable()]
TRACE LOAD_FAST kwargs [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE DICT_UPDATE 1 [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable(), ConstDictVariable()]
TRACE CALL 1 [ListIteratorVariable(length=3, index=2), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE inlined call <lambda> from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
            kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
                        ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object <lambda> at 0x70c98ce257c0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 15>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:15 in <lambda> () (inline depth: 7)
        'STORE_FINAL_STATE': lambda args: args['ht'] is not None,
TRACE RESUME 0 []
TRACE LOAD_FAST args []
TRACE LOAD_CONST ht [ConstDictVariable()]
TRACE BINARY_SUBSCR None [ConstDictVariable(), ConstantVariable(str: 'ht')]
TRACE LOAD_CONST None [TensorVariable()]
TRACE IS_OP 1 [TensorVariable(), ConstantVariable(NoneType: None)]
TRACE RETURN_VALUE None [ConstantVariable(bool: True)]
DONE INLINING <code object <lambda> at 0x70c98ce257c0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 15>
TRACE LOAD_FAST kwargs [ListIteratorVariable(length=3, index=2), ConstantVariable(bool: True)]
TRACE LOAD_FAST v [ListIteratorVariable(length=3, index=2), ConstantVariable(bool: True), ConstDictVariable()]
TRACE STORE_SUBSCR None [ListIteratorVariable(length=3, index=2), ConstantVariable(bool: True), ConstDictVariable(), ConstantVariable(str: 'STORE_FINAL_STATE')]
TRACE JUMP_BACKWARD 54 [ListIteratorVariable(length=3, index=2)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:450 in run (Heuristics.run) (inline depth: 6)
            for v, heur in self.values.items():
TRACE FOR_ITER 156 [ListIteratorVariable(length=3, index=2)]
TRACE UNPACK_SEQUENCE 2 [ListIteratorVariable(length=3, index=3), TupleVariable(length=2)]
TRACE STORE_FAST v [ListIteratorVariable(length=3, index=3), LazyVariableTracker(), ConstantVariable(str: 'USE_OFFSETS')]
TRACE STORE_FAST heur [ListIteratorVariable(length=3, index=3), LazyVariableTracker()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
                kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
TRACE PUSH_NULL None [ListIteratorVariable(length=3, index=3)]
TRACE LOAD_FAST heur [ListIteratorVariable(length=3, index=3), NullVariable]
TRACE BUILD_MAP 0 [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL dict [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE LOAD_GLOBAL zip [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict)]
TRACE LOAD_FAST self [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip)]
TRACE LOAD_ATTR arg_names [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip), UserDefinedObjectVariable(Heuristics)]
TRACE LOAD_FAST args [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip), LazyVariableTracker()]
TRACE CALL 2 [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), NullVariable, BuiltinVariable(zip), LazyVariableTracker(), TupleVariable(length=0)]
TRACE CALL 1 [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), NullVariable, BuiltinVariable(dict), ZipVariable()]
TRACE inlined call construct_dict from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
            kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
                                ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object construct_dict at 0x70c9a070b0a0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 285>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:285 in construct_dict (construct_dict) (inline depth: 7)
    def construct_dict(cls, /, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:286 in construct_dict (construct_dict) (inline depth: 7)
        dst = cls.__new__(cls)
TRACE LOAD_FAST cls []
TRACE LOAD_ATTR __new__ [BuiltinVariable(dict)]
TRACE LOAD_FAST cls [NullVariable, GetAttrVariable(BuiltinVariable(dict), __new__)]
TRACE CALL 1 [NullVariable, GetAttrVariable(BuiltinVariable(dict), __new__), BuiltinVariable(dict)]
TRACE STORE_FAST dst [ConstDictVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:288 in construct_dict (construct_dict) (inline depth: 7)
        if args:
TRACE LOAD_FAST args []
TRACE POP_JUMP_IF_FALSE 264 [TupleVariable(length=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:289 in construct_dict (construct_dict) (inline depth: 7)
            src = args[0]
TRACE LOAD_FAST args []
TRACE LOAD_CONST 0 [TupleVariable(length=1)]
TRACE BINARY_SUBSCR None [TupleVariable(length=1), ConstantVariable(int: 0)]
TRACE STORE_FAST src [ZipVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:291 in construct_dict (construct_dict) (inline depth: 7)
            if not isinstance(src, Iterable):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST src [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL Iterable [NullVariable, LazyVariableTracker(), ZipVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ZipVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_TRUE 128 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:295 in construct_dict (construct_dict) (inline depth: 7)
            if isinstance(src, (dict, MutableMapping, types.MappingProxyType)):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST src [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL dict [NullVariable, BuiltinVariable(isinstance), ZipVariable()]
TRACE LOAD_GLOBAL MutableMapping [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker()]
TRACE LOAD_GLOBAL types [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR MappingProxyType [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE BUILD_TUPLE 3 [NullVariable, BuiltinVariable(isinstance), ZipVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ZipVariable(), TupleVariable(length=3)]
TRACE POP_JUMP_IF_FALSE 234 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:301 in construct_dict (construct_dict) (inline depth: 7)
                for key, value in src:
TRACE LOAD_FAST src []
TRACE GET_ITER None [ZipVariable()]
TRACE FOR_ITER 262 [ZipVariable()]
TRACE END_FOR None [ZipVariable(), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:304 in construct_dict (construct_dict) (inline depth: 7)
        if kwargs:
TRACE LOAD_FAST kwargs []
TRACE POP_JUMP_IF_FALSE 298 [ConstDictVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:308 in construct_dict (construct_dict) (inline depth: 7)
        return dst
TRACE LOAD_FAST dst []
TRACE RETURN_VALUE None [ConstDictVariable()]
DONE INLINING <code object construct_dict at 0x70c9a070b0a0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 285>
TRACE DICT_UPDATE 1 [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), ConstDictVariable()]
TRACE LOAD_FAST kwargs [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE DICT_UPDATE 1 [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable(), ConstDictVariable()]
TRACE CALL 1 [ListIteratorVariable(length=3, index=3), NullVariable, LazyVariableTracker(), ConstDictVariable()]
TRACE inlined call <lambda> from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:451 in run (Heuristics.run) (inline depth: 6)
            kwargs[v] = heur({**dict(zip(self.arg_names, args)), **kwargs})
                        ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object <lambda> at 0x70c98ce25a30, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 16>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:16 in <lambda> () (inline depth: 7)
        'USE_OFFSETS': lambda args: args['offsets'] is not None
TRACE RESUME 0 []
TRACE LOAD_FAST args []
TRACE LOAD_CONST offsets [ConstDictVariable()]
TRACE BINARY_SUBSCR None [ConstDictVariable(), ConstantVariable(str: 'offsets')]
TRACE LOAD_CONST None [ConstantVariable(NoneType: None)]
TRACE IS_OP 1 [ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE RETURN_VALUE None [ConstantVariable(bool: False)]
DONE INLINING <code object <lambda> at 0x70c98ce25a30, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 16>
TRACE LOAD_FAST kwargs [ListIteratorVariable(length=3, index=3), ConstantVariable(bool: False)]
TRACE LOAD_FAST v [ListIteratorVariable(length=3, index=3), ConstantVariable(bool: False), ConstDictVariable()]
TRACE STORE_SUBSCR None [ListIteratorVariable(length=3, index=3), ConstantVariable(bool: False), ConstDictVariable(), ConstantVariable(str: 'USE_OFFSETS')]
TRACE JUMP_BACKWARD 54 [ListIteratorVariable(length=3, index=3)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:450 in run (Heuristics.run) (inline depth: 6)
            for v, heur in self.values.items():
TRACE FOR_ITER 156 [ListIteratorVariable(length=3, index=3)]
TRACE END_FOR None [ListIteratorVariable(length=3, index=3), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:452 in run (Heuristics.run) (inline depth: 6)
            return self.fn.run(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(Heuristics)]
TRACE LOAD_ATTR run [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST args [NullVariable, GetAttrVariable(TritonKernelVariable(), run)]
TRACE BUILD_MAP 0 [NullVariable, GetAttrVariable(TritonKernelVariable(), run), TupleVariable(length=0)]
TRACE LOAD_FAST kwargs [NullVariable, GetAttrVariable(TritonKernelVariable(), run), TupleVariable(length=0), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, GetAttrVariable(TritonKernelVariable(), run), TupleVariable(length=0), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, GetAttrVariable(TritonKernelVariable(), run), TupleVariable(length=0), ConstDictVariable()]
TRACE inlined call grid from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:452 in run (Heuristics.run) (inline depth: 6)
        return self.fn.run(*args, **kwargs)
               ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in grid (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 7)
            def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
TRACE RESUME 0 []
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF V [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST meta [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE LOAD_CONST BV [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstDictVariable(), ConstantVariable(str: 'BV')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in grid (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 7)
        def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
                                ~~~~~~~~~~~^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 128)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 128)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 128)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 9)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 9)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [ConstantVariable(int: 128)]
TRACE BINARY_OP 0 [ConstantVariable(int: 128), ConstantVariable(int: 32)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 160)]
TRACE BINARY_OP 10 [ConstantVariable(int: 160), ConstantVariable(int: 1)]
TRACE LOAD_FAST y [ConstantVariable(int: 159)]
TRACE BINARY_OP 2 [ConstantVariable(int: 159), ConstantVariable(int: 32)]
TRACE RETURN_VALUE None [ConstantVariable(int: 4)]
DONE INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [ConstantVariable(int: 4)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 4)]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE LOAD_DEREF N [ConstantVariable(int: 4)]
TRACE LOAD_DEREF H [ConstantVariable(int: 4), ConstantVariable(int: 1)]
TRACE BINARY_OP 5 [ConstantVariable(int: 4), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE BUILD_TUPLE 2 [ConstantVariable(int: 4), ConstantVariable(int: 64)]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>
TRACE inlined call grid from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:452 in run (Heuristics.run) (inline depth: 6)
        return self.fn.run(*args, **kwargs)
               ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in grid (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 7)
            def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
TRACE RESUME 0 []
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF V [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST meta [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE LOAD_CONST BV [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstDictVariable(), ConstantVariable(str: 'BV')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in grid (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 7)
        def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
                                ~~~~~~~~~~~^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 128)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 128)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 128)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 9)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 9)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [ConstantVariable(int: 128)]
TRACE BINARY_OP 0 [ConstantVariable(int: 128), ConstantVariable(int: 32)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 160)]
TRACE BINARY_OP 10 [ConstantVariable(int: 160), ConstantVariable(int: 1)]
TRACE LOAD_FAST y [ConstantVariable(int: 159)]
TRACE BINARY_OP 2 [ConstantVariable(int: 159), ConstantVariable(int: 32)]
TRACE RETURN_VALUE None [ConstantVariable(int: 4)]
DONE INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [ConstantVariable(int: 4)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 4)]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE LOAD_DEREF N [ConstantVariable(int: 4)]
TRACE LOAD_DEREF H [ConstantVariable(int: 4), ConstantVariable(int: 1)]
TRACE BINARY_OP 5 [ConstantVariable(int: 4), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE BUILD_TUPLE 2 [ConstantVariable(int: 4), ConstantVariable(int: 64)]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>
TRACE inlined call grid from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:452 in run (Heuristics.run) (inline depth: 6)
        return self.fn.run(*args, **kwargs)
               ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in grid (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 7)
            def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
TRACE RESUME 0 []
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF V [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST meta [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE LOAD_CONST BV [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstDictVariable(), ConstantVariable(str: 'BV')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:154 in grid (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 7)
        def grid(meta): return (triton.cdiv(V, meta['BV']), N * H)
                                ~~~~~~~~~~~^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 128)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 128), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 128)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), ConstantVariable(int: 128)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 9)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 9)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 9)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [ConstantVariable(int: 128)]
TRACE BINARY_OP 0 [ConstantVariable(int: 128), ConstantVariable(int: 32)]
TRACE LOAD_CONST 1 [ConstantVariable(int: 160)]
TRACE BINARY_OP 10 [ConstantVariable(int: 160), ConstantVariable(int: 1)]
TRACE LOAD_FAST y [ConstantVariable(int: 159)]
TRACE BINARY_OP 2 [ConstantVariable(int: 159), ConstantVariable(int: 32)]
TRACE RETURN_VALUE None [ConstantVariable(int: 4)]
DONE INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [ConstantVariable(int: 4)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 8)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [ConstantVariable(int: 4)]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE LOAD_DEREF N [ConstantVariable(int: 4)]
TRACE LOAD_DEREF H [ConstantVariable(int: 4), ConstantVariable(int: 1)]
TRACE BINARY_OP 5 [ConstantVariable(int: 4), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE BUILD_TUPLE 2 [ConstantVariable(int: 4), ConstantVariable(int: 64)]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object grid at 0x70c98cfd5730, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 154>
TRACE FX call triton_kernel_wrapper_mutation from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:452 in run (Heuristics.run) (inline depth: 6)
        return self.fn.run(*args, **kwargs)
               ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [ConstantVariable(NoneType: None)]
DONE INLINING <code object run at 0x70c9a971df10, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py", line 449>
TRACE RETURN_VALUE None [ConstantVariable(NoneType: None)]
DONE INLINING <code object <lambda> at 0x70c9a9437780, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 419>
TRACE POP_TOP None [ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:176 in forward (FusedRecurrentDPLRDeltaRuleFunction.forward.grid) (inline depth: 4)
            return o, final_state
TRACE LOAD_FAST o []
TRACE LOAD_FAST final_state [TensorVariable()]
TRACE BUILD_TUPLE 2 [TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object forward at 0x3060e8b0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 124>
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object wrapper at 0x70c98d04f0a0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py", line 16>
TRACE UNPACK_SEQUENCE 2 [TupleVariable(length=2)]
TRACE STORE_FAST o [TensorVariable(), TensorVariable()]
TRACE STORE_FAST final_state [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:258 in fused_recurrent_dplr_delta_rule (FusedRecurrentDPLRDeltaRuleFunction.forward.grid.fused_recurrent_dplr_delta_rule) (inline depth: 2)
        return o, final_state
TRACE LOAD_FAST o []
TRACE LOAD_FAST final_state [TensorVariable()]
TRACE BUILD_TUPLE 2 [TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object fused_recurrent_dplr_delta_rule at 0x305fb4e0, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py", line 188>
TRACE RETURN_VALUE None [TupleVariable(length=2)]
DONE INLINING <code object fused_recurrent_rwkv7 at 0x70c98d0c9890, file "/home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/rwkv7/fused_recurrent.py", line 11>
TRACE UNPACK_SEQUENCE 2 [TupleVariable(length=2)]
TRACE STORE_FAST xx [TensorVariable(), TensorVariable()]
TRACE STORE_FAST state [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:612 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            xx = xx.view(B,T,-1) * (float(N) ** -0.5)
TRACE LOAD_FAST xx []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: -1)]
TRACE FX call view_17 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:612 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.view(B,T,-1) * (float(N) ** -0.5)
             ~~~~~~~^^^^^^^^
TRACE LOAD_GLOBAL float [TensorVariable()]
TRACE LOAD_FAST N [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), ConstantVariable(int: 128)]
TRACE LOAD_CONST -0.5 [TensorVariable(), ConstantVariable(float: 128.0)]
TRACE BINARY_OP 8 [TensorVariable(), ConstantVariable(float: 128.0), ConstantVariable(float: -0.5)]
TRACE BINARY_OP 5 [TensorVariable(), ConstantVariable(float: 0.08838834764831845)]
TRACE FX call mul_14 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:612 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.view(B,T,-1) * (float(N) ** -0.5)
             ~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST xx [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
TRACE LOAD_FAST xx []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST r [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR dtype [NullVariable, GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_10 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
             ~~~~~^^^^^^^^^^^^^^^
TRACE LOAD_FAST r [TensorVariable()]
TRACE LOAD_ATTR view [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST B [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE CALL 4 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_18 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                      ~~~~~~^^^^^^^^^
TRACE LOAD_FAST k [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR view [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST B [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE CALL 4 [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_19 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                                      ~~~~~~^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call mul_15 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                      ~~~~~~~~~~~~~~~^^~~~~~~~~~~~~~~
TRACE LOAD_FAST r_k [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR view [TensorVariable(), TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['r_k'] (8192,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='r_k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_r_k_ L['r_k'] FakeTensor(..., device='cuda:0', size=(8192,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE LOAD_FAST H [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST N [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 64)]
TRACE CALL 2 [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_20 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                                                      ~~~~~~~~^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call mul_16 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^~~~~~~~~~~~~
TRACE LOAD_ATTR sum [TensorVariable(), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), sum)]
TRACE LOAD_CONST True [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), sum), ConstantVariable(int: -1)]
TRACE KW_NAMES ('dim', 'keepdim') [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), sum), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), sum), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call sum_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_FAST v [TensorVariable(), TensorVariable()]
TRACE LOAD_ATTR view [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST B [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE CALL 4 [TensorVariable(), TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_21 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                                                                                                 ~~~~~~^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE FX call mul_17 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~
TRACE LOAD_ATTR view [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST B [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE BINARY_OP 5 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE CALL 3 [TensorVariable(), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8192)]
TRACE FX call view_22 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable()]
TRACE FX call add_12 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)
             ~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST xx [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:616 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            output = fpx_matmul((xx * (torch.sigmoid(xg) @ g2)), O_, O_state,ebits,mbits)
TRACE LOAD_GLOBAL fpx_matmul []
TRACE LOAD_FAST xx [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL torch [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR sigmoid [NullVariable, LazyVariableTracker(), TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST xg [NullVariable, LazyVariableTracker(), TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call sigmoid_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:616 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        output = fpx_matmul((xx * (torch.sigmoid(xg) @ g2)), O_, O_state,ebits,mbits)
                                   ~~~~~~~~~~~~~^^^^
TRACE LOAD_FAST g2 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE BINARY_OP 4 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), LazyVariableTracker()]
wrap_to_fake L['g2'] (480, 8192) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='g2', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_g2_ L['g2'] FakeTensor(..., device='cuda:0', size=(480, 8192), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call matmul_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:616 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        output = fpx_matmul((xx * (torch.sigmoid(xg) @ g2)), O_, O_state,ebits,mbits)
                                   ~~~~~~~~~~~~~~~~~~^~~~
TRACE BINARY_OP 5 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE FX call mul_18 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:616 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        output = fpx_matmul((xx * (torch.sigmoid(xg) @ g2)), O_, O_state,ebits,mbits)
                             ~~~^~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_FAST O_ [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST O_state [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_FAST ebits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST mbits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: -44)]
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: -44), LazyVariableTracker()]
TRACE inlined call fpx_matmul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:616 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        output = fpx_matmul((xx * (torch.sigmoid(xg) @ g2)), O_, O_state,ebits,mbits)
                 ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object fpx_matmul at 0x3063a810, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:420 in fpx_matmul (fpx_matmul) (inline depth: 1)
    def fpx_matmul(x,weight,weight_state,ebits:int=3,mbits:int=2):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:421 in fpx_matmul (fpx_matmul) (inline depth: 1)
        if ebits == -44: #hqq
TRACE LOAD_FAST ebits []
TRACE LOAD_CONST -44 [ConstantVariable(int: -44)]
TRACE COMPARE_OP == [ConstantVariable(int: -44), ConstantVariable(int: -44)]
TRACE POP_JUMP_IF_FALSE 322 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S0=x.shape[0]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 0 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 0)]
TRACE STORE_FAST S0 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S1=x.shape[1]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 1)]
TRACE STORE_FAST S1 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:424 in fpx_matmul (fpx_matmul) (inline depth: 1)
            dtype = x.dtype
TRACE LOAD_FAST x []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
            x = x.to(dtype=torch.float16).view(-1,x.shape[2])
TRACE LOAD_FAST x []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float16 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_11 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST x [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1)]
TRACE LOAD_ATTR shape [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3), ConstantVariable(int: 2)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), ConstantVariable(int: 8192)]
TRACE FX call view_23 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
            out = weight.forward_manual(x).to(dtype=dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_ATTR forward_manual [LazyVariableTracker()]
TRACE LOAD_FAST x [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE CALL 1 [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton)), TensorVariable()]
TRACE inlined call forward_manual from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:543 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        def forward_manual(self, x: Tensor, matmul_type: str="GEMM") -> Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE LOAD_GLOBAL forward_functional []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:545 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                x,
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:546 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.bias,
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR bias [NullVariable, LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_tensor_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_ATTR get_tensor_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_tensor_args at 0x70c98a9e9080>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_tensor_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_tensor_args(),
            ~~~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:524 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
        def get_tensor_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:525 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
            return [self.W_q, self.scales, self.zeros]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR W_q [UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_FAST self [LazyVariableTracker()]
TRACE LOAD_ATTR scales [LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['O_']._parameters['scales'] (128, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='O_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='scales'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_O_parameters_scales_ L['O_']._parameters['scales'] Parameter(FakeTensor(..., device='cuda:0', size=(128, 5120), dtype=torch.float16)) at debug_level 0 before=False
TRACE LOAD_FAST self [LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR zeros [LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['O_']._parameters['zeros'] (128, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='O_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='zeros'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_O_parameters_zeros_ L['O_']._parameters['zeros'] Parameter(FakeTensor(..., device='cuda:0', size=(128, 5120), dtype=torch.float16)) at debug_level 0 before=False
TRACE BUILD_LIST 3 [LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [ListVariable(length=3)]
DONE INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_meta_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3)]
TRACE LOAD_ATTR get_meta_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_meta_args at 0x70c98a9e9120>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_meta_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_meta_args(),
            ~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:527 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
        def get_meta_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE LOAD_GLOBAL int []
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR scaled_activations [NullVariable, LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:529 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_nbits,
TRACE LOAD_FAST self [ConstantVariable(int: 0)]
TRACE LOAD_ATTR W_nbits [ConstantVariable(int: 0), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:530 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.group_size,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker()]
TRACE LOAD_ATTR group_size [ConstantVariable(int: 0), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:531 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.unpack_mask,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR unpack_mask [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:532 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.elements_per_sample,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR elements_per_sample [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:533 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.input_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR input_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:534 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.output_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR output_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:535 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.acc_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR acc_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:536 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.meta_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR meta_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:537 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.channel_scale_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR channel_scale_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:538 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_group_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR W_group_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:539 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    int(self.data_contiguous),
TRACE LOAD_GLOBAL int [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int)]
TRACE LOAD_ATTR data_contiguous [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE BUILD_LIST 12 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [ListVariable(length=12)]
DONE INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:549 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
TRACE LOAD_GLOBAL GEMLITE_MATMUL_TYPES_MAPPING [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12)]
TRACE LOAD_FAST matmul_type [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker(), ConstantVariable(str: 'GEMM')]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), ConstantVariable(int: 4)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        return forward_functional(
               ~~~~~~~~~~~~~~~~~~^
            x,
            ^^
            self.bias,
            ^^^^^^^^^^
            self.get_tensor_args(),
            ^^^^^^^^^^^^^^^^^^^^^^^
            self.get_meta_args(),
            ^^^^^^^^^^^^^^^^^^^^^
            GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:675 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        def __call__(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
            return self._opoverload(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR _opoverload [NullVariable, UserDefinedObjectVariable(CustomOpDef)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=5)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
wrap_to_fake L['O_'].W_q (1024, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=AttrSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='O_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='W_q'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_O_W_q L['O_'].W_q FakeTensor(..., device='cuda:0', size=(1024, 5120), dtype=torch.int32) at debug_level 0 before=False
TRACE FX call forward_functional_default_1 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        return self._opoverload(*args, **kwargs)
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_12 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE STORE_FAST out [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
            return out.view(S0,S1,-1)
TRACE LOAD_FAST out []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST S0 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST S1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: -1)]
TRACE FX call view_24 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
        return out.view(S0,S1,-1)
               ~~~~~~~~^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object fpx_matmul at 0x3063a810, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>
TRACE STORE_FAST output [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:618 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            x_in = x_in + output
TRACE LOAD_FAST x_in []
TRACE LOAD_FAST output [TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), TensorVariable()]
TRACE FX call add_13 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:618 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        x_in = x_in + output
               ~~~~~^~~~~~~~
TRACE STORE_FAST x_in [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:619 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            output = T5RMSNorm(x_in,ln2,variance_epsilon=rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST x_in [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln2 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE KW_NAMES ('variance_epsilon',) [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ConstantVariable(float: 1e-06)]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:619 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        output = T5RMSNorm(x_in,ln2,variance_epsilon=rmsnorm_epsilon)
                 ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_13 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_14 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_19 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln2'] (5120,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln2', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln2_ L['ln2'] FakeTensor(..., device='cuda:0', size=(5120,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_20 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_14 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST output [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:621 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
            return  output, x[:,-1], state, v_first, k_first, x_in
TRACE LOAD_FAST output []
TRACE LOAD_FAST x [TensorVariable()]
TRACE LOAD_CONST None [TensorVariable(), TensorVariable()]
TRACE LOAD_CONST None [TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST -1 [TensorVariable(), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [TensorVariable(), TensorVariable(), SliceVariable(), ConstantVariable(int: -1)]
TRACE BINARY_SUBSCR None [TensorVariable(), TensorVariable(), TupleVariable(length=2)]
TRACE FX call getitem_14 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:621 in hxa079_TimeMix (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.hxa079_TimeMix)
        return  output, x[:,-1], state, v_first, k_first, x_in
                        ~^^^^^^
TRACE LOAD_FAST state [TensorVariable(), TensorVariable()]
TRACE LOAD_FAST v_first [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST k_first [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE LOAD_FAST x_in [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 6 [TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [TupleVariable(length=6)]
Step 1: torchdynamo done tracing hxa079_TimeMix (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py, line 621 in hxa079_TimeMix>], graph_break=False)
REMOVE UNUSED GRAPHARG L['layer_id']
TRACED GRAPH
 ===== __compiled_fn_45_9ad182ab_79aa_4e72_af41_5a5c42c062be =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, L_x_in_: "[31mbf16[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m", L_ln1_: "[31mbf16[0m[34m[5120][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_wavgk1_: "[31mbf16[0m[34m[5120, 1376][0m[2m[34m[1376, 1][0m[2m[32mcuda:0[0m", L_RKV_parameters_scales_: "[31mf16[0m[34m[80, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m", L_RKV_parameters_zeros_: "[31mf16[0m[34m[80, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m", L_RKV_W_q: "[31mi32[0m[34m[640, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m", L_R_bias_: "[31mbf16[0m[34m[][0m[2m[34m[][0m[2m[32mcuda:0[0m", L_ln_r_: "[31mbf16[0m[34m[128][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_ln_k_: "[31mbf16[0m[34m[128][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_calc_cos_: "[31mf32[0m[34m[1, 1, 128][0m[2m[34m[128, 128, 1][0m[2m[32mcuda:0[0m", L_calc_sin_: "[31mf32[0m[34m[1, 1, 128][0m[2m[34m[128, 128, 1][0m[2m[32mcuda:0[0m", s80: "Sym(s80)", s81: "Sym(s81)", L_v_first_: "[31mbf16[0m[34m[1, 1, 8, 128][0m[2m[34m[s80, s80, 128, 1][0m[2m[32mcuda:0[0m", L_v2_: "[31mbf16[0m[34m[128, 1024][0m[2m[34m[1024, 1][0m[2m[32mcuda:0[0m", L_v0_: "[31mbf16[0m[34m[1, 1, 1024][0m[2m[34m[1024, 1024, 1][0m[2m[32mcuda:0[0m", L_k_first_: "[31mbf16[0m[34m[1, 1, 8, 128][0m[2m[34m[1024, 1024, 128, 1][0m[2m[32mcuda:0[0m", L_k2_: "[31mbf16[0m[34m[128, 1024][0m[2m[34m[1024, 1][0m[2m[32mcuda:0[0m", L_k0_: "[31mbf16[0m[34m[1, 1, 1024][0m[2m[34m[1024, 1024, 1][0m[2m[32mcuda:0[0m", L_a2_: "[31mbf16[0m[34m[160, 8192][0m[2m[34m[8192, 1][0m[2m[32mcuda:0[0m", L_a0_: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m", L_w2_: "[31mbf16[0m[34m[480, 8192][0m[2m[34m[8192, 1][0m[2m[32mcuda:0[0m", L_w0_: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m", L_state_: "[31mbf16[0m[34m[1, 64, 128, 128][0m[2m[34m[1048576, 16384, 128, 1][0m[2m[32mcuda:0[0m", L_r_k_: "[31mbf16[0m[34m[8192][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_g2_: "[31mbf16[0m[34m[480, 8192][0m[2m[34m[8192, 1][0m[2m[32mcuda:0[0m", L_O_parameters_scales_: "[31mf16[0m[34m[128, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m", L_O_parameters_zeros_: "[31mf16[0m[34m[128, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m", L_O_W_q: "[31mi32[0m[34m[1024, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m", L_ln2_: "[31mbf16[0m[34m[5120][0m[2m[34m[1][0m[2m[32mcuda:0[0m"):
        l_x_in_ = L_x_in_
        l_ln1_ = L_ln1_
        l_wavgk1_ = L_wavgk1_
        l_rkv_parameters_scales_ = L_RKV_parameters_scales_
        l_rkv_parameters_zeros_ = L_RKV_parameters_zeros_
        l_rkv_w_q = L_RKV_W_q
        l_r_bias_ = L_R_bias_
        l_ln_r_ = L_ln_r_
        l_ln_k_ = L_ln_k_
        l_calc_cos_ = L_calc_cos_
        l_calc_sin_ = L_calc_sin_
        l_v_first_ = L_v_first_
        l_v2_ = L_v2_
        l_v0_ = L_v0_
        l_k_first_ = L_k_first_
        l_k2_ = L_k2_
        l_k0_ = L_k0_
        l_a2_ = L_a2_
        l_a0_ = L_a0_
        l_w2_ = L_w2_
        l_w0_ = L_w0_
        l_state_ = L_state_
        l_r_k_ = L_r_k_
        l_g2_ = L_g2_
        l_o_parameters_scales_ = L_O_parameters_scales_
        l_o_parameters_zeros_ = L_O_parameters_zeros_
        l_o_w_q = L_O_W_q
        l_ln2_ = L_ln2_
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states: "[31mf32[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = l_x_in_.to([34mtorch.float32[0m)
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_1: "[31mf32[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states.pow([34m2[0m)
        variance: "[31mf32[0m[34m[1, 1, 1][0m[2m[34m[1, 1, 1][0m[2m[32mcuda:0[0m" = pow_1.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add: "[31mf32[0m[34m[1, 1, 1][0m[2m[34m[1, 1, 1][0m[2m[32mcuda:0[0m" = variance + [34m1e-06[0m;  [2mvariance = None[0m
        rsqrt: "[31mf32[0m[34m[1, 1, 1][0m[2m[34m[1, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add);  [2madd = None[0m
        hidden_states_1: "[31mf32[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states * rsqrt;  [2mhidden_states = rsqrt = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_1: "[31mf32[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = l_ln1_ * hidden_states_1;  [2ml_ln1_ = hidden_states_1 = None[0m
        x: "[31mbf16[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = mul_1.to([34mtorch.bfloat16[0m);  [2mmul_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:551 in hxa079_TimeMix, code: xw,xa,xv,xg,xk = (x @ wavgk1).split(wavgk_split_list, dim=-1)[0m
        matmul: "[31mbf16[0m[34m[1, 1, 1376][0m[2m[34m[1376, 1376, 1][0m[2m[32mcuda:0[0m" = x @ l_wavgk1_;  [2ml_wavgk1_ = None[0m
        split = matmul.split([[34m480[0m, [34m160[0m, [34m128[0m, [34m480[0m, [34m128[0m], dim = [34m-1[0m);  [2mmatmul = None[0m
        xw: "[31mbf16[0m[34m[1, 1, 480][0m[2m[34m[1376, 1376, 1][0m[2m[32mcuda:0[0m" = split[[34m0[0m]
        xa: "[31mbf16[0m[34m[1, 1, 160][0m[2m[34m[1376, 1376, 1][0m[2m[32mcuda:0[0m" = split[[34m1[0m]
        xv: "[31mbf16[0m[34m[1, 1, 128][0m[2m[34m[1376, 1376, 1][0m[2m[32mcuda:0[0m" = split[[34m2[0m]
        xg: "[31mbf16[0m[34m[1, 1, 480][0m[2m[34m[1376, 1376, 1][0m[2m[32mcuda:0[0m" = split[[34m3[0m]
        xk: "[31mbf16[0m[34m[1, 1, 128][0m[2m[34m[1376, 1376, 1][0m[2m[32mcuda:0[0m" = split[[34m4[0m];  [2msplit = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul, code: x = x.to(dtype=torch.float16).view(-1,x.shape[2])[0m
        to_2: "[31mf16[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = x.to(dtype = [34mtorch.float16[0m)
        x_1: "[31mf16[0m[34m[1, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m" = to_2.view([34m-1[0m, [34m5120[0m);  [2mto_2 = None[0m
        
         [2m# File: /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__, code: return self._opoverload(*args, **kwargs)[0m
        forward_functional_default: "[31mf16[0m[34m[1, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m" = torch.ops.gemlite.forward_functional.default(x_1, [34mNone[0m, [l_rkv_w_q, l_rkv_parameters_scales_, l_rkv_parameters_zeros_], [[34m0[0m, [34m4[0m, [34m64[0m, [34m15[0m, [34m8[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m0[0m, [34m4[0m, [34m1[0m], [34m4[0m);  [2mx_1 = l_rkv_w_q = l_rkv_parameters_scales_ = l_rkv_parameters_zeros_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul, code: out = weight.forward_manual(x).to(dtype=dtype)[0m
        out: "[31mbf16[0m[34m[1, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m" = forward_functional_default.to(dtype = [34mtorch.bfloat16[0m);  [2mforward_functional_default = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul, code: return out.view(S0,S1,-1)[0m
        rkv: "[31mbf16[0m[34m[1, 1, 10240][0m[2m[34m[10240, 10240, 1][0m[2m[32mcuda:0[0m" = out.view([34m1[0m, [34m1[0m, [34m-1[0m);  [2mout = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:556 in hxa079_TimeMix, code: r,k,v = rkv.split(rkv_split_list,dim=-1)[0m
        split_1 = rkv.split([[34m8192[0m, [34m1024[0m, [34m1024[0m], dim = [34m-1[0m);  [2mrkv = None[0m
        r: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[10240, 10240, 1][0m[2m[32mcuda:0[0m" = split_1[[34m0[0m]
        k: "[31mbf16[0m[34m[1, 1, 1024][0m[2m[34m[10240, 10240, 1][0m[2m[32mcuda:0[0m" = split_1[[34m1[0m]
        v: "[31mbf16[0m[34m[1, 1, 1024][0m[2m[34m[10240, 10240, 1][0m[2m[32mcuda:0[0m" = split_1[[34m2[0m];  [2msplit_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:562 in hxa079_TimeMix, code: r = r.add_(R_bias)[0m
        r_1: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[10240, 10240, 1][0m[2m[32mcuda:0[0m" = r.add_(l_r_bias_);  [2mr = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:563 in hxa079_TimeMix, code: k = k.add_(K_bias).view(B, T, kv_per_head, N)[0m
        add__1: "[31mbf16[0m[34m[1, 1, 1024][0m[2m[34m[10240, 10240, 1][0m[2m[32mcuda:0[0m" = k.add_(l_r_bias_);  [2mk = None[0m
        k_1: "[31mbf16[0m[34m[1, 1, 8, 128][0m[2m[34m[10240, 10240, 128, 1][0m[2m[32mcuda:0[0m" = add__1.view([34m1[0m, [34m1[0m, [34m8[0m, [34m128[0m);  [2madd__1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:564 in hxa079_TimeMix, code: v = v.add_(V_bias).view(B, T, kv_per_head, N)[0m
        add__2: "[31mbf16[0m[34m[1, 1, 1024][0m[2m[34m[10240, 10240, 1][0m[2m[32mcuda:0[0m" = v.add_(l_r_bias_);  [2mv = l_r_bias_ = None[0m
        v_1: "[31mbf16[0m[34m[1, 1, 8, 128][0m[2m[34m[10240, 10240, 128, 1][0m[2m[32mcuda:0[0m" = add__2.view([34m1[0m, [34m1[0m, [34m8[0m, [34m128[0m);  [2madd__2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:572 in hxa079_TimeMix, code: r = T5RMSNorm(r.view(B,T,H,N), ln_r, variance_epsilon=rmsnorm_epsilon)[0m
        view_4: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[10240, 10240, 128, 1][0m[2m[32mcuda:0[0m" = r_1.view([34m1[0m, [34m1[0m, [34m64[0m, [34m128[0m);  [2mr_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states_2: "[31mf32[0m[34m[1, 1, 64, 128][0m[2m[34m[10240, 10240, 128, 1][0m[2m[32mcuda:0[0m" = view_4.to([34mtorch.float32[0m);  [2mview_4 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_2: "[31mf32[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_2.pow([34m2[0m)
        variance_1: "[31mf32[0m[34m[1, 1, 64, 1][0m[2m[34m[64, 64, 1, 1][0m[2m[32mcuda:0[0m" = pow_2.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add_1: "[31mf32[0m[34m[1, 1, 64, 1][0m[2m[34m[64, 64, 1, 1][0m[2m[32mcuda:0[0m" = variance_1 + [34m1e-06[0m;  [2mvariance_1 = None[0m
        rsqrt_1: "[31mf32[0m[34m[1, 1, 64, 1][0m[2m[34m[64, 64, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add_1);  [2madd_1 = None[0m
        hidden_states_3: "[31mf32[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_2 * rsqrt_1;  [2mhidden_states_2 = rsqrt_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_3: "[31mf32[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = l_ln_r_ * hidden_states_3;  [2ml_ln_r_ = hidden_states_3 = None[0m
        r_2: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = mul_3.to([34mtorch.bfloat16[0m);  [2mmul_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states_4: "[31mf32[0m[34m[1, 1, 8, 128][0m[2m[34m[10240, 10240, 128, 1][0m[2m[32mcuda:0[0m" = k_1.to([34mtorch.float32[0m);  [2mk_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_3: "[31mf32[0m[34m[1, 1, 8, 128][0m[2m[34m[1024, 1024, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_4.pow([34m2[0m)
        variance_2: "[31mf32[0m[34m[1, 1, 8, 1][0m[2m[34m[8, 8, 1, 1][0m[2m[32mcuda:0[0m" = pow_3.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add_2: "[31mf32[0m[34m[1, 1, 8, 1][0m[2m[34m[8, 8, 1, 1][0m[2m[32mcuda:0[0m" = variance_2 + [34m1e-06[0m;  [2mvariance_2 = None[0m
        rsqrt_2: "[31mf32[0m[34m[1, 1, 8, 1][0m[2m[34m[8, 8, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add_2);  [2madd_2 = None[0m
        hidden_states_5: "[31mf32[0m[34m[1, 1, 8, 128][0m[2m[34m[1024, 1024, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_4 * rsqrt_2;  [2mhidden_states_4 = rsqrt_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_5: "[31mf32[0m[34m[1, 1, 8, 128][0m[2m[34m[1024, 1024, 128, 1][0m[2m[32mcuda:0[0m" = l_ln_k_ * hidden_states_5;  [2ml_ln_k_ = hidden_states_5 = None[0m
        k_2: "[31mbf16[0m[34m[1, 1, 8, 128][0m[2m[34m[1024, 1024, 128, 1][0m[2m[32mcuda:0[0m" = mul_5.to([34mtorch.bfloat16[0m);  [2mmul_5 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:576 in hxa079_TimeMix, code: cos, sin = calc_cos.to(k.dtype), calc_sin.to(k.dtype)[0m
        cos: "[31mbf16[0m[34m[1, 1, 128][0m[2m[34m[128, 128, 1][0m[2m[32mcuda:0[0m" = l_calc_cos_.to([34mtorch.bfloat16[0m);  [2ml_calc_cos_ = None[0m
        sin: "[31mbf16[0m[34m[1, 1, 128][0m[2m[34m[128, 128, 1][0m[2m[32mcuda:0[0m" = l_calc_sin_.to([34mtorch.bfloat16[0m);  [2ml_calc_sin_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:493 in apply_rotary_pos_emb, code: cos = cos.unsqueeze(unsqueeze_dim)[0m
        cos_1: "[31mbf16[0m[34m[1, 1, 1, 128][0m[2m[34m[128, 128, 128, 1][0m[2m[32mcuda:0[0m" = cos.unsqueeze([34m2[0m);  [2mcos = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:494 in apply_rotary_pos_emb, code: sin = sin.unsqueeze(unsqueeze_dim)[0m
        sin_1: "[31mbf16[0m[34m[1, 1, 1, 128][0m[2m[34m[128, 128, 128, 1][0m[2m[32mcuda:0[0m" = sin.unsqueeze([34m2[0m);  [2msin = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb, code: q_embed = (q * cos) + (rotate_half(q) * sin)[0m
        mul_6: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = r_2 * cos_1
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half, code: x1 = x[..., : x.shape[-1] // 2][0m
        x1: "[31mbf16[0m[34m[1, 1, 64, 64][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = r_2[([34mEllipsis[0m, slice([34mNone[0m, [34m64[0m, [34mNone[0m))]
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half, code: x2 = x[..., x.shape[-1] // 2 :][0m
        x2: "[31mbf16[0m[34m[1, 1, 64, 64][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = r_2[([34mEllipsis[0m, slice([34m64[0m, [34mNone[0m, [34mNone[0m))];  [2mr_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half, code: return torch.cat((-x2, x1), dim=-1)[0m
        neg: "[31mbf16[0m[34m[1, 1, 64, 64][0m[2m[34m[4096, 4096, 64, 1][0m[2m[32mcuda:0[0m" = -x2;  [2mx2 = None[0m
        cat: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = torch.cat((neg, x1), dim = [34m-1[0m);  [2mneg = x1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:495 in apply_rotary_pos_emb, code: q_embed = (q * cos) + (rotate_half(q) * sin)[0m
        mul_7: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = cat * sin_1;  [2mcat = None[0m
        q_embed: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = mul_6 + mul_7;  [2mmul_6 = mul_7 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb, code: k_embed = (k * cos) + (rotate_half(k) * sin)[0m
        mul_8: "[31mbf16[0m[34m[1, 1, 8, 128][0m[2m[34m[1024, 1024, 128, 1][0m[2m[32mcuda:0[0m" = k_2 * cos_1;  [2mcos_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:469 in rotate_half, code: x1 = x[..., : x.shape[-1] // 2][0m
        x1_1: "[31mbf16[0m[34m[1, 1, 8, 64][0m[2m[34m[1024, 1024, 128, 1][0m[2m[32mcuda:0[0m" = k_2[([34mEllipsis[0m, slice([34mNone[0m, [34m64[0m, [34mNone[0m))]
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:470 in rotate_half, code: x2 = x[..., x.shape[-1] // 2 :][0m
        x2_1: "[31mbf16[0m[34m[1, 1, 8, 64][0m[2m[34m[1024, 1024, 128, 1][0m[2m[32mcuda:0[0m" = k_2[([34mEllipsis[0m, slice([34m64[0m, [34mNone[0m, [34mNone[0m))];  [2mk_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:471 in rotate_half, code: return torch.cat((-x2, x1), dim=-1)[0m
        neg_1: "[31mbf16[0m[34m[1, 1, 8, 64][0m[2m[34m[512, 512, 64, 1][0m[2m[32mcuda:0[0m" = -x2_1;  [2mx2_1 = None[0m
        cat_1: "[31mbf16[0m[34m[1, 1, 8, 128][0m[2m[34m[1024, 1024, 128, 1][0m[2m[32mcuda:0[0m" = torch.cat((neg_1, x1_1), dim = [34m-1[0m);  [2mneg_1 = x1_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:496 in apply_rotary_pos_emb, code: k_embed = (k * cos) + (rotate_half(k) * sin)[0m
        mul_9: "[31mbf16[0m[34m[1, 1, 8, 128][0m[2m[34m[1024, 1024, 128, 1][0m[2m[32mcuda:0[0m" = cat_1 * sin_1;  [2mcat_1 = sin_1 = None[0m
        k_embed: "[31mbf16[0m[34m[1, 1, 8, 128][0m[2m[34m[1024, 1024, 128, 1][0m[2m[32mcuda:0[0m" = mul_8 + mul_9;  [2mmul_8 = mul_9 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:584 in hxa079_TimeMix, code: v = v + (v_first - v) * torch.sigmoid(xv@v2 + v0).view(B, T, kv_per_head, N)[0m
        sub: "[31mbf16[0m[34m[1, 1, 8, 128][0m[2m[34m[1024, 1024, 128, 1][0m[2m[32mcuda:0[0m" = l_v_first_ - v_1;  [2ml_v_first_ = None[0m
        matmul_1: "[31mbf16[0m[34m[1, 1, 1024][0m[2m[34m[1024, 1024, 1][0m[2m[32mcuda:0[0m" = xv @ l_v2_;  [2mxv = l_v2_ = None[0m
        add_5: "[31mbf16[0m[34m[1, 1, 1024][0m[2m[34m[1024, 1024, 1][0m[2m[32mcuda:0[0m" = matmul_1 + l_v0_;  [2mmatmul_1 = l_v0_ = None[0m
        sigmoid: "[31mbf16[0m[34m[1, 1, 1024][0m[2m[34m[1024, 1024, 1][0m[2m[32mcuda:0[0m" = torch.sigmoid(add_5);  [2madd_5 = None[0m
        view_5: "[31mbf16[0m[34m[1, 1, 8, 128][0m[2m[34m[1024, 1024, 128, 1][0m[2m[32mcuda:0[0m" = sigmoid.view([34m1[0m, [34m1[0m, [34m8[0m, [34m128[0m);  [2msigmoid = None[0m
        mul_10: "[31mbf16[0m[34m[1, 1, 8, 128][0m[2m[34m[1024, 1024, 128, 1][0m[2m[32mcuda:0[0m" = sub * view_5;  [2msub = view_5 = None[0m
        v_2: "[31mbf16[0m[34m[1, 1, 8, 128][0m[2m[34m[1024, 1024, 128, 1][0m[2m[32mcuda:0[0m" = v_1 + mul_10;  [2mv_1 = mul_10 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:585 in hxa079_TimeMix, code: k = k + (k_first - k) * torch.sigmoid(xk@k2 + k0).view(B, T, kv_per_head, N)[0m
        sub_1: "[31mbf16[0m[34m[1, 1, 8, 128][0m[2m[34m[1024, 1024, 128, 1][0m[2m[32mcuda:0[0m" = l_k_first_ - k_embed;  [2ml_k_first_ = None[0m
        matmul_2: "[31mbf16[0m[34m[1, 1, 1024][0m[2m[34m[1024, 1024, 1][0m[2m[32mcuda:0[0m" = xk @ l_k2_;  [2mxk = l_k2_ = None[0m
        add_7: "[31mbf16[0m[34m[1, 1, 1024][0m[2m[34m[1024, 1024, 1][0m[2m[32mcuda:0[0m" = matmul_2 + l_k0_;  [2mmatmul_2 = l_k0_ = None[0m
        sigmoid_1: "[31mbf16[0m[34m[1, 1, 1024][0m[2m[34m[1024, 1024, 1][0m[2m[32mcuda:0[0m" = torch.sigmoid(add_7);  [2madd_7 = None[0m
        view_6: "[31mbf16[0m[34m[1, 1, 8, 128][0m[2m[34m[1024, 1024, 128, 1][0m[2m[32mcuda:0[0m" = sigmoid_1.view([34m1[0m, [34m1[0m, [34m8[0m, [34m128[0m);  [2msigmoid_1 = None[0m
        mul_11: "[31mbf16[0m[34m[1, 1, 8, 128][0m[2m[34m[1024, 1024, 128, 1][0m[2m[32mcuda:0[0m" = sub_1 * view_6;  [2msub_1 = view_6 = None[0m
        k_3: "[31mbf16[0m[34m[1, 1, 8, 128][0m[2m[34m[1024, 1024, 128, 1][0m[2m[32mcuda:0[0m" = k_embed + mul_11;  [2mk_embed = mul_11 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:357 in repeat_kv, code: hidden_states = hidden_states[:, :, :, None, :]  # (B, T, H_kv, 1, D)[0m
        hidden_states_6: "[31mbf16[0m[34m[1, 1, 8, 1, 128][0m[2m[34m[1024, 1024, 128, 128, 1][0m[2m[32mcuda:0[0m" = k_3[(slice([34mNone[0m, [34mNone[0m, [34mNone[0m), slice([34mNone[0m, [34mNone[0m, [34mNone[0m), slice([34mNone[0m, [34mNone[0m, [34mNone[0m), [34mNone[0m, slice([34mNone[0m, [34mNone[0m, [34mNone[0m))];  [2mk_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:358 in repeat_kv, code: hidden_states = hidden_states.expand(B, T, H_kv, n_rep, D)  # (B, T, H_kv, n_rep, D)[0m
        hidden_states_7: "[31mbf16[0m[34m[1, 1, 8, 8, 128][0m[2m[34m[1024, 1024, 128, 0, 1][0m[2m[32mcuda:0[0m" = hidden_states_6.expand([34m1[0m, [34m1[0m, [34m8[0m, [34m8[0m, [34m128[0m);  [2mhidden_states_6 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv, code: return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()[0m
        reshape: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_7.reshape([34m1[0m, [34m1[0m, [34m64[0m, [34m128[0m);  [2mhidden_states_7 = None[0m
        contiguous: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = reshape.contiguous();  [2mreshape = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:589 in hxa079_TimeMix, code: k = repeat_kv(k, kv_repeat).view(B, T, -1)[0m
        k_4: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = contiguous.view([34m1[0m, [34m1[0m, [34m-1[0m);  [2mcontiguous = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:357 in repeat_kv, code: hidden_states = hidden_states[:, :, :, None, :]  # (B, T, H_kv, 1, D)[0m
        hidden_states_8: "[31mbf16[0m[34m[1, 1, 8, 1, 128][0m[2m[34m[1024, 1024, 128, 128, 1][0m[2m[32mcuda:0[0m" = v_2[(slice([34mNone[0m, [34mNone[0m, [34mNone[0m), slice([34mNone[0m, [34mNone[0m, [34mNone[0m), slice([34mNone[0m, [34mNone[0m, [34mNone[0m), [34mNone[0m, slice([34mNone[0m, [34mNone[0m, [34mNone[0m))];  [2mv_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:358 in repeat_kv, code: hidden_states = hidden_states.expand(B, T, H_kv, n_rep, D)  # (B, T, H_kv, n_rep, D)[0m
        hidden_states_9: "[31mbf16[0m[34m[1, 1, 8, 8, 128][0m[2m[34m[1024, 1024, 128, 0, 1][0m[2m[32mcuda:0[0m" = hidden_states_8.expand([34m1[0m, [34m1[0m, [34m8[0m, [34m8[0m, [34m128[0m);  [2mhidden_states_8 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:359 in repeat_kv, code: return hidden_states.reshape(B, T, H_kv * n_rep, D).contiguous()[0m
        reshape_1: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_9.reshape([34m1[0m, [34m1[0m, [34m64[0m, [34m128[0m);  [2mhidden_states_9 = None[0m
        contiguous_1: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = reshape_1.contiguous();  [2mreshape_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:590 in hxa079_TimeMix, code: v = repeat_kv(v, kv_repeat).view(B, T, -1)[0m
        v_3: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = contiguous_1.view([34m1[0m, [34m1[0m, [34m-1[0m);  [2mcontiguous_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:593 in hxa079_TimeMix, code: a = torch.sigmoid(xa @ a2 + a0)[0m
        matmul_3: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = xa @ l_a2_;  [2mxa = l_a2_ = None[0m
        add_9: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = matmul_3 + l_a0_;  [2mmatmul_3 = l_a0_ = None[0m
        a: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = torch.sigmoid(add_9);  [2madd_9 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:595 in hxa079_TimeMix, code: kk = F.normalize(k.view(B, T, H, N), p=2.0, dim=-1).view(B, T, H*N)[0m
        view_9: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = k_4.view([34m1[0m, [34m1[0m, [34m64[0m, [34m128[0m)
        normalize: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = torch.nn.functional.normalize(view_9, p = [34m2.0[0m, dim = [34m-1[0m);  [2mview_9 = None[0m
        kk: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = normalize.view([34m1[0m, [34m1[0m, [34m8192[0m);  [2mnormalize = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:596 in hxa079_TimeMix, code: w = torch.tanh(xw) @ w2 + w0[0m
        tanh: "[31mbf16[0m[34m[1, 1, 480][0m[2m[34m[480, 480, 1][0m[2m[32mcuda:0[0m" = torch.tanh(xw);  [2mxw = None[0m
        matmul_4: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = tanh @ l_w2_;  [2mtanh = l_w2_ = None[0m
        w: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = matmul_4 + l_w0_;  [2mmatmul_4 = l_w0_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:597 in hxa079_TimeMix, code: w = -F.softplus(-w) - 0.5[0m
        neg_2: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = -w;  [2mw = None[0m
        softplus: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = torch._C._nn.softplus(neg_2);  [2mneg_2 = None[0m
        neg_3: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = -softplus;  [2msoftplus = None[0m
        w_1: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = neg_3 - [34m0.5[0m;  [2mneg_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:598 in hxa079_TimeMix, code: k = k * (1.0 - w + a)[0m
        sub_3: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = [34m1.0[0m - w_1
        add_11: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = sub_3 + a;  [2msub_3 = None[0m
        k_5: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = k_4 * add_11;  [2mk_4 = add_11 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:600 in hxa079_TimeMix, code: aa = -kk[0m
        aa: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = -kk
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:601 in hxa079_TimeMix, code: bb = kk * a[0m
        bb: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = kk * a;  [2mkk = a = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:603 in hxa079_TimeMix, code: w = -w.exp()#.to(dtype=torch.float32).exp()[0m
        exp: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = w_1.exp();  [2mw_1 = None[0m
        w_2: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = -exp;  [2mexp = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:604 in hxa079_TimeMix, code: r_,w_,k_,v_,aa_,bb_ = [i.view(B,T,H,N) for i in [r,w,k,v,aa,bb]][0m
        r_: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = q_embed.view([34m1[0m, [34m1[0m, [34m64[0m, [34m128[0m)
        w_: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = w_2.view([34m1[0m, [34m1[0m, [34m64[0m, [34m128[0m);  [2mw_2 = None[0m
        k_: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = k_5.view([34m1[0m, [34m1[0m, [34m64[0m, [34m128[0m)
        v_: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = v_3.view([34m1[0m, [34m1[0m, [34m64[0m, [34m128[0m)
        aa_: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = aa.view([34m1[0m, [34m1[0m, [34m64[0m, [34m128[0m);  [2maa = None[0m
        bb_: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = bb.view([34m1[0m, [34m1[0m, [34m64[0m, [34m128[0m);  [2mbb = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/fla/utils.py:19 in <genexpr>, code: *(i if not isinstance(i, torch.Tensor) else i.contiguous() for i in args),[0m
        contiguous_2: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = r_.contiguous();  [2mr_ = None[0m
        contiguous_3: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = k_.contiguous();  [2mk_ = None[0m
        contiguous_4: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = v_.contiguous();  [2mv_ = None[0m
        contiguous_5: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = aa_.contiguous();  [2maa_ = None[0m
        contiguous_6: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = bb_.contiguous();  [2mbb_ = None[0m
        contiguous_7: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = w_.contiguous();  [2mw_ = None[0m
        contiguous_8: "[31mbf16[0m[34m[1, 64, 128, 128][0m[2m[34m[1048576, 16384, 128, 1][0m[2m[32mcuda:0[0m" = l_state_.contiguous();  [2ml_state_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:148 in forward, code: final_state = q.new_empty(B, H, K, V, dtype=torch.float32)[0m
        final_state: "[31mf32[0m[34m[1, 64, 128, 128][0m[2m[34m[1048576, 16384, 128, 1][0m[2m[32mcuda:0[0m" = contiguous_2.new_empty([34m1[0m, [34m64[0m, [34m128[0m, [34m128[0m, dtype = [34mtorch.float32[0m)
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:152 in forward, code: ha = torch.empty_like(v, dtype=torch.float32)[0m
        ha: "[31mf32[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = torch.empty_like(contiguous_4, dtype = [34mtorch.float32[0m)
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/fla/ops/generalized_delta_rule/dplr/fused_recurrent.py:155 in forward, code: o = torch.empty_like(v)[0m
        o: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = torch.empty_like(contiguous_4)
        
         [2m# File: /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/autotuner.py:452 in run, code: return self.fn.run(*args, **kwargs)[0m
        triton_kernel_wrapper_mutation = torch.ops.higher_order.triton_kernel_wrapper_mutation(kernel_idx = [34m0[0m, constant_args_idx = [34m8[0m, grid = [([34m4[0m, [34m64[0m, [34m1[0m), ([34m4[0m, [34m64[0m, [34m1[0m), ([34m4[0m, [34m64[0m, [34m1[0m)], tma_descriptor_metadata = [34m{}[0m, kwargs = [34m{'q': contiguous_2, 'k': contiguous_3, 'v': contiguous_4, 'a': contiguous_5, 'b': contiguous_6, 'gk': contiguous_7, 'o': o, 'ha': ha, 'h0': contiguous_8, 'ht': final_state}[0m);  [2mcontiguous_2 = contiguous_3 = contiguous_4 = contiguous_5 = contiguous_6 = contiguous_7 = ha = contiguous_8 = triton_kernel_wrapper_mutation = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:612 in hxa079_TimeMix, code: xx = xx.view(B,T,-1) * (float(N) ** -0.5)[0m
        view_17: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = o.view([34m1[0m, [34m1[0m, [34m-1[0m);  [2mo = None[0m
        xx: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = view_17 * [34m0.08838834764831845[0m;  [2mview_17 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:614 in hxa079_TimeMix, code: xx = xx.to(dtype=r.dtype) + ((r.view(B,T,H,N)*k.view(B,T,H,N)*r_k.view(H,N)).sum(dim=-1, keepdim=True) * v.view(B,T,H,N)).view(B,T,H*N)[0m
        to_10: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = xx.to(dtype = [34mtorch.bfloat16[0m);  [2mxx = None[0m
        view_18: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = q_embed.view([34m1[0m, [34m1[0m, [34m64[0m, [34m128[0m);  [2mq_embed = None[0m
        view_19: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = k_5.view([34m1[0m, [34m1[0m, [34m64[0m, [34m128[0m);  [2mk_5 = None[0m
        mul_15: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = view_18 * view_19;  [2mview_18 = view_19 = None[0m
        view_20: "[31mbf16[0m[34m[64, 128][0m[2m[34m[128, 1][0m[2m[32mcuda:0[0m" = l_r_k_.view([34m64[0m, [34m128[0m);  [2ml_r_k_ = None[0m
        mul_16: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = mul_15 * view_20;  [2mmul_15 = view_20 = None[0m
        sum_1: "[31mbf16[0m[34m[1, 1, 64, 1][0m[2m[34m[64, 64, 1, 1][0m[2m[32mcuda:0[0m" = mul_16.sum(dim = [34m-1[0m, keepdim = [34mTrue[0m);  [2mmul_16 = None[0m
        view_21: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = v_3.view([34m1[0m, [34m1[0m, [34m64[0m, [34m128[0m);  [2mv_3 = None[0m
        mul_17: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = sum_1 * view_21;  [2msum_1 = view_21 = None[0m
        view_22: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = mul_17.view([34m1[0m, [34m1[0m, [34m8192[0m);  [2mmul_17 = None[0m
        xx_1: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = to_10 + view_22;  [2mto_10 = view_22 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:616 in hxa079_TimeMix, code: output = fpx_matmul((xx * (torch.sigmoid(xg) @ g2)), O_, O_state,ebits,mbits)[0m
        sigmoid_3: "[31mbf16[0m[34m[1, 1, 480][0m[2m[34m[480, 480, 1][0m[2m[32mcuda:0[0m" = torch.sigmoid(xg);  [2mxg = None[0m
        matmul_5: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = sigmoid_3 @ l_g2_;  [2msigmoid_3 = l_g2_ = None[0m
        mul_18: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = xx_1 * matmul_5;  [2mxx_1 = matmul_5 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul, code: x = x.to(dtype=torch.float16).view(-1,x.shape[2])[0m
        to_11: "[31mf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = mul_18.to(dtype = [34mtorch.float16[0m);  [2mmul_18 = None[0m
        x_2: "[31mf16[0m[34m[1, 8192][0m[2m[34m[8192, 1][0m[2m[32mcuda:0[0m" = to_11.view([34m-1[0m, [34m8192[0m);  [2mto_11 = None[0m
        
         [2m# File: /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__, code: return self._opoverload(*args, **kwargs)[0m
        forward_functional_default_1: "[31mf16[0m[34m[1, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m" = torch.ops.gemlite.forward_functional.default(x_2, [34mNone[0m, [l_o_w_q, l_o_parameters_scales_, l_o_parameters_zeros_], [[34m0[0m, [34m4[0m, [34m64[0m, [34m15[0m, [34m8[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m0[0m, [34m4[0m, [34m1[0m], [34m4[0m);  [2mx_2 = l_o_w_q = l_o_parameters_scales_ = l_o_parameters_zeros_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul, code: out = weight.forward_manual(x).to(dtype=dtype)[0m
        out_1: "[31mbf16[0m[34m[1, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m" = forward_functional_default_1.to(dtype = [34mtorch.bfloat16[0m);  [2mforward_functional_default_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul, code: return out.view(S0,S1,-1)[0m
        output: "[31mbf16[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = out_1.view([34m1[0m, [34m1[0m, [34m-1[0m);  [2mout_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:618 in hxa079_TimeMix, code: x_in = x_in + output[0m
        x_in: "[31mbf16[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = l_x_in_ + output;  [2ml_x_in_ = output = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states_10: "[31mf32[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = x_in.to([34mtorch.float32[0m)
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_4: "[31mf32[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states_10.pow([34m2[0m)
        variance_3: "[31mf32[0m[34m[1, 1, 1][0m[2m[34m[1, 1, 1][0m[2m[32mcuda:0[0m" = pow_4.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_4 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add_14: "[31mf32[0m[34m[1, 1, 1][0m[2m[34m[1, 1, 1][0m[2m[32mcuda:0[0m" = variance_3 + [34m1e-06[0m;  [2mvariance_3 = None[0m
        rsqrt_3: "[31mf32[0m[34m[1, 1, 1][0m[2m[34m[1, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add_14);  [2madd_14 = None[0m
        hidden_states_11: "[31mf32[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states_10 * rsqrt_3;  [2mhidden_states_10 = rsqrt_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_20: "[31mf32[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = l_ln2_ * hidden_states_11;  [2ml_ln2_ = hidden_states_11 = None[0m
        output_1: "[31mbf16[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = mul_20.to([34mtorch.bfloat16[0m);  [2mmul_20 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:621 in hxa079_TimeMix, code: return  output, x[:,-1], state, v_first, k_first, x_in[0m
        getitem_14: "[31mbf16[0m[34m[1, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m" = x[(slice([34mNone[0m, [34mNone[0m, [34mNone[0m), [34m-1[0m)];  [2mx = None[0m
        return (output_1, getitem_14, final_state, x_in)
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing GQA_Attention_Flash_ /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:875
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:875 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7)
        @torch.compile(mode="max-autotune-no-cudagraphs")
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:904 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            B, T, C = x_in.shape
TRACE LOAD_FAST x_in []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
automatic dynamic stride L['x_in'] stride(0) InferStride(dim=2) != InferStride(dim=1)
wrap_to_fake L['x_in'] (1, 1, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='x_in', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_x_in_ L['x_in'] FakeTensor(..., device='cuda:0', size=(1, 1, 5120), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE UNPACK_SEQUENCE 3 [SizeVariable(length=3)]
TRACE STORE_FAST B [ConstantVariable(int: 5120), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 5120), ConstantVariable(int: 1)]
TRACE STORE_FAST C [ConstantVariable(int: 5120)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:905 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            device = x_in.device
TRACE LOAD_FAST x_in []
TRACE LOAD_ATTR device [TensorVariable()]
TRACE STORE_FAST device [ConstantVariable(device: device(type='cuda', index=0))]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:906 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            Lmax = past_key_value.shape[3]
TRACE LOAD_FAST past_key_value []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
wrap_to_fake L['past_key_value'] (8, 1, 2, 8192, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='past_key_value', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}), tensor_source=LocalSource(local_name='past_key_value', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_past_key_value_ L['past_key_value'] FakeTensor(..., device='cuda:0', size=(8, 1, 2, 8192, 1024),
           dtype=torch.bfloat16) at debug_level 0 before=False
wrap_to_fake L['past_key_value']._base (8, 1, 2, 8192, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='past_key_value', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
TRACE LOAD_CONST 3 [SizeVariable(length=5)]
TRACE BINARY_SUBSCR None [SizeVariable(length=5), ConstantVariable(int: 3)]
TRACE STORE_FAST Lmax [ConstantVariable(int: 8192)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            starts = cache_position[:, 0].clone()
TRACE LOAD_FAST cache_position []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE LOAD_CONST None [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [LazyVariableTracker(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST 0 [LazyVariableTracker(), SliceVariable()]
TRACE BUILD_TUPLE 2 [LazyVariableTracker(), SliceVariable(), ConstantVariable(int: 0)]
TRACE BINARY_SUBSCR None [LazyVariableTracker(), TupleVariable(length=2)]
wrap_to_fake L['cache_position'] (1, 1) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='cache_position', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_cache_position_ L['cache_position'] FakeTensor(..., device='cuda:0', size=(1, 1), dtype=torch.int64) at debug_level 0 before=False
TRACE FX call getitem from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        starts = cache_position[:, 0].clone()
                 ~~~~~~~~~~~~~~^^^^^^
TRACE LOAD_ATTR clone [TensorVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), clone)]
TRACE FX call clone from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        starts = cache_position[:, 0].clone()
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST starts [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:910 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            starts.clamp_(min=0, max=Lmax)
TRACE LOAD_FAST starts []
TRACE LOAD_ATTR clamp_ [TensorVariable()]
TRACE LOAD_CONST 0 [NullVariable, GetAttrVariable(TensorVariable(), clamp_)]
TRACE LOAD_FAST Lmax [NullVariable, GetAttrVariable(TensorVariable(), clamp_), ConstantVariable(int: 0)]
TRACE KW_NAMES ('min', 'max') [NullVariable, GetAttrVariable(TensorVariable(), clamp_), ConstantVariable(int: 0), ConstantVariable(int: 8192)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), clamp_), ConstantVariable(int: 0), ConstantVariable(int: 8192)]
TRACE FX call clamp_ from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:910 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        starts.clamp_(min=0, max=Lmax)
        ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:913 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            x = T5RMSNorm(x_in, ln1, rmsnorm_epsilon)  # 実装は外部
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST x_in [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:913 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        x = T5RMSNorm(x_in, ln1, rmsnorm_epsilon)  # 実装は外部
            ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE FX call add from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln1'] (5120,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln1', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln1_ L['ln1'] FakeTensor(..., device='cuda:0', size=(5120,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:915 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            HN = H * N
TRACE LOAD_FAST H []
TRACE LOAD_FAST N [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), LazyVariableTracker()]
TRACE STORE_FAST HN [ConstantVariable(int: 8192)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:918 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            qkv = fpx_matmul(x, QKV_, QKV_state, ebits, mbits)  # [B,T, QHN + KVd + KVd]
TRACE LOAD_GLOBAL fpx_matmul []
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST QKV_ [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST QKV_state [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_FAST ebits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST mbits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call fpx_matmul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:918 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        qkv = fpx_matmul(x, QKV_, QKV_state, ebits, mbits)  # [B,T, QHN + KVd + KVd]
              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object fpx_matmul at 0x3063a810, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:420 in fpx_matmul (fpx_matmul) (inline depth: 1)
    def fpx_matmul(x,weight,weight_state,ebits:int=3,mbits:int=2):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:421 in fpx_matmul (fpx_matmul) (inline depth: 1)
        if ebits == -44: #hqq
TRACE LOAD_FAST ebits []
TRACE LOAD_CONST -44 [LazyVariableTracker()]
TRACE COMPARE_OP == [LazyVariableTracker(), ConstantVariable(int: -44)]
TRACE POP_JUMP_IF_FALSE 322 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S0=x.shape[0]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 0 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 0)]
TRACE STORE_FAST S0 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S1=x.shape[1]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 1)]
TRACE STORE_FAST S1 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:424 in fpx_matmul (fpx_matmul) (inline depth: 1)
            dtype = x.dtype
TRACE LOAD_FAST x []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
            x = x.to(dtype=torch.float16).view(-1,x.shape[2])
TRACE LOAD_FAST x []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float16 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_2 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST x [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1)]
TRACE LOAD_ATTR shape [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3), ConstantVariable(int: 2)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), ConstantVariable(int: 5120)]
TRACE FX call view from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
            out = weight.forward_manual(x).to(dtype=dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_ATTR forward_manual [LazyVariableTracker()]
TRACE LOAD_FAST x [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE CALL 1 [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton)), TensorVariable()]
TRACE inlined call forward_manual from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:543 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        def forward_manual(self, x: Tensor, matmul_type: str="GEMM") -> Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE LOAD_GLOBAL forward_functional []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:545 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                x,
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:546 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.bias,
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR bias [NullVariable, LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_tensor_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_ATTR get_tensor_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_tensor_args at 0x70c98a9e9080>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_tensor_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_tensor_args(),
            ~~~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:524 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
        def get_tensor_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:525 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
            return [self.W_q, self.scales, self.zeros]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR W_q [UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_FAST self [LazyVariableTracker()]
TRACE LOAD_ATTR scales [LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['QKV_']._parameters['scales'] (80, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='QKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='scales'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_QKV_parameters_scales_ L['QKV_']._parameters['scales'] Parameter(FakeTensor(..., device='cuda:0', size=(80, 10240), dtype=torch.float16)) at debug_level 0 before=False
TRACE LOAD_FAST self [LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR zeros [LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['QKV_']._parameters['zeros'] (80, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='QKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='zeros'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_QKV_parameters_zeros_ L['QKV_']._parameters['zeros'] Parameter(FakeTensor(..., device='cuda:0', size=(80, 10240), dtype=torch.float16)) at debug_level 0 before=False
TRACE BUILD_LIST 3 [LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [ListVariable(length=3)]
DONE INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_meta_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3)]
TRACE LOAD_ATTR get_meta_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_meta_args at 0x70c98a9e9120>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_meta_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_meta_args(),
            ~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:527 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
        def get_meta_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE LOAD_GLOBAL int []
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR scaled_activations [NullVariable, LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:529 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_nbits,
TRACE LOAD_FAST self [ConstantVariable(int: 0)]
TRACE LOAD_ATTR W_nbits [ConstantVariable(int: 0), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:530 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.group_size,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker()]
TRACE LOAD_ATTR group_size [ConstantVariable(int: 0), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:531 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.unpack_mask,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR unpack_mask [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:532 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.elements_per_sample,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR elements_per_sample [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:533 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.input_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR input_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:534 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.output_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR output_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:535 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.acc_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR acc_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:536 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.meta_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR meta_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:537 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.channel_scale_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR channel_scale_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:538 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_group_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR W_group_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:539 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    int(self.data_contiguous),
TRACE LOAD_GLOBAL int [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int)]
TRACE LOAD_ATTR data_contiguous [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE BUILD_LIST 12 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [ListVariable(length=12)]
DONE INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:549 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
TRACE LOAD_GLOBAL GEMLITE_MATMUL_TYPES_MAPPING [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12)]
TRACE LOAD_FAST matmul_type [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker(), ConstantVariable(str: 'GEMM')]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        return forward_functional(
               ~~~~~~~~~~~~~~~~~~^
            x,
            ^^
            self.bias,
            ^^^^^^^^^^
            self.get_tensor_args(),
            ^^^^^^^^^^^^^^^^^^^^^^^
            self.get_meta_args(),
            ^^^^^^^^^^^^^^^^^^^^^
            GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:675 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        def __call__(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
            return self._opoverload(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR _opoverload [NullVariable, UserDefinedObjectVariable(CustomOpDef)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=5)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
wrap_to_fake L['QKV_'].W_q (640, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=AttrSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='QKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='W_q'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_QKV_W_q L['QKV_'].W_q FakeTensor(..., device='cuda:0', size=(640, 10240), dtype=torch.int32) at debug_level 0 before=False
TRACE FX call forward_functional_default from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        return self._opoverload(*args, **kwargs)
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_3 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE STORE_FAST out [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
            return out.view(S0,S1,-1)
TRACE LOAD_FAST out []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST S0 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST S1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: -1)]
TRACE FX call view_1 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
        return out.view(S0,S1,-1)
               ~~~~~~~~^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object fpx_matmul at 0x3063a810, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>
TRACE STORE_FAST qkv [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:919 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q, k, v = qkv.split(qkv_split_list, dim=-1)
TRACE LOAD_FAST qkv []
TRACE LOAD_ATTR split [TensorVariable()]
TRACE LOAD_FAST qkv_split_list [NullVariable, GetAttrVariable(TensorVariable(), split)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker()]
TRACE KW_NAMES ('dim',) [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE FX call split from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:919 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        q, k, v = qkv.split(qkv_split_list, dim=-1)
                  ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
TRACE UNPACK_SEQUENCE 3 [TupleVariable(length=3)]
TRACE STORE_FAST q [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST k [TensorVariable(), TensorVariable()]
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:922 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q.add_(Q_bias)
TRACE LOAD_FAST q []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST Q_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
wrap_to_fake L['Q_bias'] () StatefulSymbolicContext(dynamic_sizes=[], dynamic_strides=[], constraint_sizes=[], constraint_strides=[], specialize_on=[], view_base_context=None, tensor_source=LocalSource(local_name='Q_bias', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_Q_bias_ L['Q_bias'] FakeTensor(..., device='cuda:0', size=(), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call add_ from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:922 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        q.add_(Q_bias)
        ~~~~~~^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:923 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k.add_(K_bias)
TRACE LOAD_FAST k []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST K_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
TRACE FX call add__1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:923 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        k.add_(K_bias)
        ~~~~~~^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:924 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            v.add_(V_bias)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST V_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
TRACE FX call add__2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:924 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        v.add_(V_bias)
        ~~~~~~^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:927 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q = q.view(B, T, H, N)  # [B,T,H,N]
TRACE LOAD_FAST q []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:927 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        q = q.view(B, T, H, N)  # [B,T,H,N]
            ~~~~~~^^^^^^^^^^^^
TRACE STORE_FAST q [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:928 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            kv_dim_flat = k.shape[-1]     # kv_heads * N
TRACE LOAD_FAST k []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST -1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: -1)]
TRACE STORE_FAST kv_dim_flat [ConstantVariable(int: 1024)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:929 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            kv_heads = kv_dim_flat // N
TRACE LOAD_FAST kv_dim_flat []
TRACE LOAD_FAST N [ConstantVariable(int: 1024)]
TRACE BINARY_OP 2 [ConstantVariable(int: 1024), ConstantVariable(int: 128)]
TRACE STORE_FAST kv_heads [ConstantVariable(int: 8)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:930 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k = k.view(B, T, kv_heads, N) # [B,T,kv_h,N]
TRACE LOAD_FAST k []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_heads [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:930 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        k = k.view(B, T, kv_heads, N) # [B,T,kv_h,N]
            ~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:931 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            v = v.view(B, T, kv_heads, N)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_heads [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:931 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        v = v.view(B, T, kv_heads, N)
            ~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:934 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            if ln_r is not None:
TRACE LOAD_FAST ln_r []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 0 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
wrap_to_fake L['ln_r'] (128,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln_r', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln_r_ L['ln_r'] FakeTensor(..., device='cuda:0', size=(128,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE POP_JUMP_IF_TRUE 606 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:935 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
                q = T5RMSNorm(q, ln_r, rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln_r [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:935 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q = T5RMSNorm(q, ln_r, rmsnorm_epsilon)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST q [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:936 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
                k = T5RMSNorm(k, ln_k, rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln_k [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:936 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k = T5RMSNorm(k, ln_k, rmsnorm_epsilon)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln_k'] (128,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln_k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln_k_ L['ln_k'] FakeTensor(..., device='cuda:0', size=(128,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:940 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k_write = k.view(B, T, -1)
TRACE LOAD_FAST k []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: -1)]
TRACE FX call view_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:940 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        k_write = k.view(B, T, -1)
                  ~~~~~~^^^^^^^^^^
TRACE STORE_FAST k_write [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:941 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            v_write = v.view(B, T, -1)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: -1)]
TRACE FX call view_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:941 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        v_write = v.view(B, T, -1)
                  ~~~~~~^^^^^^^^^^
TRACE STORE_FAST v_write [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:944 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            new_lengths = starts + T
TRACE LOAD_FAST starts []
TRACE LOAD_FAST T [TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), ConstantVariable(int: 1)]
TRACE FX call add_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:944 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        new_lengths = starts + T
                      ~~~~~~~^~~
TRACE STORE_FAST new_lengths [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            excess_tokens = torch.clamp(new_lengths - Lmax, min=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR clamp [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST new_lengths [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST Lmax [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 10 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 8192)]
TRACE FX call sub from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        excess_tokens = torch.clamp(new_lengths - Lmax, min=0)
                                    ~~~~~~~~~~~~^~~~~~
TRACE LOAD_CONST 0 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE KW_NAMES ('min',) [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 0)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 0)]
TRACE FX call clamp from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        excess_tokens = torch.clamp(new_lengths - Lmax, min=0)
                        ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST excess_tokens [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:946 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            batches_to_evict = excess_tokens > 0
TRACE LOAD_FAST excess_tokens []
TRACE LOAD_CONST 0 [TensorVariable()]
TRACE COMPARE_OP > [TensorVariable(), ConstantVariable(int: 0)]
TRACE FX call gt from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:946 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        batches_to_evict = excess_tokens > 0
                           ^^^^^^^^^^^^^^^^^
TRACE STORE_FAST batches_to_evict [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            if bool(batches_to_evict.any()):
TRACE LOAD_GLOBAL bool []
TRACE LOAD_FAST batches_to_evict [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR any [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), any)]
TRACE FX call any_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        if bool(batches_to_evict.any()):
                ~~~~~~~~~~~~~~~~~~~~^^
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
Graph break (user stack suppressed due to duplicate graph break) in user code at /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949
Graph Break Reason: Failed to trace builtin operator
  Explanation: Dynamo does not know how to trace builtin operator `bool` with argument types ['Tensor'] (has_kwargs False)
  Hint: Avoid calling builtin `bool` with argument types ['Tensor']. Consider using an equivalent alternative function/method to `bool`.
  Hint: If you are attempting to call a logging function (e.g. `print`), you can try adding it to `torch._dynamo.config.reorderable_logging_functions`.
  Hint: Please report an issue to PyTorch.

  Developer debug context: builtin bool [<class 'torch._dynamo.variables.tensor.TensorVariable'>] False

 For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0059.html
Step 1: torchdynamo start tracing GQA_Attention_Flash_ /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:875
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:875 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7)
        @torch.compile(mode="max-autotune-no-cudagraphs")
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:904 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            B, T, C = x_in.shape
TRACE LOAD_FAST x_in []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
wrap_to_fake L['x_in'] (1, 1, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='x_in', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_x_in_ L['x_in'] FakeTensor(..., device='cuda:0', size=(1, 1, 5120), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE UNPACK_SEQUENCE 3 [SizeVariable(length=3)]
TRACE STORE_FAST B [ConstantVariable(int: 5120), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE STORE_FAST T [ConstantVariable(int: 5120), ConstantVariable(int: 1)]
TRACE STORE_FAST C [ConstantVariable(int: 5120)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:905 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            device = x_in.device
TRACE LOAD_FAST x_in []
TRACE LOAD_ATTR device [TensorVariable()]
TRACE STORE_FAST device [ConstantVariable(device: device(type='cuda', index=0))]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:906 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            Lmax = past_key_value.shape[3]
TRACE LOAD_FAST past_key_value []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
wrap_to_fake L['past_key_value'] (8, 1, 2, 8192, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='past_key_value', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}), tensor_source=LocalSource(local_name='past_key_value', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_past_key_value_ L['past_key_value'] FakeTensor(..., device='cuda:0', size=(8, 1, 2, 8192, 1024),
           dtype=torch.bfloat16) at debug_level 0 before=False
wrap_to_fake L['past_key_value']._base (8, 1, 2, 8192, 1024) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None, None, None, None], constraint_strides=[None, None, None, None, None], specialize_on=[[], [], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='past_key_value', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
TRACE LOAD_CONST 3 [SizeVariable(length=5)]
TRACE BINARY_SUBSCR None [SizeVariable(length=5), ConstantVariable(int: 3)]
TRACE STORE_FAST Lmax [ConstantVariable(int: 8192)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            starts = cache_position[:, 0].clone()
TRACE LOAD_FAST cache_position []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE LOAD_CONST None [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE BUILD_SLICE 2 [LazyVariableTracker(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE LOAD_CONST 0 [LazyVariableTracker(), SliceVariable()]
TRACE BUILD_TUPLE 2 [LazyVariableTracker(), SliceVariable(), ConstantVariable(int: 0)]
TRACE BINARY_SUBSCR None [LazyVariableTracker(), TupleVariable(length=2)]
wrap_to_fake L['cache_position'] (1, 1) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=LocalSource(local_name='cache_position', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_cache_position_ L['cache_position'] FakeTensor(..., device='cuda:0', size=(1, 1), dtype=torch.int64) at debug_level 0 before=False
TRACE FX call getitem from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        starts = cache_position[:, 0].clone()
                 ~~~~~~~~~~~~~~^^^^^^
TRACE LOAD_ATTR clone [TensorVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), clone)]
TRACE FX call clone from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        starts = cache_position[:, 0].clone()
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST starts [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:910 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            starts.clamp_(min=0, max=Lmax)
TRACE LOAD_FAST starts []
TRACE LOAD_ATTR clamp_ [TensorVariable()]
TRACE LOAD_CONST 0 [NullVariable, GetAttrVariable(TensorVariable(), clamp_)]
TRACE LOAD_FAST Lmax [NullVariable, GetAttrVariable(TensorVariable(), clamp_), ConstantVariable(int: 0)]
TRACE KW_NAMES ('min', 'max') [NullVariable, GetAttrVariable(TensorVariable(), clamp_), ConstantVariable(int: 0), ConstantVariable(int: 8192)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), clamp_), ConstantVariable(int: 0), ConstantVariable(int: 8192)]
TRACE FX call clamp_ from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:910 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        starts.clamp_(min=0, max=Lmax)
        ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:913 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            x = T5RMSNorm(x_in, ln1, rmsnorm_epsilon)  # 実装は外部
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST x_in [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln1 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:913 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        x = T5RMSNorm(x_in, ln1, rmsnorm_epsilon)  # 実装は外部
            ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE FX call add from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln1'] (5120,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln1', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln1_ L['ln1'] FakeTensor(..., device='cuda:0', size=(5120,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:915 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            HN = H * N
TRACE LOAD_FAST H []
TRACE LOAD_FAST N [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), LazyVariableTracker()]
TRACE STORE_FAST HN [ConstantVariable(int: 8192)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:918 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            qkv = fpx_matmul(x, QKV_, QKV_state, ebits, mbits)  # [B,T, QHN + KVd + KVd]
TRACE LOAD_GLOBAL fpx_matmul []
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST QKV_ [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST QKV_state [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_FAST ebits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST mbits [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call fpx_matmul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:918 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        qkv = fpx_matmul(x, QKV_, QKV_state, ebits, mbits)  # [B,T, QHN + KVd + KVd]
              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object fpx_matmul at 0x3063a810, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:420 in fpx_matmul (fpx_matmul) (inline depth: 1)
    def fpx_matmul(x,weight,weight_state,ebits:int=3,mbits:int=2):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:421 in fpx_matmul (fpx_matmul) (inline depth: 1)
        if ebits == -44: #hqq
TRACE LOAD_FAST ebits []
TRACE LOAD_CONST -44 [LazyVariableTracker()]
TRACE COMPARE_OP == [LazyVariableTracker(), ConstantVariable(int: -44)]
TRACE POP_JUMP_IF_FALSE 322 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S0=x.shape[0]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 0 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 0)]
TRACE STORE_FAST S0 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul) (inline depth: 1)
            S1=x.shape[1]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 1)]
TRACE STORE_FAST S1 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:424 in fpx_matmul (fpx_matmul) (inline depth: 1)
            dtype = x.dtype
TRACE LOAD_FAST x []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
            x = x.to(dtype=torch.float16).view(-1,x.shape[2])
TRACE LOAD_FAST x []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float16 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_2 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST x [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1)]
TRACE LOAD_ATTR shape [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3), ConstantVariable(int: 2)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), ConstantVariable(int: 5120)]
TRACE FX call view from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul) (inline depth: 1)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
            out = weight.forward_manual(x).to(dtype=dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_ATTR forward_manual [LazyVariableTracker()]
TRACE LOAD_FAST x [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE CALL 1 [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton)), TensorVariable()]
TRACE inlined call forward_manual from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:543 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        def forward_manual(self, x: Tensor, matmul_type: str="GEMM") -> Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE LOAD_GLOBAL forward_functional []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:545 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                x,
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:546 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.bias,
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR bias [NullVariable, LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_tensor_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_ATTR get_tensor_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_tensor_args at 0x70c98a9e9080>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_tensor_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_tensor_args(),
            ~~~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:524 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
        def get_tensor_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:525 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 3)
            return [self.W_q, self.scales, self.zeros]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR W_q [UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_FAST self [LazyVariableTracker()]
TRACE LOAD_ATTR scales [LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['QKV_']._parameters['scales'] (80, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='QKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='scales'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_QKV_parameters_scales_ L['QKV_']._parameters['scales'] Parameter(FakeTensor(..., device='cuda:0', size=(80, 10240), dtype=torch.float16)) at debug_level 0 before=False
TRACE LOAD_FAST self [LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR zeros [LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['QKV_']._parameters['zeros'] (80, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='QKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='zeros'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_QKV_parameters_zeros_ L['QKV_']._parameters['zeros'] Parameter(FakeTensor(..., device='cuda:0', size=(80, 10240), dtype=torch.float16)) at debug_level 0 before=False
TRACE BUILD_LIST 3 [LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [ListVariable(length=3)]
DONE INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                self.get_meta_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3)]
TRACE LOAD_ATTR get_meta_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_meta_args at 0x70c98a9e9120>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_meta_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            self.get_meta_args(),
            ~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:527 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
        def get_meta_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE LOAD_GLOBAL int []
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR scaled_activations [NullVariable, LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:529 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_nbits,
TRACE LOAD_FAST self [ConstantVariable(int: 0)]
TRACE LOAD_ATTR W_nbits [ConstantVariable(int: 0), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:530 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.group_size,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker()]
TRACE LOAD_ATTR group_size [ConstantVariable(int: 0), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:531 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.unpack_mask,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR unpack_mask [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:532 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.elements_per_sample,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR elements_per_sample [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:533 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.input_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR input_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:534 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.output_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR output_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:535 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.acc_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR acc_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:536 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.meta_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR meta_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:537 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.channel_scale_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR channel_scale_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:538 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    self.W_group_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR W_group_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:539 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
                    int(self.data_contiguous),
TRACE LOAD_GLOBAL int [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int)]
TRACE LOAD_ATTR data_contiguous [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 3)
            return [int(self.scaled_activations),
TRACE BUILD_LIST 12 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [ListVariable(length=12)]
DONE INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:549 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
                GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
TRACE LOAD_GLOBAL GEMLITE_MATMUL_TYPES_MAPPING [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12)]
TRACE LOAD_FAST matmul_type [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker(), ConstantVariable(str: 'GEMM')]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
            return forward_functional(
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 2)
        return forward_functional(
               ~~~~~~~~~~~~~~~~~~^
            x,
            ^^
            self.bias,
            ^^^^^^^^^^
            self.get_tensor_args(),
            ^^^^^^^^^^^^^^^^^^^^^^^
            self.get_meta_args(),
            ^^^^^^^^^^^^^^^^^^^^^
            GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:675 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        def __call__(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
            return self._opoverload(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR _opoverload [NullVariable, UserDefinedObjectVariable(CustomOpDef)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=5)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
wrap_to_fake L['QKV_'].W_q (640, 10240) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=AttrSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='QKV_', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='W_q'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_QKV_W_q L['QKV_'].W_q FakeTensor(..., device='cuda:0', size=(640, 10240), dtype=torch.int32) at debug_level 0 before=False
TRACE FX call forward_functional_default from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 3)
        return self._opoverload(*args, **kwargs)
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_3 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul) (inline depth: 1)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE STORE_FAST out [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
            return out.view(S0,S1,-1)
TRACE LOAD_FAST out []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST S0 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST S1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: -1)]
TRACE FX call view_1 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul) (inline depth: 1)
        return out.view(S0,S1,-1)
               ~~~~~~~~^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object fpx_matmul at 0x3063a810, file "/home/client/Projects/RWKV-Infer/rwkvengine/quantization.py", line 420>
TRACE STORE_FAST qkv [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:919 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q, k, v = qkv.split(qkv_split_list, dim=-1)
TRACE LOAD_FAST qkv []
TRACE LOAD_ATTR split [TensorVariable()]
TRACE LOAD_FAST qkv_split_list [NullVariable, GetAttrVariable(TensorVariable(), split)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker()]
TRACE KW_NAMES ('dim',) [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), split), LazyVariableTracker(), ConstantVariable(int: -1)]
TRACE FX call split from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:919 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        q, k, v = qkv.split(qkv_split_list, dim=-1)
                  ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
TRACE UNPACK_SEQUENCE 3 [TupleVariable(length=3)]
TRACE STORE_FAST q [TensorVariable(), TensorVariable(), TensorVariable()]
TRACE STORE_FAST k [TensorVariable(), TensorVariable()]
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:922 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q.add_(Q_bias)
TRACE LOAD_FAST q []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST Q_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
wrap_to_fake L['Q_bias'] () StatefulSymbolicContext(dynamic_sizes=[], dynamic_strides=[], constraint_sizes=[], constraint_strides=[], specialize_on=[], view_base_context=None, tensor_source=LocalSource(local_name='Q_bias', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_Q_bias_ L['Q_bias'] FakeTensor(..., device='cuda:0', size=(), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call add_ from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:922 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        q.add_(Q_bias)
        ~~~~~~^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:923 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k.add_(K_bias)
TRACE LOAD_FAST k []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST K_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
TRACE FX call add__1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:923 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        k.add_(K_bias)
        ~~~~~~^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:924 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            v.add_(V_bias)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR add_ [TensorVariable()]
TRACE LOAD_FAST V_bias [NullVariable, GetAttrVariable(TensorVariable(), add_)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), add_), LazyVariableTracker()]
TRACE FX call add__2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:924 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        v.add_(V_bias)
        ~~~~~~^^^^^^^^
TRACE POP_TOP None [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:927 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q = q.view(B, T, H, N)  # [B,T,H,N]
TRACE LOAD_FAST q []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST H [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 64), ConstantVariable(int: 128)]
TRACE FX call view_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:927 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        q = q.view(B, T, H, N)  # [B,T,H,N]
            ~~~~~~^^^^^^^^^^^^
TRACE STORE_FAST q [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:928 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            kv_dim_flat = k.shape[-1]     # kv_heads * N
TRACE LOAD_FAST k []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST -1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: -1)]
TRACE STORE_FAST kv_dim_flat [ConstantVariable(int: 1024)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:929 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            kv_heads = kv_dim_flat // N
TRACE LOAD_FAST kv_dim_flat []
TRACE LOAD_FAST N [ConstantVariable(int: 1024)]
TRACE BINARY_OP 2 [ConstantVariable(int: 1024), ConstantVariable(int: 128)]
TRACE STORE_FAST kv_heads [ConstantVariable(int: 8)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:930 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k = k.view(B, T, kv_heads, N) # [B,T,kv_h,N]
TRACE LOAD_FAST k []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_heads [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:930 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        k = k.view(B, T, kv_heads, N) # [B,T,kv_h,N]
            ~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:931 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            v = v.view(B, T, kv_heads, N)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_FAST kv_heads [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE LOAD_FAST N [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8)]
TRACE CALL 4 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: 8), ConstantVariable(int: 128)]
TRACE FX call view_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:931 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        v = v.view(B, T, kv_heads, N)
            ~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST v [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:934 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            if ln_r is not None:
TRACE LOAD_FAST ln_r []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 0 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
wrap_to_fake L['ln_r'] (128,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln_r', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln_r_ L['ln_r'] FakeTensor(..., device='cuda:0', size=(128,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE POP_JUMP_IF_TRUE 606 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:935 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
                q = T5RMSNorm(q, ln_r, rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln_r [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:935 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            q = T5RMSNorm(q, ln_r, rmsnorm_epsilon)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST q [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:936 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
                k = T5RMSNorm(k, ln_k, rmsnorm_epsilon)
TRACE LOAD_GLOBAL T5RMSNorm []
TRACE LOAD_FAST k [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST ln_k [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_FAST rmsnorm_epsilon [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE CALL 3 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ConstantVariable(float: 1e-06)]
TRACE inlined call T5RMSNorm from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:936 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k = T5RMSNorm(k, ln_k, rmsnorm_epsilon)
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(float: 1e-06)]
TRACE FX call add_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt_2 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_4 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['ln_k'] (128,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='ln_k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_ln_k_ L['ln_k'] FakeTensor(..., device='cuda:0', size=(128,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_7 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm) (inline depth: 1)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object T5RMSNorm at 0x70c98a4708f0, file "/home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py", line 373>
TRACE STORE_FAST k [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:940 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            k_write = k.view(B, T, -1)
TRACE LOAD_FAST k []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: -1)]
TRACE FX call view_5 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:940 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        k_write = k.view(B, T, -1)
                  ~~~~~~^^^^^^^^^^
TRACE STORE_FAST k_write [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:941 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            v_write = v.view(B, T, -1)
TRACE LOAD_FAST v []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST B [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST T [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: -1)]
TRACE FX call view_6 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:941 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        v_write = v.view(B, T, -1)
                  ~~~~~~^^^^^^^^^^
TRACE STORE_FAST v_write [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:944 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            new_lengths = starts + T
TRACE LOAD_FAST starts []
TRACE LOAD_FAST T [TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), ConstantVariable(int: 1)]
TRACE FX call add_3 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:944 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        new_lengths = starts + T
                      ~~~~~~~^~~
TRACE STORE_FAST new_lengths [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            excess_tokens = torch.clamp(new_lengths - Lmax, min=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR clamp [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST new_lengths [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST Lmax [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 10 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 8192)]
TRACE FX call sub from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        excess_tokens = torch.clamp(new_lengths - Lmax, min=0)
                                    ~~~~~~~~~~~~^~~~~~
TRACE LOAD_CONST 0 [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE KW_NAMES ('min',) [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 0)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), TensorVariable(), ConstantVariable(int: 0)]
TRACE FX call clamp from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        excess_tokens = torch.clamp(new_lengths - Lmax, min=0)
                        ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST excess_tokens [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:946 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            batches_to_evict = excess_tokens > 0
TRACE LOAD_FAST excess_tokens []
TRACE LOAD_CONST 0 [TensorVariable()]
TRACE COMPARE_OP > [TensorVariable(), ConstantVariable(int: 0)]
TRACE FX call gt from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:946 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        batches_to_evict = excess_tokens > 0
                           ^^^^^^^^^^^^^^^^^
TRACE STORE_FAST batches_to_evict [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
            if bool(batches_to_evict.any()):
TRACE LOAD_GLOBAL bool []
TRACE LOAD_FAST batches_to_evict [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR any [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), NullVariable, GetAttrVariable(TensorVariable(), any)]
TRACE FX call any_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949 in GQA_Attention_Flash_ (fused_recurrent_dplr_delta_rule_decode_t1.grid.HRWKV_7.GQA_Attention_Flash_)
        if bool(batches_to_evict.any()):
                ~~~~~~~~~~~~~~~~~~~~^^
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TensorVariable()]
COMPILING GRAPH due to GraphCompileReason(reason="Failed to trace builtin operator\n  Explanation: Dynamo does not know how to trace builtin operator `bool` with argument types ['Tensor'] (has_kwargs False)\n  Hint: Avoid calling builtin `bool` with argument types ['Tensor']. Consider using an equivalent alternative function/method to `bool`.\n  Hint: If you are attempting to call a logging function (e.g. `print`), you can try adding it to `torch._dynamo.config.reorderable_logging_functions`.\n  Hint: Please report an issue to PyTorch.\n\n  Developer debug context: builtin bool [<class 'torch._dynamo.variables.tensor.TensorVariable'>] False\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0059.html", user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py, line 949 in GQA_Attention_Flash_>], graph_break=True)
REMOVE UNUSED GRAPHARG L['past_key_value']
TRACED GRAPH
 ===== __compiled_fn_48_18139955_c254_4d27_85b8_2391461dfd5f =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, L_x_in_: "[31mbf16[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m", L_cache_position_: "[31mi64[0m[34m[1, 1][0m[2m[34m[1, 1][0m[2m[32mcuda:0[0m", L_ln1_: "[31mbf16[0m[34m[5120][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_QKV_parameters_scales_: "[31mf16[0m[34m[80, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m", L_QKV_parameters_zeros_: "[31mf16[0m[34m[80, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m", L_QKV_W_q: "[31mi32[0m[34m[640, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m", L_Q_bias_: "[31mbf16[0m[34m[][0m[2m[34m[][0m[2m[32mcuda:0[0m", L_ln_r_: "[31mbf16[0m[34m[128][0m[2m[34m[1][0m[2m[32mcuda:0[0m", L_ln_k_: "[31mbf16[0m[34m[128][0m[2m[34m[1][0m[2m[32mcuda:0[0m"):
        l_x_in_ = L_x_in_
        l_cache_position_ = L_cache_position_
        l_ln1_ = L_ln1_
        l_qkv_parameters_scales_ = L_QKV_parameters_scales_
        l_qkv_parameters_zeros_ = L_QKV_parameters_zeros_
        l_qkv_w_q = L_QKV_W_q
        l_q_bias_ = L_Q_bias_
        l_ln_r_ = L_ln_r_
        l_ln_k_ = L_ln_k_
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:909 in GQA_Attention_Flash_, code: starts = cache_position[:, 0].clone()[0m
        getitem: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = l_cache_position_[(slice([34mNone[0m, [34mNone[0m, [34mNone[0m), [34m0[0m)];  [2ml_cache_position_ = None[0m
        starts: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = getitem.clone();  [2mgetitem = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:910 in GQA_Attention_Flash_, code: starts.clamp_(min=0, max=Lmax)[0m
        clamp_: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = starts.clamp_(min = [34m0[0m, max = [34m8192[0m);  [2mclamp_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states: "[31mf32[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = l_x_in_.to([34mtorch.float32[0m);  [2ml_x_in_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_1: "[31mf32[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states.pow([34m2[0m)
        variance: "[31mf32[0m[34m[1, 1, 1][0m[2m[34m[1, 1, 1][0m[2m[32mcuda:0[0m" = pow_1.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add: "[31mf32[0m[34m[1, 1, 1][0m[2m[34m[1, 1, 1][0m[2m[32mcuda:0[0m" = variance + [34m1e-06[0m;  [2mvariance = None[0m
        rsqrt: "[31mf32[0m[34m[1, 1, 1][0m[2m[34m[1, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add);  [2madd = None[0m
        hidden_states_1: "[31mf32[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states * rsqrt;  [2mhidden_states = rsqrt = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_1: "[31mf32[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = l_ln1_ * hidden_states_1;  [2ml_ln1_ = hidden_states_1 = None[0m
        x: "[31mbf16[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = mul_1.to([34mtorch.bfloat16[0m);  [2mmul_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul, code: x = x.to(dtype=torch.float16).view(-1,x.shape[2])[0m
        to_2: "[31mf16[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = x.to(dtype = [34mtorch.float16[0m);  [2mx = None[0m
        x_1: "[31mf16[0m[34m[1, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m" = to_2.view([34m-1[0m, [34m5120[0m);  [2mto_2 = None[0m
        
         [2m# File: /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__, code: return self._opoverload(*args, **kwargs)[0m
        forward_functional_default: "[31mf16[0m[34m[1, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m" = torch.ops.gemlite.forward_functional.default(x_1, [34mNone[0m, [l_qkv_w_q, l_qkv_parameters_scales_, l_qkv_parameters_zeros_], [[34m0[0m, [34m4[0m, [34m64[0m, [34m15[0m, [34m8[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m0[0m, [34m4[0m, [34m1[0m], [34m4[0m);  [2mx_1 = l_qkv_w_q = l_qkv_parameters_scales_ = l_qkv_parameters_zeros_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul, code: out = weight.forward_manual(x).to(dtype=dtype)[0m
        out: "[31mbf16[0m[34m[1, 10240][0m[2m[34m[10240, 1][0m[2m[32mcuda:0[0m" = forward_functional_default.to(dtype = [34mtorch.bfloat16[0m);  [2mforward_functional_default = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul, code: return out.view(S0,S1,-1)[0m
        qkv: "[31mbf16[0m[34m[1, 1, 10240][0m[2m[34m[10240, 10240, 1][0m[2m[32mcuda:0[0m" = out.view([34m1[0m, [34m1[0m, [34m-1[0m);  [2mout = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:919 in GQA_Attention_Flash_, code: q, k, v = qkv.split(qkv_split_list, dim=-1)[0m
        split = qkv.split([[34m8192[0m, [34m1024[0m, [34m1024[0m], dim = [34m-1[0m);  [2mqkv = None[0m
        q: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[10240, 10240, 1][0m[2m[32mcuda:0[0m" = split[[34m0[0m]
        k: "[31mbf16[0m[34m[1, 1, 1024][0m[2m[34m[10240, 10240, 1][0m[2m[32mcuda:0[0m" = split[[34m1[0m]
        v: "[31mbf16[0m[34m[1, 1, 1024][0m[2m[34m[10240, 10240, 1][0m[2m[32mcuda:0[0m" = split[[34m2[0m];  [2msplit = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:922 in GQA_Attention_Flash_, code: q.add_(Q_bias)[0m
        add_: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[10240, 10240, 1][0m[2m[32mcuda:0[0m" = q.add_(l_q_bias_);  [2madd_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:923 in GQA_Attention_Flash_, code: k.add_(K_bias)[0m
        add__1: "[31mbf16[0m[34m[1, 1, 1024][0m[2m[34m[10240, 10240, 1][0m[2m[32mcuda:0[0m" = k.add_(l_q_bias_);  [2madd__1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:924 in GQA_Attention_Flash_, code: v.add_(V_bias)[0m
        add__2: "[31mbf16[0m[34m[1, 1, 1024][0m[2m[34m[10240, 10240, 1][0m[2m[32mcuda:0[0m" = v.add_(l_q_bias_);  [2ml_q_bias_ = add__2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:927 in GQA_Attention_Flash_, code: q = q.view(B, T, H, N)  # [B,T,H,N][0m
        q_1: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[10240, 10240, 128, 1][0m[2m[32mcuda:0[0m" = q.view([34m1[0m, [34m1[0m, [34m64[0m, [34m128[0m);  [2mq = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:930 in GQA_Attention_Flash_, code: k = k.view(B, T, kv_heads, N) # [B,T,kv_h,N][0m
        k_1: "[31mbf16[0m[34m[1, 1, 8, 128][0m[2m[34m[10240, 10240, 128, 1][0m[2m[32mcuda:0[0m" = k.view([34m1[0m, [34m1[0m, [34m8[0m, [34m128[0m);  [2mk = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:931 in GQA_Attention_Flash_, code: v = v.view(B, T, kv_heads, N)[0m
        v_1: "[31mbf16[0m[34m[1, 1, 8, 128][0m[2m[34m[10240, 10240, 128, 1][0m[2m[32mcuda:0[0m" = v.view([34m1[0m, [34m1[0m, [34m8[0m, [34m128[0m);  [2mv = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states_2: "[31mf32[0m[34m[1, 1, 64, 128][0m[2m[34m[10240, 10240, 128, 1][0m[2m[32mcuda:0[0m" = q_1.to([34mtorch.float32[0m);  [2mq_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_2: "[31mf32[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_2.pow([34m2[0m)
        variance_1: "[31mf32[0m[34m[1, 1, 64, 1][0m[2m[34m[64, 64, 1, 1][0m[2m[32mcuda:0[0m" = pow_2.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add_1: "[31mf32[0m[34m[1, 1, 64, 1][0m[2m[34m[64, 64, 1, 1][0m[2m[32mcuda:0[0m" = variance_1 + [34m1e-06[0m;  [2mvariance_1 = None[0m
        rsqrt_1: "[31mf32[0m[34m[1, 1, 64, 1][0m[2m[34m[64, 64, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add_1);  [2madd_1 = None[0m
        hidden_states_3: "[31mf32[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_2 * rsqrt_1;  [2mhidden_states_2 = rsqrt_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_3: "[31mf32[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = l_ln_r_ * hidden_states_3;  [2ml_ln_r_ = hidden_states_3 = None[0m
        q_2: "[31mbf16[0m[34m[1, 1, 64, 128][0m[2m[34m[8192, 8192, 128, 1][0m[2m[32mcuda:0[0m" = mul_3.to([34mtorch.bfloat16[0m);  [2mmul_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states_4: "[31mf32[0m[34m[1, 1, 8, 128][0m[2m[34m[10240, 10240, 128, 1][0m[2m[32mcuda:0[0m" = k_1.to([34mtorch.float32[0m);  [2mk_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_3: "[31mf32[0m[34m[1, 1, 8, 128][0m[2m[34m[1024, 1024, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_4.pow([34m2[0m)
        variance_2: "[31mf32[0m[34m[1, 1, 8, 1][0m[2m[34m[8, 8, 1, 1][0m[2m[32mcuda:0[0m" = pow_3.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_3 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add_2: "[31mf32[0m[34m[1, 1, 8, 1][0m[2m[34m[8, 8, 1, 1][0m[2m[32mcuda:0[0m" = variance_2 + [34m1e-06[0m;  [2mvariance_2 = None[0m
        rsqrt_2: "[31mf32[0m[34m[1, 1, 8, 1][0m[2m[34m[8, 8, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add_2);  [2madd_2 = None[0m
        hidden_states_5: "[31mf32[0m[34m[1, 1, 8, 128][0m[2m[34m[1024, 1024, 128, 1][0m[2m[32mcuda:0[0m" = hidden_states_4 * rsqrt_2;  [2mhidden_states_4 = rsqrt_2 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_5: "[31mf32[0m[34m[1, 1, 8, 128][0m[2m[34m[1024, 1024, 128, 1][0m[2m[32mcuda:0[0m" = l_ln_k_ * hidden_states_5;  [2ml_ln_k_ = hidden_states_5 = None[0m
        k_2: "[31mbf16[0m[34m[1, 1, 8, 128][0m[2m[34m[1024, 1024, 128, 1][0m[2m[32mcuda:0[0m" = mul_5.to([34mtorch.bfloat16[0m);  [2mmul_5 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:940 in GQA_Attention_Flash_, code: k_write = k.view(B, T, -1)[0m
        k_write: "[31mbf16[0m[34m[1, 1, 1024][0m[2m[34m[1024, 1024, 1][0m[2m[32mcuda:0[0m" = k_2.view([34m1[0m, [34m1[0m, [34m-1[0m)
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:941 in GQA_Attention_Flash_, code: v_write = v.view(B, T, -1)[0m
        v_write: "[31mbf16[0m[34m[1, 1, 1024][0m[2m[34m[10240, 10240, 1][0m[2m[32mcuda:0[0m" = v_1.view([34m1[0m, [34m1[0m, [34m-1[0m)
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:944 in GQA_Attention_Flash_, code: new_lengths = starts + T[0m
        new_lengths: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = starts + [34m1[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:945 in GQA_Attention_Flash_, code: excess_tokens = torch.clamp(new_lengths - Lmax, min=0)[0m
        sub: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = new_lengths - [34m8192[0m;  [2mnew_lengths = None[0m
        excess_tokens: "[31mi64[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = torch.clamp(sub, min = [34m0[0m);  [2msub = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:946 in GQA_Attention_Flash_, code: batches_to_evict = excess_tokens > 0[0m
        batches_to_evict: "[31mb8[0m[34m[1][0m[2m[34m[1][0m[2m[32mcuda:0[0m" = excess_tokens > [34m0[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:949 in GQA_Attention_Flash_, code: if bool(batches_to_evict.any()):[0m
        any_1: "[31mb8[0m[34m[][0m[2m[34m[][0m[2m[32mcuda:0[0m" = batches_to_evict.any()
        return (any_1, starts, q_2, k_2, v_1, k_write, v_write, excess_tokens, batches_to_evict)
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing forward /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:831
TRACE MAKE_CELL max_seqlens_q []
TRACE MAKE_CELL batch []
TRACE MAKE_CELL nheads_q []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:831 in forward (_attention)
        @staticmethod
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:848 in forward (_attention.forward)
            use_fp8 = False
TRACE LOAD_CONST False []
TRACE STORE_FAST use_fp8 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:849 in forward (_attention.forward)
            fp8_out_scale=None
TRACE LOAD_CONST None []
TRACE STORE_FAST fp8_out_scale [ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:850 in forward (_attention.forward)
            fp8_scales=None
TRACE LOAD_CONST None []
TRACE STORE_FAST fp8_scales [ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:851 in forward (_attention.forward)
            q_scale = k_scale = v_scale = p_scale = 1.0
TRACE LOAD_CONST 1.0 []
TRACE COPY 1 [ConstantVariable(float: 1.0)]
TRACE STORE_FAST q_scale [ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE COPY 1 [ConstantVariable(float: 1.0)]
TRACE STORE_FAST k_scale [ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE COPY 1 [ConstantVariable(float: 1.0)]
TRACE STORE_FAST v_scale [ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE STORE_FAST p_scale [ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:853 in forward (_attention.forward)
            if o is None:
TRACE LOAD_FAST o []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
wrap_to_fake L['o'] (1, 64, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='o', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_o_ L['o'] FakeTensor(..., device='cuda:0', size=(1, 64, 128), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE POP_JUMP_IF_TRUE 110 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:865 in forward (_attention.forward)
            if True:  # varlen
TRACE NOP None []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:866 in forward (_attention.forward)
                total_q, nheads_q, head_size = q.shape
TRACE LOAD_FAST q []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
automatic dynamic stride L['q']._base stride(0) InferStride(dim=2) != InferStride(dim=1)
wrap_to_fake L['q'] (1, 64, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None, None], specialize_on=[[], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='q', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}), tensor_source=LocalSource(local_name='q', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_q_ L['q'] FakeTensor(..., device='cuda:0', size=(1, 64, 128), dtype=torch.bfloat16) at debug_level 0 before=False
wrap_to_fake L['q']._base (1, 1, 64, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None, None], specialize_on=[[], [], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='q', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
TRACE UNPACK_SEQUENCE 3 [SizeVariable(length=3)]
TRACE STORE_FAST total_q [ConstantVariable(int: 128), ConstantVariable(int: 64), ConstantVariable(int: 1)]
TRACE STORE_DEREF nheads_q [ConstantVariable(int: 128), ConstantVariable(int: 64)]
TRACE STORE_FAST head_size [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:867 in forward (_attention.forward)
                total_k, nheads_k, _ = k.shape
TRACE LOAD_FAST k []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
wrap_to_fake L['k'] (1223, 8, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_k_ L['k'] FakeTensor(..., device='cuda:0', size=(s37, 8, 128), dtype=torch.bfloat16) at debug_level 0 before=False
create_graph_input s37 L['k'].size()[0] s37 at debug_level 0 before=True
_lift_symbols_in_symint s37 from L['k'].size()[0] at debug_level 0
TRACE FX call size from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:867 in forward (_attention.forward)
            total_k, nheads_k, _ = k.shape
                                   ^^^^^^^
TRACE UNPACK_SEQUENCE 3 [SizeVariable(length=3)]
TRACE STORE_FAST total_k [ConstantVariable(int: 128), ConstantVariable(int: 8), SymNodeVariable()]
TRACE STORE_FAST nheads_k [ConstantVariable(int: 128), ConstantVariable(int: 8)]
TRACE STORE_FAST _ [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:868 in forward (_attention.forward)
                batch = len(cu_seqlens_q) - 1
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST cu_seqlens_q [NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
wrap_to_fake L['cu_seqlens_q'] (2,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='cu_seqlens_q', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_cu_seqlens_q_ L['cu_seqlens_q'] FakeTensor(..., device='cuda:0', size=(2,), dtype=torch.int32) at debug_level 0 before=False
TRACE LOAD_CONST 1 [ConstantVariable(int: 2)]
TRACE BINARY_OP 10 [ConstantVariable(int: 2), ConstantVariable(int: 1)]
TRACE STORE_DEREF batch [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:869 in forward (_attention.forward)
                q_strides = (0, q.stride(1), q.stride(0), q.stride(2))
TRACE LOAD_CONST 0 []
TRACE LOAD_FAST q [ConstantVariable(int: 0)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), TensorVariable()]
TRACE LOAD_CONST 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 1)]
TRACE LOAD_FAST q [ConstantVariable(int: 0), ConstantVariable(int: 128)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 0)]
TRACE LOAD_FAST q [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), TensorVariable()]
TRACE LOAD_CONST 2 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 2)]
TRACE BUILD_TUPLE 4 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), ConstantVariable(int: 1)]
TRACE STORE_FAST q_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:870 in forward (_attention.forward)
                k_strides = (0, k.stride(1), k.stride(0), k.stride(2))
TRACE LOAD_CONST 0 []
TRACE LOAD_FAST k [ConstantVariable(int: 0)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), TensorVariable()]
TRACE LOAD_CONST 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 1)]
TRACE LOAD_FAST k [ConstantVariable(int: 0), ConstantVariable(int: 128)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 0)]
TRACE LOAD_FAST k [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), TensorVariable()]
TRACE LOAD_CONST 2 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 2)]
TRACE BUILD_TUPLE 4 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), ConstantVariable(int: 1)]
TRACE STORE_FAST k_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:871 in forward (_attention.forward)
                v_strides = (0, v.stride(1), v.stride(0), v.stride(2))
TRACE LOAD_CONST 0 []
TRACE LOAD_FAST v [ConstantVariable(int: 0)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), LazyVariableTracker()]
wrap_to_fake L['v'] (1223, 8, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='v', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_v_ L['v'] FakeTensor(..., device='cuda:0', size=(s33, 8, 128), dtype=torch.bfloat16) at debug_level 0 before=False
create_graph_input s33 L['v'].size()[0] s33 at debug_level 0 before=True
_lift_symbols_in_symint s33 from L['v'].size()[0] at debug_level 0
TRACE LOAD_CONST 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 1)]
TRACE LOAD_FAST v [ConstantVariable(int: 0), ConstantVariable(int: 128)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 0)]
TRACE LOAD_FAST v [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), TensorVariable()]
TRACE LOAD_CONST 2 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 2)]
TRACE BUILD_TUPLE 4 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 1024), ConstantVariable(int: 1)]
TRACE STORE_FAST v_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:872 in forward (_attention.forward)
                o_strides = (0, o.stride(1), o.stride(0), o.stride(2))
TRACE LOAD_CONST 0 []
TRACE LOAD_FAST o [ConstantVariable(int: 0)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), TensorVariable()]
TRACE LOAD_CONST 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 1)]
TRACE LOAD_FAST o [ConstantVariable(int: 0), ConstantVariable(int: 128)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 0)]
TRACE LOAD_FAST o [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192)]
TRACE LOAD_ATTR stride [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), TensorVariable()]
TRACE LOAD_CONST 2 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), NullVariable, GetAttrVariable(TensorVariable(), stride)]
TRACE CALL 1 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), NullVariable, GetAttrVariable(TensorVariable(), stride), ConstantVariable(int: 2)]
TRACE BUILD_TUPLE 4 [ConstantVariable(int: 0), ConstantVariable(int: 128), ConstantVariable(int: 8192), ConstantVariable(int: 1)]
TRACE STORE_FAST o_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:882 in forward (_attention.forward)
            unpadded_head_dims = {32, 64, 128, 256}
TRACE BUILD_SET 0 []
TRACE LOAD_CONST frozenset({256, 32, 64, 128}) [SetVariable()]
TRACE SET_UPDATE 1 [SetVariable(), FrozensetVariable()]
TRACE inlined call set_update from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:882 in forward (_attention.forward)
        unpadded_head_dims = {32, 64, 128, 256}
                             ^^^^^^^^^^^^^^^^^^
INLINING <code object set_update at 0x70c9a06d2630, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 210>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:210 in set_update (set_update) (inline depth: 1)
    def set_update(set1, *others):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:211 in set_update (set_update) (inline depth: 1)
        if len(others) == 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST others [NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=1)]
TRACE LOAD_CONST 0 [ConstantVariable(int: 1)]
TRACE COMPARE_OP == [ConstantVariable(int: 1), ConstantVariable(int: 0)]
TRACE POP_JUMP_IF_FALSE 34 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:214 in set_update (set_update) (inline depth: 1)
        for set2 in others:
TRACE LOAD_FAST others []
TRACE GET_ITER None [TupleVariable(length=1)]
TRACE FOR_ITER 104 [ListIteratorVariable(length=1, index=0)]
TRACE STORE_FAST set2 [ListIteratorVariable(length=1, index=1), FrozensetVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE LOAD_FAST set2 [ListIteratorVariable(length=1, index=1)]
TRACE GET_ITER None [ListIteratorVariable(length=1, index=1), FrozensetVariable()]
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=0)]
TRACE STORE_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(int: 256)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:216 in set_update (set_update) (inline depth: 1)
                if x not in set1:
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1)]
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(int: 256)]
TRACE CONTAINS_OP 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(int: 256), SetVariable()]
TRACE POP_JUMP_IF_TRUE 64 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:217 in set_update (set_update) (inline depth: 1)
                    set1.add(x)
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1)]
TRACE LOAD_ATTR add [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), SetVariable()]
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), NullVariable, GetAttrVariable(SetVariable(), add)]
TRACE CALL 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), NullVariable, GetAttrVariable(SetVariable(), add), ConstantVariable(int: 256)]
TRACE POP_TOP None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 48 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=1)]
TRACE STORE_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(int: 32)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:216 in set_update (set_update) (inline depth: 1)
                if x not in set1:
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2)]
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(int: 32)]
TRACE CONTAINS_OP 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(int: 32), SetVariable()]
TRACE POP_JUMP_IF_TRUE 64 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:217 in set_update (set_update) (inline depth: 1)
                    set1.add(x)
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2)]
TRACE LOAD_ATTR add [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), SetVariable()]
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), NullVariable, GetAttrVariable(SetVariable(), add)]
TRACE CALL 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), NullVariable, GetAttrVariable(SetVariable(), add), ConstantVariable(int: 32)]
TRACE POP_TOP None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 48 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=2)]
TRACE STORE_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(int: 64)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:216 in set_update (set_update) (inline depth: 1)
                if x not in set1:
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3)]
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(int: 64)]
TRACE CONTAINS_OP 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(int: 64), SetVariable()]
TRACE POP_JUMP_IF_TRUE 64 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:217 in set_update (set_update) (inline depth: 1)
                    set1.add(x)
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3)]
TRACE LOAD_ATTR add [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), SetVariable()]
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), NullVariable, GetAttrVariable(SetVariable(), add)]
TRACE CALL 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), NullVariable, GetAttrVariable(SetVariable(), add), ConstantVariable(int: 64)]
TRACE POP_TOP None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 48 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=3)]
TRACE STORE_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(int: 128)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:216 in set_update (set_update) (inline depth: 1)
                if x not in set1:
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4)]
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(int: 128)]
TRACE CONTAINS_OP 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(int: 128), SetVariable()]
TRACE POP_JUMP_IF_TRUE 64 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(bool: True)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:217 in set_update (set_update) (inline depth: 1)
                    set1.add(x)
TRACE LOAD_FAST set1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4)]
TRACE LOAD_ATTR add [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), SetVariable()]
TRACE LOAD_FAST x [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), NullVariable, GetAttrVariable(SetVariable(), add)]
TRACE CALL 1 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), NullVariable, GetAttrVariable(SetVariable(), add), ConstantVariable(int: 128)]
TRACE POP_TOP None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 48 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:215 in set_update (set_update) (inline depth: 1)
            for x in set2:
TRACE FOR_ITER 100 [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4)]
TRACE END_FOR None [ListIteratorVariable(length=1, index=1), ListIteratorVariable(length=4, index=4), ConstantVariable(NoneType: None)]
TRACE JUMP_BACKWARD 38 [ListIteratorVariable(length=1, index=1)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py:214 in set_update (set_update) (inline depth: 1)
        for set2 in others:
TRACE FOR_ITER 104 [ListIteratorVariable(length=1, index=1)]
TRACE END_FOR None [ListIteratorVariable(length=1, index=1), ConstantVariable(NoneType: None)]
TRACE RETURN_CONST None []
DONE INLINING <code object set_update at 0x70c9a06d2630, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_dynamo/polyfills/__init__.py", line 210>
TRACE STORE_FAST unpadded_head_dims [SetVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:883 in forward (_attention.forward)
            if head_size not in unpadded_head_dims:
TRACE LOAD_FAST head_size []
TRACE LOAD_FAST unpadded_head_dims [ConstantVariable(int: 128)]
TRACE CONTAINS_OP 1 [ConstantVariable(int: 128), SetVariable()]
TRACE POP_JUMP_IF_FALSE 676 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:891 in forward (_attention.forward)
                padded_d_model = head_size
TRACE LOAD_FAST head_size []
TRACE STORE_FAST padded_d_model [ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in forward (_attention.forward)
            grid = lambda META: (
TRACE LOAD_CLOSURE batch []
TRACE LOAD_CLOSURE max_seqlens_q [CellVariable()]
TRACE LOAD_CLOSURE nheads_q [CellVariable(), CellVariable()]
TRACE BUILD_TUPLE 3 [CellVariable(), CellVariable(), CellVariable()]
TRACE LOAD_CONST <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893> [TupleVariable(length=3)]
TRACE MAKE_FUNCTION 8 [TupleVariable(length=3), ConstantVariable(code: <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>)]
TRACE STORE_FAST grid [NestedUserFunctionVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:899 in forward (_attention.forward)
            encoded_softmax = None
TRACE LOAD_CONST None []
TRACE STORE_FAST encoded_softmax [ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:902 in forward (_attention.forward)
            philox_seed = 0x1BF52
TRACE LOAD_CONST 114514 []
TRACE STORE_FAST philox_seed [ConstantVariable(int: 114514)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:903 in forward (_attention.forward)
            philox_offset = 0x1D4B42
TRACE LOAD_CONST 1919810 []
TRACE STORE_FAST philox_offset [ConstantVariable(int: 1919810)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:905 in forward (_attention.forward)
            if bias is not None:
TRACE LOAD_FAST bias []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 0 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 848 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:913 in forward (_attention.forward)
                bias_strides = (0, 0, 0, 0)
TRACE LOAD_CONST (0, 0, 0, 0) []
TRACE STORE_FAST bias_strides [TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:915 in forward (_attention.forward)
            p_descale = 1.0 / p_scale
TRACE LOAD_CONST 1.0 []
TRACE LOAD_FAST p_scale [ConstantVariable(float: 1.0)]
TRACE BINARY_OP 11 [ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE STORE_FAST p_descale [ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:917 in forward (_attention.forward)
            ) if fp8_out_scale is not None else 1.0
TRACE LOAD_FAST fp8_out_scale []
TRACE LOAD_CONST None [ConstantVariable(NoneType: None)]
TRACE IS_OP 0 [ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 908 [ConstantVariable(bool: True)]
TRACE LOAD_CONST 1.0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:916 in forward (_attention.forward)
            o_descale = 1.0 / fp8_out_scale.item(
TRACE STORE_FAST o_descale [ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:919 in forward (_attention.forward)
            arg_max_seqlens_q = 0 if on_gfx1x() else max_seqlens_q
TRACE LOAD_GLOBAL on_gfx1x []
TRACE CALL 0 [NullVariable, LazyVariableTracker()]
TRACE inlined call on_gfx1x from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:919 in forward (_attention.forward)
        arg_max_seqlens_q = 0 if on_gfx1x() else max_seqlens_q
                                 ~~~~~~~~^^
INLINING <code object on_gfx1x at 0x70c98a3392e0, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 35>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:35 in on_gfx1x (on_gfx1x) (inline depth: 1)
    def on_gfx1x():
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:36 in on_gfx1x (on_gfx1x) (inline depth: 1)
        return True
TRACE RETURN_CONST True []
DONE INLINING <code object on_gfx1x at 0x70c98a3392e0, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 35>
TRACE POP_JUMP_IF_FALSE 936 [ConstantVariable(bool: True)]
TRACE LOAD_CONST 0 []
TRACE JUMP_FORWARD 938 [ConstantVariable(int: 0)]
TRACE STORE_FAST arg_max_seqlens_q [ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:920 in forward (_attention.forward)
            arg_max_seqlens_k = 0 if on_gfx1x() else max_seqlens_k
TRACE LOAD_GLOBAL on_gfx1x []
TRACE CALL 0 [NullVariable, LazyVariableTracker()]
TRACE inlined call on_gfx1x from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:920 in forward (_attention.forward)
        arg_max_seqlens_k = 0 if on_gfx1x() else max_seqlens_k
                                 ~~~~~~~~^^
INLINING <code object on_gfx1x at 0x70c98a3392e0, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 35>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:35 in on_gfx1x (on_gfx1x) (inline depth: 1)
    def on_gfx1x():
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:36 in on_gfx1x (on_gfx1x) (inline depth: 1)
        return True
TRACE RETURN_CONST True []
DONE INLINING <code object on_gfx1x at 0x70c98a3392e0, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 35>
TRACE POP_JUMP_IF_FALSE 964 [ConstantVariable(bool: True)]
TRACE LOAD_CONST 0 []
TRACE JUMP_FORWARD 966 [ConstantVariable(int: 0)]
TRACE STORE_FAST arg_max_seqlens_k [ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_GLOBAL attn_fwd []
TRACE LOAD_FAST grid [NullVariable, LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), NestedUserFunctionVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:923 in forward (_attention.forward)
                q,
TRACE LOAD_FAST q [NullVariable, TritonKernelVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:924 in forward (_attention.forward)
                k,
TRACE LOAD_FAST k [NullVariable, TritonKernelVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:925 in forward (_attention.forward)
                v,
TRACE LOAD_FAST v [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:926 in forward (_attention.forward)
                bias,
TRACE LOAD_FAST bias [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:927 in forward (_attention.forward)
                sm_scale,
TRACE LOAD_FAST sm_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:928 in forward (_attention.forward)
                q_scale,
TRACE LOAD_FAST q_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:929 in forward (_attention.forward)
                k_scale,
TRACE LOAD_FAST k_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:930 in forward (_attention.forward)
                v_scale,
TRACE LOAD_FAST v_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:931 in forward (_attention.forward)
                p_scale,
TRACE LOAD_FAST p_scale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:932 in forward (_attention.forward)
                p_descale,
TRACE LOAD_FAST p_descale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:933 in forward (_attention.forward)
                o_descale,
TRACE LOAD_FAST o_descale [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:934 in forward (_attention.forward)
                None,
TRACE LOAD_CONST None [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:935 in forward (_attention.forward)
                o,
TRACE LOAD_FAST o [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE BUILD_LIST 13 [NullVariable, TritonKernelVariable(), TensorVariable(), TensorVariable(), TensorVariable(), ConstantVariable(NoneType: None), LazyVariableTracker(), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(float: 1.0), ConstantVariable(NoneType: None), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:936 in forward (_attention.forward)
                *q_strides,
TRACE LOAD_FAST q_strides [NullVariable, TritonKernelVariable(), ListVariable(length=13)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=13), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:937 in forward (_attention.forward)
                *k_strides,
TRACE LOAD_FAST k_strides [NullVariable, TritonKernelVariable(), ListVariable(length=17)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=17), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:938 in forward (_attention.forward)
                *v_strides,
TRACE LOAD_FAST v_strides [NullVariable, TritonKernelVariable(), ListVariable(length=21)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=21), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:939 in forward (_attention.forward)
                *o_strides,
TRACE LOAD_FAST o_strides [NullVariable, TritonKernelVariable(), ListVariable(length=25)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=25), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:940 in forward (_attention.forward)
                *bias_strides,
TRACE LOAD_FAST bias_strides [NullVariable, TritonKernelVariable(), ListVariable(length=29)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_EXTEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=29), TupleVariable(length=4)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:941 in forward (_attention.forward)
                cu_seqlens_q,
TRACE LOAD_FAST cu_seqlens_q [NullVariable, TritonKernelVariable(), ListVariable(length=33)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_APPEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=33), TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:942 in forward (_attention.forward)
                cu_seqlens_k,
TRACE LOAD_FAST cu_seqlens_k [NullVariable, TritonKernelVariable(), ListVariable(length=34)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LIST_APPEND 1 [NullVariable, TritonKernelVariable(), ListVariable(length=34), LazyVariableTracker()]
TRACE CALL_INTRINSIC_1 6 [NullVariable, TritonKernelVariable(), ListVariable(length=35)]
TRACE BUILD_MAP 0 [NullVariable, TritonKernelVariable(), TupleVariable(length=35)]
TRACE LOAD_CONST dropout_p [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:943 in forward (_attention.forward)
                dropout_p=0.0,
TRACE LOAD_CONST 0.0 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'dropout_p')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'dropout_p'), ConstantVariable(float: 0.0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST philox_seed [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:944 in forward (_attention.forward)
                philox_seed=philox_seed,
TRACE LOAD_FAST philox_seed [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'philox_seed')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'philox_seed'), ConstantVariable(int: 114514)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST philox_offset_base [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:945 in forward (_attention.forward)
                philox_offset_base=philox_offset,
TRACE LOAD_FAST philox_offset [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'philox_offset_base')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'philox_offset_base'), ConstantVariable(int: 1919810)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST encoded_softmax [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:946 in forward (_attention.forward)
                encoded_softmax=encoded_softmax,
TRACE LOAD_FAST encoded_softmax [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'encoded_softmax')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'encoded_softmax'), ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST HQ [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:947 in forward (_attention.forward)
                HQ=nheads_q,
TRACE LOAD_DEREF nheads_q [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'HQ')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'HQ'), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST HK [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:948 in forward (_attention.forward)
                HK=nheads_k,
TRACE LOAD_FAST nheads_k [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'HK')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'HK'), ConstantVariable(int: 8)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST ACTUAL_BLOCK_DMODEL [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:949 in forward (_attention.forward)
                ACTUAL_BLOCK_DMODEL=head_size,
TRACE LOAD_FAST head_size [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'ACTUAL_BLOCK_DMODEL')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'ACTUAL_BLOCK_DMODEL'), ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST MAX_SEQLENS_Q [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:950 in forward (_attention.forward)
                MAX_SEQLENS_Q=arg_max_seqlens_q,
TRACE LOAD_FAST arg_max_seqlens_q [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'MAX_SEQLENS_Q')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'MAX_SEQLENS_Q'), ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST MAX_SEQLENS_K [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:951 in forward (_attention.forward)
                MAX_SEQLENS_K=arg_max_seqlens_k,
TRACE LOAD_FAST arg_max_seqlens_k [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'MAX_SEQLENS_K')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'MAX_SEQLENS_K'), ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST IS_CAUSAL [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:952 in forward (_attention.forward)
                IS_CAUSAL=causal,
TRACE LOAD_FAST causal [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'IS_CAUSAL')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'IS_CAUSAL'), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST VARLEN [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:953 in forward (_attention.forward)
                VARLEN=True,
TRACE LOAD_CONST True [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'VARLEN')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'VARLEN'), ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST BLOCK_DMODEL [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:954 in forward (_attention.forward)
                BLOCK_DMODEL=padded_d_model,
TRACE LOAD_FAST padded_d_model [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BLOCK_DMODEL')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BLOCK_DMODEL'), ConstantVariable(int: 128)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST BIAS_TYPE [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:955 in forward (_attention.forward)
                BIAS_TYPE=0 if bias is None else 1,
TRACE LOAD_FAST bias [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE')]
TRACE LOAD_CONST None [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(NoneType: None)]
TRACE IS_OP 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 1130 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(bool: False)]
TRACE LOAD_CONST 0 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE')]
TRACE JUMP_FORWARD 1132 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(int: 0)]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'BIAS_TYPE'), ConstantVariable(int: 0)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST ENABLE_DROPOUT [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:956 in forward (_attention.forward)
                ENABLE_DROPOUT=False,
TRACE LOAD_CONST False [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'ENABLE_DROPOUT')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'ENABLE_DROPOUT'), ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST RETURN_ENCODED_SOFTMAX [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:957 in forward (_attention.forward)
                RETURN_ENCODED_SOFTMAX=False,
TRACE LOAD_CONST False [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'RETURN_ENCODED_SOFTMAX')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'RETURN_ENCODED_SOFTMAX'), ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST USE_FP8 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:958 in forward (_attention.forward)
                USE_FP8=use_fp8,
TRACE LOAD_FAST use_fp8 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8')]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8'), ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE LOAD_CONST USE_FP8_OUT [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:959 in forward (_attention.forward)
                USE_FP8_OUT=fp8_out_scale is not None,
TRACE LOAD_FAST fp8_out_scale [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8_OUT')]
TRACE LOAD_CONST None [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8_OUT'), ConstantVariable(NoneType: None)]
TRACE IS_OP 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8_OUT'), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]
TRACE MAP_ADD 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable(), ConstantVariable(str: 'USE_FP8_OUT'), ConstantVariable(bool: False)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
            attn_fwd[grid](
TRACE CALL_FUNCTION_EX 1 [NullVariable, TritonKernelVariable(), TupleVariable(length=35), ConstDictVariable()]
TRACE inlined call <lambda> from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
                triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF max_seqlens_q [NullVariable, LazyVariableTracker()]
create_graph_input L_max_seqlens_q_ L['max_seqlens_q'] s30 at debug_level 0 before=False
TRACE LOAD_FAST META [NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE LOAD_CONST BLOCK_M [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstDictVariable(), ConstantVariable(str: 'BLOCK_M')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
            triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
            ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), SymNodeVariable()]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), SymNodeVariable()]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 3)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [SymNodeVariable()]
TRACE BINARY_OP 0 [SymNodeVariable(), ConstantVariable(int: 32)]
TRACE FX call add from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
            ~~^~~
TRACE LOAD_CONST 1 [SymNodeVariable()]
TRACE BINARY_OP 10 [SymNodeVariable(), ConstantVariable(int: 1)]
TRACE FX call sub from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
            ~~~~~~^~~
TRACE LOAD_FAST y [SymNodeVariable()]
TRACE BINARY_OP 2 [SymNodeVariable(), ConstantVariable(int: 32)]
TRACE FX call floordiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
           ~~~~~~~~~~~~^^~~
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [SymNodeVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:895 in <lambda> (_attention.forward) (inline depth: 1)
                nheads_q,
TRACE LOAD_DEREF nheads_q [SymNodeVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:896 in <lambda> (_attention.forward) (inline depth: 1)
                batch,
TRACE LOAD_DEREF batch [SymNodeVariable(), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE BUILD_TUPLE 3 [SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [TupleVariable(length=3)]
DONE INLINING <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>
TRACE inlined call <lambda> from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
                triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF max_seqlens_q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST META [NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE LOAD_CONST BLOCK_M [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstDictVariable(), ConstantVariable(str: 'BLOCK_M')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
            triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
            ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), SymNodeVariable()]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), SymNodeVariable()]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 3)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [SymNodeVariable()]
TRACE BINARY_OP 0 [SymNodeVariable(), ConstantVariable(int: 32)]
TRACE FX call add_1 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
            ~~^~~
TRACE LOAD_CONST 1 [SymNodeVariable()]
TRACE BINARY_OP 10 [SymNodeVariable(), ConstantVariable(int: 1)]
TRACE FX call sub_1 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
            ~~~~~~^~~
TRACE LOAD_FAST y [SymNodeVariable()]
TRACE BINARY_OP 2 [SymNodeVariable(), ConstantVariable(int: 32)]
TRACE FX call floordiv_1 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
           ~~~~~~~~~~~~^^~~
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [SymNodeVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:895 in <lambda> (_attention.forward) (inline depth: 1)
                nheads_q,
TRACE LOAD_DEREF nheads_q [SymNodeVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:896 in <lambda> (_attention.forward) (inline depth: 1)
                batch,
TRACE LOAD_DEREF batch [SymNodeVariable(), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE BUILD_TUPLE 3 [SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [TupleVariable(length=3)]
DONE INLINING <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>
TRACE inlined call <lambda> from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
                triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF max_seqlens_q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST META [NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE LOAD_CONST BLOCK_M [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstDictVariable(), ConstantVariable(str: 'BLOCK_M')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
            triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
            ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), SymNodeVariable()]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), SymNodeVariable()]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 3)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [SymNodeVariable()]
TRACE BINARY_OP 0 [SymNodeVariable(), ConstantVariable(int: 32)]
TRACE FX call add_2 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
            ~~^~~
TRACE LOAD_CONST 1 [SymNodeVariable()]
TRACE BINARY_OP 10 [SymNodeVariable(), ConstantVariable(int: 1)]
TRACE FX call sub_2 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
            ~~~~~~^~~
TRACE LOAD_FAST y [SymNodeVariable()]
TRACE BINARY_OP 2 [SymNodeVariable(), ConstantVariable(int: 32)]
TRACE FX call floordiv_2 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
           ~~~~~~~~~~~~^^~~
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [SymNodeVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:895 in <lambda> (_attention.forward) (inline depth: 1)
                nheads_q,
TRACE LOAD_DEREF nheads_q [SymNodeVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:896 in <lambda> (_attention.forward) (inline depth: 1)
                batch,
TRACE LOAD_DEREF batch [SymNodeVariable(), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE BUILD_TUPLE 3 [SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [TupleVariable(length=3)]
DONE INLINING <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>
TRACE inlined call <lambda> from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>, inlined according trace_rules.lookup inlined by default
TRACE COPY_FREE_VARS 3 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
                triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
TRACE LOAD_GLOBAL triton []
TRACE LOAD_ATTR cdiv [NullVariable, LazyVariableTracker()]
TRACE LOAD_DEREF max_seqlens_q [NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST META [NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE LOAD_CONST BLOCK_M [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstDictVariable()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstDictVariable(), ConstantVariable(str: 'BLOCK_M')]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), SymNodeVariable(), ConstantVariable(int: 32)]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:894 in <lambda> (_attention.forward) (inline depth: 1)
            triton.cdiv(max_seqlens_q, META["BLOCK_M"]),
            ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1082 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        def __call__(self, *args, _semantic=None, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1083 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            from triton.language.core import _unwrap_if_constexpr, constexpr
TRACE LOAD_CONST 0 []
TRACE LOAD_CONST ('_unwrap_if_constexpr', 'constexpr') [ConstantVariable(int: 0)]
TRACE IMPORT_NAME triton.language.core [ConstantVariable(int: 0), TupleVariable(length=2)]
TRACE IMPORT_FROM _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST _unwrap_if_constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE IMPORT_FROM constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE STORE_FAST constexpr [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>), LazyVariableTracker()]
TRACE POP_TOP None [PythonModuleVariable(<module 'triton.language.core' from '/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py'>)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            args = [_unwrap_if_constexpr(x) for x in args]
TRACE LOAD_FAST args []
TRACE GET_ITER None [TupleVariable(length=2)]
TRACE LOAD_FAST_AND_CLEAR x [ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [ListIteratorVariable(length=2, index=0), NullVariable]
TRACE BUILD_LIST 0 [NullVariable, ListIteratorVariable(length=2, index=0)]
TRACE SWAP 2 [NullVariable, ListIteratorVariable(length=2, index=0), ListVariable(length=0)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=0)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), SymNodeVariable()]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker()]
TRACE CALL 1 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), SymNodeVariable()]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), SymNodeVariable()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), SymNodeVariable(), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=0), ListIteratorVariable(length=2, index=1), SymNodeVariable()]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=1)]
TRACE STORE_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE PUSH_NULL None [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2)]
TRACE LOAD_FAST _unwrap_if_constexpr [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable]
TRACE LOAD_FAST x [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable()]
TRACE CALL 1 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), NullVariable, UserFunctionVariable(), ConstantVariable(int: 32)]
TRACE inlined call _unwrap_if_constexpr from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1085 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        args = [_unwrap_if_constexpr(x) for x in args]
                ~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:346 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
    def _unwrap_if_constexpr(o):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:347 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, list):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, LazyVariableTracker()]
TRACE LOAD_GLOBAL list [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, LazyVariableTracker(), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 84 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:349 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, builtins.tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL builtins [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE LOAD_ATTR tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 192 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:351 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        if isinstance(o, tuple):
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL tuple [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 260 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py:353 in _unwrap_if_constexpr (_unwrap_if_constexpr) (inline depth: 3)
        return o.value if isinstance(o, constexpr) else o
TRACE LOAD_GLOBAL isinstance []
TRACE LOAD_FAST o [NullVariable, BuiltinVariable(isinstance)]
TRACE LOAD_GLOBAL constexpr [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32)]
TRACE CALL 2 [NullVariable, BuiltinVariable(isinstance), ConstantVariable(int: 32), LazyVariableTracker()]
TRACE POP_JUMP_IF_FALSE 316 [ConstantVariable(bool: False)]
TRACE LOAD_FAST o []
TRACE RETURN_VALUE None [ConstantVariable(int: 32)]
DONE INLINING <code object _unwrap_if_constexpr at 0x2deb8910, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/language/core.py", line 346>
TRACE LIST_APPEND 2 [NullVariable, ListVariable(length=1), ListIteratorVariable(length=2, index=2), ConstantVariable(int: 32)]
TRACE JUMP_BACKWARD 30 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE FOR_ITER 54 [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2)]
TRACE END_FOR None [NullVariable, ListVariable(length=2), ListIteratorVariable(length=2, index=2), ConstantVariable(NoneType: None)]
TRACE STORE_FAST args [NullVariable, ListVariable(length=2)]
TRACE STORE_FAST x [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1086 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            kwargs = {k: _unwrap_if_constexpr(v) for (k, v) in kwargs.items()}
TRACE LOAD_FAST kwargs []
TRACE LOAD_ATTR items [ConstDictVariable()]
TRACE CALL 0 [NullVariable, GetAttrVariable(ConstDictVariable(), items)]
TRACE GET_ITER None [DictItemsVariable()]
TRACE LOAD_FAST_AND_CLEAR k [ListIteratorVariable(length=0, index=0)]
TRACE LOAD_FAST_AND_CLEAR v [ListIteratorVariable(length=0, index=0), NullVariable]
TRACE SWAP 3 [ListIteratorVariable(length=0, index=0), NullVariable, NullVariable]
TRACE BUILD_MAP 0 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0)]
TRACE SWAP 2 [NullVariable, NullVariable, ListIteratorVariable(length=0, index=0), ConstDictVariable()]
TRACE FOR_ITER 134 [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0)]
TRACE END_FOR None [NullVariable, NullVariable, ConstDictVariable(), ListIteratorVariable(length=0, index=0), ConstantVariable(NoneType: None)]
TRACE STORE_FAST kwargs [NullVariable, NullVariable, ConstDictVariable()]
TRACE STORE_FAST k [NullVariable, NullVariable]
TRACE STORE_FAST v [NullVariable]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            res = self.fn(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR fn [NullVariable, UserDefinedObjectVariable(ConstexprFunction)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), ListVariable(length=2)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), ListVariable(length=2), ConstDictVariable()]
TRACE inlined call cdiv from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1089 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
        res = self.fn(*args, **kwargs)
              ~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:66 in cdiv () (inline depth: 3)
    @constexpr_function
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
        return (x + y - 1) // y
TRACE LOAD_FAST x []
TRACE LOAD_FAST y [SymNodeVariable()]
TRACE BINARY_OP 0 [SymNodeVariable(), ConstantVariable(int: 32)]
TRACE FX call add_3 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
            ~~^~~
TRACE LOAD_CONST 1 [SymNodeVariable()]
TRACE BINARY_OP 10 [SymNodeVariable(), ConstantVariable(int: 1)]
TRACE FX call sub_3 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
            ~~~~~~^~~
TRACE LOAD_FAST y [SymNodeVariable()]
TRACE BINARY_OP 2 [SymNodeVariable(), ConstantVariable(int: 32)]
TRACE FX call floordiv_3 from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv (cdiv) (inline depth: 3)
    return (x + y - 1) // y
           ~~~~~~~~~~~~^^~~
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object cdiv at 0x70c9a94dc1f0, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py", line 66>
TRACE STORE_FAST res [SymNodeVariable()]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1091 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
            if _semantic is None:
TRACE LOAD_FAST _semantic []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE IS_OP 1 [LazyVariableTracker(), ConstantVariable(NoneType: None)]
TRACE POP_JUMP_IF_TRUE 190 [ConstantVariable(bool: False)]
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py:1093 in __call__ (ConstexprFunction.__call__) (inline depth: 2)
                return res
TRACE LOAD_FAST res []
TRACE RETURN_VALUE None [SymNodeVariable()]
DONE INLINING <code object __call__ at 0x70c9a946c990, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/runtime/jit.py", line 1082>
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:895 in <lambda> (_attention.forward) (inline depth: 1)
                nheads_q,
TRACE LOAD_DEREF nheads_q [SymNodeVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:896 in <lambda> (_attention.forward) (inline depth: 1)
                batch,
TRACE LOAD_DEREF batch [SymNodeVariable(), ConstantVariable(int: 64)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:893 in <lambda> (_attention.forward) (inline depth: 1)
            grid = lambda META: (
TRACE BUILD_TUPLE 3 [SymNodeVariable(), ConstantVariable(int: 64), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [TupleVariable(length=3)]
DONE INLINING <code object <lambda> at 0x70c98a36c730, file "/home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py", line 893>
wrap_to_fake L['cu_seqlens_k'] (2,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='cu_seqlens_k', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_cu_seqlens_k_ L['cu_seqlens_k'] FakeTensor(..., device='cuda:0', size=(2,), dtype=torch.int32) at debug_level 0 before=False
TRACE FX call triton_kernel_wrapper_mutation from /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward (_attention.forward)
        attn_fwd[grid](
        ~~~~~~~~~~~~~~^
            q,
            ^^
            k,
            ^^
            v,
            ^^
            bias,
            ^^^^^
            sm_scale,
            ^^^^^^^^^
            q_scale,
            ^^^^^^^^
            k_scale,
            ^^^^^^^^
            v_scale,
            ^^^^^^^^
            p_scale,
            ^^^^^^^^
            p_descale,
            ^^^^^^^^^^
            o_descale,
            ^^^^^^^^^^
            None,
            ^^^^^
            o,
            ^^
            *q_strides,
            ^^^^^^^^^^^
            *k_strides,
            ^^^^^^^^^^^
            *v_strides,
            ^^^^^^^^^^^
            *o_strides,
            ^^^^^^^^^^^
            *bias_strides,
            ^^^^^^^^^^^^^^
            cu_seqlens_q,
            ^^^^^^^^^^^^^
            cu_seqlens_k,
            ^^^^^^^^^^^^^
            dropout_p=0.0,
            ^^^^^^^^^^^^^^
            philox_seed=philox_seed,
            ^^^^^^^^^^^^^^^^^^^^^^^^
            philox_offset_base=philox_offset,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            encoded_softmax=encoded_softmax,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            HQ=nheads_q,
            ^^^^^^^^^^^^
            HK=nheads_k,
            ^^^^^^^^^^^^
            ACTUAL_BLOCK_DMODEL=head_size,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_Q=arg_max_seqlens_q,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            MAX_SEQLENS_K=arg_max_seqlens_k,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            IS_CAUSAL=causal,
            ^^^^^^^^^^^^^^^^^
            VARLEN=True,
            ^^^^^^^^^^^^
            BLOCK_DMODEL=padded_d_model,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            BIAS_TYPE=0 if bias is None else 1,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            ENABLE_DROPOUT=False,
            ^^^^^^^^^^^^^^^^^^^^^
            RETURN_ENCODED_SOFTMAX=False,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            USE_FP8=use_fp8,
            ^^^^^^^^^^^^^^^^
            USE_FP8_OUT=fp8_out_scale is not None,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
TRACE POP_TOP None [ConstantVariable(NoneType: None)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:962 in forward (_attention.forward)
            return o, encoded_softmax
TRACE LOAD_FAST o []
TRACE LOAD_FAST encoded_softmax [TensorVariable()]
TRACE BUILD_TUPLE 2 [TensorVariable(), ConstantVariable(NoneType: None)]
TRACE RETURN_VALUE None [TupleVariable(length=2)]
Step 1: torchdynamo done tracing forward (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py, line 962 in forward>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_51_7298cafb_326d_4e2b_84af_9121dcceef54 =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, L_o_: "[31mbf16[0m[34m[1, 64, 128][0m[2m[34m[8192, 128, 1][0m[2m[32mcuda:0[0m", L_q_: "[31mbf16[0m[34m[1, 64, 128][0m[2m[34m[8192, 128, 1][0m[2m[32mcuda:0[0m", s37: "Sym(s37)", L_k_: "[31mbf16[0m[34m[s37, 8, 128][0m[2m[34m[1024, 128, 1][0m[2m[32mcuda:0[0m", L_cu_seqlens_q_: "[31mi32[0m[34m[2][0m[2m[34m[1][0m[2m[32mcuda:0[0m", s33: "Sym(s33)", L_v_: "[31mbf16[0m[34m[s33, 8, 128][0m[2m[34m[1024, 128, 1][0m[2m[32mcuda:0[0m", L_max_seqlens_q_: "Sym(s30)", L_cu_seqlens_k_: "[31mi32[0m[34m[2][0m[2m[34m[1][0m[2m[32mcuda:0[0m"):
        l_o_ = L_o_
        l_q_ = L_q_
        l_k_ = L_k_
        l_cu_seqlens_q_ = L_cu_seqlens_q_
        l_v_ = L_v_
        l_max_seqlens_q_ = L_max_seqlens_q_
        l_cu_seqlens_k_ = L_cu_seqlens_k_
        
         [2m# File: /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/triton/__init__.py:68 in cdiv, code: return (x + y - 1) // y[0m
        add: "Sym(s30 + 32)" = l_max_seqlens_q_ + [34m32[0m;  [2ml_max_seqlens_q_ = None[0m
        sub: "Sym(s30 + 31)" = add - [34m1[0m;  [2madd = None[0m
        floordiv: "Sym(((s30 + 31)//32))" = sub // [34m32[0m;  [2msub = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/flashattention_triton.py:922 in forward, code: attn_fwd[grid]([0m
        triton_kernel_wrapper_mutation = torch.ops.higher_order.triton_kernel_wrapper_mutation(kernel_idx = [34m1[0m, constant_args_idx = [34m9[0m, grid = [(floordiv, [34m64[0m, [34m1[0m), (floordiv, [34m64[0m, [34m1[0m), (floordiv, [34m64[0m, [34m1[0m), (floordiv, [34m64[0m, [34m1[0m)], tma_descriptor_metadata = [34m{}[0m, kwargs = [34m{'Q': l_q_, 'K': l_k_, 'V': l_v_, 'Out': l_o_, 'cu_seqlens_q': l_cu_seqlens_q_, 'cu_seqlens_k': l_cu_seqlens_k_}[0m);  [2mfloordiv = l_q_ = l_k_ = l_v_ = l_o_ = l_cu_seqlens_q_ = l_cu_seqlens_k_ = triton_kernel_wrapper_mutation = None[0m
        return ()
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing fpx_matmul /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:420
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:420 in fpx_matmul (fpx_matmul)
    def fpx_matmul(x,weight,weight_state,ebits:int=3,mbits:int=2):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:421 in fpx_matmul (fpx_matmul)
        if ebits == -44: #hqq
TRACE LOAD_FAST ebits []
TRACE LOAD_CONST -44 [LazyVariableTracker()]
TRACE COMPARE_OP == [LazyVariableTracker(), ConstantVariable(int: -44)]
TRACE POP_JUMP_IF_FALSE 322 [ConstantVariable(bool: True)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:422 in fpx_matmul (fpx_matmul)
            S0=x.shape[0]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [LazyVariableTracker()]
automatic dynamic stride L['x'] stride(0) InferStride(dim=2) != InferStride(dim=1)
wrap_to_fake L['x'] (1, 1, 8192) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='x', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}), tensor_source=LocalSource(local_name='x', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_x_ L['x'] FakeTensor(..., device='cuda:0', size=(1, 1, 8192), dtype=torch.bfloat16) at debug_level 0 before=False
wrap_to_fake L['x']._base (1, 64, 128) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[RelaxedUnspecConstraint(warn_only=True), None, None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=AttrSource(base=LocalSource(local_name='x', is_input=True, dynamism=None, is_derefed_cell_contents=False), member='_base'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
TRACE LOAD_CONST 0 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 0)]
TRACE STORE_FAST S0 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:423 in fpx_matmul (fpx_matmul)
            S1=x.shape[1]
TRACE LOAD_FAST x []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE LOAD_CONST 1 [SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [SizeVariable(length=3), ConstantVariable(int: 1)]
TRACE STORE_FAST S1 [ConstantVariable(int: 1)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:424 in fpx_matmul (fpx_matmul)
            dtype = x.dtype
TRACE LOAD_FAST x []
TRACE LOAD_ATTR dtype [TensorVariable()]
TRACE STORE_FAST dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul)
            x = x.to(dtype=torch.float16).view(-1,x.shape[2])
TRACE LOAD_FAST x []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float16 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST x [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1)]
TRACE LOAD_ATTR shape [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3)]
TRACE BINARY_SUBSCR None [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), SizeVariable(length=3), ConstantVariable(int: 2)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: -1), ConstantVariable(int: 8192)]
TRACE FX call view from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul (fpx_matmul)
        x = x.to(dtype=torch.float16).view(-1,x.shape[2])
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST x [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul)
            out = weight.forward_manual(x).to(dtype=dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_ATTR forward_manual [LazyVariableTracker()]
TRACE LOAD_FAST x [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE CALL 1 [NullVariable, UserMethodVariable(<function GemLiteLinearTriton.forward_manual at 0x70c98a9e91c0>, UnspecializedNNModuleVariable(GemLiteLinearTriton)), TensorVariable()]
TRACE inlined call forward_manual from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~^^^
INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:543 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
        def forward_manual(self, x: Tensor, matmul_type: str="GEMM") -> Tensor:
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
            return forward_functional(
TRACE LOAD_GLOBAL forward_functional []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:545 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
                x,
TRACE LOAD_FAST x [NullVariable, LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:546 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
                self.bias,
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR bias [NullVariable, LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
                self.get_tensor_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE LOAD_ATTR get_tensor_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_tensor_args at 0x70c98a9e9080>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_tensor_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:547 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
            self.get_tensor_args(),
            ~~~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:524 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 2)
        def get_tensor_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:525 in get_tensor_args (GemLiteLinearTriton.get_tensor_args) (inline depth: 2)
            return [self.W_q, self.scales, self.zeros]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR W_q [UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_FAST self [LazyVariableTracker()]
TRACE LOAD_ATTR scales [LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['weight']._parameters['scales'] (128, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='weight', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='scales'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_weight_parameters_scales_ L['weight']._parameters['scales'] Parameter(FakeTensor(..., device='cuda:0', size=(128, 5120), dtype=torch.float16)) at debug_level 0 before=False
TRACE LOAD_FAST self [LazyVariableTracker(), TensorVariable()]
TRACE LOAD_ATTR zeros [LazyVariableTracker(), TensorVariable(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
wrap_to_fake L['weight']._parameters['zeros'] (128, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=DictGetItemSource(base=UnspecializedParamBufferSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='weight', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='_parameters'), index='zeros'), shape_env_to_source_to_symbol_cache={}) <class 'torch.nn.parameter.Parameter'>
create_graph_input L_weight_parameters_zeros_ L['weight']._parameters['zeros'] Parameter(FakeTensor(..., device='cuda:0', size=(128, 5120), dtype=torch.float16)) at debug_level 0 before=False
TRACE BUILD_LIST 3 [LazyVariableTracker(), TensorVariable(), TensorVariable()]
TRACE RETURN_VALUE None [ListVariable(length=3)]
DONE INLINING <code object get_tensor_args at 0x70c98ce32560, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 524>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
                self.get_meta_args(),
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3)]
TRACE LOAD_ATTR get_meta_args [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 0 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), NullVariable, UserMethodVariable(<function GemLiteLinearTriton.get_meta_args at 0x70c98a9e9120>, UnspecializedNNModuleVariable(GemLiteLinearTriton))]
TRACE inlined call get_meta_args from /home/client/Projects/RWKV-Infer/gemlite/core.py:548 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
            self.get_meta_args(),
            ~~~~~~~~~~~~~~~~~~^^
INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>, inlined according trace_rules.lookup inlined by default
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:527 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
        def get_meta_args(self):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
            return [int(self.scaled_activations),
TRACE LOAD_GLOBAL int []
TRACE LOAD_FAST self [NullVariable, LazyVariableTracker()]
TRACE LOAD_ATTR scaled_activations [NullVariable, LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [NullVariable, LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:529 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.W_nbits,
TRACE LOAD_FAST self [ConstantVariable(int: 0)]
TRACE LOAD_ATTR W_nbits [ConstantVariable(int: 0), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:530 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.group_size,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker()]
TRACE LOAD_ATTR group_size [ConstantVariable(int: 0), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:531 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.unpack_mask,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR unpack_mask [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:532 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.elements_per_sample,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR elements_per_sample [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:533 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.input_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR input_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:534 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.output_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR output_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:535 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.acc_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR acc_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:536 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.meta_dtype.value,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR meta_dtype [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE LOAD_ATTR value [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:537 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.channel_scale_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR channel_scale_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:538 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    self.W_group_mode,
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_ATTR W_group_mode [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:539 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
                    int(self.data_contiguous),
TRACE LOAD_GLOBAL int [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST self [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int)]
TRACE LOAD_ATTR data_contiguous [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), UnspecializedNNModuleVariable(GemLiteLinearTriton)]
TRACE CALL 1 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), NullVariable, BuiltinVariable(int), LazyVariableTracker()]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:528 in get_meta_args (GemLiteLinearTriton.get_meta_args) (inline depth: 2)
            return [int(self.scaled_activations),
TRACE BUILD_LIST 12 [ConstantVariable(int: 0), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), ConstantVariable(int: 1)]
TRACE RETURN_VALUE None [ListVariable(length=12)]
DONE INLINING <code object get_meta_args at 0x306405a0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 527>
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:549 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
                GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
TRACE LOAD_GLOBAL GEMLITE_MATMUL_TYPES_MAPPING [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12)]
TRACE LOAD_FAST matmul_type [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker(), ConstantVariable(str: 'GEMM')]
TRACE starts_line /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
            return forward_functional(
TRACE CALL 5 [NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker(), ListVariable(length=3), ListVariable(length=12), LazyVariableTracker()]
TRACE inlined call __call__ from /home/client/Projects/RWKV-Infer/gemlite/core.py:544 in forward_manual (GemLiteLinearTriton.forward_manual) (inline depth: 1)
        return forward_functional(
               ~~~~~~~~~~~~~~~~~~^
            x,
            ^^
            self.bias,
            ^^^^^^^^^^
            self.get_tensor_args(),
            ^^^^^^^^^^^^^^^^^^^^^^^
            self.get_meta_args(),
            ^^^^^^^^^^^^^^^^^^^^^
            GEMLITE_MATMUL_TYPES_MAPPING[matmul_type],
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>, inlined according trace_rules.lookup MOD_INLINELIST
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:675 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 2)
        def __call__(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 2)
            return self._opoverload(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST self [NullVariable]
TRACE LOAD_ATTR _opoverload [NullVariable, UserDefinedObjectVariable(CustomOpDef)]
TRACE LOAD_FAST args [NullVariable, LazyVariableTracker()]
TRACE BUILD_MAP 0 [NullVariable, LazyVariableTracker(), TupleVariable(length=5)]
TRACE LOAD_FAST kwargs [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, LazyVariableTracker(), TupleVariable(length=5), ConstDictVariable()]
wrap_to_fake L['weight'].W_q (1024, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, None], constraint_strides=[None, None], specialize_on=[[], []], view_base_context=None, tensor_source=AttrSource(base=UnspecializedNNModuleSource(base=LocalSource(local_name='weight', is_input=True, dynamism=None, is_derefed_cell_contents=False)), member='W_q'), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_weight_W_q L['weight'].W_q FakeTensor(..., device='cuda:0', size=(1024, 5120), dtype=torch.int32) at debug_level 0 before=False
TRACE FX call forward_functional_default from /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__ (custom_op.custom_op.CustomOpDef.__call__) (inline depth: 2)
        return self._opoverload(*args, **kwargs)
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object __call__ at 0x70c9c3bc3960, file "/home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py", line 675>
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object forward_manual at 0x70c98ce48cb0, file "/home/client/Projects/RWKV-Infer/gemlite/core.py", line 543>
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE KW_NAMES ('dtype',) [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_1 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul (fpx_matmul)
        out = weight.forward_manual(x).to(dtype=dtype)
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE STORE_FAST out [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul)
            return out.view(S0,S1,-1)
TRACE LOAD_FAST out []
TRACE LOAD_ATTR view [TensorVariable()]
TRACE LOAD_FAST S0 [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST S1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int: 1), ConstantVariable(int: 1), ConstantVariable(int: -1)]
TRACE FX call view_1 from /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul (fpx_matmul)
        return out.view(S0,S1,-1)
               ~~~~~~~~^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
Step 1: torchdynamo done tracing fpx_matmul (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py, line 440 in fpx_matmul>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_53_c7e1b2b5_8d41_48b4_a7cf_7a6cdd359153 =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, L_x_: "[31mbf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m", L_weight_parameters_scales_: "[31mf16[0m[34m[128, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m", L_weight_parameters_zeros_: "[31mf16[0m[34m[128, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m", L_weight_W_q: "[31mi32[0m[34m[1024, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m"):
        l_x_ = L_x_
        l_weight_parameters_scales_ = L_weight_parameters_scales_
        l_weight_parameters_zeros_ = L_weight_parameters_zeros_
        l_weight_w_q = L_weight_W_q
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:425 in fpx_matmul, code: x = x.to(dtype=torch.float16).view(-1,x.shape[2])[0m
        to: "[31mf16[0m[34m[1, 1, 8192][0m[2m[34m[8192, 8192, 1][0m[2m[32mcuda:0[0m" = l_x_.to(dtype = [34mtorch.float16[0m);  [2ml_x_ = None[0m
        x: "[31mf16[0m[34m[1, 8192][0m[2m[34m[8192, 1][0m[2m[32mcuda:0[0m" = to.view([34m-1[0m, [34m8192[0m);  [2mto = None[0m
        
         [2m# File: /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/_library/custom_ops.py:676 in __call__, code: return self._opoverload(*args, **kwargs)[0m
        forward_functional_default: "[31mf16[0m[34m[1, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m" = torch.ops.gemlite.forward_functional.default(x, [34mNone[0m, [l_weight_w_q, l_weight_parameters_scales_, l_weight_parameters_zeros_], [[34m0[0m, [34m4[0m, [34m64[0m, [34m15[0m, [34m8[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m1[0m, [34m0[0m, [34m4[0m, [34m1[0m], [34m4[0m);  [2mx = l_weight_w_q = l_weight_parameters_scales_ = l_weight_parameters_zeros_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:436 in fpx_matmul, code: out = weight.forward_manual(x).to(dtype=dtype)[0m
        out: "[31mbf16[0m[34m[1, 5120][0m[2m[34m[5120, 1][0m[2m[32mcuda:0[0m" = forward_functional_default.to(dtype = [34mtorch.bfloat16[0m);  [2mforward_functional_default = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/quantization.py:440 in fpx_matmul, code: return out.view(S0,S1,-1)[0m
        view_1: "[31mbf16[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = out.view([34m1[0m, [34m1[0m, [34m-1[0m);  [2mout = None[0m
        return (view_1,)
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing T5RMSNorm /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:373 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    def T5RMSNorm(hidden_states,weight,variance_epsilon:float=1e-6):
TRACE RESUME 0 []
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:374 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
        input_dtype = hidden_states.dtype
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR dtype [LazyVariableTracker()]
automatic dynamic stride L['hidden_states'] stride(0) InferStride(dim=2) != InferStride(dim=1)
wrap_to_fake L['hidden_states'] (1, 1, 5120) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>, <DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None, RelaxedUnspecConstraint(warn_only=True), None], constraint_strides=[None, None, None], specialize_on=[[], [], []], view_base_context=None, tensor_source=LocalSource(local_name='hidden_states', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_hidden_states_ L['hidden_states'] FakeTensor(..., device='cuda:0', size=(1, 1, 5120), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE STORE_FAST input_dtype [ConstantVariable(dtype: torch.bfloat16)]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
        hidden_states = hidden_states.to(torch.float32)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR float32 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), LazyVariableTracker()]
TRACE FX call to from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    hidden_states = hidden_states.to(torch.float32)
                    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
        variance = hidden_states.pow(2).mean(-1, keepdim=True)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_ATTR pow [TensorVariable()]
TRACE LOAD_CONST 2 [NullVariable, GetAttrVariable(TensorVariable(), pow)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), pow), ConstantVariable(int: 2)]
TRACE FX call pow_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~^^^
TRACE LOAD_ATTR mean [TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), mean)]
TRACE LOAD_CONST True [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1)]
TRACE KW_NAMES ('keepdim',) [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE CALL 2 [NullVariable, GetAttrVariable(TensorVariable(), mean), ConstantVariable(int: -1), ConstantVariable(bool: True)]
TRACE FX call mean from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
               ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST variance [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
        hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
TRACE LOAD_FAST hidden_states []
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR rsqrt [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance [TensorVariable(), NullVariable, LazyVariableTracker()]
TRACE LOAD_FAST variance_epsilon [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE BINARY_OP 0 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable(), LazyVariableTracker()]
TRACE FX call add from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                                ~~~~~~~~~^~~~~~~~~~~~~~~~~~
TRACE CALL 1 [TensorVariable(), NullVariable, LazyVariableTracker(), TensorVariable()]
TRACE FX call rsqrt from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)
                    ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST hidden_states [TensorVariable()]
TRACE starts_line /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
        return (weight * hidden_states).to(input_dtype)
TRACE LOAD_FAST weight []
TRACE LOAD_FAST hidden_states [LazyVariableTracker()]
TRACE BINARY_OP 5 [LazyVariableTracker(), TensorVariable()]
wrap_to_fake L['weight'] (5120,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='weight', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>
create_graph_input L_weight_ L['weight'] FakeTensor(..., device='cuda:0', size=(5120,), dtype=torch.bfloat16) at debug_level 0 before=False
TRACE FX call mul_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    return (weight * hidden_states).to(input_dtype)
            ~~~~~~~^~~~~~~~~~~~~~~
TRACE LOAD_ATTR to [TensorVariable()]
TRACE LOAD_FAST input_dtype [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(dtype: torch.bfloat16)]
TRACE FX call to_1 from /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm (fused_recurrent_dplr_delta_rule_decode_t1.grid.T5RMSNorm)
    return (weight * hidden_states).to(input_dtype)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
TRACE RETURN_VALUE None [TensorVariable()]
Step 1: torchdynamo done tracing T5RMSNorm (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py, line 378 in T5RMSNorm>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_55_768b007e_5ee6_4f4e_8464_b6d5d7e70eb8 =====
 /home/client/miniconda3/envs/RWKV-Infer/lib/python3.12/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):
    def forward(self, L_hidden_states_: "[31mbf16[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m", L_weight_: "[31mbf16[0m[34m[5120][0m[2m[34m[1][0m[2m[32mcuda:0[0m"):
        l_hidden_states_ = L_hidden_states_
        l_weight_ = L_weight_
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:375 in T5RMSNorm, code: hidden_states = hidden_states.to(torch.float32)[0m
        hidden_states: "[31mf32[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = l_hidden_states_.to([34mtorch.float32[0m);  [2ml_hidden_states_ = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:376 in T5RMSNorm, code: variance = hidden_states.pow(2).mean(-1, keepdim=True)[0m
        pow_1: "[31mf32[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states.pow([34m2[0m)
        variance: "[31mf32[0m[34m[1, 1, 1][0m[2m[34m[1, 1, 1][0m[2m[32mcuda:0[0m" = pow_1.mean([34m-1[0m, keepdim = [34mTrue[0m);  [2mpow_1 = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:377 in T5RMSNorm, code: hidden_states = hidden_states * torch.rsqrt(variance + variance_epsilon)[0m
        add: "[31mf32[0m[34m[1, 1, 1][0m[2m[34m[1, 1, 1][0m[2m[32mcuda:0[0m" = variance + [34m1e-06[0m;  [2mvariance = None[0m
        rsqrt: "[31mf32[0m[34m[1, 1, 1][0m[2m[34m[1, 1, 1][0m[2m[32mcuda:0[0m" = torch.rsqrt(add);  [2madd = None[0m
        hidden_states_1: "[31mf32[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = hidden_states * rsqrt;  [2mhidden_states = rsqrt = None[0m
        
         [2m# File: /home/client/Projects/RWKV-Infer/rwkvengine/hrwkv7.py:378 in T5RMSNorm, code: return (weight * hidden_states).to(input_dtype)[0m
        mul_1: "[31mf32[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = l_weight_ * hidden_states_1;  [2ml_weight_ = hidden_states_1 = None[0m
        to_1: "[31mbf16[0m[34m[1, 1, 5120][0m[2m[34m[5120, 5120, 1][0m[2m[32mcuda:0[0m" = mul_1.to([34mtorch.bfloat16[0m);  [2mmul_1 = None[0m
        return (to_1,)
        

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
